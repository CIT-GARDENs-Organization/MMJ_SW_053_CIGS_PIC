CCS PCM C Compiler, Version 5.104, 57077               26-6-25 19:19

               Filename:   build\mmj_cigs_main.lst

               ROM used:   15698 words (96%)
                           Largest free fragment is 620
               RAM used:   892 (44%) at main() level
                           1313 (64%) worst case
               Stack used: 6 locations (5 in main + 1 for interrupts)
               Stack size: 16

*
0000:  MOVLP  38
0001:  GOTO   42B
0002:  NOP
*
0004:  CLRF   03
0005:  MOVLP  00
0006:  MOVLB  00
0007:  MOVF   77,W
0008:  MOVWF  20
0009:  MOVF   78,W
000A:  MOVWF  21
000B:  MOVF   79,W
000C:  MOVWF  22
000D:  MOVF   7A,W
000E:  MOVWF  23
000F:  MOVLB  03
0010:  MOVF   11,W
0011:  MOVLB  00
0012:  MOVWF  24
0013:  MOVLB  03
0014:  MOVF   12,W
0015:  MOVLB  00
0016:  MOVWF  25
0017:  MOVLB  03
0018:  MOVF   13,W
0019:  MOVLB  00
001A:  MOVWF  26
001B:  MOVLB  03
001C:  MOVF   14,W
001D:  MOVLB  00
001E:  MOVWF  27
001F:  CLRF   05
0020:  MOVLW  91
0021:  MOVWF  04
0022:  BTFSS  00.0
0023:  GOTO   026
0024:  BTFSC  11.0
0025:  GOTO   046
0026:  CLRF   05
0027:  MOVLW  91
0028:  MOVWF  04
0029:  BTFSS  00.5
002A:  GOTO   02D
002B:  BTFSC  11.5
002C:  GOTO   048
002D:  MOVF   20,W
002E:  MOVWF  77
002F:  MOVF   21,W
0030:  MOVWF  78
0031:  MOVF   22,W
0032:  MOVWF  79
0033:  MOVF   23,W
0034:  MOVWF  7A
0035:  MOVF   24,W
0036:  MOVLB  03
0037:  MOVWF  11
0038:  MOVLB  00
0039:  MOVF   25,W
003A:  MOVLB  03
003B:  MOVWF  12
003C:  MOVLB  00
003D:  MOVF   26,W
003E:  MOVLB  03
003F:  MOVWF  13
0040:  MOVLB  00
0041:  MOVF   27,W
0042:  MOVLB  03
0043:  MOVWF  14
0044:  RETFIE
0045:  MOVLB  00
0046:  MOVLP  00
0047:  GOTO   04A
0048:  MOVLP  00
0049:  GOTO   06A
.................... #include "cigs/mmj_cigs_main.h"
.................... #ifndef MMJ_CIGS_MAIN_H
.................... #define MMJ_CIGS_MAIN_H
.................... 
.................... //#opt 0 // 0 = no optimization, 1 = optimize for speed, 2 = optimize for size
.................... 
.................... // pin assignment etc
.................... #include "mmj_cigs_config.h"
.................... #ifndef MMJ_CIGS_CONFIG_H
.................... #define MMJ_CIGS_CONFIG_H
.................... 
.................... #include <16F1789.h>
.................... //////////// Standard Header file for the PIC16F1789 device ////////////////
.................... ///////////////////////////////////////////////////////////////////////////
.................... ////        (C) Copyright 1996, 2020 Custom Computer Services          ////
.................... //// This source code may only be used by licensed users of the CCS C  ////
.................... //// compiler.  This source code may only be distributed to other      ////
.................... //// licensed users of the CCS C compiler.  No other use, reproduction ////
.................... //// or distribution is permitted without written permission.          ////
.................... //// Derivative programs created using this software in object code    ////
.................... //// form are not restricted in any way.                               ////
.................... ///////////////////////////////////////////////////////////////////////////
.................... #device PIC16F1789
*
005A:  DATA D4,34
005B:  DATA ED,32
005C:  DATA 72,10
005D:  DATA 49,37
005E:  DATA 69,3A
005F:  DATA E9,30
0060:  DATA EC,34
0061:  DATA FA,32
0062:  DATA 0D,05
0063:  DATA 00,00
0064:  DATA 89,21
0065:  DATA EF,36
0066:  DATA 70,36
0067:  DATA 65,3A
0068:  DATA E5,06
0069:  DATA 0A,00
*
0083:  DATA D5,20
0084:  DATA 52,2A
0085:  DATA A0,24
0086:  DATA EE,34
0087:  DATA F4,34
0088:  DATA 61,36
0089:  DATA 69,3D
008A:  DATA E5,06
008B:  DATA 0A,00
008C:  DATA 89,21
008D:  DATA EF,36
008E:  DATA 70,36
008F:  DATA 65,3A
0090:  DATA E5,06
0091:  DATA 0A,00
0092:  DATA CD,24
0093:  DATA D3,29
0094:  DATA C9,27
0095:  DATA 4E,10
0096:  DATA 46,26
0097:  DATA C1,29
0098:  DATA 48,10
0099:  DATA 49,37
009A:  DATA 69,3A
009B:  DATA E9,30
009C:  DATA EC,34
009D:  DATA FA,32
009E:  DATA 0D,05
009F:  DATA 00,01
00A0:  DATA 09,23
00A1:  DATA EC,30
00A2:  DATA 73,34
00A3:  DATA A0,34
00A4:  DATA 73,10
00A5:  DATA EE,37
00A6:  DATA 74,10
00A7:  DATA E3,37
00A8:  DATA 6E,37
00A9:  DATA E5,31
00AA:  DATA F4,32
00AB:  DATA E4,06
00AC:  DATA 0A,00
00AD:  DATA 89,29
00AE:  DATA 4D,23
00AF:  DATA 20,10
00B0:  DATA D0,24
00B1:  DATA 43,26
00B2:  DATA CF,23
00B3:  DATA A0,2A
00B4:  DATA F3,32
00B5:  DATA A0,21
00B6:  DATA EF,3A
00B7:  DATA 6E,3A
00B8:  DATA 65,39
00B9:  DATA 20,10
00BA:  DATA 20,10
00BB:  DATA 20,10
00BC:  DATA 3A,10
00BD:  DATA 30,3C
00BE:  DATA 25,18
00BF:  DATA 38,26
00C0:  DATA D8,06
00C1:  DATA 0A,00
00C2:  DATA 89,29
00C3:  DATA 4D,23
00C4:  DATA 20,10
00C5:  DATA D0,24
00C6:  DATA 43,26
00C7:  DATA CF,23
00C8:  DATA 20,26
00C9:  DATA EF,37
00CA:  DATA 70,10
00CB:  DATA C3,37
00CC:  DATA 75,37
00CD:  DATA F4,32
00CE:  DATA 72,10
00CF:  DATA 20,10
00D0:  DATA 20,10
00D1:  DATA 3A,10
00D2:  DATA 30,3C
00D3:  DATA 25,18
00D4:  DATA 32,2C
00D5:  DATA 0D,05
00D6:  DATA 00,01
00D7:  DATA 89,29
00D8:  DATA 4D,23
00D9:  DATA 20,10
00DA:  DATA CD,22
00DB:  DATA C1,29
00DC:  DATA 20,10
00DD:  DATA A0,2A
00DE:  DATA F3,32
00DF:  DATA A0,21
00E0:  DATA EF,3A
00E1:  DATA 6E,3A
00E2:  DATA 65,39
00E3:  DATA 20,10
00E4:  DATA 20,10
00E5:  DATA 20,10
00E6:  DATA 3A,10
00E7:  DATA 30,3C
00E8:  DATA 25,18
00E9:  DATA 38,26
00EA:  DATA D8,06
00EB:  DATA 0A,00
00EC:  DATA 89,29
00ED:  DATA 4D,23
00EE:  DATA 20,10
00EF:  DATA CD,22
00F0:  DATA C1,29
00F1:  DATA 20,10
00F2:  DATA 20,26
00F3:  DATA EF,37
00F4:  DATA 70,10
00F5:  DATA C3,37
00F6:  DATA 75,37
00F7:  DATA F4,32
00F8:  DATA 72,10
00F9:  DATA 20,10
00FA:  DATA 20,10
00FB:  DATA 3A,10
00FC:  DATA 30,3C
00FD:  DATA 25,18
00FE:  DATA 32,2C
00FF:  DATA 0D,05
0100:  DATA 00,01
0101:  DATA 89,26
0102:  DATA C9,29
0103:  DATA 46,10
0104:  DATA D0,24
0105:  DATA 43,26
0106:  DATA CF,23
0107:  DATA A0,2A
0108:  DATA F3,32
0109:  DATA A0,21
010A:  DATA EF,3A
010B:  DATA 6E,3A
010C:  DATA 65,39
010D:  DATA 20,10
010E:  DATA 20,10
010F:  DATA 20,10
0110:  DATA 3A,10
0111:  DATA 30,3C
0112:  DATA 25,18
0113:  DATA 38,26
0114:  DATA D8,06
0115:  DATA 0A,00
0116:  DATA 89,26
0117:  DATA C9,29
0118:  DATA 46,10
0119:  DATA D0,24
011A:  DATA 43,26
011B:  DATA CF,23
011C:  DATA A0,2A
011D:  DATA EE,31
011E:  DATA 6F,38
011F:  DATA F9,32
0120:  DATA 64,10
0121:  DATA C3,37
0122:  DATA 75,37
0123:  DATA F4,32
0124:  DATA 72,10
0125:  DATA 3A,10
0126:  DATA 30,3C
0127:  DATA 25,18
0128:  DATA 38,26
0129:  DATA D8,06
012A:  DATA 0A,00
012B:  DATA 89,26
012C:  DATA C9,29
012D:  DATA 46,10
012E:  DATA D0,24
012F:  DATA 43,26
0130:  DATA CF,23
0131:  DATA 20,26
0132:  DATA EF,37
0133:  DATA 70,10
0134:  DATA C3,37
0135:  DATA 75,37
0136:  DATA F4,32
0137:  DATA 72,10
0138:  DATA 20,10
0139:  DATA 20,10
013A:  DATA 3A,10
013B:  DATA 30,3C
013C:  DATA 25,18
013D:  DATA 32,2C
013E:  DATA 0D,05
013F:  DATA 00,01
0140:  DATA 89,26
0141:  DATA C9,29
0142:  DATA 46,10
0143:  DATA D0,24
0144:  DATA 43,26
0145:  DATA CF,23
0146:  DATA A0,2B
0147:  DATA F2,34
0148:  DATA F4,32
0149:  DATA A0,21
014A:  DATA EF,3A
014B:  DATA 6E,3A
014C:  DATA 65,39
014D:  DATA 20,10
014E:  DATA 20,10
014F:  DATA 3A,10
0150:  DATA 30,3C
0151:  DATA 25,18
0152:  DATA 32,2C
0153:  DATA 0D,05
0154:  DATA 00,01
0155:  DATA 89,26
0156:  DATA C9,29
0157:  DATA 46,10
0158:  DATA CD,22
0159:  DATA C1,29
015A:  DATA 20,10
015B:  DATA A0,2A
015C:  DATA F3,32
015D:  DATA A0,21
015E:  DATA EF,3A
015F:  DATA 6E,3A
0160:  DATA 65,39
0161:  DATA 20,10
0162:  DATA 20,10
0163:  DATA 20,10
0164:  DATA 3A,10
0165:  DATA 30,3C
0166:  DATA 25,18
0167:  DATA 38,26
0168:  DATA D8,06
0169:  DATA 0A,00
016A:  DATA 89,26
016B:  DATA C9,29
016C:  DATA 46,10
016D:  DATA CD,22
016E:  DATA C1,29
016F:  DATA 20,10
0170:  DATA A0,2A
0171:  DATA EE,31
0172:  DATA 6F,38
0173:  DATA F9,32
0174:  DATA 64,10
0175:  DATA C3,37
0176:  DATA 75,37
0177:  DATA F4,32
0178:  DATA 72,10
0179:  DATA 3A,10
017A:  DATA 30,3C
017B:  DATA 25,18
017C:  DATA 38,26
017D:  DATA D8,06
017E:  DATA 0A,00
017F:  DATA 89,26
0180:  DATA C9,29
0181:  DATA 46,10
0182:  DATA CD,22
0183:  DATA C1,29
0184:  DATA 20,10
0185:  DATA 20,26
0186:  DATA EF,37
0187:  DATA 70,10
0188:  DATA C3,37
0189:  DATA 75,37
018A:  DATA F4,32
018B:  DATA 72,10
018C:  DATA 20,10
018D:  DATA 20,10
018E:  DATA 3A,10
018F:  DATA 30,3C
0190:  DATA 25,18
0191:  DATA 32,2C
0192:  DATA 0D,05
0193:  DATA 00,01
0194:  DATA 89,21
0195:  DATA EF,36
0196:  DATA 70,36
0197:  DATA 65,3A
0198:  DATA E5,06
0199:  DATA 0A,00
019A:  DATA CD,34
019B:  DATA F3,39
019C:  DATA E9,37
019D:  DATA 6E,10
019E:  DATA 46,36
019F:  DATA E1,39
01A0:  DATA 68,10
01A1:  DATA E9,39
01A2:  DATA 20,37
01A3:  DATA 6F,3A
01A4:  DATA A0,31
01A5:  DATA 6F,37
01A6:  DATA EE,32
01A7:  DATA 63,3A
01A8:  DATA 65,32
01A9:  DATA 0D,05
01AA:  DATA 00,00
01AB:  DATA 5B,28
01AC:  DATA C9,21
01AD:  DATA CC,27
01AE:  DATA C7,2E
01AF:  DATA 20,1D
01B0:  DATA 20,00
01B1:  DATA CD,34
01B2:  DATA F3,39
01B3:  DATA E9,37
01B4:  DATA 6E,10
01B5:  DATA 46,36
01B6:  DATA E1,39
01B7:  DATA 68,10
01B8:  DATA E9,39
01B9:  DATA 20,37
01BA:  DATA 6F,3A
01BB:  DATA A0,31
01BC:  DATA 6F,37
01BD:  DATA EE,32
01BE:  DATA 63,3A
01BF:  DATA 65,32
01C0:  DATA 0D,05
01C1:  DATA 00,00
01C2:  DATA 41,22
01C3:  DATA 37,1A
01C4:  DATA 39,18
01C5:  DATA A0,24
01C6:  DATA EE,34
01C7:  DATA F4,34
01C8:  DATA 61,36
01C9:  DATA 69,3D
01CA:  DATA E5,06
01CB:  DATA 0A,00
01CC:  DATA 89,21
01CD:  DATA EF,36
01CE:  DATA 70,36
01CF:  DATA 65,3A
01D0:  DATA E5,06
01D1:  DATA 0A,00
01D2:  DATA 89,2B
01D3:  DATA D2,24
01D4:  DATA D4,22
01D5:  DATA 20,1D
01D6:  DATA A0,12
01D7:  DATA 64,10
01D8:  DATA A8,12
01D9:  DATA 30,1A
01DA:  DATA 4C,2C
01DB:  DATA A9,06
01DC:  DATA 0A,00
01DD:  DATA 89,29
01DE:  DATA C5,28
01DF:  DATA 20,10
01E0:  DATA 20,1D
01E1:  DATA A0,12
01E2:  DATA 64,10
01E3:  DATA A8,12
01E4:  DATA 30,1A
01E5:  DATA 4C,2C
01E6:  DATA A9,06
01E7:  DATA 0A,00
01E8:  DATA 89,20
01E9:  DATA 44,22
01EA:  DATA 52,10
01EB:  DATA 20,1D
01EC:  DATA A0,12
01ED:  DATA 64,10
01EE:  DATA A8,12
01EF:  DATA 30,1A
01F0:  DATA 4C,2C
01F1:  DATA A9,06
01F2:  DATA 0A,00
01F3:  DATA 09,28
01F4:  DATA 4D,10
01F5:  DATA 20,10
01F6:  DATA 20,10
01F7:  DATA 3A,10
01F8:  DATA 25,32
01F9:  DATA 20,14
01FA:  DATA 25,18
01FB:  DATA 34,26
01FC:  DATA D8,14
01FD:  DATA 0D,05
01FE:  DATA 00,01
01FF:  DATA 89,29
0200:  DATA C8,20
0201:  DATA C4,27
0202:  DATA 57,10
0203:  DATA 3A,10
0204:  DATA 25,32
0205:  DATA 20,14
0206:  DATA 25,18
0207:  DATA 34,26
0208:  DATA D8,14
0209:  DATA 0D,05
020A:  DATA 00,01
020B:  DATA 89,2B
020C:  DATA C5,20
020D:  DATA CB,17
020E:  DATA 54,29
020F:  DATA 49,10
0210:  DATA 3A,10
0211:  DATA 25,32
0212:  DATA 20,14
0213:  DATA 25,18
0214:  DATA 34,26
0215:  DATA D8,14
0216:  DATA 0D,05
0217:  DATA 00,01
0218:  DATA 09,29
0219:  DATA 41,27
021A:  DATA C7,22
021B:  DATA 20,10
021C:  DATA 3A,10
021D:  DATA 25,32
021E:  DATA 20,14
021F:  DATA 25,18
0220:  DATA 34,26
0221:  DATA D8,14
0222:  DATA 0D,05
0223:  DATA 00,01
0224:  DATA 89,21
0225:  DATA 4F,22
0226:  DATA 49,27
0227:  DATA 47,10
0228:  DATA 3A,10
0229:  DATA 25,32
022A:  DATA 20,14
022B:  DATA 25,18
022C:  DATA 34,26
022D:  DATA D8,14
022E:  DATA 0D,05
022F:  DATA 00,01
0230:  DATA 89,2D
0231:  DATA 41,22
0232:  DATA 37,1A
0233:  DATA 39,18
0234:  DATA 5D,10
0235:  DATA C6,34
0236:  DATA EE,30
0237:  DATA 6C,10
0238:  DATA C3,37
0239:  DATA ED,36
023A:  DATA 61,37
023B:  DATA 64,10
023C:  DATA 3A,10
023D:  DATA 25,18
023E:  DATA 34,26
023F:  DATA D8,06
0240:  DATA 0A,00
0241:  DATA 0D,05
0242:  DATA 53,3A
0243:  DATA 61,39
0244:  DATA 74,10
0245:  DATA ED,30
0246:  DATA EB,32
0247:  DATA 5F,39
0248:  DATA E5,31
0249:  DATA E5,34
024A:  DATA F6,32
024B:  DATA DF,31
024C:  DATA EF,36
024D:  DATA ED,30
024E:  DATA 6E,32
024F:  DATA 0D,05
0250:  DATA 00,01
0251:  DATA 89,2D
0252:  DATA C2,27
0253:  DATA D3,29
0254:  DATA 5D,10
0255:  DATA 3E,1F
0256:  DATA 3E,10
0257:  DATA 00,01
0258:  DATA 45,37
0259:  DATA 64,10
025A:  DATA ED,30
025B:  DATA EB,32
025C:  DATA 5F,39
025D:  DATA E5,31
025E:  DATA 69,3B
025F:  DATA E5,2F
0260:  DATA E3,37
0261:  DATA ED,36
0262:  DATA 61,37
0263:  DATA E4,06
0264:  DATA 8A,06
0265:  DATA 0A,00
0266:  DATA F3,34
0267:  DATA 67,37
0268:  DATA 61,36
0269:  DATA A0,32
026A:  DATA 6E,32
026B:  DATA A0,3B
026C:  DATA 69,3A
026D:  DATA 68,10
026E:  DATA 53,23
026F:  DATA C4,06
0270:  DATA 0A,00
0271:  DATA E4,37
0272:  DATA EE,13
0273:  DATA 74,10
0274:  DATA E6,34
0275:  DATA 6E,32
0276:  DATA A0,29
0277:  DATA 46,22
0278:  DATA 0D,05
0279:  DATA 00,00
027A:  DATA 89,16
027B:  DATA 3E,10
027C:  DATA 49,37
027D:  DATA F6,30
027E:  DATA EC,34
027F:  DATA 64,10
0280:  DATA 46,39
0281:  DATA E1,36
0282:  DATA 65,10
0283:  DATA 49,22
0284:  DATA 20,39
0285:  DATA E5,31
0286:  DATA E5,34
0287:  DATA F6,32
0288:  DATA 64,1D
0289:  DATA A0,12
028A:  DATA D8,06
028B:  DATA 0A,00
028C:  DATA 89,16
028D:  DATA 3E,10
028E:  DATA 43,29
028F:  DATA 43,10
0290:  DATA 65,39
0291:  DATA F2,37
0292:  DATA F2,10
0293:  DATA 0D,05
0294:  DATA 00,01
0295:  DATA 89,04
0296:  DATA 2D,1F
0297:  DATA 20,39
0298:  DATA E5,31
0299:  DATA E5,34
029A:  DATA F6,32
029B:  DATA 64,10
029C:  DATA 43,29
029D:  DATA 43,1D
029E:  DATA A0,12
029F:  DATA D8,06
02A0:  DATA 0A,00
02A1:  DATA 89,04
02A2:  DATA 20,10
02A3:  DATA A0,31
02A4:  DATA 6F,36
02A5:  DATA EC,32
02A6:  DATA 63,3A
02A7:  DATA A0,21
02A8:  DATA D2,21
02A9:  DATA 20,1D
02AA:  DATA A0,12
02AB:  DATA D8,06
02AC:  DATA 0A,00
02AD:  DATA 89,16
02AE:  DATA 3E,10
02AF:  DATA 49,37
02B0:  DATA F6,30
02B1:  DATA EC,34
02B2:  DATA 64,10
02B3:  DATA E4,32
02B4:  DATA F6,34
02B5:  DATA E3,32
02B6:  DATA A0,24
02B7:  DATA 44,10
02B8:  DATA F2,32
02B9:  DATA E3,32
02BA:  DATA 69,3B
02BB:  DATA 65,32
02BC:  DATA 0D,05
02BD:  DATA 00,01
02BE:  DATA 89,04
02BF:  DATA 2D,1F
02C0:  DATA 20,39
02C1:  DATA E5,31
02C2:  DATA E5,34
02C3:  DATA F6,32
02C4:  DATA 64,1D
02C5:  DATA 20,10
02C6:  DATA 20,10
02C7:  DATA A0,12
02C8:  DATA D8,06
02C9:  DATA 0A,00
02CA:  DATA 89,04
02CB:  DATA 20,10
02CC:  DATA A0,26
02CD:  DATA 79,10
02CE:  DATA E4,32
02CF:  DATA F6,34
02D0:  DATA E3,32
02D1:  DATA A0,24
02D2:  DATA 44,1D
02D3:  DATA A0,12
02D4:  DATA D8,06
02D5:  DATA 0A,00
02D6:  DATA 89,2D
02D7:  DATA C2,27
02D8:  DATA D3,29
02D9:  DATA 5D,10
02DA:  DATA 3C,1E
02DB:  DATA 3C,10
02DC:  DATA 00,01
02DD:  DATA 89,16
02DE:  DATA 3E,10
02DF:  DATA 46,39
02E0:  DATA E1,36
02E1:  DATA 65,10
02E2:  DATA 49,22
02E3:  DATA 3A,10
02E4:  DATA 25,2C
02E5:  DATA 0D,05
02E6:  DATA 00,01
02E7:  DATA 89,16
02E8:  DATA 3E,10
02E9:  DATA C3,37
02EA:  DATA 6E,3A
02EB:  DATA 65,37
02EC:  DATA 74,10
02ED:  DATA F3,34
02EE:  DATA FA,32
02EF:  DATA 3A,10
02F0:  DATA 25,32
02F1:  DATA 0D,05
02F2:  DATA 00,00
02F3:  DATA 53,3A
02F4:  DATA 61,39
02F5:  DATA 74,10
02F6:  DATA D3,26
02F7:  DATA 46,10
02F8:  DATA F5,39
02F9:  DATA 69,37
02FA:  DATA 67,10
02FB:  DATA F2,32
02FC:  DATA F1,32
02FD:  DATA 73,3A
02FE:  DATA A0,39
02FF:  DATA E5,30
0300:  DATA F1,3A
0301:  DATA 65,37
0302:  DATA E3,32
0303:  DATA 0D,05
0304:  DATA 00,01
0305:  DATA 45,39
0306:  DATA F2,37
0307:  DATA F2,10
0308:  DATA 20,29
0309:  DATA E5,31
030A:  DATA E5,34
030B:  DATA F6,34
030C:  DATA EE,33
030D:  DATA A0,31
030E:  DATA EF,36
030F:  DATA ED,30
0310:  DATA 6E,32
0311:  DATA A0,34
0312:  DATA EE,31
0313:  DATA 6F,37
0314:  DATA F3,34
0315:  DATA 73,3A
0316:  DATA 65,37
0317:  DATA 74,10
0318:  DATA F7,34
0319:  DATA 74,34
031A:  DATA 20,3A
031B:  DATA E8,32
031C:  DATA 20,32
031D:  DATA E5,39
031E:  DATA E9,33
031F:  DATA EE,06
0320:  DATA 0A,00
0321:  DATA D3,26
0322:  DATA 46,10
0323:  DATA F5,39
0324:  DATA 65,10
0325:  DATA F2,32
0326:  DATA F1,3A
0327:  DATA E5,39
0328:  DATA 74,10
0329:  DATA 61,36
032A:  DATA EC,37
032B:  DATA F7,32
032C:  DATA E4,06
032D:  DATA 0A,00
032E:  DATA D3,26
032F:  DATA 46,10
0330:  DATA F5,39
0331:  DATA 65,10
0332:  DATA F2,32
0333:  DATA F1,3A
0334:  DATA E5,39
0335:  DATA 74,10
0336:  DATA E4,32
0337:  DATA EE,3C
0338:  DATA 65,32
0339:  DATA 0D,05
033A:  DATA 00,01
033B:  DATA D2,32
033C:  DATA 74,39
033D:  DATA 79,10
033E:  DATA F2,32
033F:  DATA F1,3A
0340:  DATA E5,39
0341:  DATA 74,10
0342:  DATA F4,37
0343:  DATA 20,21
0344:  DATA CF,29
0345:  DATA 53,10
0346:  DATA D0,24
0347:  DATA C3,06
0348:  DATA 0A,00
0349:  DATA 45,39
034A:  DATA F2,37
034B:  DATA F2,10
034C:  DATA 20,29
034D:  DATA E5,31
034E:  DATA E5,34
034F:  DATA F6,34
0350:  DATA EE,33
0351:  DATA A0,31
0352:  DATA EF,36
0353:  DATA ED,30
0354:  DATA 6E,32
0355:  DATA A0,34
0356:  DATA EE,31
0357:  DATA 6F,37
0358:  DATA F3,34
0359:  DATA 73,3A
035A:  DATA 65,37
035B:  DATA 74,10
035C:  DATA F7,34
035D:  DATA 74,34
035E:  DATA 20,3A
035F:  DATA E8,32
0360:  DATA 20,32
0361:  DATA E5,39
0362:  DATA E9,33
0363:  DATA EE,06
0364:  DATA 0A,00
0365:  DATA 45,37
0366:  DATA 64,10
0367:  DATA D3,26
0368:  DATA 46,10
0369:  DATA F5,39
036A:  DATA 69,37
036B:  DATA 67,10
036C:  DATA F2,32
036D:  DATA F1,32
036E:  DATA 73,3A
036F:  DATA A0,39
0370:  DATA E5,30
0371:  DATA F1,3A
0372:  DATA 65,37
0373:  DATA E3,32
0374:  DATA 0D,05
0375:  DATA 00,00
0376:  DATA C9,27
0377:  DATA A0,24
0378:  DATA EE,34
0379:  DATA F4,34
037A:  DATA 61,36
037B:  DATA 69,3D
037C:  DATA E5,06
037D:  DATA 0A,00
037E:  DATA 89,21
037F:  DATA EF,36
0380:  DATA 70,36
0381:  DATA 65,3A
0382:  DATA E5,06
0383:  DATA 0A,00
0384:  DATA 41,22
0385:  DATA 43,10
0386:  DATA 49,37
0387:  DATA 69,3A
0388:  DATA E9,30
0389:  DATA EC,34
038A:  DATA FA,32
038B:  DATA 0D,05
038C:  DATA 00,01
038D:  DATA 89,21
038E:  DATA EF,36
038F:  DATA 70,36
0390:  DATA 65,3A
0391:  DATA E5,06
0392:  DATA 0A,00
0393:  DATA 53,3A
0394:  DATA 61,39
0395:  DATA 74,10
0396:  DATA D3,2B
0397:  DATA C5,22
0398:  DATA D0,06
0399:  DATA 0A,00
039A:  DATA 89,29
039B:  DATA F7,32
039C:  DATA 65,38
039D:  DATA A0,39
039E:  DATA F4,32
039F:  DATA 70,10
03A0:  DATA 3A,10
03A1:  DATA A5,3A
03A2:  DATA 0D,05
03A3:  DATA 00,01
03A4:  DATA 45,27
03A5:  DATA 44,10
03A6:  DATA D3,2B
03A7:  DATA C5,22
03A8:  DATA D0,06
03A9:  DATA 0A,00
03AA:  DATA 53,3A
03AB:  DATA 61,39
03AC:  DATA 74,10
03AD:  DATA C3,24
03AE:  DATA C7,29
03AF:  DATA 20,32
03B0:  DATA 61,3A
03B1:  DATA 61,10
03B2:  DATA E3,37
03B3:  DATA 6E,3B
03B4:  DATA 65,39
03B5:  DATA F3,34
03B6:  DATA 6F,37
03B7:  DATA 0D,05
03B8:  DATA 80,00
03B9:  DATA D3,26
03BA:  DATA 46,10
03BB:  DATA E4,30
03BC:  DATA F4,30
03BD:  DATA 20,36
03BE:  DATA E9,39
03BF:  DATA 74,10
03C0:  DATA E9,39
03C1:  DATA 20,33
03C2:  DATA 75,36
03C3:  DATA EC,10
03C4:  DATA A1,10
03C5:  DATA 0D,05
03C6:  DATA 00,00
03C7:  DATA D3,26
03C8:  DATA 46,10
03C9:  DATA E4,30
03CA:  DATA F4,30
03CB:  DATA 20,36
03CC:  DATA E9,39
03CD:  DATA 74,10
03CE:  DATA E9,39
03CF:  DATA A0,32
03D0:  DATA 6D,38
03D1:  DATA F4,3C
03D2:  DATA 0D,05
03D3:  DATA 00,00
03D4:  DATA 53,3A
03D5:  DATA 61,39
03D6:  DATA 74,10
03D7:  DATA CD,27
03D8:  DATA C4,22
03D9:  DATA 20,22
03DA:  DATA D5,26
03DB:  DATA CD,2C
03DC:  DATA 0D,05
03DD:  DATA 00,01
03DE:  DATA 89,26
03DF:  DATA 4F,22
03E0:  DATA 45,10
03E1:  DATA 20,10
03E2:  DATA 20,10
03E3:  DATA 3A,10
03E4:  DATA 25,18
03E5:  DATA 32,2C
03E6:  DATA 0D,05
03E7:  DATA 00,01
03E8:  DATA 09,28
03E9:  DATA 61,39
03EA:  DATA E1,36
03EB:  DATA 31,10
03EC:  DATA 20,10
03ED:  DATA 3A,10
03EE:  DATA 30,3C
03EF:  DATA 25,18
03F0:  DATA 38,26
03F1:  DATA D8,06
03F2:  DATA 0A,00
03F3:  DATA 09,28
03F4:  DATA 61,39
03F5:  DATA E1,36
03F6:  DATA 32,10
03F7:  DATA 20,10
03F8:  DATA 3A,10
03F9:  DATA 30,3C
03FA:  DATA 25,18
03FB:  DATA 34,26
03FC:  DATA D8,06
03FD:  DATA 0A,00
03FE:  DATA 45,37
03FF:  DATA 64,10
0400:  DATA CD,27
0401:  DATA C4,22
0402:  DATA 20,22
0403:  DATA D5,26
0404:  DATA CD,2C
0405:  DATA 0D,05
0406:  DATA 00,00
0407:  DATA 53,3A
0408:  DATA 61,39
0409:  DATA 74,10
040A:  DATA CD,27
040B:  DATA C4,22
040C:  DATA A0,26
040D:  DATA C5,20
040E:  DATA D3,2A
040F:  DATA D2,22
0410:  DATA 0D,05
0411:  DATA 00,00
0412:  DATA 53,3A
0413:  DATA 61,39
0414:  DATA 74,10
0415:  DATA CD,27
0416:  DATA C4,22
0417:  DATA A0,26
0418:  DATA C5,20
0419:  DATA D3,2A
041A:  DATA D2,22
041B:  DATA 20,2B
041C:  DATA 6F,36
041D:  DATA F4,30
041E:  DATA E7,32
041F:  DATA 0D,05
0420:  DATA 00,00
0421:  DATA 53,3A
0422:  DATA 61,39
0423:  DATA 74,10
0424:  DATA D3,2B
0425:  DATA C5,22
0426:  DATA D0,06
0427:  DATA 0A,00
0428:  DATA 89,29
0429:  DATA F7,32
042A:  DATA 65,38
042B:  DATA A0,39
042C:  DATA F4,32
042D:  DATA 70,10
042E:  DATA 3A,10
042F:  DATA A5,3A
0430:  DATA 0D,05
0431:  DATA 80,01
0432:  DATA 45,27
0433:  DATA 44,10
0434:  DATA D3,2B
0435:  DATA C5,22
0436:  DATA D0,06
0437:  DATA 0A,00
0438:  DATA F4,32
0439:  DATA 6D,38
043A:  DATA 5F,3A
043B:  DATA 6F,38
043C:  DATA 3A,10
043D:  DATA 25,2C
043E:  DATA 0D,05
043F:  DATA 00,01
0440:  DATA F4,32
0441:  DATA 6D,38
0442:  DATA 5F,31
0443:  DATA 6F,3A
0444:  DATA 3A,10
0445:  DATA 25,2C
0446:  DATA 0D,05
0447:  DATA 00,00
0448:  DATA 70,32
0449:  DATA 5F,3B
044A:  DATA 61,36
044B:  DATA F5,32
044C:  DATA 3A,10
044D:  DATA 25,2C
044E:  DATA 0D,05
044F:  DATA 00,00
0450:  DATA E3,34
0451:  DATA E7,39
0452:  DATA 5F,3B
0453:  DATA 61,36
0454:  DATA F5,32
0455:  DATA 3A,10
0456:  DATA 25,2C
0457:  DATA 0D,05
0458:  DATA 00,00
0459:  DATA E3,3A
045A:  DATA 72,39
045B:  DATA 65,37
045C:  DATA F4,2F
045D:  DATA F6,30
045E:  DATA EC,3A
045F:  DATA 65,1D
0460:  DATA A0,12
0461:  DATA D8,06
0462:  DATA 0A,00
0463:  DATA F6,37
0464:  DATA 6C,3A
0465:  DATA E1,33
0466:  DATA E5,2F
0467:  DATA F6,30
0468:  DATA EC,3A
0469:  DATA 65,1D
046A:  DATA A0,12
046B:  DATA D8,06
046C:  DATA 0A,00
046D:  DATA 53,3A
046E:  DATA 61,39
046F:  DATA 74,10
0470:  DATA CD,27
0471:  DATA C4,22
0472:  DATA 20,2A
0473:  DATA C5,29
0474:  DATA 54,10
0475:  DATA 49,2B
0476:  DATA 0D,05
0477:  DATA 00,01
0478:  DATA 89,29
0479:  DATA F7,32
047A:  DATA 65,38
047B:  DATA A0,39
047C:  DATA F4,32
047D:  DATA 70,10
047E:  DATA 3A,10
047F:  DATA A5,3A
0480:  DATA 0D,05
0481:  DATA 00,01
0482:  DATA 53,3A
0483:  DATA 61,39
0484:  DATA 74,10
0485:  DATA 46,36
0486:  DATA E1,39
0487:  DATA 68,10
0488:  DATA 45,39
0489:  DATA E1,39
048A:  DATA 65,10
048B:  DATA 41,36
048C:  DATA EC,06
048D:  DATA 0A,00
048E:  DATA 45,37
048F:  DATA 64,10
0490:  DATA 46,36
0491:  DATA E1,39
0492:  DATA 68,10
0493:  DATA 45,39
0494:  DATA E1,39
0495:  DATA 65,10
0496:  DATA 41,36
0497:  DATA EC,06
0498:  DATA 0A,00
0499:  DATA 53,3A
049A:  DATA 61,39
049B:  DATA 74,10
049C:  DATA 46,36
049D:  DATA E1,39
049E:  DATA 68,10
049F:  DATA 45,39
04A0:  DATA E1,39
04A1:  DATA 65,10
04A2:  DATA 31,10
04A3:  DATA D3,32
04A4:  DATA 63,3A
04A5:  DATA 6F,39
04A6:  DATA 0D,05
04A7:  DATA 00,01
04A8:  DATA 89,29
04A9:  DATA E5,31
04AA:  DATA F4,37
04AB:  DATA 72,10
04AC:  DATA 41,32
04AD:  DATA 64,39
04AE:  DATA E5,39
04AF:  DATA 73,1D
04B0:  DATA 20,18
04B1:  DATA F8,12
04B2:  DATA 30,1C
04B3:  DATA 4C,2C
04B4:  DATA 0D,05
04B5:  DATA 00,01
04B6:  DATA 45,37
04B7:  DATA 64,10
04B8:  DATA 46,36
04B9:  DATA E1,39
04BA:  DATA 68,10
04BB:  DATA 45,39
04BC:  DATA E1,39
04BD:  DATA 65,10
04BE:  DATA 31,10
04BF:  DATA D3,32
04C0:  DATA 63,3A
04C1:  DATA 6F,39
04C2:  DATA 0D,05
04C3:  DATA 00,00
04C4:  DATA 53,3A
04C5:  DATA 61,39
04C6:  DATA 74,10
04C7:  DATA 46,36
04C8:  DATA E1,39
04C9:  DATA 68,10
04CA:  DATA C3,37
04CB:  DATA F0,3C
04CC:  DATA A0,18
04CD:  DATA A0,29
04CE:  DATA E5,31
04CF:  DATA F4,37
04D0:  DATA F2,06
04D1:  DATA 0A,00
04D2:  DATA 89,29
04D3:  DATA 75,31
04D4:  DATA F3,32
04D5:  DATA 63,3A
04D6:  DATA 6F,39
04D7:  DATA A0,20
04D8:  DATA 64,32
04D9:  DATA F2,32
04DA:  DATA F3,39
04DB:  DATA 3A,10
04DC:  DATA 30,3C
04DD:  DATA 25,18
04DE:  DATA 38,26
04DF:  DATA D8,06
04E0:  DATA 0A,00
04E1:  DATA 45,37
04E2:  DATA 64,10
04E3:  DATA 46,36
04E4:  DATA E1,39
04E5:  DATA 68,10
04E6:  DATA C3,37
04E7:  DATA F0,3C
04E8:  DATA A0,18
04E9:  DATA A0,29
04EA:  DATA E5,31
04EB:  DATA F4,37
04EC:  DATA F2,06
04ED:  DATA 0A,00
04EE:  DATA 53,3A
04EF:  DATA 61,39
04F0:  DATA 74,10
04F1:  DATA 46,36
04F2:  DATA E1,39
04F3:  DATA 68,10
04F4:  DATA 57,39
04F5:  DATA 69,3A
04F6:  DATA 65,10
04F7:  DATA C4,32
04F8:  DATA ED,37
04F9:  DATA 0D,05
04FA:  DATA 00,01
04FB:  DATA 89,26
04FC:  DATA 4F,22
04FD:  DATA 45,10
04FE:  DATA 20,10
04FF:  DATA 20,10
0500:  DATA 3A,10
0501:  DATA 25,18
0502:  DATA 32,2C
0503:  DATA 0D,05
0504:  DATA 00,01
0505:  DATA 89,20
0506:  DATA 64,32
0507:  DATA F2,32
0508:  DATA F3,39
0509:  DATA 20,10
050A:  DATA 3A,10
050B:  DATA 30,3C
050C:  DATA 25,18
050D:  DATA 38,26
050E:  DATA D8,06
050F:  DATA 0A,00
0510:  DATA 09,28
0511:  DATA E1,31
0512:  DATA EB,32
0513:  DATA 74,27
0514:  DATA F5,36
0515:  DATA 3A,10
0516:  DATA 30,3C
0517:  DATA 25,18
0518:  DATA 34,26
0519:  DATA D8,06
051A:  DATA 0A,00
051B:  DATA 57,39
051C:  DATA 69,3A
051D:  DATA 65,10
051E:  DATA C4,30
051F:  DATA F4,30
0520:  DATA 0D,05
0521:  DATA 00,01
0522:  DATA 45,37
0523:  DATA 64,10
0524:  DATA 46,36
0525:  DATA E1,39
0526:  DATA 68,10
0527:  DATA 57,39
0528:  DATA 69,3A
0529:  DATA 65,10
052A:  DATA C4,32
052B:  DATA ED,37
052C:  DATA 0D,05
052D:  DATA 00,00
052E:  DATA 53,3A
052F:  DATA 61,39
0530:  DATA 74,10
0531:  DATA 46,36
0532:  DATA E1,39
0533:  DATA 68,10
0534:  DATA 57,39
0535:  DATA 69,3A
0536:  DATA 65,10
0537:  DATA B4,35
0538:  DATA C2,3C
0539:  DATA F4,32
053A:  DATA A0,29
053B:  DATA 75,31
053C:  DATA F3,32
053D:  DATA 63,3A
053E:  DATA 6F,39
053F:  DATA 0D,05
0540:  DATA 00,01
0541:  DATA 45,37
0542:  DATA 64,10
0543:  DATA 46,36
0544:  DATA E1,39
0545:  DATA 68,10
0546:  DATA 57,39
0547:  DATA 69,3A
0548:  DATA 65,10
0549:  DATA B4,35
054A:  DATA C2,3C
054B:  DATA F4,32
054C:  DATA A0,29
054D:  DATA 75,31
054E:  DATA F3,32
054F:  DATA 63,3A
0550:  DATA 6F,39
0551:  DATA 0D,05
0552:  DATA 00,00
0553:  DATA 53,3A
0554:  DATA 61,39
0555:  DATA 74,10
0556:  DATA 46,36
0557:  DATA E1,39
0558:  DATA 68,10
0559:  DATA D2,32
055A:  DATA 61,32
055B:  DATA 0D,05
055C:  DATA 00,01
055D:  DATA 89,26
055E:  DATA 4F,22
055F:  DATA 45,10
0560:  DATA 20,10
0561:  DATA 20,10
0562:  DATA 3A,10
0563:  DATA 25,18
0564:  DATA 32,2C
0565:  DATA 0D,05
0566:  DATA 00,01
0567:  DATA 89,20
0568:  DATA 64,32
0569:  DATA F2,32
056A:  DATA F3,39
056B:  DATA 20,10
056C:  DATA 3A,10
056D:  DATA 30,3C
056E:  DATA 25,18
056F:  DATA 38,26
0570:  DATA D8,06
0571:  DATA 0A,00
0572:  DATA 09,28
0573:  DATA E1,31
0574:  DATA EB,32
0575:  DATA 74,27
0576:  DATA F5,36
0577:  DATA 3A,10
0578:  DATA 30,3C
0579:  DATA 25,18
057A:  DATA 34,26
057B:  DATA D8,06
057C:  DATA 0A,00
057D:  DATA D2,22
057E:  DATA 41,22
057F:  DATA 20,22
0580:  DATA 41,2A
0581:  DATA C1,06
0582:  DATA 0A,00
0583:  DATA CD,34
0584:  DATA F3,39
0585:  DATA E9,37
0586:  DATA 6E,10
0587:  DATA 46,36
0588:  DATA E1,39
0589:  DATA 68,10
058A:  DATA E9,39
058B:  DATA 20,37
058C:  DATA 6F,3A
058D:  DATA A0,31
058E:  DATA 6F,37
058F:  DATA EE,32
0590:  DATA 63,3A
0591:  DATA 65,32
0592:  DATA 0D,05
0593:  DATA 00,01
0594:  DATA 45,37
0595:  DATA 64,10
0596:  DATA 46,36
0597:  DATA E1,39
0598:  DATA 68,10
0599:  DATA D2,32
059A:  DATA 61,32
059B:  DATA 0D,05
059C:  DATA 00,00
059D:  DATA 53,3A
059E:  DATA 61,39
059F:  DATA 74,10
05A0:  DATA 46,36
05A1:  DATA E1,39
05A2:  DATA 68,10
05A3:  DATA D2,32
05A4:  DATA 61,32
05A5:  DATA A0,20
05A6:  DATA 64,32
05A7:  DATA F2,32
05A8:  DATA F3,39
05A9:  DATA 0D,05
05AA:  DATA 00,01
05AB:  DATA D2,32
05AC:  DATA 61,32
05AD:  DATA 20,22
05AE:  DATA 61,3A
05AF:  DATA 61,1D
05B0:  DATA A0,12
05B1:  DATA 30,19
05B2:  DATA 58,10
05B3:  DATA 25,18
05B4:  DATA 32,2C
05B5:  DATA A0,12
05B6:  DATA 30,19
05B7:  DATA 58,10
05B8:  DATA 25,18
05B9:  DATA 32,2C
05BA:  DATA 0D,05
05BB:  DATA 00,01
05BC:  DATA 45,37
05BD:  DATA 64,10
05BE:  DATA 46,36
05BF:  DATA E1,39
05C0:  DATA 68,10
05C1:  DATA D2,32
05C2:  DATA 61,32
05C3:  DATA A0,20
05C4:  DATA 64,32
05C5:  DATA F2,32
05C6:  DATA F3,39
05C7:  DATA 0D,05
05C8:  DATA 00,00
05C9:  DATA 53,3A
05CA:  DATA 61,39
05CB:  DATA 74,10
05CC:  DATA 46,36
05CD:  DATA E1,39
05CE:  DATA 68,10
05CF:  DATA D3,26
05D0:  DATA 46,10
05D1:  DATA C3,37
05D2:  DATA F0,3C
05D3:  DATA 0D,05
05D4:  DATA 00,01
05D5:  DATA 45,37
05D6:  DATA 64,10
05D7:  DATA 46,36
05D8:  DATA E1,39
05D9:  DATA 68,10
05DA:  DATA D3,26
05DB:  DATA 46,10
05DC:  DATA C3,37
05DD:  DATA F0,3C
05DE:  DATA 0D,05
05DF:  DATA 00,00
05E0:  DATA 53,3A
05E1:  DATA 61,39
05E2:  DATA 74,10
05E3:  DATA 46,36
05E4:  DATA E1,39
05E5:  DATA 68,10
05E6:  DATA D3,26
05E7:  DATA 46,10
05E8:  DATA D2,32
05E9:  DATA 61,32
05EA:  DATA 0D,05
05EB:  DATA 00,01
05EC:  DATA D2,32
05ED:  DATA 61,32
05EE:  DATA 20,22
05EF:  DATA 61,3A
05F0:  DATA 61,1D
05F1:  DATA 20,00
05F2:  DATA 0D,05
05F3:  DATA 45,37
05F4:  DATA 64,10
05F5:  DATA 46,36
05F6:  DATA E1,39
05F7:  DATA 68,10
05F8:  DATA D3,26
05F9:  DATA 46,10
05FA:  DATA D2,32
05FB:  DATA 61,32
05FC:  DATA 0D,05
05FD:  DATA 00,00
05FE:  DATA 53,3A
05FF:  DATA 61,39
0600:  DATA 74,10
0601:  DATA 46,36
0602:  DATA E1,39
0603:  DATA 68,10
0604:  DATA D3,26
0605:  DATA 46,10
0606:  DATA 57,39
0607:  DATA 69,3A
0608:  DATA E5,06
0609:  DATA 0A,00
060A:  DATA 45,37
060B:  DATA 64,10
060C:  DATA 46,36
060D:  DATA E1,39
060E:  DATA 68,10
060F:  DATA D3,26
0610:  DATA 46,10
0611:  DATA 57,39
0612:  DATA 69,3A
0613:  DATA E5,06
0614:  DATA 0A,00
0615:  DATA 53,3A
0616:  DATA 61,39
0617:  DATA 74,10
0618:  DATA 46,36
0619:  DATA E1,39
061A:  DATA 68,10
061B:  DATA 41,32
061C:  DATA 64,39
061D:  DATA E5,39
061E:  DATA 73,10
061F:  DATA D2,32
0620:  DATA F3,32
0621:  DATA F4,06
0622:  DATA 0A,00
0623:  DATA 45,37
0624:  DATA 64,10
0625:  DATA 46,36
0626:  DATA E1,39
0627:  DATA 68,10
0628:  DATA 41,32
0629:  DATA 64,39
062A:  DATA E5,39
062B:  DATA 73,10
062C:  DATA D2,32
062D:  DATA F3,32
062E:  DATA F4,06
062F:  DATA 0A,00
0630:  DATA 0D,05
0631:  DATA DF,2F
0632:  DATA DF,2F
0633:  DATA DF,2F
0634:  DATA DF,2F
0635:  DATA DF,2F
0636:  DATA DF,2F
0637:  DATA DF,2F
0638:  DATA DF,2F
0639:  DATA DF,2F
063A:  DATA DF,2F
063B:  DATA 0D,05
063C:  DATA 00,01
063D:  DATA DF,2F
063E:  DATA DF,29
063F:  DATA F4,30
0640:  DATA 72,3A
0641:  DATA A0,31
0642:  DATA 6F,38
0643:  DATA F9,2F
0644:  DATA E4,30
0645:  DATA F4,30
0646:  DATA DF,2F
0647:  DATA 0D,05
0648:  DATA 00,01
0649:  DATA 53,3A
064A:  DATA 61,39
064B:  DATA 74,10
064C:  DATA DB,12
064D:  DATA 64,10
064E:  DATA 74,34
064F:  DATA 5D,10
0650:  DATA E4,30
0651:  DATA F4,30
0652:  DATA A0,31
0653:  DATA 6F,38
0654:  DATA F9,06
0655:  DATA 8A,06
0656:  DATA 0A,00
0657:  DATA 0D,05
0658:  DATA DF,2F
0659:  DATA DF,22
065A:  DATA 6E,32
065B:  DATA A0,31
065C:  DATA 6F,38
065D:  DATA F9,2F
065E:  DATA E4,30
065F:  DATA F4,30
0660:  DATA DF,2F
0661:  DATA DF,2F
0662:  DATA 0D,05
0663:  DATA 00,01
0664:  DATA DF,2F
0665:  DATA DF,2F
0666:  DATA DF,2F
0667:  DATA DF,2F
0668:  DATA DF,2F
0669:  DATA DF,2F
066A:  DATA DF,2F
066B:  DATA DF,2F
066C:  DATA DF,2F
066D:  DATA DF,2F
066E:  DATA 0D,05
066F:  DATA 0D,05
0670:  DATA 00,00
0671:  DATA 49,37
0672:  DATA A0,39
0673:  DATA 6D,33
0674:  DATA A0,36
0675:  DATA E9,39
0676:  DATA F3,34
0677:  DATA 6F,37
0678:  DATA 20,32
0679:  DATA 61,3A
067A:  DATA 61,10
067B:  DATA 73,3A
067C:  DATA 61,39
067D:  DATA 74,10
067E:  DATA 20,10
067F:  DATA 61,32
0680:  DATA 64,39
0681:  DATA E5,39
0682:  DATA 73,1D
0683:  DATA A0,12
0684:  DATA 4C,2C
0685:  DATA 0D,05
0686:  DATA 00,01
0687:  DATA 49,37
0688:  DATA A0,39
0689:  DATA 6D,33
068A:  DATA A0,36
068B:  DATA E9,39
068C:  DATA F3,34
068D:  DATA 6F,37
068E:  DATA 20,32
068F:  DATA 61,3A
0690:  DATA 61,10
0691:  DATA 65,37
0692:  DATA 64,10
0693:  DATA 20,10
0694:  DATA 20,10
0695:  DATA 61,32
0696:  DATA 64,39
0697:  DATA E5,39
0698:  DATA 73,1D
0699:  DATA A0,12
069A:  DATA 4C,2C
069B:  DATA 0D,05
069C:  DATA 00,01
069D:  DATA 49,37
069E:  DATA A0,26
069F:  DATA C9,29
06A0:  DATA 20,23
06A1:  DATA 4D,10
06A2:  DATA 57,39
06A3:  DATA 69,3A
06A4:  DATA 65,10
06A5:  DATA F3,37
06A6:  DATA 75,39
06A7:  DATA E3,32
06A8:  DATA 20,32
06A9:  DATA 61,3A
06AA:  DATA 61,10
06AB:  DATA 61,32
06AC:  DATA 64,39
06AD:  DATA E5,39
06AE:  DATA 73,1D
06AF:  DATA A0,12
06B0:  DATA 4C,2C
06B1:  DATA 0D,05
06B2:  DATA 00,01
06B3:  DATA 49,37
06B4:  DATA A0,26
06B5:  DATA C9,29
06B6:  DATA 20,23
06B7:  DATA 4D,10
06B8:  DATA 57,39
06B9:  DATA 69,3A
06BA:  DATA 65,10
06BB:  DATA E4,30
06BC:  DATA F4,30
06BD:  DATA A0,39
06BE:  DATA 69,3D
06BF:  DATA 65,10
06C0:  DATA 20,10
06C1:  DATA 20,10
06C2:  DATA 20,10
06C3:  DATA 20,10
06C4:  DATA 20,1D
06C5:  DATA A0,12
06C6:  DATA EC,3A
06C7:  DATA 0D,05
06C8:  DATA 0D,05
06C9:  DATA 00,02
06CA:  DATA D3,34
06CB:  DATA FA,32
06CC:  DATA A0,30
06CD:  DATA F2,32
06CE:  DATA 61,10
06CF:  DATA F2,32
06D0:  DATA 61,32
06D1:  DATA 0D,05
06D2:  DATA 00,01
06D3:  DATA F5,39
06D4:  DATA 65,32
06D5:  DATA DF,39
06D6:  DATA 69,3D
06D7:  DATA 65,10
06D8:  DATA 3D,10
06D9:  DATA 25,36
06DA:  DATA 75,10
06DB:  DATA A8,39
06DC:  DATA F2,31
06DD:  DATA 20,18
06DE:  DATA F8,12
06DF:  DATA 30,1C
06E0:  DATA 4C,2C
06E1:  DATA A9,06
06E2:  DATA 0A,00
06E3:  DATA EC,37
06E4:  DATA 6F,38
06E5:  DATA A0,31
06E6:  DATA EF,3A
06E7:  DATA 6E,3A
06E8:  DATA 3D,10
06E9:  DATA 25,32
06EA:  DATA 20,10
06EB:  DATA A8,39
06EC:  DATA F2,31
06ED:  DATA 20,18
06EE:  DATA F8,12
06EF:  DATA 30,1C
06F0:  DATA 4C,2C
06F1:  DATA A9,06
06F2:  DATA 8A,06
06F3:  DATA 0A,00
06F4:  DATA 57,39
06F5:  DATA 61,38
06F6:  DATA 20,3A
06F7:  DATA F2,34
06F8:  DATA E7,33
06F9:  DATA 65,39
06FA:  DATA 65,32
06FB:  DATA 3A,10
06FC:  DATA D2,32
06FD:  DATA F3,32
06FE:  DATA 74,3A
06FF:  DATA 69,37
0700:  DATA 67,10
0701:  DATA E4,30
0702:  DATA F4,30
0703:  DATA DF,3B
0704:  DATA F2,34
0705:  DATA F4,32
0706:  DATA DF,30
0707:  DATA 64,32
0708:  DATA 72,10
0709:  DATA F4,37
070A:  DATA A0,39
070B:  DATA F4,30
070C:  DATA 72,3A
070D:  DATA 0D,05
070E:  DATA 00,00
070F:  DATA 55,38
0710:  DATA E4,30
0711:  DATA F4,32
0712:  DATA A0,39
0713:  DATA 69,3D
0714:  DATA 65,10
0715:  DATA 61,39
0716:  DATA E5,30
0717:  DATA 0D,05
0718:  DATA 00,01
0719:  DATA F5,39
071A:  DATA 65,32
071B:  DATA DF,39
071C:  DATA 69,3D
071D:  DATA 65,10
071E:  DATA 3D,10
071F:  DATA 25,36
0720:  DATA E4,06
0721:  DATA 0A,00
0722:  DATA EC,37
0723:  DATA 6F,38
0724:  DATA DF,31
0725:  DATA EF,3A
0726:  DATA 6E,3A
0727:  DATA A0,1E
0728:  DATA A0,12
0729:  DATA F5,06
072A:  DATA 8A,06
072B:  DATA 0A,00
072C:  DATA 0D,05
072D:  DATA DF,2F
072E:  DATA DF,2F
072F:  DATA DF,2F
0730:  DATA DF,2F
0731:  DATA DF,2F
0732:  DATA DF,2F
0733:  DATA DF,2F
0734:  DATA DF,2F
0735:  DATA DF,2F
0736:  DATA DF,2F
0737:  DATA DF,2F
0738:  DATA DF,2F
0739:  DATA DF,2F
073A:  DATA DF,2F
073B:  DATA DF,2F
073C:  DATA 0D,05
073D:  DATA DF,2F
073E:  DATA DF,2F
073F:  DATA DF,29
0740:  DATA F4,30
0741:  DATA 72,3A
0742:  DATA A0,32
0743:  DATA F8,32
0744:  DATA E3,3A
0745:  DATA F4,32
0746:  DATA DF,36
0747:  DATA E9,39
0748:  DATA F3,34
0749:  DATA 6F,37
074A:  DATA DF,2F
074B:  DATA DF,2F
074C:  DATA DF,06
074D:  DATA 8A,06
074E:  DATA 0A,00
074F:  DATA C3,37
0750:  DATA ED,36
0751:  DATA 61,37
0752:  DATA 64,10
0753:  DATA 49,22
0754:  DATA 3A,10
0755:  DATA 25,2C
0756:  DATA 0D,05
0757:  DATA 0D,05
0758:  DATA 00,01
0759:  DATA 89,04
075A:  DATA 2D,1F
075B:  DATA A0,24
075C:  DATA 6E,3B
075D:  DATA 61,36
075E:  DATA 69,32
075F:  DATA A0,21
0760:  DATA 4D,22
0761:  DATA A0,24
0762:  DATA C4,10
0763:  DATA 0D,05
0764:  DATA 00,01
0765:  DATA 0D,05
0766:  DATA DF,2F
0767:  DATA DF,2F
0768:  DATA DF,2F
0769:  DATA 45,37
076A:  DATA 64,10
076B:  DATA 65,3C
076C:  DATA E5,31
076D:  DATA 75,3A
076E:  DATA E5,2F
076F:  DATA ED,34
0770:  DATA F3,39
0771:  DATA E9,37
0772:  DATA EE,2F
0773:  DATA DF,2F
0774:  DATA DF,2F
0775:  DATA DF,06
0776:  DATA 8A,2F
0777:  DATA DF,2F
0778:  DATA DF,2F
0779:  DATA DF,2F
077A:  DATA DF,2F
077B:  DATA DF,2F
077C:  DATA DF,2F
077D:  DATA DF,2F
077E:  DATA DF,2F
077F:  DATA DF,2F
0780:  DATA DF,2F
0781:  DATA DF,2F
0782:  DATA DF,2F
0783:  DATA DF,2F
0784:  DATA DF,2F
0785:  DATA DF,2F
0786:  DATA 0D,05
0787:  DATA 00,00
0788:  DATA 53,3A
0789:  DATA 61,39
078A:  DATA 74,10
078B:  DATA 65,3C
078C:  DATA E5,31
078D:  DATA 75,3A
078E:  DATA E5,2F
078F:  DATA E3,37
0790:  DATA ED,36
0791:  DATA 61,37
0792:  DATA E4,06
0793:  DATA 0A,00
0794:  DATA 89,16
0795:  DATA 3E,10
0796:  DATA 55,38
0797:  DATA EC,34
0798:  DATA EE,35
0799:  DATA A0,31
079A:  DATA EF,36
079B:  DATA ED,30
079C:  DATA 6E,32
079D:  DATA 0D,05
079E:  DATA 00,01
079F:  DATA 09,10
07A0:  DATA 20,10
07A1:  DATA 54,39
07A2:  DATA 61,37
07A3:  DATA F3,36
07A4:  DATA 69,3A
07A5:  DATA A0,20
07A6:  DATA E3,35
07A7:  DATA EE,37
07A8:  DATA EC,32
07A9:  DATA 67,32
07AA:  DATA E5,06
07AB:  DATA 0A,00
07AC:  DATA 89,16
07AD:  DATA 3E,10
07AE:  DATA 53,3A
07AF:  DATA 61,3A
07B0:  DATA F5,39
07B1:  DATA A0,31
07B2:  DATA E8,32
07B3:  DATA E3,35
07B4:  DATA 0D,05
07B5:  DATA 00,01
07B6:  DATA 09,10
07B7:  DATA 20,10
07B8:  DATA 54,39
07B9:  DATA 61,37
07BA:  DATA F3,36
07BB:  DATA 69,3A
07BC:  DATA A0,26
07BD:  DATA C9,29
07BE:  DATA A0,26
07BF:  DATA C3,2A
07C0:  DATA A0,29
07C1:  DATA F4,30
07C2:  DATA F4,3A
07C3:  DATA F3,06
07C4:  DATA 0A,00
07C5:  DATA E6,34
07C6:  DATA EE,34
07C7:  DATA 73,34
07C8:  DATA 65,32
07C9:  DATA A0,34
07CA:  DATA 6E,10
07CB:  DATA 73,3A
07CC:  DATA 61,3A
07CD:  DATA F5,39
07CE:  DATA DF,31
07CF:  DATA E8,32
07D0:  DATA E3,35
07D1:  DATA 0D,05
07D2:  DATA 00,00
07D3:  DATA 89,16
07D4:  DATA 3E,10
07D5:  DATA D3,26
07D6:  DATA 46,10
07D7:  DATA 61,3B
07D8:  DATA E1,34
07D9:  DATA EC,30
07DA:  DATA 62,36
07DB:  DATA 65,10
07DC:  DATA 63,34
07DD:  DATA E5,31
07DE:  DATA EB,06
07DF:  DATA 0A,00
07E0:  DATA 09,10
07E1:  DATA 20,10
07E2:  DATA 54,39
07E3:  DATA 61,37
07E4:  DATA F3,36
07E5:  DATA 69,3A
07E6:  DATA A0,20
07E7:  DATA E3,35
07E8:  DATA EE,37
07E9:  DATA EC,32
07EA:  DATA 67,32
07EB:  DATA E5,06
07EC:  DATA 0A,00
07ED:  DATA 89,04
07EE:  DATA 2D,1F
07EF:  DATA A0,30
07F0:  DATA 6C,36
07F1:  DATA EF,3B
07F2:  DATA E4,06
07F3:  DATA 0A,00
07F4:  DATA 89,04
07F5:  DATA 2D,1F
07F6:  DATA 20,32
07F7:  DATA 65,37
07F8:  DATA F9,32
07F9:  DATA E4,06
07FA:  DATA 0A,00
*
0800:  DATA 0D,05
0801:  DATA 0D,05
0802:  DATA 0D,05
0803:  DATA BD,1E
0804:  DATA BD,1E
0805:  DATA BD,1E
0806:  DATA BD,1E
0807:  DATA BD,1E
0808:  DATA BD,1E
0809:  DATA BD,1E
080A:  DATA BD,1E
080B:  DATA BD,1E
080C:  DATA BD,1E
080D:  DATA BD,1E
080E:  DATA BD,1E
080F:  DATA BD,1E
0810:  DATA BD,1E
0811:  DATA BD,1E
0812:  DATA BD,1E
0813:  DATA BD,1E
0814:  DATA BD,1E
0815:  DATA BD,1E
0816:  DATA BD,1E
0817:  DATA BD,1E
0818:  DATA BD,1E
0819:  DATA BD,1E
081A:  DATA BD,1E
081B:  DATA BD,1E
081C:  DATA BD,1E
081D:  DATA BD,1E
081E:  DATA BD,1E
081F:  DATA BD,1E
0820:  DATA BD,1E
0821:  DATA 0D,05
0822:  DATA 00,01
0823:  DATA 54,34
0824:  DATA E9,39
0825:  DATA A0,34
0826:  DATA 73,10
0827:  DATA CD,27
0828:  DATA CD,24
0829:  DATA CA,24
082A:  DATA A0,21
082B:  DATA C9,23
082C:  DATA 53,10
082D:  DATA D0,24
082E:  DATA 43,10
082F:  DATA 42,21
0830:  DATA 4D,10
0831:  DATA E6,37
0832:  DATA 72,10
0833:  DATA CD,24
0834:  DATA D3,1B
0835:  DATA 5F,21
0836:  DATA C2,26
0837:  DATA 31,17
0838:  DATA 0D,05
0839:  DATA 00,01
083A:  DATA CC,30
083B:  DATA 73,3A
083C:  DATA A0,3A
083D:  DATA 70,32
083E:  DATA 61,3A
083F:  DATA 65,32
0840:  DATA A0,37
0841:  DATA 6E,10
0842:  DATA 32,18
0843:  DATA B2,1A
0844:  DATA 2F,18
0845:  DATA B6,17
0846:  DATA B1,1A
0847:  DATA 2C,10
0848:  DATA E2,3C
0849:  DATA A0,24
084A:  DATA EE,37
084B:  DATA F5,32
084C:  DATA AE,06
084D:  DATA 8A,06
084E:  DATA 0A,00
084F:  DATA DF,2F
0850:  DATA DF,2F
0851:  DATA C3,24
0852:  DATA C7,29
0853:  DATA 20,28
0854:  DATA C9,21
0855:  DATA A0,29
0856:  DATA F4,30
0857:  DATA 72,3A
0858:  DATA A0,27
0859:  DATA F0,32
085A:  DATA F2,30
085B:  DATA F4,34
085C:  DATA 6F,37
085D:  DATA DF,2F
085E:  DATA DF,2F
085F:  DATA DF,06
0860:  DATA 8A,06
0861:  DATA 0A,00
0862:  DATA F7,30
0863:  DATA 69,3A
0864:  DATA 69,37
0865:  DATA 67,10
0866:  DATA E6,37
0867:  DATA 72,10
0868:  DATA C2,27
0869:  DATA D3,29
086A:  DATA 20,28
086B:  DATA C9,21
086C:  DATA A0,31
086D:  DATA EF,36
086E:  DATA ED,30
086F:  DATA 6E,32
0870:  DATA 00,01
0871:  DATA 0D,05
0872:  DATA F7,30
0873:  DATA 69,3A
0874:  DATA 69,37
0875:  DATA 67,10
0876:  DATA E6,37
0877:  DATA 72,10
0878:  DATA C2,27
0879:  DATA D3,29
087A:  DATA 20,28
087B:  DATA C9,21
087C:  DATA A0,31
087D:  DATA EF,36
087E:  DATA ED,30
087F:  DATA 6E,32
0880:  DATA 00,01
0881:  DATA 0D,05
0882:  DATA 0D,05
0883:  DATA BD,1E
0884:  DATA BD,1E
0885:  DATA BD,1E
0886:  DATA 0D,05
0887:  DATA 0D,05
0888:  DATA C6,34
0889:  DATA EE,34
088A:  DATA 73,34
088B:  DATA 65,32
088C:  DATA 20,38
088D:  DATA F2,37
088E:  DATA E3,32
088F:  DATA F3,39
0890:  DATA AE,06
0891:  DATA 8A,2B
0892:  DATA E1,34
0893:  DATA 74,10
0894:  DATA E6,37
0895:  DATA 72,10
0896:  DATA C2,27
0897:  DATA D3,29
0898:  DATA 20,28
0899:  DATA C9,21
089A:  DATA 20,3A
089B:  DATA 75,39
089C:  DATA 6E,10
089D:  DATA 6F,33
089E:  DATA 66,10
089F:  DATA ED,32
08A0:  DATA 00,01
08A1:  DATA 45,37
08A2:  DATA 64,10
08A3:  DATA ED,30
08A4:  DATA 69,37
08A5:  DATA 0D,05
08A6:  DATA 00,00
*
08CC:  MOVF   0B,W
08CD:  BCF    0B.7
08CE:  MOVLB  03
08CF:  BSF    15.7
08D0:  BSF    15.0
08D1:  NOP
08D2:  NOP
08D3:  BTFSC  09.7
08D4:  BSF    0B.7
08D5:  MOVF   13,W
08D6:  ANDLW  7F
08D7:  BTFSC  03.2
08D8:  GOTO   118
08D9:  MOVLB  0F
08DA:  MOVWF  40
08DB:  MOVLB  03
08DC:  MOVF   11,W
08DD:  MOVLB  0F
08DE:  MOVWF  41
08DF:  MOVLB  03
08E0:  MOVF   12,W
08E1:  MOVLB  0F
08E2:  MOVWF  42
08E3:  MOVF   40,W
08E4:  MOVWF  43
08E5:  MOVLB  00
08E6:  CALL   0A7
08E7:  MOVLB  0F
08E8:  MOVF   41,W
08E9:  MOVLB  03
08EA:  MOVWF  11
08EB:  MOVLB  0F
08EC:  MOVF   42,W
08ED:  MOVLB  03
08EE:  MOVWF  12
08EF:  MOVF   0B,W
08F0:  BCF    0B.7
08F1:  BSF    15.7
08F2:  BSF    15.0
08F3:  NOP
08F4:  NOP
08F5:  BTFSC  09.7
08F6:  BSF    0B.7
08F7:  RLF    13,W
08F8:  RLF    14,W
08F9:  ANDLW  7F
08FA:  BTFSC  03.2
08FB:  GOTO   118
08FC:  MOVLB  0F
08FD:  MOVWF  40
08FE:  MOVLB  03
08FF:  MOVF   11,W
0900:  MOVLB  0F
0901:  MOVWF  41
0902:  MOVLB  03
0903:  MOVF   12,W
0904:  MOVLB  0F
0905:  MOVWF  42
0906:  MOVF   40,W
0907:  MOVWF  43
0908:  MOVLB  00
0909:  CALL   0A7
090A:  MOVLB  0F
090B:  MOVF   41,W
090C:  MOVLB  03
090D:  MOVWF  11
090E:  MOVLB  0F
090F:  MOVF   42,W
0910:  MOVLB  03
0911:  MOVWF  12
0912:  INCF   11,F
0913:  BTFSC  03.2
0914:  INCF   12,F
0915:  MOVLB  00
0916:  GOTO   0CC
0917:  MOVLB  03
0918:  MOVLB  00
0919:  RETURN
*
09A9:  MOVLB  0F
09AA:  MOVF   5D,W
09AB:  ANDLW  07
09AC:  MOVWF  77
09AD:  RRF    5D,W
09AE:  MOVWF  78
09AF:  RRF    78,F
09B0:  RRF    78,F
09B1:  MOVLW  1F
09B2:  ANDWF  78,F
09B3:  MOVF   78,W
09B4:  ADDWF  5F,W
09B5:  MOVWF  04
09B6:  MOVLW  00
09B7:  ADDWFC 60,W
09B8:  MOVWF  05
09B9:  CLRF   78
09BA:  INCF   78,F
09BB:  INCF   77,F
09BC:  GOTO   1BE
09BD:  RLF    78,F
09BE:  DECFSZ 77,F
09BF:  GOTO   1BD
09C0:  MOVF   5E,F
09C1:  BTFSC  03.2
09C2:  GOTO   1C6
09C3:  MOVF   78,W
09C4:  IORWF  00,F
09C5:  GOTO   1C9
09C6:  COMF   78,F
09C7:  MOVF   78,W
09C8:  ANDWF  00,F
09C9:  MOVLB  00
09CA:  RETURN
*
0C16:  MOVF   0B,W
0C17:  BCF    0B.7
0C18:  MOVLB  03
0C19:  BSF    15.7
0C1A:  BSF    15.0
0C1B:  NOP
0C1C:  NOP
0C1D:  BTFSC  09.7
0C1E:  BSF    0B.7
0C1F:  BTFSC  03.0
0C20:  GOTO   44A
0C21:  MOVF   13,W
0C22:  ANDLW  7F
0C23:  MOVLB  0C
0C24:  MOVWF  61
0C25:  MOVLB  03
0C26:  MOVF   11,W
0C27:  MOVLB  0C
0C28:  MOVWF  62
0C29:  MOVLB  03
0C2A:  MOVF   12,W
0C2B:  MOVLB  0C
0C2C:  MOVWF  63
0C2D:  MOVF   61,W
0C2E:  MOVLB  0F
0C2F:  MOVWF  43
0C30:  MOVLB  00
0C31:  CALL   0A7
0C32:  MOVLB  0C
0C33:  MOVF   62,W
0C34:  MOVLB  03
0C35:  MOVWF  11
0C36:  MOVLB  0C
0C37:  MOVF   63,W
0C38:  MOVLB  03
0C39:  MOVWF  12
0C3A:  MOVF   0B,W
0C3B:  BCF    0B.7
0C3C:  BSF    15.7
0C3D:  BSF    15.0
0C3E:  NOP
0C3F:  NOP
0C40:  BTFSC  09.7
0C41:  BSF    0B.7
0C42:  MOVLB  0C
0C43:  DECFSZ 5E,F
0C44:  GOTO   446
0C45:  GOTO   448
0C46:  MOVLB  03
0C47:  GOTO   44A
0C48:  GOTO   46E
0C49:  MOVLB  03
0C4A:  RLF    13,W
0C4B:  RLF    14,W
0C4C:  ANDLW  7F
0C4D:  MOVLB  0C
0C4E:  MOVWF  61
0C4F:  MOVLB  03
0C50:  MOVF   11,W
0C51:  MOVLB  0C
0C52:  MOVWF  62
0C53:  MOVLB  03
0C54:  MOVF   12,W
0C55:  MOVLB  0C
0C56:  MOVWF  63
0C57:  MOVF   61,W
0C58:  MOVLB  0F
0C59:  MOVWF  43
0C5A:  MOVLB  00
0C5B:  CALL   0A7
0C5C:  MOVLB  0C
0C5D:  MOVF   62,W
0C5E:  MOVLB  03
0C5F:  MOVWF  11
0C60:  MOVLB  0C
0C61:  MOVF   63,W
0C62:  MOVLB  03
0C63:  MOVWF  12
0C64:  INCF   11,F
0C65:  BTFSC  03.2
0C66:  INCF   12,F
0C67:  BCF    03.0
0C68:  MOVLB  0C
0C69:  DECFSZ 5E,F
0C6A:  GOTO   46C
0C6B:  GOTO   46E
0C6C:  MOVLB  00
0C6D:  GOTO   416
0C6E:  MOVLB  00
0C6F:  RETURN
0C70:  MOVLB  0E
0C71:  BTFSC  4F.7
0C72:  GOTO   486
0C73:  MOVLW  0F
0C74:  MOVWF  77
0C75:  SWAPF  4E,W
0C76:  ANDWF  77,F
0C77:  MOVLW  0A
0C78:  SUBWF  77,W
0C79:  BTFSC  03.0
0C7A:  GOTO   47E
0C7B:  MOVLW  30
0C7C:  ADDWF  77,F
0C7D:  GOTO   480
0C7E:  MOVF   4F,W
0C7F:  ADDWF  77,F
0C80:  MOVF   77,W
0C81:  MOVLB  0F
0C82:  MOVWF  43
0C83:  MOVLB  00
0C84:  CALL   0A7
0C85:  MOVLB  0E
0C86:  MOVLW  0F
0C87:  ANDWF  4E,F
0C88:  MOVLW  0A
0C89:  SUBWF  4E,W
0C8A:  BTFSC  03.0
0C8B:  GOTO   48E
0C8C:  MOVLW  30
0C8D:  GOTO   490
0C8E:  BCF    4F.7
0C8F:  MOVF   4F,W
0C90:  ADDWF  4E,F
0C91:  MOVF   4E,W
0C92:  MOVLB  0F
0C93:  MOVWF  43
0C94:  MOVLB  00
0C95:  CALL   0A7
0C96:  RETURN
*
0FE9:  MOVLB  0C
0FEA:  MOVF   65,W
0FEB:  CLRF   78
0FEC:  SUBWF  64,W
0FED:  BTFSC  03.0
0FEE:  GOTO   7F2
0FEF:  MOVF   64,W
0FF0:  MOVWF  77
0FF1:  GOTO   7FE
0FF2:  CLRF   77
0FF3:  MOVLW  08
0FF4:  MOVWF  66
0FF5:  RLF    64,F
0FF6:  RLF    77,F
0FF7:  MOVF   65,W
0FF8:  SUBWF  77,W
0FF9:  BTFSC  03.0
0FFA:  MOVWF  77
0FFB:  RLF    78,F
0FFC:  DECFSZ 66,F
0FFD:  GOTO   7F5
0FFE:  MOVLB  00
0FFF:  RETURN
*
1666:  MOVF   78,W
1667:  BTFSC  03.2
1668:  GOTO   66D
1669:  MOVF   77,W
166A:  MOVWI  W,[FSR0++]
166B:  DECFSZ 78,F
166C:  GOTO   669
*
1705:  MOVF   78,W
1706:  MOVLB  0C
1707:  MOVF   4C,W
1708:  MOVWF  64
1709:  MOVLW  64
170A:  MOVWF  65
170B:  MOVLP  08
170C:  MOVLB  00
170D:  CALL   7E9
170E:  MOVLP  10
170F:  MOVF   77,W
1710:  MOVLB  0C
1711:  MOVWF  4C
1712:  MOVF   78,W
1713:  MOVLW  30
1714:  BTFSS  03.2
1715:  GOTO   71D
1716:  BTFSS  4D.1
1717:  GOTO   729
1718:  BTFSC  4D.3
1719:  GOTO   729
171A:  BTFSC  4D.4
171B:  MOVLW  20
171C:  GOTO   720
171D:  BCF    4D.3
171E:  BCF    4D.4
171F:  BSF    4D.0
1720:  ADDWF  78,F
1721:  MOVF   78,W
1722:  MOVLB  0F
1723:  MOVWF  43
1724:  MOVLP  08
1725:  MOVLB  00
1726:  CALL   0A7
1727:  MOVLP  10
1728:  MOVLB  0C
1729:  MOVF   4C,W
172A:  MOVWF  64
172B:  MOVLW  0A
172C:  MOVWF  65
172D:  MOVLP  08
172E:  MOVLB  00
172F:  CALL   7E9
1730:  MOVLP  10
1731:  MOVF   77,W
1732:  MOVLB  0C
1733:  MOVWF  4C
1734:  MOVF   78,W
1735:  MOVLW  30
1736:  BTFSS  03.2
1737:  GOTO   73E
1738:  BTFSC  4D.3
1739:  GOTO   747
173A:  BTFSS  4D.0
173B:  GOTO   747
173C:  BTFSC  4D.4
173D:  MOVLW  20
173E:  ADDWF  78,F
173F:  MOVF   78,W
1740:  MOVLB  0F
1741:  MOVWF  43
1742:  MOVLP  08
1743:  MOVLB  00
1744:  CALL   0A7
1745:  MOVLP  10
1746:  MOVLB  0C
1747:  MOVLW  30
1748:  ADDWF  4C,F
1749:  MOVF   4C,W
174A:  MOVLB  0F
174B:  MOVWF  43
174C:  MOVLP  08
174D:  MOVLB  00
174E:  CALL   0A7
174F:  MOVLP  10
1750:  RETURN
*
1F8C:  MOVLW  20
1F8D:  MOVLB  0C
1F8E:  BTFSS  5C.4
1F8F:  MOVLW  30
1F90:  MOVWF  60
1F91:  MOVF   5B,W
1F92:  MOVWF  77
1F93:  BTFSS  5B.7
1F94:  GOTO   79D
1F95:  COMF   77,F
1F96:  INCF   77,F
1F97:  MOVF   77,W
1F98:  MOVWF  5B
1F99:  MOVLW  2D
1F9A:  MOVWF  60
1F9B:  BSF    5C.7
1F9C:  BSF    5C.0
1F9D:  MOVF   5B,W
1F9E:  MOVWF  64
1F9F:  MOVLW  64
1FA0:  MOVWF  65
1FA1:  MOVLP  08
1FA2:  MOVLB  00
1FA3:  CALL   7E9
1FA4:  MOVLP  18
1FA5:  MOVF   77,W
1FA6:  MOVLB  0C
1FA7:  MOVWF  5B
1FA8:  MOVLW  30
1FA9:  ADDWF  78,W
1FAA:  MOVWF  61
1FAB:  MOVF   5B,W
1FAC:  MOVWF  64
1FAD:  MOVLW  0A
1FAE:  MOVWF  65
1FAF:  MOVLP  08
1FB0:  MOVLB  00
1FB1:  CALL   7E9
1FB2:  MOVLP  18
1FB3:  MOVLW  30
1FB4:  ADDWF  77,W
1FB5:  MOVLB  0C
1FB6:  MOVWF  63
1FB7:  MOVLW  30
1FB8:  ADDWF  78,W
1FB9:  MOVWF  62
1FBA:  MOVF   60,W
1FBB:  MOVWF  77
1FBC:  MOVLW  30
1FBD:  SUBWF  61,W
1FBE:  BTFSC  03.2
1FBF:  GOTO   7C4
1FC0:  BSF    5C.1
1FC1:  BTFSC  5C.7
1FC2:  BSF    5C.2
1FC3:  GOTO   7D8
1FC4:  MOVF   60,W
1FC5:  MOVWF  61
1FC6:  MOVLW  20
1FC7:  MOVWF  60
1FC8:  MOVLW  30
1FC9:  SUBWF  62,W
1FCA:  BTFSC  03.2
1FCB:  GOTO   7D0
1FCC:  BSF    5C.0
1FCD:  BTFSC  5C.7
1FCE:  BSF    5C.1
1FCF:  GOTO   7D8
1FD0:  BTFSS  03.2
1FD1:  BSF    5C.0
1FD2:  BTFSS  03.2
1FD3:  GOTO   7D8
1FD4:  MOVF   61,W
1FD5:  MOVWF  62
1FD6:  MOVLW  20
1FD7:  MOVWF  61
1FD8:  BTFSC  5C.2
1FD9:  GOTO   7DF
1FDA:  BTFSC  5C.1
1FDB:  GOTO   7E7
1FDC:  BTFSC  5C.0
1FDD:  GOTO   7EF
1FDE:  GOTO   7F7
1FDF:  MOVF   60,W
1FE0:  MOVLB  0F
1FE1:  MOVWF  43
1FE2:  MOVLP  08
1FE3:  MOVLB  00
1FE4:  CALL   0A7
1FE5:  MOVLP  18
1FE6:  MOVLB  0C
1FE7:  MOVF   61,W
1FE8:  MOVLB  0F
1FE9:  MOVWF  43
1FEA:  MOVLP  08
1FEB:  MOVLB  00
1FEC:  CALL   0A7
1FED:  MOVLP  18
1FEE:  MOVLB  0C
1FEF:  MOVF   62,W
1FF0:  MOVLB  0F
1FF1:  MOVWF  43
1FF2:  MOVLP  08
1FF3:  MOVLB  00
1FF4:  CALL   0A7
1FF5:  MOVLP  18
1FF6:  MOVLB  0C
1FF7:  MOVF   63,W
1FF8:  MOVLB  0F
1FF9:  MOVWF  43
1FFA:  MOVLP  08
1FFB:  MOVLB  00
1FFC:  CALL   0A7
1FFD:  MOVLP  18
1FFE:  RETURN
*
2B79:  BTFSC  03.1
2B7A:  GOTO   37F
2B7B:  MOVLW  24
2B7C:  MOVWF  05
2B7D:  MOVLW  1A
2B7E:  MOVWF  04
2B7F:  CLRF   77
2B80:  CLRF   78
2B81:  CLRF   79
2B82:  CLRF   7A
2B83:  MOVLB  0D
2B84:  CLRF   2A
2B85:  CLRF   2B
2B86:  CLRF   2C
2B87:  CLRF   2D
2B88:  MOVF   27,W
2B89:  IORWF  26,W
2B8A:  IORWF  25,W
2B8B:  IORWF  24,W
2B8C:  BTFSC  03.2
2B8D:  GOTO   3BE
2B8E:  MOVLW  20
2B8F:  MOVWF  2E
2B90:  BCF    03.0
2B91:  RLF    20,F
2B92:  RLF    21,F
2B93:  RLF    22,F
2B94:  RLF    23,F
2B95:  RLF    2A,F
2B96:  RLF    2B,F
2B97:  RLF    2C,F
2B98:  RLF    2D,F
2B99:  MOVF   27,W
2B9A:  SUBWF  2D,W
2B9B:  BTFSS  03.2
2B9C:  GOTO   3A7
2B9D:  MOVF   26,W
2B9E:  SUBWF  2C,W
2B9F:  BTFSS  03.2
2BA0:  GOTO   3A7
2BA1:  MOVF   25,W
2BA2:  SUBWF  2B,W
2BA3:  BTFSS  03.2
2BA4:  GOTO   3A7
2BA5:  MOVF   24,W
2BA6:  SUBWF  2A,W
2BA7:  BTFSS  03.0
2BA8:  GOTO   3B8
2BA9:  MOVF   24,W
2BAA:  SUBWF  2A,F
2BAB:  MOVF   25,W
2BAC:  BTFSS  03.0
2BAD:  INCFSZ 25,W
2BAE:  SUBWF  2B,F
2BAF:  MOVF   26,W
2BB0:  BTFSS  03.0
2BB1:  INCFSZ 26,W
2BB2:  SUBWF  2C,F
2BB3:  MOVF   27,W
2BB4:  BTFSS  03.0
2BB5:  INCFSZ 27,W
2BB6:  SUBWF  2D,F
2BB7:  BSF    03.0
2BB8:  RLF    77,F
2BB9:  RLF    78,F
2BBA:  RLF    79,F
2BBB:  RLF    7A,F
2BBC:  DECFSZ 2E,F
2BBD:  GOTO   390
2BBE:  MOVF   2A,W
2BBF:  MOVWF  00
2BC0:  MOVF   2B,W
2BC1:  MOVWI  W,[FSR0+01]
2BC2:  MOVF   2C,W
2BC3:  MOVWI  W,[FSR0+02]
2BC4:  MOVF   2D,W
2BC5:  MOVWI  W,[FSR0+03]
2BC6:  MOVLB  00
2BC7:  RETURN
*
2E83:  CLRF   77
2E84:  CLRF   78
2E85:  MOVF   42,W
2E86:  BCF    03.0
2E87:  BTFSC  43.0
2E88:  ADDWF  77,F
2E89:  RRF    77,F
2E8A:  RRF    78,F
2E8B:  BTFSC  43.1
2E8C:  ADDWF  77,F
2E8D:  RRF    77,F
2E8E:  RRF    78,F
2E8F:  BTFSC  43.2
2E90:  ADDWF  77,F
2E91:  RRF    77,F
2E92:  RRF    78,F
2E93:  BTFSC  43.3
2E94:  ADDWF  77,F
2E95:  RRF    77,F
2E96:  RRF    78,F
2E97:  BTFSC  43.4
2E98:  ADDWF  77,F
2E99:  RRF    77,F
2E9A:  RRF    78,F
2E9B:  BTFSC  43.5
2E9C:  ADDWF  77,F
2E9D:  RRF    77,F
2E9E:  RRF    78,F
2E9F:  BTFSC  43.6
2EA0:  ADDWF  77,F
2EA1:  RRF    77,F
2EA2:  RRF    78,F
2EA3:  BTFSC  43.7
2EA4:  ADDWF  77,F
2EA5:  RRF    77,F
2EA6:  RRF    78,F
*
2F22:  MOVF   04,W
2F23:  MOVLB  0C
2F24:  MOVWF  68
2F25:  MOVLW  3B
2F26:  MOVWF  6F
2F27:  MOVLW  9A
2F28:  MOVWF  6E
2F29:  MOVLW  CA
2F2A:  MOVWF  6D
2F2B:  CLRF   6C
2F2C:  MOVLW  0A
2F2D:  MOVWF  6A
2F2E:  BSF    03.1
2F2F:  MOVLW  23
2F30:  MOVWF  05
2F31:  MOVLW  FE
2F32:  MOVWF  04
2F33:  MOVF   61,W
2F34:  MOVLB  0D
2F35:  MOVWF  23
2F36:  MOVLB  0C
2F37:  MOVF   60,W
2F38:  MOVLB  0D
2F39:  MOVWF  22
2F3A:  MOVLB  0C
2F3B:  MOVF   5F,W
2F3C:  MOVLB  0D
2F3D:  MOVWF  21
2F3E:  MOVLB  0C
2F3F:  MOVF   5E,W
2F40:  MOVLB  0D
2F41:  MOVWF  20
2F42:  MOVLB  0C
2F43:  MOVF   6F,W
2F44:  MOVLB  0D
2F45:  MOVWF  27
2F46:  MOVLB  0C
2F47:  MOVF   6E,W
2F48:  MOVLB  0D
2F49:  MOVWF  26
2F4A:  MOVLB  0C
2F4B:  MOVF   6D,W
2F4C:  MOVLB  0D
2F4D:  MOVWF  25
2F4E:  MOVLB  0C
2F4F:  MOVF   6C,W
2F50:  MOVLB  0D
2F51:  MOVWF  24
2F52:  MOVLB  00
2F53:  CALL   379
2F54:  MOVF   78,W
2F55:  MOVF   77,F
2F56:  BTFSS  03.2
2F57:  GOTO   76F
2F58:  MOVLB  0C
2F59:  MOVF   6A,W
2F5A:  XORLW  01
2F5B:  BTFSS  03.2
2F5C:  GOTO   75F
2F5D:  MOVLB  00
2F5E:  GOTO   76F
2F5F:  MOVF   68,W
2F60:  BTFSC  03.2
2F61:  GOTO   771
2F62:  ANDLW  0F
2F63:  SUBWF  6A,W
2F64:  BTFSC  03.2
2F65:  GOTO   768
2F66:  BTFSC  03.0
2F67:  GOTO   77B
2F68:  BTFSC  68.7
2F69:  GOTO   77B
2F6A:  BTFSC  68.6
2F6B:  GOTO   771
2F6C:  MOVLW  20
2F6D:  GOTO   772
2F6E:  MOVLB  00
2F6F:  MOVLB  0C
2F70:  CLRF   68
2F71:  MOVLW  30
2F72:  ADDWF  77,F
2F73:  MOVF   77,W
2F74:  MOVLB  0F
2F75:  MOVWF  43
2F76:  MOVLP  08
2F77:  MOVLB  00
2F78:  CALL   0A7
2F79:  MOVLP  28
2F7A:  MOVLB  0C
2F7B:  BCF    03.1
2F7C:  MOVF   6F,W
2F7D:  MOVLB  0D
2F7E:  MOVWF  23
2F7F:  MOVLB  0C
2F80:  MOVF   6E,W
2F81:  MOVLB  0D
2F82:  MOVWF  22
2F83:  MOVLB  0C
2F84:  MOVF   6D,W
2F85:  MOVLB  0D
2F86:  MOVWF  21
2F87:  MOVLB  0C
2F88:  MOVF   6C,W
2F89:  MOVLB  0D
2F8A:  MOVWF  20
2F8B:  CLRF   27
2F8C:  CLRF   26
2F8D:  CLRF   25
2F8E:  MOVLW  0A
2F8F:  MOVWF  24
2F90:  MOVLB  00
2F91:  CALL   379
2F92:  MOVF   7A,W
2F93:  MOVLB  0C
2F94:  MOVWF  6F
2F95:  MOVF   79,W
2F96:  MOVWF  6E
2F97:  MOVF   78,W
2F98:  MOVWF  6D
2F99:  MOVF   77,W
2F9A:  MOVWF  6C
2F9B:  DECFSZ 6A,F
2F9C:  GOTO   72E
2F9D:  MOVLB  00
2F9E:  RETURN
*
3B07:  MOVF   04,W
3B08:  MOVWF  50
3B09:  BTFSS  4F.7
3B0A:  GOTO   318
3B0B:  DECF   50,F
3B0C:  BSF    50.5
3B0D:  COMF   4C,F
3B0E:  COMF   4D,F
3B0F:  COMF   4E,F
3B10:  COMF   4F,F
3B11:  INCF   4C,F
3B12:  BTFSC  03.2
3B13:  INCF   4D,F
3B14:  BTFSC  03.2
3B15:  INCF   4E,F
3B16:  BTFSC  03.2
3B17:  INCF   4F,F
3B18:  MOVLW  3B
3B19:  MOVWF  57
3B1A:  MOVLW  9A
3B1B:  MOVWF  56
3B1C:  MOVLW  CA
3B1D:  MOVWF  55
3B1E:  CLRF   54
3B1F:  MOVLW  0A
3B20:  MOVWF  52
3B21:  BSF    03.1
3B22:  MOVLW  23
3B23:  MOVWF  05
3B24:  MOVLW  EC
3B25:  MOVWF  04
3B26:  MOVF   4F,W
3B27:  MOVLB  0D
3B28:  MOVWF  23
3B29:  MOVLB  0C
3B2A:  MOVF   4E,W
3B2B:  MOVLB  0D
3B2C:  MOVWF  22
3B2D:  MOVLB  0C
3B2E:  MOVF   4D,W
3B2F:  MOVLB  0D
3B30:  MOVWF  21
3B31:  MOVLB  0C
3B32:  MOVF   4C,W
3B33:  MOVLB  0D
3B34:  MOVWF  20
3B35:  MOVLB  0C
3B36:  MOVF   57,W
3B37:  MOVLB  0D
3B38:  MOVWF  27
3B39:  MOVLB  0C
3B3A:  MOVF   56,W
3B3B:  MOVLB  0D
3B3C:  MOVWF  26
3B3D:  MOVLB  0C
3B3E:  MOVF   55,W
3B3F:  MOVLB  0D
3B40:  MOVWF  25
3B41:  MOVLB  0C
3B42:  MOVF   54,W
3B43:  MOVLB  0D
3B44:  MOVWF  24
3B45:  MOVLP  28
3B46:  MOVLB  00
3B47:  CALL   379
3B48:  MOVLP  38
3B49:  MOVF   78,W
3B4A:  MOVF   77,F
3B4B:  BTFSS  03.2
3B4C:  GOTO   364
3B4D:  MOVLB  0C
3B4E:  MOVF   52,W
3B4F:  XORLW  01
3B50:  BTFSS  03.2
3B51:  GOTO   354
3B52:  MOVLB  00
3B53:  GOTO   364
3B54:  MOVF   50,W
3B55:  BTFSC  03.2
3B56:  GOTO   367
3B57:  ANDLW  0F
3B58:  SUBWF  52,W
3B59:  BTFSC  03.2
3B5A:  GOTO   35D
3B5B:  BTFSC  03.0
3B5C:  GOTO   392
3B5D:  BTFSC  50.7
3B5E:  GOTO   392
3B5F:  BTFSC  50.6
3B60:  GOTO   367
3B61:  MOVLW  20
3B62:  GOTO   389
3B63:  MOVLB  00
3B64:  MOVLW  20
3B65:  MOVLB  0C
3B66:  ANDWF  50,F
3B67:  BTFSS  50.5
3B68:  GOTO   377
3B69:  BCF    50.5
3B6A:  MOVF   77,W
3B6B:  MOVWF  50
3B6C:  MOVLW  2D
3B6D:  MOVLB  0F
3B6E:  MOVWF  43
3B6F:  MOVLP  08
3B70:  MOVLB  00
3B71:  CALL   0A7
3B72:  MOVLP  38
3B73:  MOVLB  0C
3B74:  MOVF   50,W
3B75:  MOVWF  77
3B76:  CLRF   50
3B77:  MOVLW  30
3B78:  BTFSS  50.5
3B79:  GOTO   389
3B7A:  BCF    50.5
3B7B:  MOVF   77,W
3B7C:  MOVWF  50
3B7D:  MOVLW  2D
3B7E:  MOVLB  0F
3B7F:  MOVWF  43
3B80:  MOVLP  08
3B81:  MOVLB  00
3B82:  CALL   0A7
3B83:  MOVLP  38
3B84:  MOVLB  0C
3B85:  MOVF   50,W
3B86:  MOVWF  77
3B87:  CLRF   50
3B88:  MOVLW  30
3B89:  ADDWF  77,F
3B8A:  MOVF   77,W
3B8B:  MOVLB  0F
3B8C:  MOVWF  43
3B8D:  MOVLP  08
3B8E:  MOVLB  00
3B8F:  CALL   0A7
3B90:  MOVLP  38
3B91:  MOVLB  0C
3B92:  BCF    03.1
3B93:  MOVF   57,W
3B94:  MOVLB  0D
3B95:  MOVWF  23
3B96:  MOVLB  0C
3B97:  MOVF   56,W
3B98:  MOVLB  0D
3B99:  MOVWF  22
3B9A:  MOVLB  0C
3B9B:  MOVF   55,W
3B9C:  MOVLB  0D
3B9D:  MOVWF  21
3B9E:  MOVLB  0C
3B9F:  MOVF   54,W
3BA0:  MOVLB  0D
3BA1:  MOVWF  20
3BA2:  CLRF   27
3BA3:  CLRF   26
3BA4:  CLRF   25
3BA5:  MOVLW  0A
3BA6:  MOVWF  24
3BA7:  MOVLP  28
3BA8:  MOVLB  00
3BA9:  CALL   379
3BAA:  MOVLP  38
3BAB:  MOVF   7A,W
3BAC:  MOVLB  0C
3BAD:  MOVWF  57
3BAE:  MOVF   79,W
3BAF:  MOVWF  56
3BB0:  MOVF   78,W
3BB1:  MOVWF  55
3BB2:  MOVF   77,W
3BB3:  MOVWF  54
3BB4:  DECFSZ 52,F
3BB5:  GOTO   321
.................... 
.................... #list
.................... 
.................... 
.................... //#opt 0 // 0 = no optimization, 1 = optimize for speed, 2 = optimize for size
.................... 
.................... //#device ADC=12
.................... #use delay(crystal=16MHz)
*
0FAD:  MOVLW  24
0FAE:  MOVWF  05
0FAF:  MOVLW  E7
0FB0:  MOVWF  04
0FB1:  MOVF   00,W
0FB2:  BTFSC  03.2
0FB3:  GOTO   7C2
0FB4:  MOVLW  05
0FB5:  MOVWF  78
0FB6:  CLRF   77
0FB7:  DECFSZ 77,F
0FB8:  GOTO   7B7
0FB9:  DECFSZ 78,F
0FBA:  GOTO   7B6
0FBB:  MOVLW  2E
0FBC:  MOVWF  77
0FBD:  DECFSZ 77,F
0FBE:  GOTO   7BD
0FBF:  GOTO   7C0
0FC0:  DECFSZ 00,F
0FC1:  GOTO   7B4
0FC2:  RETURN
.................... #fuses NOMCLR
.................... 
.................... 
.................... 
.................... //#define SELF_DEVICE_ID CIGS_PIC
.................... 
.................... 
.................... //-------------Serial--------------------
.................... #use rs232(baud=9600,parity=N,xmit=PIN_C6,rcv=PIN_C7,bits=8,stream=BOSS)
*
16C5:  MOVLB  00
16C6:  BTFSS  11.4
16C7:  GOTO   6C6
16C8:  MOVLB  03
16C9:  MOVWF  1A
.................... #use rs232(baud=9600,parity=N,xmit=PIN_B4,bits=8,stream=PC,FORCE_SW)
*
08A7:  MOVLB  01
08A8:  BCF    0D.4
08A9:  MOVLB  02
08AA:  BCF    0D.4
08AB:  MOVLW  08
08AC:  MOVWF  78
08AD:  GOTO   0AE
08AE:  NOP
08AF:  BSF    78.7
08B0:  GOTO   0C1
08B1:  BCF    78.7
08B2:  MOVLB  0F
08B3:  RRF    43,F
08B4:  MOVLB  02
08B5:  BTFSC  03.0
08B6:  BSF    0D.4
08B7:  BTFSS  03.0
08B8:  BCF    0D.4
08B9:  BSF    78.6
08BA:  GOTO   0C1
08BB:  BCF    78.6
08BC:  DECFSZ 78,F
08BD:  GOTO   0B2
08BE:  GOTO   0BF
08BF:  NOP
08C0:  BSF    0D.4
08C1:  MOVLW  84
08C2:  MOVWF  04
08C3:  DECFSZ 04,F
08C4:  GOTO   0C3
08C5:  NOP
08C6:  BTFSC  78.7
08C7:  GOTO   0B1
08C8:  BTFSC  78.6
08C9:  GOTO   0BB
08CA:  MOVLB  00
08CB:  RETURN
.................... 
.................... 
.................... // -------------SPI--------------------
.................... // MOSI:PIN_C5, MISO:PIN_C4, SCK:PIN_C3
.................... // Shared Mission Flash
.................... #define MIS_FM_CS  PIN_D3
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS= 8, STREAM = MIS_FM_STREAM)
*
09CB:  MOVLB  04
09CC:  MOVF   11,W
09CD:  MOVLB  10
09CE:  MOVF   2C,W
09CF:  MOVLB  04
09D0:  MOVWF  11
09D1:  RRF    14,W
09D2:  BTFSS  03.0
09D3:  GOTO   1D1
09D4:  MOVF   11,W
09D5:  MOVWF  77
09D6:  MOVLB  00
09D7:  RETURN
.................... 
.................... // Mission Flash
.................... #define SMF_CS PIN_D1
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS = 8, STREAM = SMF_STREAM)
09D8:  MOVLB  04
09D9:  MOVF   11,W
09DA:  MOVLB  10
09DB:  MOVF   2C,W
09DC:  MOVLB  04
09DD:  MOVWF  11
09DE:  RRF    14,W
09DF:  BTFSS  03.0
09E0:  GOTO   1DE
09E1:  MOVF   11,W
09E2:  MOVWF  77
09E3:  MOVLB  00
09E4:  RETURN
.................... 
.................... // Analog to Digital Converter 
.................... #define ADC_CS PIN_D2
.................... //#use spi(MASTER, SPI1, BAUD = 9600, MODE=2, BITS = 16, STREAM = ADC_STREAM)
.................... #use spi(MASTER, CLK = PIN_C3, DI = PIN_C4, DO = PIN_C5,ENABLE = PIN_D2, BAUD = 9600, BITS = 16, STREAM = ADC_STREAM, MODE = 2 )
*
1751:  MOVLB  01
1752:  BCF    0F.2
1753:  MOVLB  02
1754:  BCF    0F.2
1755:  MOVLB  04
1756:  MOVF   11,W
1757:  MOVLB  0B
1758:  MOVF   38,W
1759:  MOVLB  04
175A:  MOVWF  11
175B:  RRF    14,W
175C:  BTFSS  03.0
175D:  GOTO   75B
175E:  MOVF   11,W
175F:  MOVWF  78
1760:  MOVF   11,W
1761:  MOVLB  0B
1762:  MOVF   37,W
1763:  MOVLB  04
1764:  MOVWF  11
1765:  RRF    14,W
1766:  BTFSS  03.0
1767:  GOTO   765
1768:  MOVF   11,W
1769:  MOVWF  77
176A:  MOVLB  01
176B:  BCF    0F.2
176C:  MOVLB  02
176D:  BSF    0F.2
176E:  MOVLB  00
176F:  RETURN
.................... 
.................... 
.................... 
.................... /* DEMO
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A0, MODE=0, BITS=8, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A1, MODE=0, BITS=8, ENABLE_ACTIVE=1, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A3, BAUD=40000, MODE=2, BITS=16, ENABLE_ACTIVE=1, STREAM=ADC)
.................... #use spi (MASTER, MODE=0, BITS=8, STREAM=SPI_4)
.................... */
.................... 
.................... 
.................... //-------------I/O port--------------------
.................... 
.................... // AI/O___ADC
.................... #define TEMP_TOP PIN_B0
.................... #define TEMP_BOT PIN_A3
.................... #define CIGS_VOLT PIN_A0 //PIN_A0
.................... #define CIGS_CURR PIN_A1
.................... #define PD PIN_E0
.................... #define VREF PIN_A4
.................... 
.................... // AI/O___DAC
.................... #define LOAD PIN_A5
.................... 
.................... // DI/O___
.................... #define CONNECT_CIGS PIN_E0
.................... #define EN_NPWR PIN_A4
.................... #define EN_MEAS_VOL PIN_A5
.................... 
.................... 
.................... // ADC Settings
.................... #define ADC_CIGS_VOLT   AD7490_VIN0
.................... #define ADC_CIGS_CURR   AD7490_VIN1
.................... #define ADC_PD          AD7490_VIN2
.................... #define ADC_TEMP_TOP    AD7490_VIN3
.................... #define ADC_TEMP_BOT    AD7490_VIN4
.................... 
.................... // Flasj Settings
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #endif // MMJ_CIGS_CONFIG_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... 
.................... #include "../lib/typedef_content.h"
.................... #ifndef TYPEDEF_CONTENT_H
.................... #define TYPEDEF_CONTENT_H
.................... 
.................... // there is used in main.c
.................... 
.................... typedef enum {
....................     EXECUTING_MISSION = 0x02,
....................     IDLE              = 0x03,
....................     SMF_USE_REQ       = 0x04,
....................     COPYING           = 0x05,
....................     FINISHED          = 0x06
.................... } MisMcuStatusContent;
.................... 
.................... 
.................... typedef enum {
....................     ALLOW = 0x00,
....................     DENY  = 0x01
.................... } IsSmfAvailableContent;
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... #include "../lib/value_status.h"
.................... #ifndef VALUE_STATUS_H
.................... #define VALUE_STATUS_H
.................... 
.................... // there is used in main.c and mission
.................... 
.................... volatile int1 is_use_smf_req_in_mission = FALSE;
.................... volatile int8 status[4] = {IDLE, 0, 0, 0};
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... #include "../lib/timer.h"
.................... #ifndef TIMER_H
.................... #define TIMER_H
.................... 
.................... // __________ define _________
.................... 
.................... #define SEC_IN_A_DAY 86400
.................... #define CLOCK_FREQUENCY 32768 // 32.768 kHz
.................... // External clock source for Timer1
.................... // Must Add a 32.768 kHz crystal to the T1CKI pin (pin 6 of PIC16F1789)
.................... 
.................... 
.................... // __________ values _________
.................... 
.................... unsigned int32 subsec = 0, sec = 0; //dsec -> deci second (0.01 sec)
.................... volatile unsigned int16 day = 0;
.................... 
.................... 
.................... // __________ functions _________
.................... unsigned int32 get_current_sec();
.................... unsigned int16 get_current_day();
.................... void set_current_sec(unsigned int32 new_sec);
.................... 
.................... #INT_TIMER0
.................... static void TIMER0_isr();
.................... 
.................... 
.................... #include "./src/timer.c"
.................... #INT_TIMER1
.................... void TIMER1_isr()
.................... {
....................    set_timer1(CLOCK_FREQUENCY); //3.2767
*
004A:  CLRF   16
004B:  MOVLW  80
004C:  MOVWF  17
004D:  CLRF   16
004E:  NOP
....................    sec++;
004F:  MOVLW  01
0050:  ADDWF  31,F
0051:  BTFSC  03.0
0052:  INCF   32,F
0053:  BTFSC  03.2
0054:  INCF   33,F
0055:  BTFSC  03.2
0056:  INCF   34,F
....................    /*
....................    if (++subsec >= 100)
....................    {
....................       subsec = 0;
....................       sec++;
.................... 
....................       if (sec >= SEC_IN_A_DAY)
....................       {
....................          day++;
....................       }
....................    }*/
0057:  BCF    11.0
0058:  MOVLP  00
0059:  GOTO   02D
.................... }
.................... 
.................... void setup_timer()
.................... {
....................    fprintf(PC, "Timer Initialize\r\n");
*
096E:  MOVLW  5A
096F:  MOVLB  03
0970:  MOVWF  11
0971:  MOVLW  00
0972:  MOVWF  12
0973:  MOVLB  00
0974:  CALL   0CC
....................    clear_interrupt(INT_TIMER1);
0975:  BCF    11.0
....................    //sec = 0;
....................    // T1CKI
....................    setup_timer_1(T1_EXTERNAL | T1_DIV_BY_1 | T1_ENABLE_SOSC);
0976:  MOVLW  8F
0977:  MOVWF  18
0978:  CLRF   19
....................    set_timer1(CLOCK_FREQUENCY); 
0979:  CLRF   16
097A:  MOVLW  80
097B:  MOVWF  17
097C:  CLRF   16
097D:  NOP
....................    //set_timer1(0);  // 
....................    //T1OSCEN = 1; //Enable TMR1 Oscillator
....................    enable_interrupts(INT_TIMER1);   
097E:  MOVLB  01
097F:  BSF    11.0
....................    enable_interrupts(GLOBAL);
0980:  MOVLW  C0
0981:  IORWF  0B,F
....................    fprintf(PC, "\tComplete\r\n");
0982:  MOVLW  64
0983:  MOVLB  03
0984:  MOVWF  11
0985:  MOVLW  00
0986:  MOVWF  12
0987:  MOVLB  00
0988:  CALL   0CC
0989:  MOVLP  38
098A:  GOTO   4E9 (RETURN)
.................... }
.................... 
.................... void set_current_sec(unsigned int32 new_sec)
.................... {
....................    sec = new_sec;
.................... 
.................... }
.................... 
.................... 
.................... unsigned int32 get_current_sec()
.................... {
....................    return sec;
*
13A7:  MOVF   31,W
13A8:  MOVWF  77
13A9:  MOVF   32,W
13AA:  MOVWF  78
13AB:  MOVF   33,W
13AC:  MOVWF  79
13AD:  MOVF   34,W
13AE:  MOVWF  7A
.................... }
.................... 
.................... unsigned int16 get_current_day()
.................... {
....................    return day;
.................... }
.................... 
.................... 
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... #include "../lib/uart.h"
.................... #ifndef UART_H
.................... #define UART_H
.................... 
.................... // _________ defines ________________
.................... 
.................... #define RECEIVE_BUFFER_MAX 32
.................... 
.................... 
.................... // _____________ values _______________
.................... 
.................... volatile unsigned int8 boss_receive_buffer[RECEIVE_BUFFER_MAX] = {0x00};
.................... volatile int8 boss_receive_buffer_size = 0;
.................... 
.................... 
.................... // _______________ functions ___________
.................... 
.................... #INT_RDA
.................... static void RDA_isr(void);
.................... 
.................... void setup_uart_to_boss();
.................... 
.................... void clear_receive_signal(unsigned int8 receive_signal[], int8 *receive_signal_size);
.................... 
.................... 
.................... #include "./src/uart.c"
.................... #INT_RDA
.................... static void RDA_isr(void)
.................... {
....................    if (!(status == EXECUTING_MISSION || status == COPYING) || is_use_smf_req_in_mission)
*
006A:  GOTO   06D
006B:  BTFSS  28.0
006C:  GOTO   080
....................       if (boss_receive_buffer_size < RECEIVE_BUFFER_MAX)
006D:  MOVF   59,W
006E:  SUBLW  1F
006F:  BTFSS  03.0
0070:  GOTO   080
....................          boss_receive_buffer[boss_receive_buffer_size++ % RECEIVE_BUFFER_MAX] = fgetc(BOSS);
0071:  MOVF   59,W
0072:  INCF   59,F
0073:  ANDLW  1F
0074:  ADDLW  19
0075:  MOVWF  04
0076:  MOVLW  20
0077:  MOVWF  05
0078:  BTFSC  03.0
0079:  INCF   05,F
007A:  BTFSS  11.5
007B:  GOTO   07A
007C:  MOVLB  03
007D:  MOVF   19,W
007E:  MOVWF  00
007F:  MOVLB  00
0080:  BCF    11.5
0081:  MOVLP  00
0082:  GOTO   02D
.................... }
.................... 
.................... void setup_uart_to_boss()
.................... {
....................    fprintf(PC, "UART Initialize\r\n");
*
095A:  MOVLW  83
095B:  MOVLB  03
095C:  MOVWF  11
095D:  MOVLW  00
095E:  MOVWF  12
095F:  MOVLB  00
0960:  CALL   0CC
....................    enable_interrupts(INT_RDA);
0961:  MOVLB  01
0962:  BSF    11.5
....................    enable_interrupts(global);
0963:  MOVLW  C0
0964:  IORWF  0B,F
....................    fprintf(PC, "\tComplete\r\n");
0965:  MOVLW  8C
0966:  MOVLB  03
0967:  MOVWF  11
0968:  MOVLW  00
0969:  MOVWF  12
096A:  MOVLB  00
096B:  CALL   0CC
096C:  MOVLP  38
096D:  GOTO   4E6 (RETURN)
.................... }
.................... 
.................... void clear_receive_signal(unsigned int8 receive_signal[], int8 *receive_signal_size)
.................... {
....................    memset(receive_signal, 0x00, *receive_signal_size);
*
1653:  MOVLB  0A
1654:  MOVF   6E,W
1655:  MOVWF  7A
1656:  MOVF   6D,W
1657:  MOVWF  04
1658:  MOVF   7A,W
1659:  MOVWF  05
165A:  MOVF   00,W
165B:  MOVLB  0B
165C:  MOVWF  20
165D:  MOVLB  0A
165E:  MOVF   6C,W
165F:  MOVWF  05
1660:  MOVF   6B,W
1661:  MOVWF  04
1662:  CLRF   77
1663:  MOVLB  0B
1664:  MOVF   20,W
1665:  MOVWF  78
....................    *receive_signal_size = 0;
*
166D:  MOVLB  0A
166E:  MOVF   6D,W
166F:  MOVWF  04
1670:  MOVF   6E,W
1671:  MOVWF  05
1672:  CLRF   00
1673:  MOVLP  38
1674:  MOVLB  00
1675:  GOTO   53C (RETURN)
.................... }
.................... 
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... // Missions
.................... #include "mmj_cigs_mode.h"
.................... #ifndef MMJ_CIGS_MODE_H
.................... #define MMJ_CIGS_MODE_H
.................... 
.................... #define PARAMETER_LENGTH 9
.................... 
.................... // ___________MODE FUNCTIONS____________
.................... 
.................... #Separate
.................... void mode_dummy(unsigned int8 uplinkcmd[]);
.................... typedef struct {
....................     unsigned int8 id;
....................     unsigned int32 param1;
....................     unsigned int16 param2;
.................... } DUMMY_CMD;
.................... 
.................... // Flash command 
.................... #Separate
.................... void mode_flash_erase_all(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_erase_1sector(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_erase_4kbyte_subsector(unsigned int8 parameter[]);
.................... 
.................... #separate
.................... void mode_flash_write_demo(unsigned int8 parameter[]);
.................... typedef struct {
....................     unsigned int8 id;
....................     unsigned int32 writeaddress;
....................     unsigned int16 packetnum;
.................... } FLASH_WRITE_PARAM;
.................... 
.................... #Separate
.................... void mode_flash_write_4kbyte_subsecotr(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_read(unsigned int8 parameter[]);
.................... 
.................... typedef struct{
....................     unsigned int8 id;
....................     unsigned int16 readpacketnum;
....................     unsigned int32 readaddress;
.................... }FLASH_PARAM;
.................... 
.................... #Separate
.................... void mode_flash_read_address(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_smf_copy(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_address_reset(unsigned int8 parameter[]);
.................... 
.................... 
.................... // IV command
.................... #Separate
.................... void mode_iv_measure();
.................... #Separate
.................... void mode_iv_measure_voltage();
.................... #Separate
.................... void mode_iv_meas_adc();
.................... 
.................... 
.................... 
.................... // Development command
.................... #Separate
.................... void mode_dev_vol();
.................... #Separate
.................... void mode_dev_cur();
.................... #Separate
.................... void mode_dev_temp();   
.................... #Separate
.................... void mode_dev_pd();
.................... #Separate
.................... void mode_dev_cigs();
.................... #Separate
.................... void mode_dev_time();
.................... #Separate
.................... void mode_dev_sweep();
.................... 
.................... // ______________CMD ID________________
.................... #define ID_DUMMY 0x00
.................... #define ID_SWEEP 0x01
.................... 
.................... // Flash command 
.................... #define ID_FLASH_ERASE_ALL 0x90
.................... #define ID_FLASH_ERASE_1SECTOR 0x91
.................... #define ID_FLASH_ERASE_4kByte_SUBSECTOR 0x92
.................... #define ID_FALSH_WRITE_DEMO 0x93
.................... #define ID_FLASH_4kByte_SUBSECTOR 0x94
.................... #define ID_FLASH_READ 0x96
.................... #define ID_FLASH_READ_ADDRESS 0x97
.................... #define ID_FLASH_SMF_COPY 0x9A
.................... #define ID_FLASH_ADDRESS_RESET 0x9F
.................... // IV command
.................... #define ID_IV_MEASURE 0xB0
.................... #define ID_IV_MEASURE_VOLTAGE 0xB1
.................... 
.................... // Development command
.................... #define ID_DEV_VOL 0xC0
.................... #define ID_DEV_CUR 0xC1
.................... #define ID_DEV_TEMP 0xC1
.................... #define ID_DEV_PD 0xC2
.................... #define ID_DEV_CIGS 0xC3
.................... #define ID_DEV_TIME 0xC4
.................... #define ID_DEV_SWEEP 0xC5
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_mode.c"
.................... #include "../mmj_cigs_mode.h"
.................... #ifndef MMJ_CIGS_MODE_H
.................... #define MMJ_CIGS_MODE_H
.................... 
.................... #define PARAMETER_LENGTH 9
.................... 
.................... // ___________MODE FUNCTIONS____________
.................... 
.................... #Separate
.................... void mode_dummy(unsigned int8 uplinkcmd[]);
.................... typedef struct {
....................     unsigned int8 id;
....................     unsigned int32 param1;
....................     unsigned int16 param2;
.................... } DUMMY_CMD;
.................... 
.................... // Flash command 
.................... #Separate
.................... void mode_flash_erase_all(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_erase_1sector(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_erase_4kbyte_subsector(unsigned int8 parameter[]);
.................... 
.................... #separate
.................... void mode_flash_write_demo(unsigned int8 parameter[]);
.................... typedef struct {
....................     unsigned int8 id;
....................     unsigned int32 writeaddress;
....................     unsigned int16 packetnum;
.................... } FLASH_WRITE_PARAM;
.................... 
.................... #Separate
.................... void mode_flash_write_4kbyte_subsecotr(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_read(unsigned int8 parameter[]);
.................... 
.................... typedef struct{
....................     unsigned int8 id;
....................     unsigned int16 readpacketnum;
....................     unsigned int32 readaddress;
.................... }FLASH_PARAM;
.................... 
.................... #Separate
.................... void mode_flash_read_address(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_smf_copy(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_address_reset(unsigned int8 parameter[]);
.................... 
.................... 
.................... // IV command
.................... #Separate
.................... void mode_iv_measure();
.................... #Separate
.................... void mode_iv_measure_voltage();
.................... #Separate
.................... void mode_iv_meas_adc();
.................... 
.................... 
.................... 
.................... // Development command
.................... #Separate
.................... void mode_dev_vol();
.................... #Separate
.................... void mode_dev_cur();
.................... #Separate
.................... void mode_dev_temp();   
.................... #Separate
.................... void mode_dev_pd();
.................... #Separate
.................... void mode_dev_cigs();
.................... #Separate
.................... void mode_dev_time();
.................... #Separate
.................... void mode_dev_sweep();
.................... 
.................... // ______________CMD ID________________
.................... #define ID_DUMMY 0x00
.................... #define ID_SWEEP 0x01
.................... 
.................... // Flash command 
.................... #define ID_FLASH_ERASE_ALL 0x90
.................... #define ID_FLASH_ERASE_1SECTOR 0x91
.................... #define ID_FLASH_ERASE_4kByte_SUBSECTOR 0x92
.................... #define ID_FALSH_WRITE_DEMO 0x93
.................... #define ID_FLASH_4kByte_SUBSECTOR 0x94
.................... #define ID_FLASH_READ 0x96
.................... #define ID_FLASH_READ_ADDRESS 0x97
.................... #define ID_FLASH_SMF_COPY 0x9A
.................... #define ID_FLASH_ADDRESS_RESET 0x9F
.................... // IV command
.................... #define ID_IV_MEASURE 0xB0
.................... #define ID_IV_MEASURE_VOLTAGE 0xB1
.................... 
.................... // Development command
.................... #define ID_DEV_VOL 0xC0
.................... #define ID_DEV_CUR 0xC1
.................... #define ID_DEV_TEMP 0xC1
.................... #define ID_DEV_PD 0xC2
.................... #define ID_DEV_CIGS 0xC3
.................... #define ID_DEV_TIME 0xC4
.................... #define ID_DEV_SWEEP 0xC5
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_mode.c"
.................... 
.................... #endif // MMJ_CIGS_MODE_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_func.h"
.................... #ifndef MMJ_CIGS_FUNC_H
.................... #define MMJ_CIGS_FUNC_H
.................... 
.................... /*
.................... // _________ values _________
.................... #define MISSION_DATA_SIZE 64
.................... volatile unsigned int8 mission_datas[MISSION_DATA_SIZE] = {0x00};
.................... volatile int8 executed_mission_count = 0;
.................... */
.................... 
.................... #define START_MAKER 0xFF
.................... #define RESERVED_VALUE 0x00
.................... 
.................... 
.................... 
.................... // _________ values ____________
.................... 
.................... 
.................... // _________ functions ____________
.................... #define DATA_BUFFER_SIZE 150
.................... #define HEADER_SIZE 12
.................... volatile unsigned int16 data_buffer [DATA_BUFFER_SIZE*2] = {0x00} ;
.................... volatile unsigned int32 measured_time = 0 ;
.................... volatile unsigned int16 measured_open_voltage = 0 ;
.................... volatile unsigned int16 measured_pd = 0 ;
.................... volatile unsigned int16 measured_temp_top = 0 ;
.................... volatile unsigned int16 measured_temp_bot = 0 ;     
.................... 
.................... 
.................... void make_meas_header(unsigned int8 *packetdata, unsigned int8 *cmd);
.................... 
.................... #separate
.................... void sweep(unsigned int8 parameter[]);
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_func.c"
.................... #include "../mmj_cigs_func.h"
.................... #ifndef MMJ_CIGS_FUNC_H
.................... #define MMJ_CIGS_FUNC_H
.................... 
.................... /*
.................... // _________ values _________
.................... #define MISSION_DATA_SIZE 64
.................... volatile unsigned int8 mission_datas[MISSION_DATA_SIZE] = {0x00};
.................... volatile int8 executed_mission_count = 0;
.................... */
.................... 
.................... #define START_MAKER 0xFF
.................... #define RESERVED_VALUE 0x00
.................... 
.................... 
.................... 
.................... // _________ values ____________
.................... 
.................... 
.................... // _________ functions ____________
.................... #define DATA_BUFFER_SIZE 150
.................... #define HEADER_SIZE 12
.................... volatile unsigned int16 data_buffer [DATA_BUFFER_SIZE*2] = {0x00} ;
.................... volatile unsigned int32 measured_time = 0 ;
.................... volatile unsigned int16 measured_open_voltage = 0 ;
.................... volatile unsigned int16 measured_pd = 0 ;
.................... volatile unsigned int16 measured_temp_top = 0 ;
.................... volatile unsigned int16 measured_temp_bot = 0 ;     
.................... 
.................... 
.................... void make_meas_header(unsigned int8 *packetdata, unsigned int8 *cmd);
.................... 
.................... #separate
.................... void sweep(unsigned int8 parameter[]);
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_func.c"
.................... 
.................... #endif
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_config.h"
.................... #ifndef MMJ_CIGS_CONFIG_H
.................... #define MMJ_CIGS_CONFIG_H
.................... 
.................... #include <16F1789.h>
.................... 
.................... //#opt 0 // 0 = no optimization, 1 = optimize for speed, 2 = optimize for size
.................... 
.................... //#device ADC=12
.................... #use delay(crystal=16MHz)
.................... #fuses NOMCLR
.................... 
.................... 
.................... 
.................... //#define SELF_DEVICE_ID CIGS_PIC
.................... 
.................... 
.................... //-------------Serial--------------------
.................... #use rs232(baud=9600,parity=N,xmit=PIN_C6,rcv=PIN_C7,bits=8,stream=BOSS)
.................... #use rs232(baud=9600,parity=N,xmit=PIN_B4,bits=8,stream=PC,FORCE_SW)
.................... 
.................... 
.................... // -------------SPI--------------------
.................... // MOSI:PIN_C5, MISO:PIN_C4, SCK:PIN_C3
.................... // Shared Mission Flash
.................... #define MIS_FM_CS  PIN_D3
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS= 8, STREAM = MIS_FM_STREAM)
.................... 
.................... // Mission Flash
.................... #define SMF_CS PIN_D1
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS = 8, STREAM = SMF_STREAM)
.................... 
.................... // Analog to Digital Converter 
.................... #define ADC_CS PIN_D2
.................... //#use spi(MASTER, SPI1, BAUD = 9600, MODE=2, BITS = 16, STREAM = ADC_STREAM)
.................... #use spi(MASTER, CLK = PIN_C3, DI = PIN_C4, DO = PIN_C5,ENABLE = PIN_D2, BAUD = 9600, BITS = 16, STREAM = ADC_STREAM, MODE = 2 )
.................... 
.................... 
.................... 
.................... /* DEMO
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A0, MODE=0, BITS=8, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A1, MODE=0, BITS=8, ENABLE_ACTIVE=1, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A3, BAUD=40000, MODE=2, BITS=16, ENABLE_ACTIVE=1, STREAM=ADC)
.................... #use spi (MASTER, MODE=0, BITS=8, STREAM=SPI_4)
.................... */
.................... 
.................... 
.................... //-------------I/O port--------------------
.................... 
.................... // AI/O___ADC
.................... #define TEMP_TOP PIN_B0
.................... #define TEMP_BOT PIN_A3
.................... #define CIGS_VOLT PIN_A0 //PIN_A0
.................... #define CIGS_CURR PIN_A1
.................... #define PD PIN_E0
.................... #define VREF PIN_A4
.................... 
.................... // AI/O___DAC
.................... #define LOAD PIN_A5
.................... 
.................... // DI/O___
.................... #define CONNECT_CIGS PIN_E0
.................... #define EN_NPWR PIN_A4
.................... #define EN_MEAS_VOL PIN_A5
.................... 
.................... 
.................... // ADC Settings
.................... #define ADC_CIGS_VOLT   AD7490_VIN0
.................... #define ADC_CIGS_CURR   AD7490_VIN1
.................... #define ADC_PD          AD7490_VIN2
.................... #define ADC_TEMP_TOP    AD7490_VIN3
.................... #define ADC_TEMP_BOT    AD7490_VIN4
.................... 
.................... // Flasj Settings
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #endif // MMJ_CIGS_CONFIG_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_piclog.h"
.................... #ifndef     MMJ_CIGS_PICLOG_H
.................... #define     MMJ_CIGS_PICLOG_H
.................... 
.................... #define PICLOG_PACKET_SIZE 6
.................... unsigned int8 PICLOG_STARTUP = 0x00;
.................... 
.................... // PICLOG Parameter
.................... #define PICLOG_PARAM_START 0x01
.................... #define PICLOG_PARAM_END 0x02
.................... 
.................... 
.................... // PICLOG
.................... typedef union {
....................     struct {
....................         unsigned int32  time;
....................         unsigned int8   function;
....................         unsigned int8   parameter;
....................     };
....................     unsigned int8 bytes[PICLOG_PACKET_SIZE];  
.................... } PICLOG;
.................... 
.................... // extern.c
.................... #define PICLOG_BLANK_SIZE 4 // PICLOG
.................... unsigned int8 PICLOG_BLANK_DATA[PICLOG_BLANK_SIZE] = {0x00, 0x00, 0x00, 0x00}; // PICLOG
.................... void piclog_make(unsigned int8 function, unsigned int8 parameter);
.................... void piclog_write(unsigned int8 *data);
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_piclog.c"
.................... #include "../mmj_cigs_piclog.h"
.................... #ifndef     MMJ_CIGS_PICLOG_H
.................... #define     MMJ_CIGS_PICLOG_H
.................... 
.................... #define PICLOG_PACKET_SIZE 6
.................... unsigned int8 PICLOG_STARTUP = 0x00;
.................... 
.................... // PICLOG Parameter
.................... #define PICLOG_PARAM_START 0x01
.................... #define PICLOG_PARAM_END 0x02
.................... 
.................... 
.................... // PICLOG
.................... typedef union {
....................     struct {
....................         unsigned int32  time;
....................         unsigned int8   function;
....................         unsigned int8   parameter;
....................     };
....................     unsigned int8 bytes[PICLOG_PACKET_SIZE];  
.................... } PICLOG;
.................... 
.................... // extern.c
.................... #define PICLOG_BLANK_SIZE 4 // PICLOG
.................... unsigned int8 PICLOG_BLANK_DATA[PICLOG_BLANK_SIZE] = {0x00, 0x00, 0x00, 0x00}; // PICLOG
.................... void piclog_make(unsigned int8 function, unsigned int8 parameter);
.................... void piclog_write(unsigned int8 *data);
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_piclog.c"
.................... 
.................... #endif // MMJ_CIGS_PICLOG_H
.................... //------------------End of File------------------
.................... 
.................... #include "../../lib/timer.h"
.................... #ifndef TIMER_H
.................... #define TIMER_H
.................... 
.................... // __________ define _________
.................... 
.................... #define SEC_IN_A_DAY 86400
.................... #define CLOCK_FREQUENCY 32768 // 32.768 kHz
.................... // External clock source for Timer1
.................... // Must Add a 32.768 kHz crystal to the T1CKI pin (pin 6 of PIC16F1789)
.................... 
.................... 
.................... // __________ values _________
.................... 
.................... unsigned int32 subsec = 0, sec = 0; //dsec -> deci second (0.01 sec)
.................... volatile unsigned int16 day = 0;
.................... 
.................... 
.................... // __________ functions _________
.................... unsigned int32 get_current_sec();
.................... unsigned int16 get_current_day();
.................... void set_current_sec(unsigned int32 new_sec);
.................... 
.................... #INT_TIMER0
.................... static void TIMER0_isr();
.................... 
.................... 
.................... #include "./src/timer.c"
.................... 
.................... #endif
.................... 
.................... 
.................... #include "../mmj_cigs_flash.h"
.................... #ifndef  MMJ_CIGS_FLASH_H
.................... #define  MMJ_CIGS_FLASH_H
.................... 
.................... 
.................... 
.................... 
.................... // MIS_FM Function
.................... void misf_init(void);
.................... void update_misf_data_header(void);
.................... void write_misf_address_area(void);
.................... 
.................... 
.................... 
.................... #define PACKET_SIZE 64
.................... #define MISF_DATA_HEADER_SIZE 64 // MISF
.................... #define MISF_PICLOG_MAX_COUNT 60
.................... 
.................... 
.................... 
.................... 
.................... // __________MISF-ADDRESS__________
.................... #define ADDRESS_MISF_START              0x000000
.................... #define ADDRESS_MISF_END                0xF42400
.................... #define ADDRESS_MANEGE_START            0x000000
.................... #define ADDRESS_MANEGE_END              0x00FFFF
.................... #define ADDRESS_MISF_PICLOG_INDEX_START 0x010000
.................... #define ADDRESS_MISF_PICLOG_INDEX_END   0x01FFFF
.................... #define ADDRESS_MISF_PICLOG_DATA_START  0x020000
.................... #define ADDRESS_MISF_PICLOG_DATA_END    0x15FFFF
.................... #define ADDRESS_MISF_MEASUREMENT_START  0x160000
.................... #define ADDRESS_MISF_MEASUREMENT_END    0x95FFFF
.................... 
.................... //
.................... #define SECTOR_64K_BYTE 0x10000 // 64KByte
.................... #define SECTOR_32K_BYTE 0x8000  // 32KByte
.................... #define SECTOR_4K_BYTE  0x1000  // 4KByte
.................... 
.................... // Counter
.................... unsigned int32  smf_piclog_use_counter;
.................... unsigned int8   smf_piclog_loop_counter;
.................... unsigned int32  smf_meas_use_counter;
.................... unsigned int8   smf_meas_loop_counter;
.................... 
.................... unsigned int32  misf_piclog_use_counter;
.................... unsigned int8   misf_piclog_loop_counter;
.................... unsigned int32  misf_piclog_uncopyed_counter;
.................... unsigned int8   misf_piclog_write_counter;
.................... unsigned int32  misf_meas_use_counter;
.................... unsigned int8   misf_meas_loop_counter;
.................... unsigned int32  misf_meas_uncopyed_counter;
.................... 
.................... 
.................... #define DATA_HEADER_SIZE 64 
.................... 
.................... 
.................... 
.................... 
.................... // ___________SMF-ADDRESS___________
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_flash.c"
.................... #include "../mmj_cigs_config.h"
.................... #ifndef MMJ_CIGS_CONFIG_H
.................... #define MMJ_CIGS_CONFIG_H
.................... 
.................... #include <16F1789.h>
.................... 
.................... //#opt 0 // 0 = no optimization, 1 = optimize for speed, 2 = optimize for size
.................... 
.................... //#device ADC=12
.................... #use delay(crystal=16MHz)
.................... #fuses NOMCLR
.................... 
.................... 
.................... 
.................... //#define SELF_DEVICE_ID CIGS_PIC
.................... 
.................... 
.................... //-------------Serial--------------------
.................... #use rs232(baud=9600,parity=N,xmit=PIN_C6,rcv=PIN_C7,bits=8,stream=BOSS)
.................... #use rs232(baud=9600,parity=N,xmit=PIN_B4,bits=8,stream=PC,FORCE_SW)
.................... 
.................... 
.................... // -------------SPI--------------------
.................... // MOSI:PIN_C5, MISO:PIN_C4, SCK:PIN_C3
.................... // Shared Mission Flash
.................... #define MIS_FM_CS  PIN_D3
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS= 8, STREAM = MIS_FM_STREAM)
.................... 
.................... // Mission Flash
.................... #define SMF_CS PIN_D1
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS = 8, STREAM = SMF_STREAM)
.................... 
.................... // Analog to Digital Converter 
.................... #define ADC_CS PIN_D2
.................... //#use spi(MASTER, SPI1, BAUD = 9600, MODE=2, BITS = 16, STREAM = ADC_STREAM)
.................... #use spi(MASTER, CLK = PIN_C3, DI = PIN_C4, DO = PIN_C5,ENABLE = PIN_D2, BAUD = 9600, BITS = 16, STREAM = ADC_STREAM, MODE = 2 )
.................... 
.................... 
.................... 
.................... /* DEMO
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A0, MODE=0, BITS=8, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A1, MODE=0, BITS=8, ENABLE_ACTIVE=1, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A3, BAUD=40000, MODE=2, BITS=16, ENABLE_ACTIVE=1, STREAM=ADC)
.................... #use spi (MASTER, MODE=0, BITS=8, STREAM=SPI_4)
.................... */
.................... 
.................... 
.................... //-------------I/O port--------------------
.................... 
.................... // AI/O___ADC
.................... #define TEMP_TOP PIN_B0
.................... #define TEMP_BOT PIN_A3
.................... #define CIGS_VOLT PIN_A0 //PIN_A0
.................... #define CIGS_CURR PIN_A1
.................... #define PD PIN_E0
.................... #define VREF PIN_A4
.................... 
.................... // AI/O___DAC
.................... #define LOAD PIN_A5
.................... 
.................... // DI/O___
.................... #define CONNECT_CIGS PIN_E0
.................... #define EN_NPWR PIN_A4
.................... #define EN_MEAS_VOL PIN_A5
.................... 
.................... 
.................... // ADC Settings
.................... #define ADC_CIGS_VOLT   AD7490_VIN0
.................... #define ADC_CIGS_CURR   AD7490_VIN1
.................... #define ADC_PD          AD7490_VIN2
.................... #define ADC_TEMP_TOP    AD7490_VIN3
.................... #define ADC_TEMP_BOT    AD7490_VIN4
.................... 
.................... // Flasj Settings
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #endif // MMJ_CIGS_CONFIG_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_flash.h"
.................... #ifndef  MMJ_CIGS_FLASH_H
.................... #define  MMJ_CIGS_FLASH_H
.................... 
.................... 
.................... 
.................... 
.................... // MIS_FM Function
.................... void misf_init(void);
.................... void update_misf_data_header(void);
.................... void write_misf_address_area(void);
.................... 
.................... 
.................... 
.................... #define PACKET_SIZE 64
.................... #define MISF_DATA_HEADER_SIZE 64 // MISF
.................... #define MISF_PICLOG_MAX_COUNT 60
.................... 
.................... 
.................... 
.................... 
.................... // __________MISF-ADDRESS__________
.................... #define ADDRESS_MISF_START              0x000000
.................... #define ADDRESS_MISF_END                0xF42400
.................... #define ADDRESS_MANEGE_START            0x000000
.................... #define ADDRESS_MANEGE_END              0x00FFFF
.................... #define ADDRESS_MISF_PICLOG_INDEX_START 0x010000
.................... #define ADDRESS_MISF_PICLOG_INDEX_END   0x01FFFF
.................... #define ADDRESS_MISF_PICLOG_DATA_START  0x020000
.................... #define ADDRESS_MISF_PICLOG_DATA_END    0x15FFFF
.................... #define ADDRESS_MISF_MEASUREMENT_START  0x160000
.................... #define ADDRESS_MISF_MEASUREMENT_END    0x95FFFF
.................... 
.................... //
.................... #define SECTOR_64K_BYTE 0x10000 // 64KByte
.................... #define SECTOR_32K_BYTE 0x8000  // 32KByte
.................... #define SECTOR_4K_BYTE  0x1000  // 4KByte
.................... 
.................... // Counter
.................... unsigned int32  smf_piclog_use_counter;
.................... unsigned int8   smf_piclog_loop_counter;
.................... unsigned int32  smf_meas_use_counter;
.................... unsigned int8   smf_meas_loop_counter;
.................... 
.................... unsigned int32  misf_piclog_use_counter;
.................... unsigned int8   misf_piclog_loop_counter;
.................... unsigned int32  misf_piclog_uncopyed_counter;
.................... unsigned int8   misf_piclog_write_counter;
.................... unsigned int32  misf_meas_use_counter;
.................... unsigned int8   misf_meas_loop_counter;
.................... unsigned int32  misf_meas_uncopyed_counter;
.................... 
.................... 
.................... #define DATA_HEADER_SIZE 64 
.................... 
.................... 
.................... 
.................... 
.................... // ___________SMF-ADDRESS___________
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_flash.c"
.................... 
.................... #endif // MMJ_CIGS_FLASH_H
.................... //------------------End of File------------------
.................... 
.................... #include "../../lib/mt25q.h"
.................... #ifndef MT25Q_H
.................... #define MT25Q_H
.................... 
.................... // =========
.................... //#define MT25Q_DEBUG
.................... // =========
.................... 
.................... 
.................... #define FLASH_STREAM0 MIS_FM_STREAM     // <- Align the names to `config.h` Stream name
.................... #define FLASH_STREAM1 SMF_STREAM
.................... #define FLASH_STREAM2 SMF_STREAM // dont use
.................... #define FLASH_STREAM3 SMF_STREAM // dont use
.................... typedef enum spi_stream{
....................     SPI_0,
....................     SPI_1,
....................     SPI_2,
....................     SPI_3,
.................... }SpiStreamId;
.................... 
.................... #define MT25QL128ABA 0x00     //Mission Flash
.................... #define MT25QL01GBBB 0x01     //SMF,CF
.................... typedef struct select_stream_to_flash{
....................     SpiStreamId spi_stream_id;
....................     unsigned int8 flash_model;
....................     int16 cs_pin;
.................... }Flash;
.................... 
.................... 
.................... Flash mis_fm = {SPI_0, MT25QL128ABA, MIS_FM_CS};
.................... Flash smf = {SPI_1, MT25QL01GBBB, SMF_CS};
.................... 
.................... 
.................... 
.................... // ===================== Function List =====================
.................... // Public Functions
.................... #Separate
.................... int1 is_connect(Flash flash_stream);
.................... #Separate
.................... void write_data_bytes(Flash flash_stream, unsigned int32 write_start_address, int8 *write_data, unsigned int16 write_amount);      
.................... #Separate
.................... void read_data_bytes(Flash flash_stream, unsigned int32 read_start_address, int8 *read_data, unsigned int32 read_amount);  
.................... #Separate
.................... void sector_erase(Flash flash_stream, unsigned int32 sector_address);
.................... #Separate
.................... void subsector_32kByte_erase(Flash flash_stream, unsigned int32 subsector_address);  
.................... #Separate                               
.................... void subsector_4kByte_erase(Flash flash_stream, unsigned int32 subsector_address);      
.................... 
.................... //Private Functions
.................... #Separate 
.................... void flash_setting(Flash flash_stream);
.................... #Separate 
.................... int8 status_register(Flash flash_stream);
.................... #Separate 
.................... int8 read_id(Flash flash_stream);
.................... #Separate 
.................... int8 read_data_byte(Flash flash_stream, unsigned int32 read_address);                                               
.................... #Separate 
.................... void write_data_byte(Flash flash_stream, unsigned int32 write_address,int8 write_data);                             
....................         //
.................... 
.................... 
.................... // ===================== Flash Commands =====================
.................... #define CMD_READ_ID                     0x9F
.................... #define CMD_READ_STATUS_REGISTER        0x05
.................... #define CMD_READ                        0x03//for MT25QL128ABA
.................... #define CMD_4BYTE_READ                  0x13//for MT25QL01GBBB
.................... #define CMD_WRITE_ENABLE                0x06
.................... #define CMD_PAGE_PROGRAM                0x02//for MT25QL128ABA
.................... #define CMD_4BYTE_PAGE_PROGRAM          0x12//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_4KB_ERASE         0x20//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_4KB_ERASE   0x21//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_32KB_ERASE        0x52//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_32KB_ERASE  0x5C//for MT25QL01GBBB
.................... #define CMD_SECTOR_ERASE                0xD8//for MT25QL128ABA
.................... #define CMD_4BYTE_SECTOR_ERASE          0xDC//for MT25QL01GBBB
.................... 
.................... // ====================== Value List =====================
.................... #define MANUFACTURER_ID_MICRON 0x20 // Manufacturer ID for Micron flash
.................... #define READ_ID_DATASIZE 4 // 20 bytes for read ID data
.................... 
.................... 
.................... // ====================== Data Structures =====================
.................... typedef union
.................... {
.................... unsigned int8 bytes[READ_ID_DATASIZE]; // 20 bytes for read ID
.................... struct {
....................     unsigned int8 manufacturer_id; // 1 byte
....................     unsigned int8 memory_type;     // 1 byte
....................     unsigned int8 capacity;        // 1 byte
....................     unsigned int8 reserved;    
.................... } fields;
.................... }READ_ID_DATA;
.................... 
.................... #include "./src/mt25q.c"
.................... #include "../mt25q.h"
.................... #ifndef MT25Q_H
.................... #define MT25Q_H
.................... 
.................... // =========
.................... //#define MT25Q_DEBUG
.................... // =========
.................... 
.................... 
.................... #define FLASH_STREAM0 MIS_FM_STREAM     // <- Align the names to `config.h` Stream name
.................... #define FLASH_STREAM1 SMF_STREAM
.................... #define FLASH_STREAM2 SMF_STREAM // dont use
.................... #define FLASH_STREAM3 SMF_STREAM // dont use
.................... typedef enum spi_stream{
....................     SPI_0,
....................     SPI_1,
....................     SPI_2,
....................     SPI_3,
.................... }SpiStreamId;
.................... 
.................... #define MT25QL128ABA 0x00     //Mission Flash
.................... #define MT25QL01GBBB 0x01     //SMF,CF
.................... typedef struct select_stream_to_flash{
....................     SpiStreamId spi_stream_id;
....................     unsigned int8 flash_model;
....................     int16 cs_pin;
.................... }Flash;
.................... 
.................... 
.................... Flash mis_fm = {SPI_0, MT25QL128ABA, MIS_FM_CS};
.................... Flash smf = {SPI_1, MT25QL01GBBB, SMF_CS};
.................... 
.................... 
.................... 
.................... // ===================== Function List =====================
.................... // Public Functions
.................... #Separate
.................... int1 is_connect(Flash flash_stream);
.................... #Separate
.................... void write_data_bytes(Flash flash_stream, unsigned int32 write_start_address, int8 *write_data, unsigned int16 write_amount);      
.................... #Separate
.................... void read_data_bytes(Flash flash_stream, unsigned int32 read_start_address, int8 *read_data, unsigned int32 read_amount);  
.................... #Separate
.................... void sector_erase(Flash flash_stream, unsigned int32 sector_address);
.................... #Separate
.................... void subsector_32kByte_erase(Flash flash_stream, unsigned int32 subsector_address);  
.................... #Separate                               
.................... void subsector_4kByte_erase(Flash flash_stream, unsigned int32 subsector_address);      
.................... 
.................... //Private Functions
.................... #Separate 
.................... void flash_setting(Flash flash_stream);
.................... #Separate 
.................... int8 status_register(Flash flash_stream);
.................... #Separate 
.................... int8 read_id(Flash flash_stream);
.................... #Separate 
.................... int8 read_data_byte(Flash flash_stream, unsigned int32 read_address);                                               
.................... #Separate 
.................... void write_data_byte(Flash flash_stream, unsigned int32 write_address,int8 write_data);                             
....................         //
.................... 
.................... 
.................... // ===================== Flash Commands =====================
.................... #define CMD_READ_ID                     0x9F
.................... #define CMD_READ_STATUS_REGISTER        0x05
.................... #define CMD_READ                        0x03//for MT25QL128ABA
.................... #define CMD_4BYTE_READ                  0x13//for MT25QL01GBBB
.................... #define CMD_WRITE_ENABLE                0x06
.................... #define CMD_PAGE_PROGRAM                0x02//for MT25QL128ABA
.................... #define CMD_4BYTE_PAGE_PROGRAM          0x12//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_4KB_ERASE         0x20//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_4KB_ERASE   0x21//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_32KB_ERASE        0x52//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_32KB_ERASE  0x5C//for MT25QL01GBBB
.................... #define CMD_SECTOR_ERASE                0xD8//for MT25QL128ABA
.................... #define CMD_4BYTE_SECTOR_ERASE          0xDC//for MT25QL01GBBB
.................... 
.................... // ====================== Value List =====================
.................... #define MANUFACTURER_ID_MICRON 0x20 // Manufacturer ID for Micron flash
.................... #define READ_ID_DATASIZE 4 // 20 bytes for read ID data
.................... 
.................... 
.................... // ====================== Data Structures =====================
.................... typedef union
.................... {
.................... unsigned int8 bytes[READ_ID_DATASIZE]; // 20 bytes for read ID
.................... struct {
....................     unsigned int8 manufacturer_id; // 1 byte
....................     unsigned int8 memory_type;     // 1 byte
....................     unsigned int8 capacity;        // 1 byte
....................     unsigned int8 reserved;    
.................... } fields;
.................... }READ_ID_DATA;
.................... 
.................... #include "./src/mt25q.c"
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... 
.................... //send multi bytes
.................... void spi_xfer_select_stream(Flash flash_stream, int8 *write_data, unsigned int16 write_amount){
....................    switch(flash_stream.spi_stream_id){
*
0F07:  MOVLB  0F
0F08:  MOVF   57,W
0F09:  XORLW  00
0F0A:  MOVLB  00
0F0B:  BTFSC  03.2
0F0C:  GOTO   711
0F0D:  XORLW  01
0F0E:  BTFSC  03.2
0F0F:  GOTO   73A
0F10:  GOTO   764
....................       case SPI_0:
....................          for(unsigned int16 spi_xfer_num = 0;spi_xfer_num < write_amount;spi_xfer_num++)
0F11:  MOVLB  0F
0F12:  CLRF   60
0F13:  CLRF   5F
0F14:  MOVF   60,W
0F15:  SUBWF  5E,W
0F16:  BTFSS  03.0
0F17:  GOTO   739
0F18:  BTFSS  03.2
0F19:  GOTO   71E
0F1A:  MOVF   5D,W
0F1B:  SUBWF  5F,W
0F1C:  BTFSC  03.0
0F1D:  GOTO   739
....................             spi_xfer(FLASH_STREAM0,write_data[spi_xfer_num]);
0F1E:  MOVF   5B,W
0F1F:  ADDWF  5F,W
0F20:  MOVWF  04
0F21:  MOVF   5C,W
0F22:  ADDWFC 60,W
0F23:  MOVWF  05
0F24:  MOVF   00,W
0F25:  MOVWF  63
0F26:  MOVLB  04
0F27:  BCF    15.5
0F28:  MOVLW  40
0F29:  MOVWF  14
0F2A:  MOVLW  09
0F2B:  MOVWF  12
0F2C:  MOVLW  2A
0F2D:  MOVWF  15
0F2E:  MOVLB  0F
0F2F:  MOVF   63,W
0F30:  MOVLB  10
0F31:  MOVWF  2C
0F32:  MOVLB  00
0F33:  CALL   1CB
0F34:  MOVLB  0F
0F35:  INCF   5F,F
0F36:  BTFSC  03.2
0F37:  INCF   60,F
0F38:  GOTO   714
....................          break;
0F39:  GOTO   765
....................          
....................       case SPI_1:
....................          for(unsigned int16 spi_xfer_num = 0;spi_xfer_num < write_amount;spi_xfer_num++)
0F3A:  MOVLB  0F
0F3B:  CLRF   62
0F3C:  CLRF   61
0F3D:  MOVF   62,W
0F3E:  SUBWF  5E,W
0F3F:  BTFSS  03.0
0F40:  GOTO   762
0F41:  BTFSS  03.2
0F42:  GOTO   747
0F43:  MOVF   5D,W
0F44:  SUBWF  61,W
0F45:  BTFSC  03.0
0F46:  GOTO   762
....................             spi_xfer(FLASH_STREAM1,write_data[spi_xfer_num]);
0F47:  MOVF   5B,W
0F48:  ADDWF  61,W
0F49:  MOVWF  04
0F4A:  MOVF   5C,W
0F4B:  ADDWFC 62,W
0F4C:  MOVWF  05
0F4D:  MOVF   00,W
0F4E:  MOVWF  63
0F4F:  MOVLB  04
0F50:  BCF    15.5
0F51:  MOVLW  40
0F52:  MOVWF  14
0F53:  MOVLW  09
0F54:  MOVWF  12
0F55:  MOVLW  2A
0F56:  MOVWF  15
0F57:  MOVLB  0F
0F58:  MOVF   63,W
0F59:  MOVLB  10
0F5A:  MOVWF  2C
0F5B:  MOVLB  00
0F5C:  CALL   1D8
0F5D:  MOVLB  0F
0F5E:  INCF   61,F
0F5F:  BTFSC  03.2
0F60:  INCF   62,F
0F61:  GOTO   73D
....................          break;
0F62:  GOTO   765
0F63:  MOVLB  00
....................          
....................       default:
....................          break;
0F64:  MOVLB  0F
....................    }
....................    return;
0F65:  MOVLB  00
0F66:  RETURN
.................... }
.................... 
.................... //send multi bytes then receive multi bytes 
.................... void spi_xfer_and_read_select_stream(Flash flash_stream, int8 *write_data, unsigned int16 write_amount, int8 *read_data, unsigned int32 read_amount){
....................    switch(flash_stream.spi_stream_id){
*
09E5:  MOVLB  0F
09E6:  MOVF   5D,W
09E7:  XORLW  00
09E8:  MOVLB  00
09E9:  BTFSC  03.2
09EA:  GOTO   1EF
09EB:  XORLW  01
09EC:  BTFSC  03.2
09ED:  GOTO   25F
09EE:  GOTO   2D0
....................       case SPI_0:
....................       for(unsigned int16 spi_xfer_num = 0;spi_xfer_num < write_amount;spi_xfer_num++)
09EF:  MOVLB  0F
09F0:  CLRF   6C
09F1:  CLRF   6B
09F2:  MOVF   6C,W
09F3:  SUBWF  64,W
09F4:  BTFSS  03.0
09F5:  GOTO   217
09F6:  BTFSS  03.2
09F7:  GOTO   1FC
09F8:  MOVF   63,W
09F9:  SUBWF  6B,W
09FA:  BTFSC  03.0
09FB:  GOTO   217
....................          spi_xfer(FLASH_STREAM0, write_data[spi_xfer_num]);
09FC:  MOVF   61,W
09FD:  ADDWF  6B,W
09FE:  MOVWF  04
09FF:  MOVF   62,W
0A00:  ADDWFC 6C,W
0A01:  MOVWF  05
0A02:  MOVF   00,W
0A03:  MOVLB  10
0A04:  MOVWF  28
0A05:  MOVLB  04
0A06:  BCF    15.5
0A07:  MOVLW  40
0A08:  MOVWF  14
0A09:  MOVLW  09
0A0A:  MOVWF  12
0A0B:  MOVLW  2A
0A0C:  MOVWF  15
0A0D:  MOVLB  10
0A0E:  MOVF   28,W
0A0F:  MOVWF  2C
0A10:  MOVLB  00
0A11:  CALL   1CB
0A12:  MOVLB  0F
0A13:  INCF   6B,F
0A14:  BTFSC  03.2
0A15:  INCF   6C,F
0A16:  GOTO   1F2
....................       for(unsigned int32 spi_rcv_num = 0;spi_rcv_num < read_amount;spi_rcv_num++)
0A17:  MOVLB  10
0A18:  CLRF   23
0A19:  CLRF   22
0A1A:  CLRF   21
0A1B:  CLRF   20
0A1C:  MOVF   23,W
0A1D:  MOVLB  0F
0A1E:  SUBWF  6A,W
0A1F:  BTFSS  03.0
0A20:  GOTO   25E
0A21:  BTFSS  03.2
0A22:  GOTO   23B
0A23:  MOVLB  10
0A24:  MOVF   22,W
0A25:  MOVLB  0F
0A26:  SUBWF  69,W
0A27:  BTFSS  03.0
0A28:  GOTO   25E
0A29:  BTFSS  03.2
0A2A:  GOTO   23B
0A2B:  MOVLB  10
0A2C:  MOVF   21,W
0A2D:  MOVLB  0F
0A2E:  SUBWF  68,W
0A2F:  BTFSS  03.0
0A30:  GOTO   25E
0A31:  BTFSS  03.2
0A32:  GOTO   23B
0A33:  MOVF   67,W
0A34:  MOVLB  10
0A35:  SUBWF  20,W
0A36:  BTFSS  03.0
0A37:  GOTO   23A
0A38:  MOVLB  0F
0A39:  GOTO   25E
0A3A:  MOVLB  0F
....................          read_data[spi_rcv_num] = spi_xfer(FLASH_STREAM0);
0A3B:  MOVF   65,W
0A3C:  MOVLB  10
0A3D:  ADDWF  20,W
0A3E:  MOVWF  04
0A3F:  MOVLB  0F
0A40:  MOVF   66,W
0A41:  MOVLB  10
0A42:  ADDWFC 21,W
0A43:  MOVWF  05
0A44:  MOVLB  04
0A45:  BCF    15.5
0A46:  MOVLW  40
0A47:  MOVWF  14
0A48:  MOVLW  09
0A49:  MOVWF  12
0A4A:  MOVLW  2A
0A4B:  MOVWF  15
0A4C:  MOVLW  01
0A4D:  MOVLB  10
0A4E:  MOVWF  2C
0A4F:  MOVLB  00
0A50:  CALL   1CB
0A51:  MOVF   77,W
0A52:  MOVWF  00
0A53:  MOVLW  01
0A54:  MOVLB  10
0A55:  ADDWF  20,F
0A56:  BTFSC  03.0
0A57:  INCF   21,F
0A58:  BTFSC  03.2
0A59:  INCF   22,F
0A5A:  BTFSC  03.2
0A5B:  INCF   23,F
0A5C:  GOTO   21C
0A5D:  MOVLB  0F
....................          break;
0A5E:  GOTO   2D1
....................          
....................       case SPI_1:
....................          for(unsigned int16 spi_xfer_num = 0;spi_xfer_num < write_amount;spi_xfer_num++)
0A5F:  MOVLB  0F
0A60:  CLRF   6E
0A61:  CLRF   6D
0A62:  MOVF   6E,W
0A63:  SUBWF  64,W
0A64:  BTFSS  03.0
0A65:  GOTO   287
0A66:  BTFSS  03.2
0A67:  GOTO   26C
0A68:  MOVF   63,W
0A69:  SUBWF  6D,W
0A6A:  BTFSC  03.0
0A6B:  GOTO   287
....................             spi_xfer(FLASH_STREAM1, write_data[spi_xfer_num]);
0A6C:  MOVF   61,W
0A6D:  ADDWF  6D,W
0A6E:  MOVWF  04
0A6F:  MOVF   62,W
0A70:  ADDWFC 6E,W
0A71:  MOVWF  05
0A72:  MOVF   00,W
0A73:  MOVLB  10
0A74:  MOVWF  28
0A75:  MOVLB  04
0A76:  BCF    15.5
0A77:  MOVLW  40
0A78:  MOVWF  14
0A79:  MOVLW  09
0A7A:  MOVWF  12
0A7B:  MOVLW  2A
0A7C:  MOVWF  15
0A7D:  MOVLB  10
0A7E:  MOVF   28,W
0A7F:  MOVWF  2C
0A80:  MOVLB  00
0A81:  CALL   1D8
0A82:  MOVLB  0F
0A83:  INCF   6D,F
0A84:  BTFSC  03.2
0A85:  INCF   6E,F
0A86:  GOTO   262
....................          for(unsigned int32 spi_rcv_num = 0;spi_rcv_num < read_amount;spi_rcv_num++)
0A87:  MOVLB  10
0A88:  CLRF   27
0A89:  CLRF   26
0A8A:  CLRF   25
0A8B:  CLRF   24
0A8C:  MOVF   27,W
0A8D:  MOVLB  0F
0A8E:  SUBWF  6A,W
0A8F:  BTFSS  03.0
0A90:  GOTO   2CE
0A91:  BTFSS  03.2
0A92:  GOTO   2AB
0A93:  MOVLB  10
0A94:  MOVF   26,W
0A95:  MOVLB  0F
0A96:  SUBWF  69,W
0A97:  BTFSS  03.0
0A98:  GOTO   2CE
0A99:  BTFSS  03.2
0A9A:  GOTO   2AB
0A9B:  MOVLB  10
0A9C:  MOVF   25,W
0A9D:  MOVLB  0F
0A9E:  SUBWF  68,W
0A9F:  BTFSS  03.0
0AA0:  GOTO   2CE
0AA1:  BTFSS  03.2
0AA2:  GOTO   2AB
0AA3:  MOVF   67,W
0AA4:  MOVLB  10
0AA5:  SUBWF  24,W
0AA6:  BTFSS  03.0
0AA7:  GOTO   2AA
0AA8:  MOVLB  0F
0AA9:  GOTO   2CE
0AAA:  MOVLB  0F
....................             read_data[spi_rcv_num] = spi_xfer(FLASH_STREAM1);
0AAB:  MOVF   65,W
0AAC:  MOVLB  10
0AAD:  ADDWF  24,W
0AAE:  MOVWF  04
0AAF:  MOVLB  0F
0AB0:  MOVF   66,W
0AB1:  MOVLB  10
0AB2:  ADDWFC 25,W
0AB3:  MOVWF  05
0AB4:  MOVLB  04
0AB5:  BCF    15.5
0AB6:  MOVLW  40
0AB7:  MOVWF  14
0AB8:  MOVLW  09
0AB9:  MOVWF  12
0ABA:  MOVLW  2A
0ABB:  MOVWF  15
0ABC:  MOVLW  02
0ABD:  MOVLB  10
0ABE:  MOVWF  2C
0ABF:  MOVLB  00
0AC0:  CALL   1D8
0AC1:  MOVF   77,W
0AC2:  MOVWF  00
0AC3:  MOVLW  01
0AC4:  MOVLB  10
0AC5:  ADDWF  24,F
0AC6:  BTFSC  03.0
0AC7:  INCF   25,F
0AC8:  BTFSC  03.2
0AC9:  INCF   26,F
0ACA:  BTFSC  03.2
0ACB:  INCF   27,F
0ACC:  GOTO   28C
0ACD:  MOVLB  0F
....................          break;
0ACE:  GOTO   2D1
0ACF:  MOVLB  00
....................    
....................          
....................       default:
....................          break;
0AD0:  MOVLB  0F
....................    }
....................    return;
0AD1:  MOVLB  00
0AD2:  RETURN
.................... }
.................... 
.................... //send multi bytes(ex:cmd) then send other multi bytes(for write multi bytes) 
.................... void spi_xfer_two_datas_select_stream(Flash flash_stream, int8 *cmd_data, unsigned int8 cmd_amount, int8 *write_data, unsigned int16 write_amount){
....................    switch(flash_stream.spi_stream_id){
*
1000:  MOVLB  0F
1001:  MOVF   57,W
1002:  XORLW  00
1003:  MOVLB  00
1004:  BTFSC  03.2
1005:  GOTO   00A
1006:  XORLW  01
1007:  BTFSC  03.2
1008:  GOTO   055
1009:  GOTO   0A1
....................       case SPI_0:
....................       for(unsigned int8 spi_xfer_num = 0;spi_xfer_num < cmd_amount;spi_xfer_num++)
100A:  MOVLB  0F
100B:  CLRF   62
100C:  MOVF   5D,W
100D:  SUBWF  62,W
100E:  BTFSC  03.0
100F:  GOTO   02B
....................          spi_xfer(FLASH_STREAM0, cmd_data[spi_xfer_num]);
1010:  MOVF   62,W
1011:  ADDWF  5B,W
1012:  MOVWF  04
1013:  MOVLW  00
1014:  ADDWFC 5C,W
1015:  MOVWF  05
1016:  MOVF   00,W
1017:  MOVWF  68
1018:  MOVLB  04
1019:  BCF    15.5
101A:  MOVLW  40
101B:  MOVWF  14
101C:  MOVLW  09
101D:  MOVWF  12
101E:  MOVLW  2A
101F:  MOVWF  15
1020:  MOVLB  0F
1021:  MOVF   68,W
1022:  MOVLB  10
1023:  MOVWF  2C
1024:  MOVLP  08
1025:  MOVLB  00
1026:  CALL   1CB
1027:  MOVLP  10
1028:  MOVLB  0F
1029:  INCF   62,F
102A:  GOTO   00C
....................       for(unsigned int16 spi_xfer_num = 0;spi_xfer_num < write_amount;spi_xfer_num++)
102B:  CLRF   64
102C:  CLRF   63
102D:  MOVF   64,W
102E:  SUBWF  61,W
102F:  BTFSS  03.0
1030:  GOTO   054
1031:  BTFSS  03.2
1032:  GOTO   037
1033:  MOVF   60,W
1034:  SUBWF  63,W
1035:  BTFSC  03.0
1036:  GOTO   054
....................          spi_xfer(FLASH_STREAM0, write_data[spi_xfer_num]);
1037:  MOVF   5E,W
1038:  ADDWF  63,W
1039:  MOVWF  04
103A:  MOVF   5F,W
103B:  ADDWFC 64,W
103C:  MOVWF  05
103D:  MOVF   00,W
103E:  MOVWF  68
103F:  MOVLB  04
1040:  BCF    15.5
1041:  MOVLW  40
1042:  MOVWF  14
1043:  MOVLW  09
1044:  MOVWF  12
1045:  MOVLW  2A
1046:  MOVWF  15
1047:  MOVLB  0F
1048:  MOVF   68,W
1049:  MOVLB  10
104A:  MOVWF  2C
104B:  MOVLP  08
104C:  MOVLB  00
104D:  CALL   1CB
104E:  MOVLP  10
104F:  MOVLB  0F
1050:  INCF   63,F
1051:  BTFSC  03.2
1052:  INCF   64,F
1053:  GOTO   02D
....................          break;
1054:  GOTO   0A3
....................          
....................       case SPI_1:
....................          for(unsigned int8 spi_xfer_num = 0;spi_xfer_num < cmd_amount;spi_xfer_num++)
1055:  MOVLB  0F
1056:  CLRF   65
1057:  MOVF   5D,W
1058:  SUBWF  65,W
1059:  BTFSC  03.0
105A:  GOTO   076
....................             spi_xfer(FLASH_STREAM1, cmd_data[spi_xfer_num]);
105B:  MOVF   65,W
105C:  ADDWF  5B,W
105D:  MOVWF  04
105E:  MOVLW  00
105F:  ADDWFC 5C,W
1060:  MOVWF  05
1061:  MOVF   00,W
1062:  MOVWF  68
1063:  MOVLB  04
1064:  BCF    15.5
1065:  MOVLW  40
1066:  MOVWF  14
1067:  MOVLW  09
1068:  MOVWF  12
1069:  MOVLW  2A
106A:  MOVWF  15
106B:  MOVLB  0F
106C:  MOVF   68,W
106D:  MOVLB  10
106E:  MOVWF  2C
106F:  MOVLP  08
1070:  MOVLB  00
1071:  CALL   1D8
1072:  MOVLP  10
1073:  MOVLB  0F
1074:  INCF   65,F
1075:  GOTO   057
....................          for(unsigned int16 spi_xfer_num = 0;spi_xfer_num < write_amount;spi_xfer_num++)
1076:  CLRF   67
1077:  CLRF   66
1078:  MOVF   67,W
1079:  SUBWF  61,W
107A:  BTFSS  03.0
107B:  GOTO   09F
107C:  BTFSS  03.2
107D:  GOTO   082
107E:  MOVF   60,W
107F:  SUBWF  66,W
1080:  BTFSC  03.0
1081:  GOTO   09F
....................             spi_xfer(FLASH_STREAM1, write_data[spi_xfer_num]);
1082:  MOVF   5E,W
1083:  ADDWF  66,W
1084:  MOVWF  04
1085:  MOVF   5F,W
1086:  ADDWFC 67,W
1087:  MOVWF  05
1088:  MOVF   00,W
1089:  MOVWF  68
108A:  MOVLB  04
108B:  BCF    15.5
108C:  MOVLW  40
108D:  MOVWF  14
108E:  MOVLW  09
108F:  MOVWF  12
1090:  MOVLW  2A
1091:  MOVWF  15
1092:  MOVLB  0F
1093:  MOVF   68,W
1094:  MOVLB  10
1095:  MOVWF  2C
1096:  MOVLP  08
1097:  MOVLB  00
1098:  CALL   1D8
1099:  MOVLP  10
109A:  MOVLB  0F
109B:  INCF   66,F
109C:  BTFSC  03.2
109D:  INCF   67,F
109E:  GOTO   078
....................          break;
109F:  GOTO   0A3
10A0:  MOVLB  00
....................          
....................       default:
....................          break;
10A1:  MOVLB  0F
10A2:  GOTO   0A3
....................    }
....................    return;
10A3:  MOVLB  00
10A4:  RETURN
.................... }
.................... 
.................... ///////////////////////////////////////////////////////////////////////////////
.................... ///////////////////////////////////////////////////////////////////////////////
.................... ///////////////////////////////////////////////////////////////////////////////
.................... 
.................... void flash_setting(Flash flash_stream){
....................    output_high(flash_stream.cs_pin);
*
1F73:  MOVLB  0E
1F74:  MOVF   41,W
1F75:  MOVLB  0F
1F76:  MOVWF  5D
1F77:  MOVLW  01
1F78:  MOVWF  5E
1F79:  MOVWF  60
1F7A:  CLRF   5F
1F7B:  MOVLP  08
1F7C:  MOVLB  00
1F7D:  CALL   1A9
1F7E:  MOVLP  18
1F7F:  MOVLB  0E
1F80:  MOVF   41,W
1F81:  MOVLB  0F
1F82:  MOVWF  5D
1F83:  CLRF   5E
1F84:  CLRF   60
1F85:  MOVLW  80
1F86:  MOVWF  5F
1F87:  MOVLP  08
1F88:  MOVLB  00
1F89:  CALL   1A9
1F8A:  MOVLP  18
1F8B:  RETURN
.................... }
.................... #Separate 
.................... int8 status_register(Flash flash_stream){
*
0F67:  MOVLW  05
0F68:  MOVLB  0F
0F69:  MOVWF  5B
....................    int8 flash_cmd = CMD_READ_STATUS_REGISTER;
....................    int8 status_reg;
....................    output_low(flash_stream.cs_pin);                                              //lower the CS PIN
0F6A:  MOVF   59,W
0F6B:  MOVWF  5D
0F6C:  CLRF   5E
0F6D:  MOVLW  01
0F6E:  MOVWF  60
0F6F:  CLRF   5F
0F70:  MOVLB  00
0F71:  CALL   1A9
0F72:  MOVLB  0F
0F73:  MOVF   59,W
0F74:  MOVWF  5D
0F75:  CLRF   5E
0F76:  CLRF   60
0F77:  MOVLW  80
0F78:  MOVWF  5F
0F79:  MOVLB  00
0F7A:  CALL   1A9
....................    spi_xfer_and_read_select_stream(flash_stream, &flash_cmd, 1, &status_reg, 1);
0F7B:  MOVLB  0F
0F7C:  MOVF   5A,W
0F7D:  MOVWF  60
0F7E:  MOVF   59,W
0F7F:  MOVWF  5F
0F80:  MOVF   58,W
0F81:  MOVWF  5E
0F82:  MOVF   57,W
0F83:  MOVWF  5D
0F84:  MOVLW  24
0F85:  MOVWF  62
0F86:  MOVLW  EB
0F87:  MOVWF  61
0F88:  CLRF   64
0F89:  MOVLW  01
0F8A:  MOVWF  63
0F8B:  MOVLW  24
0F8C:  MOVWF  66
0F8D:  MOVLW  EC
0F8E:  MOVWF  65
0F8F:  CLRF   6A
0F90:  CLRF   69
0F91:  CLRF   68
0F92:  MOVLW  01
0F93:  MOVWF  67
0F94:  MOVLB  00
0F95:  CALL   1E5
....................    output_high(flash_stream.cs_pin);                                             //take CS PIN higher back
0F96:  MOVLB  0F
0F97:  MOVF   59,W
0F98:  MOVWF  5D
0F99:  MOVLW  01
0F9A:  MOVWF  5E
0F9B:  MOVWF  60
0F9C:  CLRF   5F
0F9D:  MOVLB  00
0F9E:  CALL   1A9
0F9F:  MOVLB  0F
0FA0:  MOVF   59,W
0FA1:  MOVWF  5D
0FA2:  CLRF   5E
0FA3:  CLRF   60
0FA4:  MOVLW  80
0FA5:  MOVWF  5F
0FA6:  MOVLB  00
0FA7:  CALL   1A9
....................    #ifdef MT25Q_DEBUG
....................       if((status_reg & 0x01) == true)                                          //masking status bit   
....................          fprintf(PC,"flash busy\n\r");
....................    #endif
....................    return status_reg;  
0FA8:  MOVLB  0F
0FA9:  MOVF   5C,W
0FAA:  MOVWF  78
0FAB:  MOVLB  00
0FAC:  RETURN
.................... }
.................... 
.................... //
.................... //->success:True,fail:false
.................... #Separate 
.................... int8 read_id(Flash flash_stream){
....................    int8 flash_cmd = CMD_READ_ID;
....................    int8 chip_id[20];
....................    output_low(flash_stream.cs_pin);
....................    spi_xfer_and_read_select_stream(flash_stream, &flash_cmd, 1, chip_id, 20);
....................    output_high(flash_stream.cs_pin);
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"Read ID:");
....................       for(int8 print_counter = 0;print_counter < 20;print_counter++)
....................          fprintf(PC,"%x ",chip_id[print_counter]);
....................       fprintf(PC,"\r\n");
....................    #endif
....................    //chip id check
....................    if(chip_id[0] == 0x20){  
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"flash connect OK\r\n");
....................       #endif
....................       return true;
....................    }
....................    else{
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"flash not connect\r\n");
....................       #endif
....................       return false;
....................    }
.................... }
.................... #Separate 
.................... void sector_erase(Flash flash_stream, unsigned int32 sector_address){
.................... //!   #ifdef MT25Q_DEBUG
.................... //!      fprintf(PC,"Sector Erase\r\n");
.................... //!   #endif
....................    if(flash_stream.flash_model == MT25QL128ABA){
*
1C12:  MOVLB  0B
1C13:  MOVF   2F,F
1C14:  BTFSS  03.2
1C15:  GOTO   4C3
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[4];
1C16:  MOVLW  06
1C17:  MOVWF  36
.................... //!      #ifdef MT25Q_DEBUG
.................... //!         fprintf(PC,"FLASH MODEL:MT25QL128ABA\r\n");
.................... //!      #endif
....................       flash_cmd[0] = CMD_SECTOR_ERASE;
1C18:  MOVLW  D8
1C19:  MOVWF  37
....................       flash_cmd[1] = (unsigned int8)((sector_address>>16) & 0xff);   // 0x 00 _ _ 00 00
1C1A:  CLRF   46
1C1B:  CLRF   47
1C1C:  CLRF   78
1C1D:  CLRF   79
1C1E:  CLRF   7A
1C1F:  MOVF   34,W
1C20:  MOVWF  38
....................       flash_cmd[2] = (unsigned int8)((sector_address>>8) & 0xff);    // 0x 00 00 _ _ 00
1C21:  CLRF   47
1C22:  CLRF   78
1C23:  CLRF   79
1C24:  CLRF   7A
1C25:  MOVF   33,W
1C26:  MOVWF  39
....................       flash_cmd[3] = (unsigned int8)((sector_address) & 0xff);       // 0x 00 00 00 _ _
1C27:  CLRF   78
1C28:  CLRF   79
1C29:  CLRF   7A
1C2A:  MOVF   32,W
1C2B:  MOVWF  3A
....................             
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
1C2C:  MOVF   30,W
1C2D:  MOVLB  0F
1C2E:  MOVWF  5D
1C2F:  CLRF   5E
1C30:  MOVLW  01
1C31:  MOVWF  60
1C32:  CLRF   5F
1C33:  MOVLP  08
1C34:  MOVLB  00
1C35:  CALL   1A9
1C36:  MOVLP  18
1C37:  MOVLB  0B
1C38:  MOVF   30,W
1C39:  MOVLB  0F
1C3A:  MOVWF  5D
1C3B:  CLRF   5E
1C3C:  CLRF   60
1C3D:  MOVLW  80
1C3E:  MOVWF  5F
1C3F:  MOVLP  08
1C40:  MOVLB  00
1C41:  CALL   1A9
1C42:  MOVLP  18
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
1C43:  MOVLB  0B
1C44:  MOVF   31,W
1C45:  MOVLB  0F
1C46:  MOVWF  5A
1C47:  MOVLB  0B
1C48:  MOVF   30,W
1C49:  MOVLB  0F
1C4A:  MOVWF  59
1C4B:  MOVLB  0B
1C4C:  MOVF   2F,W
1C4D:  MOVLB  0F
1C4E:  MOVWF  58
1C4F:  MOVLB  0B
1C50:  MOVF   2E,W
1C51:  MOVLB  0F
1C52:  MOVWF  57
1C53:  MOVLW  23
1C54:  MOVWF  5C
1C55:  MOVLW  86
1C56:  MOVWF  5B
1C57:  CLRF   5E
1C58:  MOVLW  01
1C59:  MOVWF  5D
1C5A:  MOVLP  08
1C5B:  MOVLB  00
1C5C:  CALL   707
1C5D:  MOVLP  18
....................       output_high(flash_stream.cs_pin);
1C5E:  MOVLB  0B
1C5F:  MOVF   30,W
1C60:  MOVLB  0F
1C61:  MOVWF  5D
1C62:  MOVLW  01
1C63:  MOVWF  5E
1C64:  MOVWF  60
1C65:  CLRF   5F
1C66:  MOVLP  08
1C67:  MOVLB  00
1C68:  CALL   1A9
1C69:  MOVLP  18
1C6A:  MOVLB  0B
1C6B:  MOVF   30,W
1C6C:  MOVLB  0F
1C6D:  MOVWF  5D
1C6E:  CLRF   5E
1C6F:  CLRF   60
1C70:  MOVLW  80
1C71:  MOVWF  5F
1C72:  MOVLP  08
1C73:  MOVLB  00
1C74:  CALL   1A9
1C75:  MOVLP  18
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
1C76:  MOVLB  0B
1C77:  MOVF   30,W
1C78:  MOVLB  0F
1C79:  MOVWF  5D
1C7A:  CLRF   5E
1C7B:  MOVLW  01
1C7C:  MOVWF  60
1C7D:  CLRF   5F
1C7E:  MOVLP  08
1C7F:  MOVLB  00
1C80:  CALL   1A9
1C81:  MOVLP  18
1C82:  MOVLB  0B
1C83:  MOVF   30,W
1C84:  MOVLB  0F
1C85:  MOVWF  5D
1C86:  CLRF   5E
1C87:  CLRF   60
1C88:  MOVLW  80
1C89:  MOVWF  5F
1C8A:  MOVLP  08
1C8B:  MOVLB  00
1C8C:  CALL   1A9
1C8D:  MOVLP  18
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 4);
1C8E:  MOVLB  0B
1C8F:  MOVF   31,W
1C90:  MOVLB  0F
1C91:  MOVWF  5A
1C92:  MOVLB  0B
1C93:  MOVF   30,W
1C94:  MOVLB  0F
1C95:  MOVWF  59
1C96:  MOVLB  0B
1C97:  MOVF   2F,W
1C98:  MOVLB  0F
1C99:  MOVWF  58
1C9A:  MOVLB  0B
1C9B:  MOVF   2E,W
1C9C:  MOVLB  0F
1C9D:  MOVWF  57
1C9E:  MOVLW  23
1C9F:  MOVWF  5C
1CA0:  MOVLW  87
1CA1:  MOVWF  5B
1CA2:  CLRF   5E
1CA3:  MOVLW  04
1CA4:  MOVWF  5D
1CA5:  MOVLP  08
1CA6:  MOVLB  00
1CA7:  CALL   707
1CA8:  MOVLP  18
....................       //////////////////////////////////////////////////////////////////
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
1CA9:  MOVLB  0B
1CAA:  MOVF   30,W
1CAB:  MOVLB  0F
1CAC:  MOVWF  5D
1CAD:  MOVLW  01
1CAE:  MOVWF  5E
1CAF:  MOVWF  60
1CB0:  CLRF   5F
1CB1:  MOVLP  08
1CB2:  MOVLB  00
1CB3:  CALL   1A9
1CB4:  MOVLP  18
1CB5:  MOVLB  0B
1CB6:  MOVF   30,W
1CB7:  MOVLB  0F
1CB8:  MOVWF  5D
1CB9:  CLRF   5E
1CBA:  CLRF   60
1CBB:  MOVLW  80
1CBC:  MOVWF  5F
1CBD:  MOVLP  08
1CBE:  MOVLB  00
1CBF:  CALL   1A9
1CC0:  MOVLP  18
....................    }
1CC1:  GOTO   578
1CC2:  MOVLB  0B
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
1CC3:  DECFSZ 2F,W
1CC4:  GOTO   579
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[5];
1CC5:  MOVLW  06
1CC6:  MOVWF  3B
.................... //!      #ifdef MT25Q_DEBUG
.................... //!         fprintf(PC,"FLASH MODEL:MT25QL01GBBB\r\n");
.................... //!      #endif
....................       flash_cmd[0] = CMD_4BYTE_SECTOR_ERASE;
1CC7:  MOVLW  DC
1CC8:  MOVWF  3C
....................       flash_cmd[1] = (unsigned int8)((sector_address>>24) & 0xff);   // 0x _ _ 00 00 00
1CC9:  CLRF   45
1CCA:  CLRF   46
1CCB:  CLRF   47
1CCC:  CLRF   78
1CCD:  CLRF   79
1CCE:  CLRF   7A
1CCF:  MOVF   35,W
1CD0:  MOVWF  3D
....................       flash_cmd[2] = (unsigned int8)((sector_address>>16) & 0xff);   // 0x 00 _ _ 00 00
1CD1:  CLRF   46
1CD2:  CLRF   47
1CD3:  CLRF   78
1CD4:  CLRF   79
1CD5:  CLRF   7A
1CD6:  MOVF   34,W
1CD7:  MOVWF  3E
....................       flash_cmd[3] = (unsigned int8)((sector_address>>8) & 0xff);    // 0x 00 00 _ _ 00
1CD8:  CLRF   47
1CD9:  CLRF   78
1CDA:  CLRF   79
1CDB:  CLRF   7A
1CDC:  MOVF   33,W
1CDD:  MOVWF  3F
....................       flash_cmd[4] = (unsigned int8)((sector_address) & 0xff);       // 0x 00 00 00 _ _
1CDE:  CLRF   78
1CDF:  CLRF   79
1CE0:  CLRF   7A
1CE1:  MOVF   32,W
1CE2:  MOVWF  40
....................       
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
1CE3:  MOVF   30,W
1CE4:  MOVLB  0F
1CE5:  MOVWF  5D
1CE6:  CLRF   5E
1CE7:  MOVLW  01
1CE8:  MOVWF  60
1CE9:  CLRF   5F
1CEA:  MOVLP  08
1CEB:  MOVLB  00
1CEC:  CALL   1A9
1CED:  MOVLP  18
1CEE:  MOVLB  0B
1CEF:  MOVF   30,W
1CF0:  MOVLB  0F
1CF1:  MOVWF  5D
1CF2:  CLRF   5E
1CF3:  CLRF   60
1CF4:  MOVLW  80
1CF5:  MOVWF  5F
1CF6:  MOVLP  08
1CF7:  MOVLB  00
1CF8:  CALL   1A9
1CF9:  MOVLP  18
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
1CFA:  MOVLB  0B
1CFB:  MOVF   31,W
1CFC:  MOVLB  0F
1CFD:  MOVWF  5A
1CFE:  MOVLB  0B
1CFF:  MOVF   30,W
1D00:  MOVLB  0F
1D01:  MOVWF  59
1D02:  MOVLB  0B
1D03:  MOVF   2F,W
1D04:  MOVLB  0F
1D05:  MOVWF  58
1D06:  MOVLB  0B
1D07:  MOVF   2E,W
1D08:  MOVLB  0F
1D09:  MOVWF  57
1D0A:  MOVLW  23
1D0B:  MOVWF  5C
1D0C:  MOVLW  8B
1D0D:  MOVWF  5B
1D0E:  CLRF   5E
1D0F:  MOVLW  01
1D10:  MOVWF  5D
1D11:  MOVLP  08
1D12:  MOVLB  00
1D13:  CALL   707
1D14:  MOVLP  18
....................       output_high(flash_stream.cs_pin);
1D15:  MOVLB  0B
1D16:  MOVF   30,W
1D17:  MOVLB  0F
1D18:  MOVWF  5D
1D19:  MOVLW  01
1D1A:  MOVWF  5E
1D1B:  MOVWF  60
1D1C:  CLRF   5F
1D1D:  MOVLP  08
1D1E:  MOVLB  00
1D1F:  CALL   1A9
1D20:  MOVLP  18
1D21:  MOVLB  0B
1D22:  MOVF   30,W
1D23:  MOVLB  0F
1D24:  MOVWF  5D
1D25:  CLRF   5E
1D26:  CLRF   60
1D27:  MOVLW  80
1D28:  MOVWF  5F
1D29:  MOVLP  08
1D2A:  MOVLB  00
1D2B:  CALL   1A9
1D2C:  MOVLP  18
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
1D2D:  MOVLB  0B
1D2E:  MOVF   30,W
1D2F:  MOVLB  0F
1D30:  MOVWF  5D
1D31:  CLRF   5E
1D32:  MOVLW  01
1D33:  MOVWF  60
1D34:  CLRF   5F
1D35:  MOVLP  08
1D36:  MOVLB  00
1D37:  CALL   1A9
1D38:  MOVLP  18
1D39:  MOVLB  0B
1D3A:  MOVF   30,W
1D3B:  MOVLB  0F
1D3C:  MOVWF  5D
1D3D:  CLRF   5E
1D3E:  CLRF   60
1D3F:  MOVLW  80
1D40:  MOVWF  5F
1D41:  MOVLP  08
1D42:  MOVLB  00
1D43:  CALL   1A9
1D44:  MOVLP  18
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 5);
1D45:  MOVLB  0B
1D46:  MOVF   31,W
1D47:  MOVLB  0F
1D48:  MOVWF  5A
1D49:  MOVLB  0B
1D4A:  MOVF   30,W
1D4B:  MOVLB  0F
1D4C:  MOVWF  59
1D4D:  MOVLB  0B
1D4E:  MOVF   2F,W
1D4F:  MOVLB  0F
1D50:  MOVWF  58
1D51:  MOVLB  0B
1D52:  MOVF   2E,W
1D53:  MOVLB  0F
1D54:  MOVWF  57
1D55:  MOVLW  23
1D56:  MOVWF  5C
1D57:  MOVLW  8C
1D58:  MOVWF  5B
1D59:  CLRF   5E
1D5A:  MOVLW  05
1D5B:  MOVWF  5D
1D5C:  MOVLP  08
1D5D:  MOVLB  00
1D5E:  CALL   707
1D5F:  MOVLP  18
....................       //////////////////////////////////////////////////////////////////
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
1D60:  MOVLB  0B
1D61:  MOVF   30,W
1D62:  MOVLB  0F
1D63:  MOVWF  5D
1D64:  MOVLW  01
1D65:  MOVWF  5E
1D66:  MOVWF  60
1D67:  CLRF   5F
1D68:  MOVLP  08
1D69:  MOVLB  00
1D6A:  CALL   1A9
1D6B:  MOVLP  18
1D6C:  MOVLB  0B
1D6D:  MOVF   30,W
1D6E:  MOVLB  0F
1D6F:  MOVWF  5D
1D70:  CLRF   5E
1D71:  CLRF   60
1D72:  MOVLW  80
1D73:  MOVWF  5F
1D74:  MOVLP  08
1D75:  MOVLB  00
1D76:  CALL   1A9
1D77:  MOVLP  18
....................    }
1D78:  MOVLB  0B
....................    
....................    else{
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"error:flash model is invalid\r\n");
....................       #endif
....................    }
....................    
....................    //wait process finished
....................    unsigned int8 timeout_counter = 0;
1D79:  CLRF   41
....................    while((status_register(flash_stream) & 0x01) == 1){      //masking status bit
1D7A:  MOVF   31,W
1D7B:  MOVLB  0F
1D7C:  MOVWF  5A
1D7D:  MOVLB  0B
1D7E:  MOVF   30,W
1D7F:  MOVLB  0F
1D80:  MOVWF  59
1D81:  MOVLB  0B
1D82:  MOVF   2F,W
1D83:  MOVLB  0F
1D84:  MOVWF  58
1D85:  MOVLB  0B
1D86:  MOVF   2E,W
1D87:  MOVLB  0F
1D88:  MOVWF  57
1D89:  MOVLP  08
1D8A:  MOVLB  00
1D8B:  CALL   767
1D8C:  MOVLP  18
1D8D:  MOVF   78,W
1D8E:  ANDLW  01
1D8F:  SUBLW  01
1D90:  BTFSS  03.2
1D91:  GOTO   5B1
....................       if(timeout_counter > 10)
1D92:  MOVLB  0B
1D93:  MOVF   41,W
1D94:  SUBLW  0A
1D95:  BTFSC  03.0
1D96:  GOTO   5A0
....................          delay_ms(200);
1D97:  MOVLW  C8
1D98:  MOVLB  0F
1D99:  MOVWF  57
1D9A:  MOVLP  08
1D9B:  MOVLB  00
1D9C:  CALL   7AD
1D9D:  MOVLP  18
1D9E:  GOTO   5A7
1D9F:  MOVLB  0B
....................       else
....................          delay_ms(10);   
1DA0:  MOVLW  0A
1DA1:  MOVLB  0F
1DA2:  MOVWF  57
1DA3:  MOVLP  08
1DA4:  MOVLB  00
1DA5:  CALL   7AD
1DA6:  MOVLP  18
....................       
....................       if(timeout_counter > 100){
1DA7:  MOVLB  0B
1DA8:  MOVF   41,W
1DA9:  SUBLW  64
1DAA:  BTFSC  03.0
1DAB:  GOTO   5AF
....................          #ifdef MT25Q_DEBUG
....................             fprintf(PC,"flash timeout\r\n");
....................          #endif
....................          break;
1DAC:  MOVLB  00
1DAD:  GOTO   5B1
1DAE:  MOVLB  0B
....................       }  
....................       timeout_counter++;
1DAF:  INCF   41,F
1DB0:  GOTO   57A
1DB1:  MOVLB  00
....................    }
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"flash sector erase complete\r\n");
....................    #endif
....................    return;
1DB2:  RETURN
.................... }
.................... #Separate 
.................... void subsector_32kByte_erase(Flash flash_stream, unsigned int32 subsector_address){
....................    if(flash_stream.flash_model == MT25QL128ABA){
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[4];
....................       
....................       flash_cmd[0] = CMD_SUBSECTOR_32KB_ERASE;
....................       flash_cmd[1] = (unsigned int8)((subsector_address>>16) & 0xff);   // 0x 00 _ _ 00 00
....................       flash_cmd[2] = (unsigned int8)((subsector_address>>8) & 0xff);    // 0x 00 00 _ _ 00
....................       flash_cmd[3] = (unsigned int8)((subsector_address) & 0xff);       // 0x 00 00 00 _ _
....................             
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
....................       output_high(flash_stream.cs_pin);
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 4);
....................       //////////////////////////////////////////////////////////////////
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
....................    }
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[5];
....................       
....................       flash_cmd[0] = CMD_4BYTE_SUBSECTOR_32KB_ERASE;
....................       flash_cmd[1] = (unsigned int8)((subsector_address>>24) & 0xff);   // 0x _ _ 00 00 00
....................       flash_cmd[2] = (unsigned int8)((subsector_address>>16) & 0xff);   // 0x 00 _ _ 00 00
....................       flash_cmd[3] = (unsigned int8)((subsector_address>>8) & 0xff);    // 0x 00 00 _ _ 00
....................       flash_cmd[4] = (unsigned int8)((subsector_address) & 0xff);       // 0x 00 00 00 _ _
....................       
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
....................       output_high(flash_stream.cs_pin);
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 5);
....................       //////////////////////////////////////////////////////////////////
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
....................    }
....................    
....................    else{
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"error:flash model is invalid\r\n");
....................       #endif
....................    }
....................    
....................    //wait process finished
....................    unsigned int8 timeout_counter = 0;
....................    while((status_register(flash_stream) & 0x01) == 1){                  //masking status bit
....................       if(timeout_counter > 10)
....................          delay_ms(200);
....................       else
....................          delay_ms(10);   
....................       
....................       if(timeout_counter > 100){
....................          #ifdef MT25Q_DEBUG
....................             fprintf(PC,"flash timeout\r\n");
....................          #endif
....................          break;
....................       }  
....................       timeout_counter++;
....................    }
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"flash 32kByte subsector erase complete\r\n");
....................    #endif
....................    return;
.................... }
.................... #Separate 
.................... void subsector_4kByte_erase(Flash flash_stream, unsigned int32 subsector_address){
....................    if(flash_stream.flash_model == MT25QL128ABA){
*
123B:  MOVLB  0F
123C:  MOVF   3F,F
123D:  BTFSS  03.2
123E:  GOTO   2D6
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[4];
123F:  MOVLW  06
1240:  MOVWF  46
....................       
....................       flash_cmd[0] = CMD_SUBSECTOR_4KB_ERASE;
1241:  MOVLW  20
1242:  MOVWF  47
....................       flash_cmd[1] = (unsigned int8)((subsector_address>>16) & 0xff);   // 0x 00 _ _ 00 00
1243:  CLRF   55
1244:  CLRF   56
1245:  CLRF   78
1246:  CLRF   79
1247:  CLRF   7A
1248:  MOVF   44,W
1249:  MOVWF  48
....................       flash_cmd[2] = (unsigned int8)((subsector_address>>8) & 0xff);    // 0x 00 00 _ _ 00
124A:  CLRF   56
124B:  CLRF   78
124C:  CLRF   79
124D:  CLRF   7A
124E:  MOVF   43,W
124F:  MOVWF  49
....................       flash_cmd[3] = (unsigned int8)((subsector_address) & 0xff);       // 0x 00 00 00 _ _
1250:  CLRF   78
1251:  CLRF   79
1252:  CLRF   7A
1253:  MOVF   42,W
1254:  MOVWF  4A
....................             
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
1255:  MOVF   40,W
1256:  MOVWF  5D
1257:  CLRF   5E
1258:  MOVLW  01
1259:  MOVWF  60
125A:  CLRF   5F
125B:  MOVLP  08
125C:  MOVLB  00
125D:  CALL   1A9
125E:  MOVLP  10
125F:  MOVLB  0F
1260:  MOVF   40,W
1261:  MOVWF  5D
1262:  CLRF   5E
1263:  CLRF   60
1264:  MOVLW  80
1265:  MOVWF  5F
1266:  MOVLP  08
1267:  MOVLB  00
1268:  CALL   1A9
1269:  MOVLP  10
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
126A:  MOVLB  0F
126B:  MOVF   41,W
126C:  MOVWF  5A
126D:  MOVF   40,W
126E:  MOVWF  59
126F:  MOVF   3F,W
1270:  MOVWF  58
1271:  MOVF   3E,W
1272:  MOVWF  57
1273:  MOVLW  24
1274:  MOVWF  5C
1275:  MOVLW  D6
1276:  MOVWF  5B
1277:  CLRF   5E
1278:  MOVLW  01
1279:  MOVWF  5D
127A:  MOVLP  08
127B:  MOVLB  00
127C:  CALL   707
127D:  MOVLP  10
....................       output_high(flash_stream.cs_pin);
127E:  MOVLB  0F
127F:  MOVF   40,W
1280:  MOVWF  5D
1281:  MOVLW  01
1282:  MOVWF  5E
1283:  MOVWF  60
1284:  CLRF   5F
1285:  MOVLP  08
1286:  MOVLB  00
1287:  CALL   1A9
1288:  MOVLP  10
1289:  MOVLB  0F
128A:  MOVF   40,W
128B:  MOVWF  5D
128C:  CLRF   5E
128D:  CLRF   60
128E:  MOVLW  80
128F:  MOVWF  5F
1290:  MOVLP  08
1291:  MOVLB  00
1292:  CALL   1A9
1293:  MOVLP  10
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
1294:  MOVLB  0F
1295:  MOVF   40,W
1296:  MOVWF  5D
1297:  CLRF   5E
1298:  MOVLW  01
1299:  MOVWF  60
129A:  CLRF   5F
129B:  MOVLP  08
129C:  MOVLB  00
129D:  CALL   1A9
129E:  MOVLP  10
129F:  MOVLB  0F
12A0:  MOVF   40,W
12A1:  MOVWF  5D
12A2:  CLRF   5E
12A3:  CLRF   60
12A4:  MOVLW  80
12A5:  MOVWF  5F
12A6:  MOVLP  08
12A7:  MOVLB  00
12A8:  CALL   1A9
12A9:  MOVLP  10
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 4);
12AA:  MOVLB  0F
12AB:  MOVF   41,W
12AC:  MOVWF  5A
12AD:  MOVF   40,W
12AE:  MOVWF  59
12AF:  MOVF   3F,W
12B0:  MOVWF  58
12B1:  MOVF   3E,W
12B2:  MOVWF  57
12B3:  MOVLW  24
12B4:  MOVWF  5C
12B5:  MOVLW  D7
12B6:  MOVWF  5B
12B7:  CLRF   5E
12B8:  MOVLW  04
12B9:  MOVWF  5D
12BA:  MOVLP  08
12BB:  MOVLB  00
12BC:  CALL   707
12BD:  MOVLP  10
....................       //////////////////////////////////////////////////////////////////
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
12BE:  MOVLB  0F
12BF:  MOVF   40,W
12C0:  MOVWF  5D
12C1:  MOVLW  01
12C2:  MOVWF  5E
12C3:  MOVWF  60
12C4:  CLRF   5F
12C5:  MOVLP  08
12C6:  MOVLB  00
12C7:  CALL   1A9
12C8:  MOVLP  10
12C9:  MOVLB  0F
12CA:  MOVF   40,W
12CB:  MOVWF  5D
12CC:  CLRF   5E
12CD:  CLRF   60
12CE:  MOVLW  80
12CF:  MOVWF  5F
12D0:  MOVLP  08
12D1:  MOVLB  00
12D2:  CALL   1A9
12D3:  MOVLP  10
....................    }
12D4:  GOTO   375
12D5:  MOVLB  0F
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
12D6:  DECFSZ 3F,W
12D7:  GOTO   376
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[5];
12D8:  MOVLW  06
12D9:  MOVWF  4B
....................       
....................       flash_cmd[0] = CMD_4BYTE_SUBSECTOR_4KB_ERASE;
12DA:  MOVLW  21
12DB:  MOVWF  4C
....................       flash_cmd[1] = (unsigned int8)((subsector_address>>24) & 0xff);   // 0x _ _ 00 00 00
12DC:  CLRF   54
12DD:  CLRF   55
12DE:  CLRF   56
12DF:  CLRF   78
12E0:  CLRF   79
12E1:  CLRF   7A
12E2:  MOVF   45,W
12E3:  MOVWF  4D
....................       flash_cmd[2] = (unsigned int8)((subsector_address>>16) & 0xff);   // 0x 00 _ _ 00 00
12E4:  CLRF   55
12E5:  CLRF   56
12E6:  CLRF   78
12E7:  CLRF   79
12E8:  CLRF   7A
12E9:  MOVF   44,W
12EA:  MOVWF  4E
....................       flash_cmd[3] = (unsigned int8)((subsector_address>>8) & 0xff);    // 0x 00 00 _ _ 00
12EB:  CLRF   56
12EC:  CLRF   78
12ED:  CLRF   79
12EE:  CLRF   7A
12EF:  MOVF   43,W
12F0:  MOVWF  4F
....................       flash_cmd[4] = (unsigned int8)((subsector_address) & 0xff);       // 0x 00 00 00 _ _
12F1:  CLRF   78
12F2:  CLRF   79
12F3:  CLRF   7A
12F4:  MOVF   42,W
12F5:  MOVWF  50
....................       
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
12F6:  MOVF   40,W
12F7:  MOVWF  5D
12F8:  CLRF   5E
12F9:  MOVLW  01
12FA:  MOVWF  60
12FB:  CLRF   5F
12FC:  MOVLP  08
12FD:  MOVLB  00
12FE:  CALL   1A9
12FF:  MOVLP  10
1300:  MOVLB  0F
1301:  MOVF   40,W
1302:  MOVWF  5D
1303:  CLRF   5E
1304:  CLRF   60
1305:  MOVLW  80
1306:  MOVWF  5F
1307:  MOVLP  08
1308:  MOVLB  00
1309:  CALL   1A9
130A:  MOVLP  10
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
130B:  MOVLB  0F
130C:  MOVF   41,W
130D:  MOVWF  5A
130E:  MOVF   40,W
130F:  MOVWF  59
1310:  MOVF   3F,W
1311:  MOVWF  58
1312:  MOVF   3E,W
1313:  MOVWF  57
1314:  MOVLW  24
1315:  MOVWF  5C
1316:  MOVLW  DB
1317:  MOVWF  5B
1318:  CLRF   5E
1319:  MOVLW  01
131A:  MOVWF  5D
131B:  MOVLP  08
131C:  MOVLB  00
131D:  CALL   707
131E:  MOVLP  10
....................       output_high(flash_stream.cs_pin);
131F:  MOVLB  0F
1320:  MOVF   40,W
1321:  MOVWF  5D
1322:  MOVLW  01
1323:  MOVWF  5E
1324:  MOVWF  60
1325:  CLRF   5F
1326:  MOVLP  08
1327:  MOVLB  00
1328:  CALL   1A9
1329:  MOVLP  10
132A:  MOVLB  0F
132B:  MOVF   40,W
132C:  MOVWF  5D
132D:  CLRF   5E
132E:  CLRF   60
132F:  MOVLW  80
1330:  MOVWF  5F
1331:  MOVLP  08
1332:  MOVLB  00
1333:  CALL   1A9
1334:  MOVLP  10
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
1335:  MOVLB  0F
1336:  MOVF   40,W
1337:  MOVWF  5D
1338:  CLRF   5E
1339:  MOVLW  01
133A:  MOVWF  60
133B:  CLRF   5F
133C:  MOVLP  08
133D:  MOVLB  00
133E:  CALL   1A9
133F:  MOVLP  10
1340:  MOVLB  0F
1341:  MOVF   40,W
1342:  MOVWF  5D
1343:  CLRF   5E
1344:  CLRF   60
1345:  MOVLW  80
1346:  MOVWF  5F
1347:  MOVLP  08
1348:  MOVLB  00
1349:  CALL   1A9
134A:  MOVLP  10
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 5);
134B:  MOVLB  0F
134C:  MOVF   41,W
134D:  MOVWF  5A
134E:  MOVF   40,W
134F:  MOVWF  59
1350:  MOVF   3F,W
1351:  MOVWF  58
1352:  MOVF   3E,W
1353:  MOVWF  57
1354:  MOVLW  24
1355:  MOVWF  5C
1356:  MOVLW  DC
1357:  MOVWF  5B
1358:  CLRF   5E
1359:  MOVLW  05
135A:  MOVWF  5D
135B:  MOVLP  08
135C:  MOVLB  00
135D:  CALL   707
135E:  MOVLP  10
....................       //////////////////////////////////////////////////////////////////
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
135F:  MOVLB  0F
1360:  MOVF   40,W
1361:  MOVWF  5D
1362:  MOVLW  01
1363:  MOVWF  5E
1364:  MOVWF  60
1365:  CLRF   5F
1366:  MOVLP  08
1367:  MOVLB  00
1368:  CALL   1A9
1369:  MOVLP  10
136A:  MOVLB  0F
136B:  MOVF   40,W
136C:  MOVWF  5D
136D:  CLRF   5E
136E:  CLRF   60
136F:  MOVLW  80
1370:  MOVWF  5F
1371:  MOVLP  08
1372:  MOVLB  00
1373:  CALL   1A9
1374:  MOVLP  10
....................    }
1375:  MOVLB  0F
....................    
....................    else{
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"error:flash model is invalid\r\n");
....................       #endif
....................    }
....................    
....................    //wait process finished
....................    unsigned int8 timeout_counter = 0;
1376:  CLRF   51
....................    while((status_register(flash_stream) & 0x01) == 1){                           //masking status bit
1377:  MOVF   41,W
1378:  MOVWF  5A
1379:  MOVF   40,W
137A:  MOVWF  59
137B:  MOVF   3F,W
137C:  MOVWF  58
137D:  MOVF   3E,W
137E:  MOVWF  57
137F:  MOVLP  08
1380:  MOVLB  00
1381:  CALL   767
1382:  MOVLP  10
1383:  MOVF   78,W
1384:  ANDLW  01
1385:  SUBLW  01
1386:  BTFSS  03.2
1387:  GOTO   3A5
....................       if(timeout_counter > 10)
1388:  MOVLB  0F
1389:  MOVF   51,W
138A:  SUBLW  0A
138B:  BTFSC  03.0
138C:  GOTO   395
....................          delay_ms(200);
138D:  MOVLW  C8
138E:  MOVWF  57
138F:  MOVLP  08
1390:  MOVLB  00
1391:  CALL   7AD
1392:  MOVLP  10
1393:  GOTO   39B
1394:  MOVLB  0F
....................       else
....................          delay_ms(10);   
1395:  MOVLW  0A
1396:  MOVWF  57
1397:  MOVLP  08
1398:  MOVLB  00
1399:  CALL   7AD
139A:  MOVLP  10
....................       
....................       if(timeout_counter > 100){
139B:  MOVLB  0F
139C:  MOVF   51,W
139D:  SUBLW  64
139E:  BTFSC  03.0
139F:  GOTO   3A3
....................          #ifdef MT25Q_DEBUG
....................             fprintf(PC,"flash timeout\r\n");
....................          #endif
....................          break;
13A0:  MOVLB  00
13A1:  GOTO   3A5
13A2:  MOVLB  0F
....................       }  
....................       timeout_counter++;
13A3:  INCF   51,F
13A4:  GOTO   377
13A5:  MOVLB  00
....................    }
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"flash 4kByte subsector erase complete\r\n");
....................    #endif
....................    return;
13A6:  RETURN
.................... }
.................... #Separate 
.................... int8 read_data_byte(Flash flash_stream, unsigned int32 read_address){
....................    int8 read_data;
....................    if(flash_stream.flash_model == MT25QL128ABA){
*
3000:  MOVLB  0C
3001:  MOVF   5D,F
3002:  BTFSS  03.2
3003:  GOTO   086
....................       unsigned int8 flash_cmd[4];
....................       
....................       flash_cmd[0] = CMD_READ;
3004:  MOVLW  03
3005:  MOVWF  65
....................       flash_cmd[1] = (unsigned int8)((read_address>>16) & 0xff);   // 0x 00 _ _ 00 00
3006:  MOVF   62,W
3007:  MOVLB  0D
3008:  MOVWF  21
3009:  MOVLB  0C
300A:  MOVF   63,W
300B:  MOVLB  0D
300C:  MOVWF  22
300D:  CLRF   23
300E:  CLRF   24
300F:  CLRF   78
3010:  CLRF   79
3011:  CLRF   7A
3012:  MOVF   21,W
3013:  MOVLB  0C
3014:  MOVWF  66
....................       flash_cmd[2] = (unsigned int8)((read_address>>8) & 0xff);    // 0x 00 00 _ _ 00
3015:  MOVF   61,W
3016:  MOVLB  0D
3017:  MOVWF  21
3018:  MOVLB  0C
3019:  MOVF   62,W
301A:  MOVLB  0D
301B:  MOVWF  22
301C:  MOVLB  0C
301D:  MOVF   63,W
301E:  MOVLB  0D
301F:  MOVWF  23
3020:  CLRF   24
3021:  CLRF   78
3022:  CLRF   79
3023:  CLRF   7A
3024:  MOVF   21,W
3025:  MOVLB  0C
3026:  MOVWF  67
....................       flash_cmd[3] = (unsigned int8)((read_address) & 0xff);       // 0x 00 00 00 _ _
3027:  CLRF   78
3028:  CLRF   79
3029:  CLRF   7A
302A:  MOVF   60,W
302B:  MOVWF  68
....................             
....................       output_low(flash_stream.cs_pin);
302C:  MOVF   5E,W
302D:  MOVLB  0F
302E:  MOVWF  5D
302F:  CLRF   5E
3030:  MOVLW  01
3031:  MOVWF  60
3032:  CLRF   5F
3033:  MOVLP  08
3034:  MOVLB  00
3035:  CALL   1A9
3036:  MOVLP  30
3037:  MOVLB  0C
3038:  MOVF   5E,W
3039:  MOVLB  0F
303A:  MOVWF  5D
303B:  CLRF   5E
303C:  CLRF   60
303D:  MOVLW  80
303E:  MOVWF  5F
303F:  MOVLP  08
3040:  MOVLB  00
3041:  CALL   1A9
3042:  MOVLP  30
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_and_read_select_stream(flash_stream, flash_cmd, 4, &read_data, 1);
3043:  MOVLB  0C
3044:  MOVF   5F,W
3045:  MOVLB  0F
3046:  MOVWF  60
3047:  MOVLB  0C
3048:  MOVF   5E,W
3049:  MOVLB  0F
304A:  MOVWF  5F
304B:  MOVLB  0C
304C:  MOVF   5D,W
304D:  MOVLB  0F
304E:  MOVWF  5E
304F:  MOVLB  0C
3050:  MOVF   5C,W
3051:  MOVLB  0F
3052:  MOVWF  5D
3053:  MOVLW  24
3054:  MOVWF  62
3055:  MOVLW  05
3056:  MOVWF  61
3057:  CLRF   64
3058:  MOVLW  04
3059:  MOVWF  63
305A:  MOVLW  24
305B:  MOVWF  66
305C:  MOVLW  04
305D:  MOVWF  65
305E:  CLRF   6A
305F:  CLRF   69
3060:  CLRF   68
3061:  MOVLW  01
3062:  MOVWF  67
3063:  MOVLP  08
3064:  MOVLB  00
3065:  CALL   1E5
3066:  MOVLP  30
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
3067:  MOVLW  02
3068:  MOVWF  77
3069:  DECFSZ 77,F
306A:  GOTO   069
306B:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
306C:  MOVLB  0C
306D:  MOVF   5E,W
306E:  MOVLB  0F
306F:  MOVWF  5D
3070:  MOVLW  01
3071:  MOVWF  5E
3072:  MOVWF  60
3073:  CLRF   5F
3074:  MOVLP  08
3075:  MOVLB  00
3076:  CALL   1A9
3077:  MOVLP  30
3078:  MOVLB  0C
3079:  MOVF   5E,W
307A:  MOVLB  0F
307B:  MOVWF  5D
307C:  CLRF   5E
307D:  CLRF   60
307E:  MOVLW  80
307F:  MOVWF  5F
3080:  MOVLP  08
3081:  MOVLB  00
3082:  CALL   1A9
3083:  MOVLP  30
....................    }
3084:  GOTO   114
3085:  MOVLB  0C
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
3086:  DECFSZ 5D,W
3087:  GOTO   115
....................       unsigned int8 flash_cmd[5];
....................       
....................       flash_cmd[0] = CMD_4BYTE_READ;
3088:  MOVLW  13
3089:  MOVWF  69
....................       flash_cmd[1] = (unsigned int8)((read_address>>24) & 0xff);   // 0x _ _ 00 00 00
308A:  MOVF   63,W
308B:  MOVLB  0D
308C:  MOVWF  21
308D:  CLRF   22
308E:  CLRF   23
308F:  CLRF   24
3090:  CLRF   78
3091:  CLRF   79
3092:  CLRF   7A
3093:  MOVF   21,W
3094:  MOVLB  0C
3095:  MOVWF  6A
....................       flash_cmd[2] = (unsigned int8)((read_address>>16) & 0xff);   // 0x 00 _ _ 00 00
3096:  MOVF   62,W
3097:  MOVLB  0D
3098:  MOVWF  21
3099:  MOVLB  0C
309A:  MOVF   63,W
309B:  MOVLB  0D
309C:  MOVWF  22
309D:  CLRF   23
309E:  CLRF   24
309F:  CLRF   78
30A0:  CLRF   79
30A1:  CLRF   7A
30A2:  MOVF   21,W
30A3:  MOVLB  0C
30A4:  MOVWF  6B
....................       flash_cmd[3] = (unsigned int8)((read_address>>8) & 0xff);    // 0x 00 00 _ _ 00
30A5:  MOVF   61,W
30A6:  MOVLB  0D
30A7:  MOVWF  21
30A8:  MOVLB  0C
30A9:  MOVF   62,W
30AA:  MOVLB  0D
30AB:  MOVWF  22
30AC:  MOVLB  0C
30AD:  MOVF   63,W
30AE:  MOVLB  0D
30AF:  MOVWF  23
30B0:  CLRF   24
30B1:  CLRF   78
30B2:  CLRF   79
30B3:  CLRF   7A
30B4:  MOVF   21,W
30B5:  MOVLB  0C
30B6:  MOVWF  6C
....................       flash_cmd[4] = (unsigned int8)((read_address) & 0xff);       // 0x 00 00 00 _ _
30B7:  CLRF   78
30B8:  CLRF   79
30B9:  CLRF   7A
30BA:  MOVF   60,W
30BB:  MOVWF  6D
....................    
....................       output_low(flash_stream.cs_pin);
30BC:  MOVF   5E,W
30BD:  MOVLB  0F
30BE:  MOVWF  5D
30BF:  CLRF   5E
30C0:  MOVLW  01
30C1:  MOVWF  60
30C2:  CLRF   5F
30C3:  MOVLP  08
30C4:  MOVLB  00
30C5:  CALL   1A9
30C6:  MOVLP  30
30C7:  MOVLB  0C
30C8:  MOVF   5E,W
30C9:  MOVLB  0F
30CA:  MOVWF  5D
30CB:  CLRF   5E
30CC:  CLRF   60
30CD:  MOVLW  80
30CE:  MOVWF  5F
30CF:  MOVLP  08
30D0:  MOVLB  00
30D1:  CALL   1A9
30D2:  MOVLP  30
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_and_read_select_stream(flash_stream, flash_cmd, 5, &read_data, 1);
30D3:  MOVLB  0C
30D4:  MOVF   5F,W
30D5:  MOVLB  0F
30D6:  MOVWF  60
30D7:  MOVLB  0C
30D8:  MOVF   5E,W
30D9:  MOVLB  0F
30DA:  MOVWF  5F
30DB:  MOVLB  0C
30DC:  MOVF   5D,W
30DD:  MOVLB  0F
30DE:  MOVWF  5E
30DF:  MOVLB  0C
30E0:  MOVF   5C,W
30E1:  MOVLB  0F
30E2:  MOVWF  5D
30E3:  MOVLW  24
30E4:  MOVWF  62
30E5:  MOVLW  09
30E6:  MOVWF  61
30E7:  CLRF   64
30E8:  MOVLW  05
30E9:  MOVWF  63
30EA:  MOVLW  24
30EB:  MOVWF  66
30EC:  MOVLW  04
30ED:  MOVWF  65
30EE:  CLRF   6A
30EF:  CLRF   69
30F0:  CLRF   68
30F1:  MOVLW  01
30F2:  MOVWF  67
30F3:  MOVLP  08
30F4:  MOVLB  00
30F5:  CALL   1E5
30F6:  MOVLP  30
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
30F7:  MOVLW  02
30F8:  MOVWF  77
30F9:  DECFSZ 77,F
30FA:  GOTO   0F9
30FB:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
30FC:  MOVLB  0C
30FD:  MOVF   5E,W
30FE:  MOVLB  0F
30FF:  MOVWF  5D
3100:  MOVLW  01
3101:  MOVWF  5E
3102:  MOVWF  60
3103:  CLRF   5F
3104:  MOVLP  08
3105:  MOVLB  00
3106:  CALL   1A9
3107:  MOVLP  30
3108:  MOVLB  0C
3109:  MOVF   5E,W
310A:  MOVLB  0F
310B:  MOVWF  5D
310C:  CLRF   5E
310D:  CLRF   60
310E:  MOVLW  80
310F:  MOVWF  5F
3110:  MOVLP  08
3111:  MOVLB  00
3112:  CALL   1A9
3113:  MOVLP  30
3114:  MOVLB  0C
....................    }
....................    return read_data;
3115:  MOVF   64,W
3116:  MOVWF  78
3117:  MOVLP  30
3118:  MOVLB  00
3119:  GOTO   3CF (RETURN)
.................... }
.................... #Separate 
.................... void read_data_bytes(Flash flash_stream, unsigned int32 read_start_address, int8 *read_data, unsigned int32 read_amount)
.................... {
....................    if(flash_stream.flash_model == MT25QL128ABA){
*
0B21:  MOVLB  0E
0B22:  MOVF   40,F
0B23:  BTFSS  03.2
0B24:  GOTO   398
....................       unsigned int8 flash_cmd[4];
....................       
....................       flash_cmd[0] = CMD_READ;
0B25:  MOVLW  03
0B26:  MOVWF  4D
....................       flash_cmd[1] = (unsigned int8)((read_start_address>>16) & 0xff);   // 0x 00 _ _ 00 00
0B27:  CLRF   5A
0B28:  CLRF   5B
0B29:  CLRF   78
0B2A:  CLRF   79
0B2B:  CLRF   7A
0B2C:  MOVF   45,W
0B2D:  MOVWF  4E
....................       flash_cmd[2] = (unsigned int8)((read_start_address>>8) & 0xff);    // 0x 00 00 _ _ 00
0B2E:  CLRF   5B
0B2F:  CLRF   78
0B30:  CLRF   79
0B31:  CLRF   7A
0B32:  MOVF   44,W
0B33:  MOVWF  4F
....................       flash_cmd[3] = (unsigned int8)((read_start_address) & 0xff);       // 0x 00 00 00 _ _
0B34:  CLRF   78
0B35:  CLRF   79
0B36:  CLRF   7A
0B37:  MOVF   43,W
0B38:  MOVWF  50
....................             
....................       output_low(flash_stream.cs_pin);
0B39:  MOVF   41,W
0B3A:  MOVLB  0F
0B3B:  MOVWF  5D
0B3C:  CLRF   5E
0B3D:  MOVLW  01
0B3E:  MOVWF  60
0B3F:  CLRF   5F
0B40:  MOVLB  00
0B41:  CALL   1A9
0B42:  MOVLB  0E
0B43:  MOVF   41,W
0B44:  MOVLB  0F
0B45:  MOVWF  5D
0B46:  CLRF   5E
0B47:  CLRF   60
0B48:  MOVLW  80
0B49:  MOVWF  5F
0B4A:  MOVLB  00
0B4B:  CALL   1A9
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_and_read_select_stream(flash_stream, flash_cmd, 4, read_data, read_amount);
0B4C:  MOVLB  0E
0B4D:  MOVF   42,W
0B4E:  MOVLB  0F
0B4F:  MOVWF  60
0B50:  MOVLB  0E
0B51:  MOVF   41,W
0B52:  MOVLB  0F
0B53:  MOVWF  5F
0B54:  MOVLB  0E
0B55:  MOVF   40,W
0B56:  MOVLB  0F
0B57:  MOVWF  5E
0B58:  MOVLB  0E
0B59:  MOVF   3F,W
0B5A:  MOVLB  0F
0B5B:  MOVWF  5D
0B5C:  MOVLW  24
0B5D:  MOVWF  62
0B5E:  MOVLW  8D
0B5F:  MOVWF  61
0B60:  CLRF   64
0B61:  MOVLW  04
0B62:  MOVWF  63
0B63:  MOVLB  0E
0B64:  MOVF   48,W
0B65:  MOVLB  0F
0B66:  MOVWF  66
0B67:  MOVLB  0E
0B68:  MOVF   47,W
0B69:  MOVLB  0F
0B6A:  MOVWF  65
0B6B:  MOVLB  0E
0B6C:  MOVF   4C,W
0B6D:  MOVLB  0F
0B6E:  MOVWF  6A
0B6F:  MOVLB  0E
0B70:  MOVF   4B,W
0B71:  MOVLB  0F
0B72:  MOVWF  69
0B73:  MOVLB  0E
0B74:  MOVF   4A,W
0B75:  MOVLB  0F
0B76:  MOVWF  68
0B77:  MOVLB  0E
0B78:  MOVF   49,W
0B79:  MOVLB  0F
0B7A:  MOVWF  67
0B7B:  MOVLB  00
0B7C:  CALL   1E5
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
0B7D:  MOVLW  02
0B7E:  MOVWF  77
0B7F:  DECFSZ 77,F
0B80:  GOTO   37F
0B81:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
0B82:  MOVLB  0E
0B83:  MOVF   41,W
0B84:  MOVLB  0F
0B85:  MOVWF  5D
0B86:  MOVLW  01
0B87:  MOVWF  5E
0B88:  MOVWF  60
0B89:  CLRF   5F
0B8A:  MOVLB  00
0B8B:  CALL   1A9
0B8C:  MOVLB  0E
0B8D:  MOVF   41,W
0B8E:  MOVLB  0F
0B8F:  MOVWF  5D
0B90:  CLRF   5E
0B91:  CLRF   60
0B92:  MOVLW  80
0B93:  MOVWF  5F
0B94:  MOVLB  00
0B95:  CALL   1A9
....................    }
0B96:  GOTO   413
0B97:  MOVLB  0E
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
0B98:  DECFSZ 40,W
0B99:  GOTO   414
....................       unsigned int8 flash_cmd[5];
....................       
....................       flash_cmd[0] = CMD_4BYTE_READ;
0B9A:  MOVLW  13
0B9B:  MOVWF  51
....................       flash_cmd[1] = (unsigned int8)((read_start_address>>24) & 0xff);   // 0x _ _ 00 00 00
0B9C:  CLRF   59
0B9D:  CLRF   5A
0B9E:  CLRF   5B
0B9F:  CLRF   78
0BA0:  CLRF   79
0BA1:  CLRF   7A
0BA2:  MOVF   46,W
0BA3:  MOVWF  52
....................       flash_cmd[2] = (unsigned int8)((read_start_address>>16) & 0xff);   // 0x 00 _ _ 00 00
0BA4:  CLRF   5A
0BA5:  CLRF   5B
0BA6:  CLRF   78
0BA7:  CLRF   79
0BA8:  CLRF   7A
0BA9:  MOVF   45,W
0BAA:  MOVWF  53
....................       flash_cmd[3] = (unsigned int8)((read_start_address>>8) & 0xff);    // 0x 00 00 _ _ 00
0BAB:  CLRF   5B
0BAC:  CLRF   78
0BAD:  CLRF   79
0BAE:  CLRF   7A
0BAF:  MOVF   44,W
0BB0:  MOVWF  54
....................       flash_cmd[4] = (unsigned int8)((read_start_address) & 0xff);       // 0x 00 00 00 _ _
0BB1:  CLRF   78
0BB2:  CLRF   79
0BB3:  CLRF   7A
0BB4:  MOVF   43,W
0BB5:  MOVWF  55
....................    
....................       output_low(flash_stream.cs_pin);
0BB6:  MOVF   41,W
0BB7:  MOVLB  0F
0BB8:  MOVWF  5D
0BB9:  CLRF   5E
0BBA:  MOVLW  01
0BBB:  MOVWF  60
0BBC:  CLRF   5F
0BBD:  MOVLB  00
0BBE:  CALL   1A9
0BBF:  MOVLB  0E
0BC0:  MOVF   41,W
0BC1:  MOVLB  0F
0BC2:  MOVWF  5D
0BC3:  CLRF   5E
0BC4:  CLRF   60
0BC5:  MOVLW  80
0BC6:  MOVWF  5F
0BC7:  MOVLB  00
0BC8:  CALL   1A9
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_and_read_select_stream(flash_stream, flash_cmd, 5, read_data, read_amount);
0BC9:  MOVLB  0E
0BCA:  MOVF   42,W
0BCB:  MOVLB  0F
0BCC:  MOVWF  60
0BCD:  MOVLB  0E
0BCE:  MOVF   41,W
0BCF:  MOVLB  0F
0BD0:  MOVWF  5F
0BD1:  MOVLB  0E
0BD2:  MOVF   40,W
0BD3:  MOVLB  0F
0BD4:  MOVWF  5E
0BD5:  MOVLB  0E
0BD6:  MOVF   3F,W
0BD7:  MOVLB  0F
0BD8:  MOVWF  5D
0BD9:  MOVLW  24
0BDA:  MOVWF  62
0BDB:  MOVLW  91
0BDC:  MOVWF  61
0BDD:  CLRF   64
0BDE:  MOVLW  05
0BDF:  MOVWF  63
0BE0:  MOVLB  0E
0BE1:  MOVF   48,W
0BE2:  MOVLB  0F
0BE3:  MOVWF  66
0BE4:  MOVLB  0E
0BE5:  MOVF   47,W
0BE6:  MOVLB  0F
0BE7:  MOVWF  65
0BE8:  MOVLB  0E
0BE9:  MOVF   4C,W
0BEA:  MOVLB  0F
0BEB:  MOVWF  6A
0BEC:  MOVLB  0E
0BED:  MOVF   4B,W
0BEE:  MOVLB  0F
0BEF:  MOVWF  69
0BF0:  MOVLB  0E
0BF1:  MOVF   4A,W
0BF2:  MOVLB  0F
0BF3:  MOVWF  68
0BF4:  MOVLB  0E
0BF5:  MOVF   49,W
0BF6:  MOVLB  0F
0BF7:  MOVWF  67
0BF8:  MOVLB  00
0BF9:  CALL   1E5
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
0BFA:  MOVLW  02
0BFB:  MOVWF  77
0BFC:  DECFSZ 77,F
0BFD:  GOTO   3FC
0BFE:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
0BFF:  MOVLB  0E
0C00:  MOVF   41,W
0C01:  MOVLB  0F
0C02:  MOVWF  5D
0C03:  MOVLW  01
0C04:  MOVWF  5E
0C05:  MOVWF  60
0C06:  CLRF   5F
0C07:  MOVLB  00
0C08:  CALL   1A9
0C09:  MOVLB  0E
0C0A:  MOVF   41,W
0C0B:  MOVLB  0F
0C0C:  MOVWF  5D
0C0D:  CLRF   5E
0C0E:  CLRF   60
0C0F:  MOVLW  80
0C10:  MOVWF  5F
0C11:  MOVLB  00
0C12:  CALL   1A9
0C13:  MOVLB  0E
....................    }
....................    return;
0C14:  MOVLB  00
0C15:  RETURN
.................... }
.................... #Separate 
.................... void write_data_byte(Flash flash_stream, unsigned int32 write_address,int8 write_data)
.................... {
....................    if(flash_stream.flash_model == MT25QL128ABA){
*
3800:  MOVLB  0C
3801:  MOVF   56,F
3802:  BTFSS  03.2
3803:  GOTO   0CC
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[5];
3804:  MOVLW  06
3805:  MOVWF  5E
....................       
....................       flash_cmd[0] = CMD_PAGE_PROGRAM;
3806:  MOVLW  02
3807:  MOVWF  5F
....................       flash_cmd[1] = (unsigned int8)((write_address>>16) & 0xff);   // 0x 00 _ _ 00 00
3808:  MOVF   5B,W
3809:  MOVLB  0D
380A:  MOVWF  21
380B:  MOVLB  0C
380C:  MOVF   5C,W
380D:  MOVLB  0D
380E:  MOVWF  22
380F:  CLRF   23
3810:  CLRF   24
3811:  CLRF   78
3812:  CLRF   79
3813:  CLRF   7A
3814:  MOVF   21,W
3815:  MOVLB  0C
3816:  MOVWF  60
....................       flash_cmd[2] = (unsigned int8)((write_address>>8) & 0xff);    // 0x 00 00 _ _ 00
3817:  MOVF   5A,W
3818:  MOVLB  0D
3819:  MOVWF  21
381A:  MOVLB  0C
381B:  MOVF   5B,W
381C:  MOVLB  0D
381D:  MOVWF  22
381E:  MOVLB  0C
381F:  MOVF   5C,W
3820:  MOVLB  0D
3821:  MOVWF  23
3822:  CLRF   24
3823:  CLRF   78
3824:  CLRF   79
3825:  CLRF   7A
3826:  MOVF   21,W
3827:  MOVLB  0C
3828:  MOVWF  61
....................       flash_cmd[3] = (unsigned int8)((write_address) & 0xff);       // 0x 00 00 00 _ _
3829:  CLRF   78
382A:  CLRF   79
382B:  CLRF   7A
382C:  MOVF   59,W
382D:  MOVWF  62
....................       flash_cmd[4] = write_data;
382E:  MOVF   5D,W
382F:  MOVWF  63
.................... 
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
3830:  MOVF   57,W
3831:  MOVLB  0F
3832:  MOVWF  5D
3833:  CLRF   5E
3834:  MOVLW  01
3835:  MOVWF  60
3836:  CLRF   5F
3837:  MOVLP  08
3838:  MOVLB  00
3839:  CALL   1A9
383A:  MOVLP  38
383B:  MOVLB  0C
383C:  MOVF   57,W
383D:  MOVLB  0F
383E:  MOVWF  5D
383F:  CLRF   5E
3840:  CLRF   60
3841:  MOVLW  80
3842:  MOVWF  5F
3843:  MOVLP  08
3844:  MOVLB  00
3845:  CALL   1A9
3846:  MOVLP  38
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
3847:  MOVLB  0C
3848:  MOVF   58,W
3849:  MOVLB  0F
384A:  MOVWF  5A
384B:  MOVLB  0C
384C:  MOVF   57,W
384D:  MOVLB  0F
384E:  MOVWF  59
384F:  MOVLB  0C
3850:  MOVF   56,W
3851:  MOVLB  0F
3852:  MOVWF  58
3853:  MOVLB  0C
3854:  MOVF   55,W
3855:  MOVLB  0F
3856:  MOVWF  57
3857:  MOVLW  23
3858:  MOVWF  5C
3859:  MOVLW  FE
385A:  MOVWF  5B
385B:  CLRF   5E
385C:  MOVLW  01
385D:  MOVWF  5D
385E:  MOVLP  08
385F:  MOVLB  00
3860:  CALL   707
3861:  MOVLP  38
....................       output_high(flash_stream.cs_pin);
3862:  MOVLB  0C
3863:  MOVF   57,W
3864:  MOVLB  0F
3865:  MOVWF  5D
3866:  MOVLW  01
3867:  MOVWF  5E
3868:  MOVWF  60
3869:  CLRF   5F
386A:  MOVLP  08
386B:  MOVLB  00
386C:  CALL   1A9
386D:  MOVLP  38
386E:  MOVLB  0C
386F:  MOVF   57,W
3870:  MOVLB  0F
3871:  MOVWF  5D
3872:  CLRF   5E
3873:  CLRF   60
3874:  MOVLW  80
3875:  MOVWF  5F
3876:  MOVLP  08
3877:  MOVLB  00
3878:  CALL   1A9
3879:  MOVLP  38
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
387A:  MOVLB  0C
387B:  MOVF   57,W
387C:  MOVLB  0F
387D:  MOVWF  5D
387E:  CLRF   5E
387F:  MOVLW  01
3880:  MOVWF  60
3881:  CLRF   5F
3882:  MOVLP  08
3883:  MOVLB  00
3884:  CALL   1A9
3885:  MOVLP  38
3886:  MOVLB  0C
3887:  MOVF   57,W
3888:  MOVLB  0F
3889:  MOVWF  5D
388A:  CLRF   5E
388B:  CLRF   60
388C:  MOVLW  80
388D:  MOVWF  5F
388E:  MOVLP  08
388F:  MOVLB  00
3890:  CALL   1A9
3891:  MOVLP  38
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 5);
3892:  MOVLB  0C
3893:  MOVF   58,W
3894:  MOVLB  0F
3895:  MOVWF  5A
3896:  MOVLB  0C
3897:  MOVF   57,W
3898:  MOVLB  0F
3899:  MOVWF  59
389A:  MOVLB  0C
389B:  MOVF   56,W
389C:  MOVLB  0F
389D:  MOVWF  58
389E:  MOVLB  0C
389F:  MOVF   55,W
38A0:  MOVLB  0F
38A1:  MOVWF  57
38A2:  MOVLW  23
38A3:  MOVWF  5C
38A4:  MOVLW  FF
38A5:  MOVWF  5B
38A6:  CLRF   5E
38A7:  MOVLW  05
38A8:  MOVWF  5D
38A9:  MOVLP  08
38AA:  MOVLB  00
38AB:  CALL   707
38AC:  MOVLP  38
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
38AD:  MOVLW  02
38AE:  MOVWF  77
38AF:  DECFSZ 77,F
38B0:  GOTO   0AF
38B1:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
38B2:  MOVLB  0C
38B3:  MOVF   57,W
38B4:  MOVLB  0F
38B5:  MOVWF  5D
38B6:  MOVLW  01
38B7:  MOVWF  5E
38B8:  MOVWF  60
38B9:  CLRF   5F
38BA:  MOVLP  08
38BB:  MOVLB  00
38BC:  CALL   1A9
38BD:  MOVLP  38
38BE:  MOVLB  0C
38BF:  MOVF   57,W
38C0:  MOVLB  0F
38C1:  MOVWF  5D
38C2:  CLRF   5E
38C3:  CLRF   60
38C4:  MOVLW  80
38C5:  MOVWF  5F
38C6:  MOVLP  08
38C7:  MOVLB  00
38C8:  CALL   1A9
38C9:  MOVLP  38
....................    }
38CA:  GOTO   1A0
38CB:  MOVLB  0C
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
38CC:  DECFSZ 56,W
38CD:  GOTO   1A1
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[6];
38CE:  MOVLW  06
38CF:  MOVWF  64
....................       
....................       flash_cmd[0] = CMD_4BYTE_PAGE_PROGRAM;
38D0:  MOVLW  12
38D1:  MOVWF  65
....................       flash_cmd[1] = (unsigned int8)((write_address>>24) & 0xff);   // 0x _ _ 00 00 00
38D2:  MOVF   5C,W
38D3:  MOVLB  0D
38D4:  MOVWF  21
38D5:  CLRF   22
38D6:  CLRF   23
38D7:  CLRF   24
38D8:  CLRF   78
38D9:  CLRF   79
38DA:  CLRF   7A
38DB:  MOVF   21,W
38DC:  MOVLB  0C
38DD:  MOVWF  66
....................       flash_cmd[2] = (unsigned int8)((write_address>>16) & 0xff);   // 0x 00 _ _ 00 00
38DE:  MOVF   5B,W
38DF:  MOVLB  0D
38E0:  MOVWF  21
38E1:  MOVLB  0C
38E2:  MOVF   5C,W
38E3:  MOVLB  0D
38E4:  MOVWF  22
38E5:  CLRF   23
38E6:  CLRF   24
38E7:  CLRF   78
38E8:  CLRF   79
38E9:  CLRF   7A
38EA:  MOVF   21,W
38EB:  MOVLB  0C
38EC:  MOVWF  67
....................       flash_cmd[3] = (unsigned int8)((write_address>>8) & 0xff);    // 0x 00 00 _ _ 00
38ED:  MOVF   5A,W
38EE:  MOVLB  0D
38EF:  MOVWF  21
38F0:  MOVLB  0C
38F1:  MOVF   5B,W
38F2:  MOVLB  0D
38F3:  MOVWF  22
38F4:  MOVLB  0C
38F5:  MOVF   5C,W
38F6:  MOVLB  0D
38F7:  MOVWF  23
38F8:  CLRF   24
38F9:  CLRF   78
38FA:  CLRF   79
38FB:  CLRF   7A
38FC:  MOVF   21,W
38FD:  MOVLB  0C
38FE:  MOVWF  68
....................       flash_cmd[4] = (unsigned int8)((write_address) & 0xff);       // 0x 00 00 00 _ _
38FF:  CLRF   78
3900:  CLRF   79
3901:  CLRF   7A
3902:  MOVF   59,W
3903:  MOVWF  69
....................       flash_cmd[5] = write_data;
3904:  MOVF   5D,W
3905:  MOVWF  6A
....................    
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
3906:  MOVF   57,W
3907:  MOVLB  0F
3908:  MOVWF  5D
3909:  CLRF   5E
390A:  MOVLW  01
390B:  MOVWF  60
390C:  CLRF   5F
390D:  MOVLP  08
390E:  MOVLB  00
390F:  CALL   1A9
3910:  MOVLP  38
3911:  MOVLB  0C
3912:  MOVF   57,W
3913:  MOVLB  0F
3914:  MOVWF  5D
3915:  CLRF   5E
3916:  CLRF   60
3917:  MOVLW  80
3918:  MOVWF  5F
3919:  MOVLP  08
391A:  MOVLB  00
391B:  CALL   1A9
391C:  MOVLP  38
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
391D:  MOVLB  0C
391E:  MOVF   58,W
391F:  MOVLB  0F
3920:  MOVWF  5A
3921:  MOVLB  0C
3922:  MOVF   57,W
3923:  MOVLB  0F
3924:  MOVWF  59
3925:  MOVLB  0C
3926:  MOVF   56,W
3927:  MOVLB  0F
3928:  MOVWF  58
3929:  MOVLB  0C
392A:  MOVF   55,W
392B:  MOVLB  0F
392C:  MOVWF  57
392D:  MOVLW  24
392E:  MOVWF  5C
392F:  MOVLW  04
3930:  MOVWF  5B
3931:  CLRF   5E
3932:  MOVLW  01
3933:  MOVWF  5D
3934:  MOVLP  08
3935:  MOVLB  00
3936:  CALL   707
3937:  MOVLP  38
....................       output_high(flash_stream.cs_pin);
3938:  MOVLB  0C
3939:  MOVF   57,W
393A:  MOVLB  0F
393B:  MOVWF  5D
393C:  MOVLW  01
393D:  MOVWF  5E
393E:  MOVWF  60
393F:  CLRF   5F
3940:  MOVLP  08
3941:  MOVLB  00
3942:  CALL   1A9
3943:  MOVLP  38
3944:  MOVLB  0C
3945:  MOVF   57,W
3946:  MOVLB  0F
3947:  MOVWF  5D
3948:  CLRF   5E
3949:  CLRF   60
394A:  MOVLW  80
394B:  MOVWF  5F
394C:  MOVLP  08
394D:  MOVLB  00
394E:  CALL   1A9
394F:  MOVLP  38
....................       //Write enabled
....................       output_low(flash_stream.cs_pin);
3950:  MOVLB  0C
3951:  MOVF   57,W
3952:  MOVLB  0F
3953:  MOVWF  5D
3954:  CLRF   5E
3955:  MOVLW  01
3956:  MOVWF  60
3957:  CLRF   5F
3958:  MOVLP  08
3959:  MOVLB  00
395A:  CALL   1A9
395B:  MOVLP  38
395C:  MOVLB  0C
395D:  MOVF   57,W
395E:  MOVLB  0F
395F:  MOVWF  5D
3960:  CLRF   5E
3961:  CLRF   60
3962:  MOVLW  80
3963:  MOVWF  5F
3964:  MOVLP  08
3965:  MOVLB  00
3966:  CALL   1A9
3967:  MOVLP  38
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_select_stream(flash_stream, flash_cmd, 6);
3968:  MOVLB  0C
3969:  MOVF   58,W
396A:  MOVLB  0F
396B:  MOVWF  5A
396C:  MOVLB  0C
396D:  MOVF   57,W
396E:  MOVLB  0F
396F:  MOVWF  59
3970:  MOVLB  0C
3971:  MOVF   56,W
3972:  MOVLB  0F
3973:  MOVWF  58
3974:  MOVLB  0C
3975:  MOVF   55,W
3976:  MOVLB  0F
3977:  MOVWF  57
3978:  MOVLW  24
3979:  MOVWF  5C
397A:  MOVLW  05
397B:  MOVWF  5B
397C:  CLRF   5E
397D:  MOVLW  06
397E:  MOVWF  5D
397F:  MOVLP  08
3980:  MOVLB  00
3981:  CALL   707
3982:  MOVLP  38
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
3983:  MOVLW  02
3984:  MOVWF  77
3985:  DECFSZ 77,F
3986:  GOTO   185
3987:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
3988:  MOVLB  0C
3989:  MOVF   57,W
398A:  MOVLB  0F
398B:  MOVWF  5D
398C:  MOVLW  01
398D:  MOVWF  5E
398E:  MOVWF  60
398F:  CLRF   5F
3990:  MOVLP  08
3991:  MOVLB  00
3992:  CALL   1A9
3993:  MOVLP  38
3994:  MOVLB  0C
3995:  MOVF   57,W
3996:  MOVLB  0F
3997:  MOVWF  5D
3998:  CLRF   5E
3999:  CLRF   60
399A:  MOVLW  80
399B:  MOVWF  5F
399C:  MOVLP  08
399D:  MOVLB  00
399E:  CALL   1A9
399F:  MOVLP  38
39A0:  MOVLB  0C
....................    }
....................    
....................    //wait process finished
....................    unsigned int8 timeout_counter = 0;
39A1:  CLRF   6B
....................    while((status_register(flash_stream) & 0x01) == 1){                           //masking status bit
39A2:  MOVF   58,W
39A3:  MOVLB  0F
39A4:  MOVWF  5A
39A5:  MOVLB  0C
39A6:  MOVF   57,W
39A7:  MOVLB  0F
39A8:  MOVWF  59
39A9:  MOVLB  0C
39AA:  MOVF   56,W
39AB:  MOVLB  0F
39AC:  MOVWF  58
39AD:  MOVLB  0C
39AE:  MOVF   55,W
39AF:  MOVLB  0F
39B0:  MOVWF  57
39B1:  MOVLP  08
39B2:  MOVLB  00
39B3:  CALL   767
39B4:  MOVLP  38
39B5:  MOVF   78,W
39B6:  ANDLW  01
39B7:  SUBLW  01
39B8:  BTFSS  03.2
39B9:  GOTO   1D9
....................       if(timeout_counter > 10)
39BA:  MOVLB  0C
39BB:  MOVF   6B,W
39BC:  SUBLW  0A
39BD:  BTFSC  03.0
39BE:  GOTO   1C8
....................          delay_ms(200);
39BF:  MOVLW  C8
39C0:  MOVLB  0F
39C1:  MOVWF  57
39C2:  MOVLP  08
39C3:  MOVLB  00
39C4:  CALL   7AD
39C5:  MOVLP  38
39C6:  GOTO   1CF
39C7:  MOVLB  0C
....................       else
....................          delay_ms(10);   
39C8:  MOVLW  0A
39C9:  MOVLB  0F
39CA:  MOVWF  57
39CB:  MOVLP  08
39CC:  MOVLB  00
39CD:  CALL   7AD
39CE:  MOVLP  38
....................       
....................       if(timeout_counter > 100){
39CF:  MOVLB  0C
39D0:  MOVF   6B,W
39D1:  SUBLW  64
39D2:  BTFSC  03.0
39D3:  GOTO   1D7
....................          #ifdef MT25Q_DEBUG
....................             fprintf(PC,"flash timeout\r\n");
....................          #endif
....................          break;
39D4:  MOVLB  00
39D5:  GOTO   1D9
39D6:  MOVLB  0C
....................       }  
....................       timeout_counter++;
39D7:  INCF   6B,F
39D8:  GOTO   1A2
39D9:  MOVLB  00
....................    }
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"flash write complete\r\n");
....................    #endif
....................    return;
39DA:  RETURN
.................... }
.................... #Separate 
.................... void write_data_bytes(Flash flash_stream, unsigned int32 write_start_address, int8 *write_data, unsigned int16 write_amount){
....................    if(flash_stream.flash_model == MT25QL128ABA){
*
10A5:  MOVLB  0F
10A6:  MOVF   3F,F
10A7:  BTFSS  03.2
10A8:  GOTO   154
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[4];
10A9:  MOVLW  06
10AA:  MOVWF  4A
....................       
....................       flash_cmd[0] = CMD_PAGE_PROGRAM;
10AB:  MOVLW  02
10AC:  MOVWF  4B
....................       flash_cmd[1] = (unsigned int8)((write_start_address>>16) & 0xff);   // 0x 00 _ _ 00 00
10AD:  MOVF   44,W
10AE:  MOVWF  58
10AF:  MOVF   45,W
10B0:  MOVWF  59
10B1:  CLRF   5A
10B2:  CLRF   5B
10B3:  CLRF   78
10B4:  CLRF   79
10B5:  CLRF   7A
10B6:  MOVF   58,W
10B7:  MOVWF  4C
....................       flash_cmd[2] = (unsigned int8)((write_start_address>>8) & 0xff);    // 0x 00 00 _ _ 00
10B8:  MOVF   43,W
10B9:  MOVWF  58
10BA:  MOVF   44,W
10BB:  MOVWF  59
10BC:  MOVF   45,W
10BD:  MOVWF  5A
10BE:  CLRF   5B
10BF:  CLRF   78
10C0:  CLRF   79
10C1:  CLRF   7A
10C2:  MOVF   58,W
10C3:  MOVWF  4D
....................       flash_cmd[3] = (unsigned int8)((write_start_address) & 0xff);       // 0x 00 00 00 _ _
10C4:  CLRF   78
10C5:  CLRF   79
10C6:  CLRF   7A
10C7:  MOVF   42,W
10C8:  MOVWF  4E
.................... 
....................       //fprintf(PC, "address:0x%08LX\r\n", write_start_address);
.................... 
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
10C9:  MOVF   40,W
10CA:  MOVWF  5D
10CB:  CLRF   5E
10CC:  MOVLW  01
10CD:  MOVWF  60
10CE:  CLRF   5F
10CF:  MOVLP  08
10D0:  MOVLB  00
10D1:  CALL   1A9
10D2:  MOVLP  10
10D3:  MOVLB  0F
10D4:  MOVF   40,W
10D5:  MOVWF  5D
10D6:  CLRF   5E
10D7:  CLRF   60
10D8:  MOVLW  80
10D9:  MOVWF  5F
10DA:  MOVLP  08
10DB:  MOVLB  00
10DC:  CALL   1A9
10DD:  MOVLP  10
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
10DE:  MOVLB  0F
10DF:  MOVF   41,W
10E0:  MOVWF  5A
10E1:  MOVF   40,W
10E2:  MOVWF  59
10E3:  MOVF   3F,W
10E4:  MOVWF  58
10E5:  MOVF   3E,W
10E6:  MOVWF  57
10E7:  MOVLW  24
10E8:  MOVWF  5C
10E9:  MOVLW  DA
10EA:  MOVWF  5B
10EB:  CLRF   5E
10EC:  MOVLW  01
10ED:  MOVWF  5D
10EE:  MOVLP  08
10EF:  MOVLB  00
10F0:  CALL   707
10F1:  MOVLP  10
....................       output_high(flash_stream.cs_pin);
10F2:  MOVLB  0F
10F3:  MOVF   40,W
10F4:  MOVWF  5D
10F5:  MOVLW  01
10F6:  MOVWF  5E
10F7:  MOVWF  60
10F8:  CLRF   5F
10F9:  MOVLP  08
10FA:  MOVLB  00
10FB:  CALL   1A9
10FC:  MOVLP  10
10FD:  MOVLB  0F
10FE:  MOVF   40,W
10FF:  MOVWF  5D
1100:  CLRF   5E
1101:  CLRF   60
1102:  MOVLW  80
1103:  MOVWF  5F
1104:  MOVLP  08
1105:  MOVLB  00
1106:  CALL   1A9
1107:  MOVLP  10
....................       //Write enabled
....................       
....................       output_low(flash_stream.cs_pin);
1108:  MOVLB  0F
1109:  MOVF   40,W
110A:  MOVWF  5D
110B:  CLRF   5E
110C:  MOVLW  01
110D:  MOVWF  60
110E:  CLRF   5F
110F:  MOVLP  08
1110:  MOVLB  00
1111:  CALL   1A9
1112:  MOVLP  10
1113:  MOVLB  0F
1114:  MOVF   40,W
1115:  MOVWF  5D
1116:  CLRF   5E
1117:  CLRF   60
1118:  MOVLW  80
1119:  MOVWF  5F
111A:  MOVLP  08
111B:  MOVLB  00
111C:  CALL   1A9
111D:  MOVLP  10
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_two_datas_select_stream(flash_stream, flash_cmd, 4, write_data, write_amount);
111E:  MOVLB  0F
111F:  MOVF   41,W
1120:  MOVWF  5A
1121:  MOVF   40,W
1122:  MOVWF  59
1123:  MOVF   3F,W
1124:  MOVWF  58
1125:  MOVF   3E,W
1126:  MOVWF  57
1127:  MOVLW  24
1128:  MOVWF  5C
1129:  MOVLW  DB
112A:  MOVWF  5B
112B:  MOVLW  04
112C:  MOVWF  5D
112D:  MOVF   47,W
112E:  MOVWF  5F
112F:  MOVF   46,W
1130:  MOVWF  5E
1131:  MOVF   49,W
1132:  MOVWF  61
1133:  MOVF   48,W
1134:  MOVWF  60
1135:  MOVLB  00
1136:  CALL   000
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
1137:  MOVLW  02
1138:  MOVWF  77
1139:  DECFSZ 77,F
113A:  GOTO   139
113B:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
113C:  MOVLB  0F
113D:  MOVF   40,W
113E:  MOVWF  5D
113F:  MOVLW  01
1140:  MOVWF  5E
1141:  MOVWF  60
1142:  CLRF   5F
1143:  MOVLP  08
1144:  MOVLB  00
1145:  CALL   1A9
1146:  MOVLP  10
1147:  MOVLB  0F
1148:  MOVF   40,W
1149:  MOVWF  5D
114A:  CLRF   5E
114B:  CLRF   60
114C:  MOVLW  80
114D:  MOVWF  5F
114E:  MOVLP  08
114F:  MOVLB  00
1150:  CALL   1A9
1151:  MOVLP  10
....................    }
1152:  GOTO   209
1153:  MOVLB  0F
....................    else if(flash_stream.flash_model == MT25QL01GBBB){
1154:  DECFSZ 3F,W
1155:  GOTO   20A
....................       int8 write_enable_cmd = CMD_WRITE_ENABLE;
....................       unsigned int8 flash_cmd[5];
1156:  MOVLW  06
1157:  MOVWF  4F
....................       
....................       flash_cmd[0] = CMD_4BYTE_PAGE_PROGRAM;
1158:  MOVLW  12
1159:  MOVWF  50
....................       flash_cmd[1] = (unsigned int8)((write_start_address>>24) & 0xff);   // 0x _ _ 00 00 00
115A:  MOVF   45,W
115B:  MOVWF  58
115C:  CLRF   59
115D:  CLRF   5A
115E:  CLRF   5B
115F:  CLRF   78
1160:  CLRF   79
1161:  CLRF   7A
1162:  MOVF   58,W
1163:  MOVWF  51
....................       flash_cmd[2] = (unsigned int8)((write_start_address>>16) & 0xff);   // 0x 00 _ _ 00 00
1164:  MOVF   44,W
1165:  MOVWF  58
1166:  MOVF   45,W
1167:  MOVWF  59
1168:  CLRF   5A
1169:  CLRF   5B
116A:  CLRF   78
116B:  CLRF   79
116C:  CLRF   7A
116D:  MOVF   58,W
116E:  MOVWF  52
....................       flash_cmd[3] = (unsigned int8)((write_start_address>>8) & 0xff);    // 0x 00 00 _ _ 00
116F:  MOVF   43,W
1170:  MOVWF  58
1171:  MOVF   44,W
1172:  MOVWF  59
1173:  MOVF   45,W
1174:  MOVWF  5A
1175:  CLRF   5B
1176:  CLRF   78
1177:  CLRF   79
1178:  CLRF   7A
1179:  MOVF   58,W
117A:  MOVWF  53
....................       flash_cmd[4] = (unsigned int8)((write_start_address) & 0xff);       // 0x 00 00 00 _ _
117B:  CLRF   78
117C:  CLRF   79
117D:  CLRF   7A
117E:  MOVF   42,W
117F:  MOVWF  54
....................    
....................       //Write enable sequence
....................       output_low(flash_stream.cs_pin);
1180:  MOVF   40,W
1181:  MOVWF  5D
1182:  CLRF   5E
1183:  MOVLW  01
1184:  MOVWF  60
1185:  CLRF   5F
1186:  MOVLP  08
1187:  MOVLB  00
1188:  CALL   1A9
1189:  MOVLP  10
118A:  MOVLB  0F
118B:  MOVF   40,W
118C:  MOVWF  5D
118D:  CLRF   5E
118E:  CLRF   60
118F:  MOVLW  80
1190:  MOVWF  5F
1191:  MOVLP  08
1192:  MOVLB  00
1193:  CALL   1A9
1194:  MOVLP  10
....................       spi_xfer_select_stream(flash_stream, &write_enable_cmd, 1);
1195:  MOVLB  0F
1196:  MOVF   41,W
1197:  MOVWF  5A
1198:  MOVF   40,W
1199:  MOVWF  59
119A:  MOVF   3F,W
119B:  MOVWF  58
119C:  MOVF   3E,W
119D:  MOVWF  57
119E:  MOVLW  24
119F:  MOVWF  5C
11A0:  MOVLW  DF
11A1:  MOVWF  5B
11A2:  CLRF   5E
11A3:  MOVLW  01
11A4:  MOVWF  5D
11A5:  MOVLP  08
11A6:  MOVLB  00
11A7:  CALL   707
11A8:  MOVLP  10
....................       output_high(flash_stream.cs_pin);
11A9:  MOVLB  0F
11AA:  MOVF   40,W
11AB:  MOVWF  5D
11AC:  MOVLW  01
11AD:  MOVWF  5E
11AE:  MOVWF  60
11AF:  CLRF   5F
11B0:  MOVLP  08
11B1:  MOVLB  00
11B2:  CALL   1A9
11B3:  MOVLP  10
11B4:  MOVLB  0F
11B5:  MOVF   40,W
11B6:  MOVWF  5D
11B7:  CLRF   5E
11B8:  CLRF   60
11B9:  MOVLW  80
11BA:  MOVWF  5F
11BB:  MOVLP  08
11BC:  MOVLB  00
11BD:  CALL   1A9
11BE:  MOVLP  10
....................       //Write enabled
....................       output_low(flash_stream.cs_pin);
11BF:  MOVLB  0F
11C0:  MOVF   40,W
11C1:  MOVWF  5D
11C2:  CLRF   5E
11C3:  MOVLW  01
11C4:  MOVWF  60
11C5:  CLRF   5F
11C6:  MOVLP  08
11C7:  MOVLB  00
11C8:  CALL   1A9
11C9:  MOVLP  10
11CA:  MOVLB  0F
11CB:  MOVF   40,W
11CC:  MOVWF  5D
11CD:  CLRF   5E
11CE:  CLRF   60
11CF:  MOVLW  80
11D0:  MOVWF  5F
11D1:  MOVLP  08
11D2:  MOVLB  00
11D3:  CALL   1A9
11D4:  MOVLP  10
....................       ///////////////////////////////////////////////////////////////////
....................       spi_xfer_two_datas_select_stream(flash_stream, flash_cmd, 5, write_data, write_amount);
11D5:  MOVLB  0F
11D6:  MOVF   41,W
11D7:  MOVWF  5A
11D8:  MOVF   40,W
11D9:  MOVWF  59
11DA:  MOVF   3F,W
11DB:  MOVWF  58
11DC:  MOVF   3E,W
11DD:  MOVWF  57
11DE:  MOVLW  24
11DF:  MOVWF  5C
11E0:  MOVLW  E0
11E1:  MOVWF  5B
11E2:  MOVLW  05
11E3:  MOVWF  5D
11E4:  MOVF   47,W
11E5:  MOVWF  5F
11E6:  MOVF   46,W
11E7:  MOVWF  5E
11E8:  MOVF   49,W
11E9:  MOVWF  61
11EA:  MOVF   48,W
11EB:  MOVWF  60
11EC:  MOVLB  00
11ED:  CALL   000
....................       //////////////////////////////////////////////////////////////////
....................       delay_us(2);
11EE:  MOVLW  02
11EF:  MOVWF  77
11F0:  DECFSZ 77,F
11F1:  GOTO   1F0
11F2:  NOP
....................       output_high(flash_stream.cs_pin);            //take CS PIN higher back
11F3:  MOVLB  0F
11F4:  MOVF   40,W
11F5:  MOVWF  5D
11F6:  MOVLW  01
11F7:  MOVWF  5E
11F8:  MOVWF  60
11F9:  CLRF   5F
11FA:  MOVLP  08
11FB:  MOVLB  00
11FC:  CALL   1A9
11FD:  MOVLP  10
11FE:  MOVLB  0F
11FF:  MOVF   40,W
1200:  MOVWF  5D
1201:  CLRF   5E
1202:  CLRF   60
1203:  MOVLW  80
1204:  MOVWF  5F
1205:  MOVLP  08
1206:  MOVLB  00
1207:  CALL   1A9
1208:  MOVLP  10
1209:  MOVLB  0F
....................    }
....................    
....................    //wait process finished
....................    unsigned int8 timeout_counter = 0;
120A:  CLRF   55
....................    while((status_register(flash_stream) & 0x01) == 1){                           //masking status bit
120B:  MOVF   41,W
120C:  MOVWF  5A
120D:  MOVF   40,W
120E:  MOVWF  59
120F:  MOVF   3F,W
1210:  MOVWF  58
1211:  MOVF   3E,W
1212:  MOVWF  57
1213:  MOVLP  08
1214:  MOVLB  00
1215:  CALL   767
1216:  MOVLP  10
1217:  MOVF   78,W
1218:  ANDLW  01
1219:  SUBLW  01
121A:  BTFSS  03.2
121B:  GOTO   239
....................       if(timeout_counter > 10)
121C:  MOVLB  0F
121D:  MOVF   55,W
121E:  SUBLW  0A
121F:  BTFSC  03.0
1220:  GOTO   229
....................          delay_ms(200);
1221:  MOVLW  C8
1222:  MOVWF  57
1223:  MOVLP  08
1224:  MOVLB  00
1225:  CALL   7AD
1226:  MOVLP  10
1227:  GOTO   22F
1228:  MOVLB  0F
....................       else
....................          delay_ms(10);   
1229:  MOVLW  0A
122A:  MOVWF  57
122B:  MOVLP  08
122C:  MOVLB  00
122D:  CALL   7AD
122E:  MOVLP  10
....................       
....................       if(timeout_counter > 100){
122F:  MOVLB  0F
1230:  MOVF   55,W
1231:  SUBLW  64
1232:  BTFSC  03.0
1233:  GOTO   237
....................          #ifdef MT25Q_DEBUG
....................             fprintf(PC,"flash timeout\r\n");
....................          #endif
....................          break;
1234:  MOVLB  00
1235:  GOTO   239
1236:  MOVLB  0F
....................       }  
....................       timeout_counter++;
1237:  INCF   55,F
1238:  GOTO   20B
1239:  MOVLB  00
....................    }
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"flash write complete\r\n");
....................    #endif
....................    return;
123A:  RETURN
.................... }
.................... 
.................... #Separate 
.................... int1 is_connect(Flash flash_stream){
*
0AD3:  MOVLW  9F
0AD4:  MOVLB  0F
0AD5:  MOVWF  46
....................    READ_ID_DATA read_id_data;
....................    int8 flash_cmd = CMD_READ_ID;
....................    output_low(flash_stream.cs_pin);
0AD6:  MOVF   40,W
0AD7:  MOVWF  5D
0AD8:  CLRF   5E
0AD9:  MOVLW  01
0ADA:  MOVWF  60
0ADB:  CLRF   5F
0ADC:  MOVLB  00
0ADD:  CALL   1A9
0ADE:  MOVLB  0F
0ADF:  MOVF   40,W
0AE0:  MOVWF  5D
0AE1:  CLRF   5E
0AE2:  CLRF   60
0AE3:  MOVLW  80
0AE4:  MOVWF  5F
0AE5:  MOVLB  00
0AE6:  CALL   1A9
....................    spi_xfer_and_read_select_stream(flash_stream, &flash_cmd, 1, read_id_data.bytes, sizeof(read_id_data.bytes));
0AE7:  MOVLB  0F
0AE8:  MOVF   41,W
0AE9:  MOVWF  60
0AEA:  MOVF   40,W
0AEB:  MOVWF  5F
0AEC:  MOVF   3F,W
0AED:  MOVWF  5E
0AEE:  MOVF   3E,W
0AEF:  MOVWF  5D
0AF0:  MOVLW  24
0AF1:  MOVWF  62
0AF2:  MOVLW  D6
0AF3:  MOVWF  61
0AF4:  CLRF   64
0AF5:  MOVLW  01
0AF6:  MOVWF  63
0AF7:  MOVLW  24
0AF8:  MOVWF  66
0AF9:  MOVLW  D2
0AFA:  MOVWF  65
0AFB:  CLRF   6A
0AFC:  CLRF   69
0AFD:  CLRF   68
0AFE:  MOVLW  04
0AFF:  MOVWF  67
0B00:  MOVLB  00
0B01:  CALL   1E5
....................    output_high(flash_stream.cs_pin);
0B02:  MOVLB  0F
0B03:  MOVF   40,W
0B04:  MOVWF  5D
0B05:  MOVLW  01
0B06:  MOVWF  5E
0B07:  MOVWF  60
0B08:  CLRF   5F
0B09:  MOVLB  00
0B0A:  CALL   1A9
0B0B:  MOVLB  0F
0B0C:  MOVF   40,W
0B0D:  MOVWF  5D
0B0E:  CLRF   5E
0B0F:  CLRF   60
0B10:  MOVLW  80
0B11:  MOVWF  5F
0B12:  MOVLB  00
0B13:  CALL   1A9
....................    #ifdef MT25Q_DEBUG
....................       fprintf(PC,"Read ID:");
.................... 
....................    #endif
....................    //chip id check
....................    if(read_id_data.fields.manufacturer_id == MANUFACTURER_ID_MICRON){  
0B14:  MOVLB  0F
0B15:  MOVF   42,W
0B16:  SUBLW  20
0B17:  BTFSS  03.2
0B18:  GOTO   31D
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"flash connect OK\r\n");
....................       #endif
....................       return true;
0B19:  MOVLW  01
0B1A:  MOVWF  78
0B1B:  GOTO   31F
....................    }
0B1C:  GOTO   31F
....................    else{
....................       #ifdef MT25Q_DEBUG
....................          fprintf(PC,"flash not connect\r\n");
....................       #endif
....................       return false;
0B1D:  MOVLW  00
0B1E:  MOVWF  78
....................    }
0B1F:  MOVLB  00
0B20:  RETURN
.................... }
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... 
.................... void misf_init()
.................... {
....................     fprintf(PC, "MISSION FLASH Initialize\r\n");
*
0C97:  MOVLW  92
0C98:  MOVLB  03
0C99:  MOVWF  11
0C9A:  MOVLW  00
0C9B:  MOVWF  12
0C9C:  MOVLB  00
0C9D:  CALL   0CC
....................     output_high(MIS_FM_CS); // Set CS pin high to deselect the flash
0C9E:  MOVLB  01
0C9F:  BCF    0F.3
0CA0:  MOVLB  02
0CA1:  BSF    0F.3
....................     output_high(SMF_CS); // Set CS pin high to deselect the SMF
0CA2:  MOVLB  01
0CA3:  BCF    0F.1
0CA4:  MOVLB  02
0CA5:  BSF    0F.1
....................     
....................     unsigned int8 readdata[PACKET_SIZE];
.................... 
....................     if (!is_connect(mis_fm)) {
0CA6:  MOVLB  08
0CA7:  MOVF   5D,W
0CA8:  MOVLB  0F
0CA9:  MOVWF  41
0CAA:  MOVLB  08
0CAB:  MOVF   5C,W
0CAC:  MOVLB  0F
0CAD:  MOVWF  40
0CAE:  MOVLB  08
0CAF:  MOVF   5B,W
0CB0:  MOVLB  0F
0CB1:  MOVWF  3F
0CB2:  MOVLB  08
0CB3:  MOVF   5A,W
0CB4:  MOVLB  0F
0CB5:  MOVWF  3E
0CB6:  MOVLB  00
0CB7:  CALL   2D3
0CB8:  MOVF   78,F
0CB9:  BTFSS  03.2
0CBA:  GOTO   4C3
....................         fprintf(PC, "\tFlash is not connected\r\n");
0CBB:  MOVLW  A0
0CBC:  MOVLB  03
0CBD:  MOVWF  11
0CBE:  MOVLW  00
0CBF:  MOVWF  12
0CC0:  MOVLB  00
0CC1:  CALL   0CC
....................         return;
0CC2:  GOTO   706
....................     }else {
....................         //fprintf(PC, "\tFlash is connected\r\n");
....................     }
....................     read_data_bytes(mis_fm, ADDRESS_MANEGE_START, readdata, PACKET_SIZE); // Read the PICLOG data header
0CC3:  MOVLB  08
0CC4:  MOVF   5D,W
0CC5:  MOVLB  0E
0CC6:  MOVWF  42
0CC7:  MOVLB  08
0CC8:  MOVF   5C,W
0CC9:  MOVLB  0E
0CCA:  MOVWF  41
0CCB:  MOVLB  08
0CCC:  MOVF   5B,W
0CCD:  MOVLB  0E
0CCE:  MOVWF  40
0CCF:  MOVLB  08
0CD0:  MOVF   5A,W
0CD1:  MOVLB  0E
0CD2:  MOVWF  3F
0CD3:  CLRF   46
0CD4:  CLRF   45
0CD5:  CLRF   44
0CD6:  CLRF   43
0CD7:  MOVLW  23
0CD8:  MOVWF  48
0CD9:  MOVLW  B7
0CDA:  MOVWF  47
0CDB:  CLRF   4C
0CDC:  CLRF   4B
0CDD:  CLRF   4A
0CDE:  MOVLW  40
0CDF:  MOVWF  49
0CE0:  MOVLB  00
0CE1:  CALL   321
....................     
....................     // Update the flash data header with the read data
....................     smf_piclog_use_counter = (readdata[0] << 24) | (readdata[1] << 16) | (readdata[2] << 8) | readdata[3];
0CE2:  MOVLB  0C
0CE3:  CLRF   59
0CE4:  MOVLW  00
0CE5:  IORWF  59,F
0CE6:  IORWF  59,W
0CE7:  MOVLB  0B
0CE8:  IORWF  6A,W
0CE9:  MOVLB  08
0CEA:  MOVWF  42
0CEB:  CLRF   43
0CEC:  CLRF   44
0CED:  CLRF   45
....................     smf_piclog_loop_counter = readdata[4];
0CEE:  MOVLB  0B
0CEF:  MOVF   6B,W
0CF0:  MOVWF  71
....................     smf_meas_use_counter = (readdata[5] << 24) | (readdata[6] << 16) | (readdata[7] << 8) | readdata[8];
0CF1:  MOVLB  0C
0CF2:  CLRF   59
0CF3:  MOVLW  00
0CF4:  IORWF  59,F
0CF5:  IORWF  59,W
0CF6:  MOVLB  0B
0CF7:  IORWF  6F,W
0CF8:  MOVLB  08
0CF9:  MOVWF  46
0CFA:  CLRF   47
0CFB:  CLRF   48
0CFC:  CLRF   49
....................     smf_meas_loop_counter = readdata[9];
0CFD:  MOVLB  0C
0CFE:  MOVF   20,W
0CFF:  MOVWF  72
.................... 
....................     misf_piclog_use_counter = (readdata[10] << 24) | (readdata[11] << 16) | (readdata[12] << 8) | readdata[13];
0D00:  CLRF   59
0D01:  MOVLW  00
0D02:  IORWF  59,F
0D03:  IORWF  59,W
0D04:  IORWF  24,W
0D05:  MOVLB  08
0D06:  MOVWF  4A
0D07:  CLRF   4B
0D08:  CLRF   4C
0D09:  CLRF   4D
....................     misf_piclog_loop_counter = readdata[14];
0D0A:  MOVLB  0C
0D0B:  MOVF   25,W
0D0C:  MOVWF  73
....................     misf_piclog_uncopyed_counter = (readdata[15] << 24) | (readdata[16] << 16) | (readdata[17] << 8) | readdata[18];
0D0D:  CLRF   59
0D0E:  MOVLW  00
0D0F:  IORWF  59,F
0D10:  IORWF  59,W
0D11:  IORWF  29,W
0D12:  MOVLB  08
0D13:  MOVWF  4E
0D14:  CLRF   4F
0D15:  CLRF   50
0D16:  CLRF   51
....................     misf_piclog_write_counter = (readdata[19] << 24) | (readdata[20] << 16) | (readdata[21] << 8) | readdata[22];
0D17:  MOVLB  0C
0D18:  CLRF   58
0D19:  MOVLW  00
0D1A:  IORWF  58,F
0D1B:  IORWF  58,W
0D1C:  IORWF  2D,W
0D1D:  MOVWF  74
....................     misf_meas_use_counter = (readdata[23] << 24) | (readdata[24] << 16) | (readdata[25] << 8) | readdata[26];
0D1E:  CLRF   59
0D1F:  MOVLW  00
0D20:  IORWF  59,F
0D21:  IORWF  59,W
0D22:  IORWF  31,W
0D23:  MOVLB  08
0D24:  MOVWF  52
0D25:  CLRF   53
0D26:  CLRF   54
0D27:  CLRF   55
....................     misf_meas_loop_counter = readdata[27];
0D28:  MOVLB  0C
0D29:  MOVF   32,W
0D2A:  MOVWF  75
....................     misf_meas_uncopyed_counter = (readdata[28] << 24) | (readdata[29] << 16) | (readdata[30] << 8) | readdata[31];
0D2B:  CLRF   59
0D2C:  MOVLW  00
0D2D:  IORWF  59,F
0D2E:  IORWF  59,W
0D2F:  IORWF  36,W
0D30:  MOVLB  08
0D31:  MOVWF  56
0D32:  CLRF   57
0D33:  CLRF   58
0D34:  CLRF   59
.................... 
....................     fprintf(PC, "\tSMF  PICLOG Use Counter      : 0x%08LX\r\n", smf_piclog_use_counter);
0D35:  MOVLW  AD
0D36:  MOVLB  03
0D37:  MOVWF  11
0D38:  MOVLW  00
0D39:  MOVWF  12
0D3A:  BCF    03.0
0D3B:  MOVLW  22
0D3C:  MOVLB  0C
0D3D:  MOVWF  5E
0D3E:  MOVLB  00
0D3F:  CALL   416
0D40:  MOVLB  08
0D41:  MOVF   45,W
0D42:  MOVLB  0E
0D43:  MOVWF  4E
0D44:  MOVLW  37
0D45:  MOVWF  4F
0D46:  MOVLB  00
0D47:  CALL   470
0D48:  MOVLB  08
0D49:  MOVF   44,W
0D4A:  MOVLB  0E
0D4B:  MOVWF  4E
0D4C:  MOVLW  37
0D4D:  MOVWF  4F
0D4E:  MOVLB  00
0D4F:  CALL   470
0D50:  MOVLB  08
0D51:  MOVF   43,W
0D52:  MOVLB  0E
0D53:  MOVWF  4E
0D54:  MOVLW  37
0D55:  MOVWF  4F
0D56:  MOVLB  00
0D57:  CALL   470
0D58:  MOVLB  08
0D59:  MOVF   42,W
0D5A:  MOVLB  0E
0D5B:  MOVWF  4E
0D5C:  MOVLW  37
0D5D:  MOVWF  4F
0D5E:  MOVLB  00
0D5F:  CALL   470
0D60:  MOVLW  0D
0D61:  MOVLB  0F
0D62:  MOVWF  43
0D63:  MOVLB  00
0D64:  CALL   0A7
0D65:  MOVLW  0A
0D66:  MOVLB  0F
0D67:  MOVWF  43
0D68:  MOVLB  00
0D69:  CALL   0A7
....................     fprintf(PC, "\tSMF  PICLOG Loop Counter     : 0x%02X\r\n", smf_piclog_loop_counter);
0D6A:  MOVLW  C2
0D6B:  MOVLB  03
0D6C:  MOVWF  11
0D6D:  MOVLW  00
0D6E:  MOVWF  12
0D6F:  BCF    03.0
0D70:  MOVLW  22
0D71:  MOVLB  0C
0D72:  MOVWF  5E
0D73:  MOVLB  00
0D74:  CALL   416
0D75:  MOVF   71,W
0D76:  MOVLB  0E
0D77:  MOVWF  4E
0D78:  MOVLW  37
0D79:  MOVWF  4F
0D7A:  MOVLB  00
0D7B:  CALL   470
0D7C:  MOVLW  0D
0D7D:  MOVLB  0F
0D7E:  MOVWF  43
0D7F:  MOVLB  00
0D80:  CALL   0A7
0D81:  MOVLW  0A
0D82:  MOVLB  0F
0D83:  MOVWF  43
0D84:  MOVLB  00
0D85:  CALL   0A7
....................     fprintf(PC, "\tSMF  MEAS   Use Counter      : 0x%08LX\r\n", smf_meas_use_counter);
0D86:  MOVLW  D7
0D87:  MOVLB  03
0D88:  MOVWF  11
0D89:  MOVLW  00
0D8A:  MOVWF  12
0D8B:  BCF    03.0
0D8C:  MOVLW  22
0D8D:  MOVLB  0C
0D8E:  MOVWF  5E
0D8F:  MOVLB  00
0D90:  CALL   416
0D91:  MOVLB  08
0D92:  MOVF   49,W
0D93:  MOVLB  0E
0D94:  MOVWF  4E
0D95:  MOVLW  37
0D96:  MOVWF  4F
0D97:  MOVLB  00
0D98:  CALL   470
0D99:  MOVLB  08
0D9A:  MOVF   48,W
0D9B:  MOVLB  0E
0D9C:  MOVWF  4E
0D9D:  MOVLW  37
0D9E:  MOVWF  4F
0D9F:  MOVLB  00
0DA0:  CALL   470
0DA1:  MOVLB  08
0DA2:  MOVF   47,W
0DA3:  MOVLB  0E
0DA4:  MOVWF  4E
0DA5:  MOVLW  37
0DA6:  MOVWF  4F
0DA7:  MOVLB  00
0DA8:  CALL   470
0DA9:  MOVLB  08
0DAA:  MOVF   46,W
0DAB:  MOVLB  0E
0DAC:  MOVWF  4E
0DAD:  MOVLW  37
0DAE:  MOVWF  4F
0DAF:  MOVLB  00
0DB0:  CALL   470
0DB1:  MOVLW  0D
0DB2:  MOVLB  0F
0DB3:  MOVWF  43
0DB4:  MOVLB  00
0DB5:  CALL   0A7
0DB6:  MOVLW  0A
0DB7:  MOVLB  0F
0DB8:  MOVWF  43
0DB9:  MOVLB  00
0DBA:  CALL   0A7
....................     fprintf(PC, "\tSMF  MEAS   Loop Counter     : 0x%02X\r\n", smf_meas_loop_counter);
0DBB:  MOVLW  EC
0DBC:  MOVLB  03
0DBD:  MOVWF  11
0DBE:  MOVLW  00
0DBF:  MOVWF  12
0DC0:  BCF    03.0
0DC1:  MOVLW  22
0DC2:  MOVLB  0C
0DC3:  MOVWF  5E
0DC4:  MOVLB  00
0DC5:  CALL   416
0DC6:  MOVF   72,W
0DC7:  MOVLB  0E
0DC8:  MOVWF  4E
0DC9:  MOVLW  37
0DCA:  MOVWF  4F
0DCB:  MOVLB  00
0DCC:  CALL   470
0DCD:  MOVLW  0D
0DCE:  MOVLB  0F
0DCF:  MOVWF  43
0DD0:  MOVLB  00
0DD1:  CALL   0A7
0DD2:  MOVLW  0A
0DD3:  MOVLB  0F
0DD4:  MOVWF  43
0DD5:  MOVLB  00
0DD6:  CALL   0A7
....................     fprintf(PC, "\tMISF PICLOG Use Counter      : 0x%08LX\r\n", misf_piclog_use_counter);
0DD7:  MOVLW  01
0DD8:  MOVLB  03
0DD9:  MOVWF  11
0DDA:  MOVLW  01
0DDB:  MOVWF  12
0DDC:  BCF    03.0
0DDD:  MOVLW  22
0DDE:  MOVLB  0C
0DDF:  MOVWF  5E
0DE0:  MOVLB  00
0DE1:  CALL   416
0DE2:  MOVLB  08
0DE3:  MOVF   4D,W
0DE4:  MOVLB  0E
0DE5:  MOVWF  4E
0DE6:  MOVLW  37
0DE7:  MOVWF  4F
0DE8:  MOVLB  00
0DE9:  CALL   470
0DEA:  MOVLB  08
0DEB:  MOVF   4C,W
0DEC:  MOVLB  0E
0DED:  MOVWF  4E
0DEE:  MOVLW  37
0DEF:  MOVWF  4F
0DF0:  MOVLB  00
0DF1:  CALL   470
0DF2:  MOVLB  08
0DF3:  MOVF   4B,W
0DF4:  MOVLB  0E
0DF5:  MOVWF  4E
0DF6:  MOVLW  37
0DF7:  MOVWF  4F
0DF8:  MOVLB  00
0DF9:  CALL   470
0DFA:  MOVLB  08
0DFB:  MOVF   4A,W
0DFC:  MOVLB  0E
0DFD:  MOVWF  4E
0DFE:  MOVLW  37
0DFF:  MOVWF  4F
0E00:  MOVLB  00
0E01:  CALL   470
0E02:  MOVLW  0D
0E03:  MOVLB  0F
0E04:  MOVWF  43
0E05:  MOVLB  00
0E06:  CALL   0A7
0E07:  MOVLW  0A
0E08:  MOVLB  0F
0E09:  MOVWF  43
0E0A:  MOVLB  00
0E0B:  CALL   0A7
....................     fprintf(PC, "\tMISF PICLOG Uncopyed Counter : 0x%08LX\r\n", misf_piclog_uncopyed_counter);
0E0C:  MOVLW  16
0E0D:  MOVLB  03
0E0E:  MOVWF  11
0E0F:  MOVLW  01
0E10:  MOVWF  12
0E11:  BCF    03.0
0E12:  MOVLW  22
0E13:  MOVLB  0C
0E14:  MOVWF  5E
0E15:  MOVLB  00
0E16:  CALL   416
0E17:  MOVLB  08
0E18:  MOVF   51,W
0E19:  MOVLB  0E
0E1A:  MOVWF  4E
0E1B:  MOVLW  37
0E1C:  MOVWF  4F
0E1D:  MOVLB  00
0E1E:  CALL   470
0E1F:  MOVLB  08
0E20:  MOVF   50,W
0E21:  MOVLB  0E
0E22:  MOVWF  4E
0E23:  MOVLW  37
0E24:  MOVWF  4F
0E25:  MOVLB  00
0E26:  CALL   470
0E27:  MOVLB  08
0E28:  MOVF   4F,W
0E29:  MOVLB  0E
0E2A:  MOVWF  4E
0E2B:  MOVLW  37
0E2C:  MOVWF  4F
0E2D:  MOVLB  00
0E2E:  CALL   470
0E2F:  MOVLB  08
0E30:  MOVF   4E,W
0E31:  MOVLB  0E
0E32:  MOVWF  4E
0E33:  MOVLW  37
0E34:  MOVWF  4F
0E35:  MOVLB  00
0E36:  CALL   470
0E37:  MOVLW  0D
0E38:  MOVLB  0F
0E39:  MOVWF  43
0E3A:  MOVLB  00
0E3B:  CALL   0A7
0E3C:  MOVLW  0A
0E3D:  MOVLB  0F
0E3E:  MOVWF  43
0E3F:  MOVLB  00
0E40:  CALL   0A7
....................     fprintf(PC, "\tMISF PICLOG Loop Counter     : 0x%02X\r\n", misf_piclog_loop_counter);
0E41:  MOVLW  2B
0E42:  MOVLB  03
0E43:  MOVWF  11
0E44:  MOVLW  01
0E45:  MOVWF  12
0E46:  BCF    03.0
0E47:  MOVLW  22
0E48:  MOVLB  0C
0E49:  MOVWF  5E
0E4A:  MOVLB  00
0E4B:  CALL   416
0E4C:  MOVF   73,W
0E4D:  MOVLB  0E
0E4E:  MOVWF  4E
0E4F:  MOVLW  37
0E50:  MOVWF  4F
0E51:  MOVLB  00
0E52:  CALL   470
0E53:  MOVLW  0D
0E54:  MOVLB  0F
0E55:  MOVWF  43
0E56:  MOVLB  00
0E57:  CALL   0A7
0E58:  MOVLW  0A
0E59:  MOVLB  0F
0E5A:  MOVWF  43
0E5B:  MOVLB  00
0E5C:  CALL   0A7
....................     fprintf(PC, "\tMISF PICLOG Write Counter    : 0x%02X\r\n", misf_piclog_write_counter);
0E5D:  MOVLW  40
0E5E:  MOVLB  03
0E5F:  MOVWF  11
0E60:  MOVLW  01
0E61:  MOVWF  12
0E62:  BCF    03.0
0E63:  MOVLW  22
0E64:  MOVLB  0C
0E65:  MOVWF  5E
0E66:  MOVLB  00
0E67:  CALL   416
0E68:  MOVF   74,W
0E69:  MOVLB  0E
0E6A:  MOVWF  4E
0E6B:  MOVLW  37
0E6C:  MOVWF  4F
0E6D:  MOVLB  00
0E6E:  CALL   470
0E6F:  MOVLW  0D
0E70:  MOVLB  0F
0E71:  MOVWF  43
0E72:  MOVLB  00
0E73:  CALL   0A7
0E74:  MOVLW  0A
0E75:  MOVLB  0F
0E76:  MOVWF  43
0E77:  MOVLB  00
0E78:  CALL   0A7
....................     fprintf(PC, "\tMISF MEAS   Use Counter      : 0x%08LX\r\n", misf_meas_use_counter);
0E79:  MOVLW  55
0E7A:  MOVLB  03
0E7B:  MOVWF  11
0E7C:  MOVLW  01
0E7D:  MOVWF  12
0E7E:  BCF    03.0
0E7F:  MOVLW  22
0E80:  MOVLB  0C
0E81:  MOVWF  5E
0E82:  MOVLB  00
0E83:  CALL   416
0E84:  MOVLB  08
0E85:  MOVF   55,W
0E86:  MOVLB  0E
0E87:  MOVWF  4E
0E88:  MOVLW  37
0E89:  MOVWF  4F
0E8A:  MOVLB  00
0E8B:  CALL   470
0E8C:  MOVLB  08
0E8D:  MOVF   54,W
0E8E:  MOVLB  0E
0E8F:  MOVWF  4E
0E90:  MOVLW  37
0E91:  MOVWF  4F
0E92:  MOVLB  00
0E93:  CALL   470
0E94:  MOVLB  08
0E95:  MOVF   53,W
0E96:  MOVLB  0E
0E97:  MOVWF  4E
0E98:  MOVLW  37
0E99:  MOVWF  4F
0E9A:  MOVLB  00
0E9B:  CALL   470
0E9C:  MOVLB  08
0E9D:  MOVF   52,W
0E9E:  MOVLB  0E
0E9F:  MOVWF  4E
0EA0:  MOVLW  37
0EA1:  MOVWF  4F
0EA2:  MOVLB  00
0EA3:  CALL   470
0EA4:  MOVLW  0D
0EA5:  MOVLB  0F
0EA6:  MOVWF  43
0EA7:  MOVLB  00
0EA8:  CALL   0A7
0EA9:  MOVLW  0A
0EAA:  MOVLB  0F
0EAB:  MOVWF  43
0EAC:  MOVLB  00
0EAD:  CALL   0A7
....................     fprintf(PC, "\tMISF MEAS   Uncopyed Counter : 0x%08LX\r\n", misf_meas_uncopyed_counter);  
0EAE:  MOVLW  6A
0EAF:  MOVLB  03
0EB0:  MOVWF  11
0EB1:  MOVLW  01
0EB2:  MOVWF  12
0EB3:  BCF    03.0
0EB4:  MOVLW  22
0EB5:  MOVLB  0C
0EB6:  MOVWF  5E
0EB7:  MOVLB  00
0EB8:  CALL   416
0EB9:  MOVLB  08
0EBA:  MOVF   59,W
0EBB:  MOVLB  0E
0EBC:  MOVWF  4E
0EBD:  MOVLW  37
0EBE:  MOVWF  4F
0EBF:  MOVLB  00
0EC0:  CALL   470
0EC1:  MOVLB  08
0EC2:  MOVF   58,W
0EC3:  MOVLB  0E
0EC4:  MOVWF  4E
0EC5:  MOVLW  37
0EC6:  MOVWF  4F
0EC7:  MOVLB  00
0EC8:  CALL   470
0EC9:  MOVLB  08
0ECA:  MOVF   57,W
0ECB:  MOVLB  0E
0ECC:  MOVWF  4E
0ECD:  MOVLW  37
0ECE:  MOVWF  4F
0ECF:  MOVLB  00
0ED0:  CALL   470
0ED1:  MOVLB  08
0ED2:  MOVF   56,W
0ED3:  MOVLB  0E
0ED4:  MOVWF  4E
0ED5:  MOVLW  37
0ED6:  MOVWF  4F
0ED7:  MOVLB  00
0ED8:  CALL   470
0ED9:  MOVLW  0D
0EDA:  MOVLB  0F
0EDB:  MOVWF  43
0EDC:  MOVLB  00
0EDD:  CALL   0A7
0EDE:  MOVLW  0A
0EDF:  MOVLB  0F
0EE0:  MOVWF  43
0EE1:  MOVLB  00
0EE2:  CALL   0A7
....................     fprintf(PC, "\tMISF MEAS   Loop Counter     : 0x%02X\r\n", misf_meas_loop_counter);    
0EE3:  MOVLW  7F
0EE4:  MOVLB  03
0EE5:  MOVWF  11
0EE6:  MOVLW  01
0EE7:  MOVWF  12
0EE8:  BCF    03.0
0EE9:  MOVLW  22
0EEA:  MOVLB  0C
0EEB:  MOVWF  5E
0EEC:  MOVLB  00
0EED:  CALL   416
0EEE:  MOVF   75,W
0EEF:  MOVLB  0E
0EF0:  MOVWF  4E
0EF1:  MOVLW  37
0EF2:  MOVWF  4F
0EF3:  MOVLB  00
0EF4:  CALL   470
0EF5:  MOVLW  0D
0EF6:  MOVLB  0F
0EF7:  MOVWF  43
0EF8:  MOVLB  00
0EF9:  CALL   0A7
0EFA:  MOVLW  0A
0EFB:  MOVLB  0F
0EFC:  MOVWF  43
0EFD:  MOVLB  00
0EFE:  CALL   0A7
....................     fprintf(PC, "\tComplete\r\n");
0EFF:  MOVLW  94
0F00:  MOVLB  03
0F01:  MOVWF  11
0F02:  MOVLW  01
0F03:  MOVWF  12
0F04:  MOVLB  00
0F05:  CALL   0CC
0F06:  RETURN
.................... }
.................... 
.................... void smf_init()
.................... {
....................    //Flash smf = {SPI_1, MT25QL01GBBB, SPI1_CS};
.................... }
.................... 
.................... void write_misf_address_area()
.................... {
....................     //fprintf(PC, "Write MISF Address Area (Big Endian)\r\n");
....................     unsigned int8 writedata[PACKET_SIZE] = {0x00}; // Initialize write data buffer
*
14AC:  MOVLB  0E
14AD:  CLRF   4D
14AE:  CLRF   4E
14AF:  CLRF   4F
14B0:  CLRF   50
14B1:  CLRF   51
14B2:  CLRF   52
14B3:  CLRF   53
14B4:  CLRF   54
14B5:  CLRF   55
14B6:  CLRF   56
14B7:  CLRF   57
14B8:  CLRF   58
14B9:  CLRF   59
14BA:  CLRF   5A
14BB:  CLRF   5B
14BC:  CLRF   5C
14BD:  CLRF   5D
14BE:  CLRF   5E
14BF:  CLRF   5F
14C0:  CLRF   60
14C1:  CLRF   61
14C2:  CLRF   62
14C3:  CLRF   63
14C4:  CLRF   64
14C5:  CLRF   65
14C6:  CLRF   66
14C7:  CLRF   67
14C8:  CLRF   68
14C9:  CLRF   69
14CA:  CLRF   6A
14CB:  CLRF   6B
14CC:  CLRF   6C
14CD:  CLRF   6D
14CE:  CLRF   6E
14CF:  CLRF   6F
14D0:  MOVLB  0F
14D1:  CLRF   20
14D2:  CLRF   21
14D3:  CLRF   22
14D4:  CLRF   23
14D5:  CLRF   24
14D6:  CLRF   25
14D7:  CLRF   26
14D8:  CLRF   27
14D9:  CLRF   28
14DA:  CLRF   29
14DB:  CLRF   2A
14DC:  CLRF   2B
14DD:  CLRF   2C
14DE:  CLRF   2D
14DF:  CLRF   2E
14E0:  CLRF   2F
14E1:  CLRF   30
14E2:  CLRF   31
14E3:  CLRF   32
14E4:  CLRF   33
14E5:  CLRF   34
14E6:  CLRF   35
14E7:  CLRF   36
14E8:  CLRF   37
14E9:  CLRF   38
14EA:  CLRF   39
14EB:  CLRF   3A
14EC:  CLRF   3B
14ED:  CLRF   3C
.................... 
....................     // 03: smf_piclog_use_counterMSBLSB
....................     writedata[0] = (smf_piclog_use_counter >> 24) & 0xFF;
14EE:  MOVLB  08
14EF:  MOVF   45,W
14F0:  MOVLB  0F
14F1:  MOVWF  3F
14F2:  CLRF   40
14F3:  CLRF   41
14F4:  CLRF   42
14F5:  MOVF   3F,W
14F6:  MOVLB  0E
14F7:  MOVWF  4D
....................     writedata[1] = (smf_piclog_use_counter >> 16) & 0xFF;
14F8:  MOVLB  08
14F9:  MOVF   44,W
14FA:  MOVLB  0F
14FB:  MOVWF  3F
14FC:  MOVLB  08
14FD:  MOVF   45,W
14FE:  MOVLB  0F
14FF:  MOVWF  40
1500:  CLRF   41
1501:  CLRF   42
1502:  MOVF   3F,W
1503:  MOVLB  0E
1504:  MOVWF  4E
....................     writedata[2] = (smf_piclog_use_counter >> 8) & 0xFF;
1505:  MOVLB  08
1506:  MOVF   43,W
1507:  MOVLB  0F
1508:  MOVWF  3F
1509:  MOVLB  08
150A:  MOVF   44,W
150B:  MOVLB  0F
150C:  MOVWF  40
150D:  MOVLB  08
150E:  MOVF   45,W
150F:  MOVLB  0F
1510:  MOVWF  41
1511:  CLRF   42
1512:  MOVF   3F,W
1513:  MOVLB  0E
1514:  MOVWF  4F
....................     writedata[3] = smf_piclog_use_counter & 0xFF;
1515:  MOVLB  08
1516:  MOVF   42,W
1517:  MOVLB  0E
1518:  MOVWF  50
.................... 
....................     // 4: smf_piclog_loop_counter
....................     writedata[4] = smf_piclog_loop_counter;
1519:  MOVF   71,W
151A:  MOVWF  51
.................... 
....................     // 58: smf_meas_use_counterMSBLSB
....................     writedata[5] = (smf_meas_use_counter >> 24) & 0xFF;
151B:  MOVLB  08
151C:  MOVF   49,W
151D:  MOVLB  0F
151E:  MOVWF  3F
151F:  CLRF   40
1520:  CLRF   41
1521:  CLRF   42
1522:  MOVF   3F,W
1523:  MOVLB  0E
1524:  MOVWF  52
....................     writedata[6] = (smf_meas_use_counter >> 16) & 0xFF;
1525:  MOVLB  08
1526:  MOVF   48,W
1527:  MOVLB  0F
1528:  MOVWF  3F
1529:  MOVLB  08
152A:  MOVF   49,W
152B:  MOVLB  0F
152C:  MOVWF  40
152D:  CLRF   41
152E:  CLRF   42
152F:  MOVF   3F,W
1530:  MOVLB  0E
1531:  MOVWF  53
....................     writedata[7] = (smf_meas_use_counter >> 8) & 0xFF;
1532:  MOVLB  08
1533:  MOVF   47,W
1534:  MOVLB  0F
1535:  MOVWF  3F
1536:  MOVLB  08
1537:  MOVF   48,W
1538:  MOVLB  0F
1539:  MOVWF  40
153A:  MOVLB  08
153B:  MOVF   49,W
153C:  MOVLB  0F
153D:  MOVWF  41
153E:  CLRF   42
153F:  MOVF   3F,W
1540:  MOVLB  0E
1541:  MOVWF  54
....................     writedata[8] = smf_meas_use_counter & 0xFF;
1542:  MOVLB  08
1543:  MOVF   46,W
1544:  MOVLB  0E
1545:  MOVWF  55
.................... 
....................     // 9: smf_meas_loop_counter
....................     writedata[9] = smf_meas_loop_counter;
1546:  MOVF   72,W
1547:  MOVWF  56
.................... 
....................     // 1013: misf_piclog_use_counterMSBLSB
....................     writedata[10] = (misf_piclog_use_counter >> 24) & 0xFF;
1548:  MOVLB  08
1549:  MOVF   4D,W
154A:  MOVLB  0F
154B:  MOVWF  3F
154C:  CLRF   40
154D:  CLRF   41
154E:  CLRF   42
154F:  MOVF   3F,W
1550:  MOVLB  0E
1551:  MOVWF  57
....................     writedata[11] = (misf_piclog_use_counter >> 16) & 0xFF;
1552:  MOVLB  08
1553:  MOVF   4C,W
1554:  MOVLB  0F
1555:  MOVWF  3F
1556:  MOVLB  08
1557:  MOVF   4D,W
1558:  MOVLB  0F
1559:  MOVWF  40
155A:  CLRF   41
155B:  CLRF   42
155C:  MOVF   3F,W
155D:  MOVLB  0E
155E:  MOVWF  58
....................     writedata[12] = (misf_piclog_use_counter >> 8) & 0xFF;
155F:  MOVLB  08
1560:  MOVF   4B,W
1561:  MOVLB  0F
1562:  MOVWF  3F
1563:  MOVLB  08
1564:  MOVF   4C,W
1565:  MOVLB  0F
1566:  MOVWF  40
1567:  MOVLB  08
1568:  MOVF   4D,W
1569:  MOVLB  0F
156A:  MOVWF  41
156B:  CLRF   42
156C:  MOVF   3F,W
156D:  MOVLB  0E
156E:  MOVWF  59
....................     writedata[13] = misf_piclog_use_counter & 0xFF;
156F:  MOVLB  08
1570:  MOVF   4A,W
1571:  MOVLB  0E
1572:  MOVWF  5A
.................... 
....................     // 14: misf_piclog_loop_counter
....................     writedata[14] = misf_piclog_loop_counter;
1573:  MOVF   73,W
1574:  MOVWF  5B
.................... 
....................     // 1518: misf_piclog_uncopyed_counterMSBLSB
....................     writedata[15] = (misf_piclog_uncopyed_counter >> 24) & 0xFF;
1575:  MOVLB  08
1576:  MOVF   51,W
1577:  MOVLB  0F
1578:  MOVWF  3F
1579:  CLRF   40
157A:  CLRF   41
157B:  CLRF   42
157C:  MOVF   3F,W
157D:  MOVLB  0E
157E:  MOVWF  5C
....................     writedata[16] = (misf_piclog_uncopyed_counter >> 16) & 0xFF;
157F:  MOVLB  08
1580:  MOVF   50,W
1581:  MOVLB  0F
1582:  MOVWF  3F
1583:  MOVLB  08
1584:  MOVF   51,W
1585:  MOVLB  0F
1586:  MOVWF  40
1587:  CLRF   41
1588:  CLRF   42
1589:  MOVF   3F,W
158A:  MOVLB  0E
158B:  MOVWF  5D
....................     writedata[17] = (misf_piclog_uncopyed_counter >> 8) & 0xFF;
158C:  MOVLB  08
158D:  MOVF   4F,W
158E:  MOVLB  0F
158F:  MOVWF  3F
1590:  MOVLB  08
1591:  MOVF   50,W
1592:  MOVLB  0F
1593:  MOVWF  40
1594:  MOVLB  08
1595:  MOVF   51,W
1596:  MOVLB  0F
1597:  MOVWF  41
1598:  CLRF   42
1599:  MOVF   3F,W
159A:  MOVLB  0E
159B:  MOVWF  5E
....................     writedata[18] = misf_piclog_uncopyed_counter & 0xFF;
159C:  MOVLB  08
159D:  MOVF   4E,W
159E:  MOVLB  0E
159F:  MOVWF  5F
.................... 
....................     // 1922: misf_piclog_write_counterMSBLSB
....................     writedata[19] = (misf_piclog_write_counter >> 24) & 0xFF;
15A0:  MOVLW  00
15A1:  MOVWF  60
....................     writedata[20] = (misf_piclog_write_counter >> 16) & 0xFF;
15A2:  MOVWF  61
....................     writedata[21] = (misf_piclog_write_counter >> 8) & 0xFF;
15A3:  MOVWF  62
....................     writedata[22] = misf_piclog_write_counter & 0xFF;
15A4:  MOVF   74,W
15A5:  MOVWF  63
.................... 
....................     // 2326: misf_meas_use_counterMSBLSB
....................     writedata[23] = (misf_meas_use_counter >> 24) & 0xFF;
15A6:  MOVLB  08
15A7:  MOVF   55,W
15A8:  MOVLB  0F
15A9:  MOVWF  3F
15AA:  CLRF   40
15AB:  CLRF   41
15AC:  CLRF   42
15AD:  MOVF   3F,W
15AE:  MOVLB  0E
15AF:  MOVWF  64
....................     writedata[24] = (misf_meas_use_counter >> 16) & 0xFF;
15B0:  MOVLB  08
15B1:  MOVF   54,W
15B2:  MOVLB  0F
15B3:  MOVWF  3F
15B4:  MOVLB  08
15B5:  MOVF   55,W
15B6:  MOVLB  0F
15B7:  MOVWF  40
15B8:  CLRF   41
15B9:  CLRF   42
15BA:  MOVF   3F,W
15BB:  MOVLB  0E
15BC:  MOVWF  65
....................     writedata[25] = (misf_meas_use_counter >> 8) & 0xFF;
15BD:  MOVLB  08
15BE:  MOVF   53,W
15BF:  MOVLB  0F
15C0:  MOVWF  3F
15C1:  MOVLB  08
15C2:  MOVF   54,W
15C3:  MOVLB  0F
15C4:  MOVWF  40
15C5:  MOVLB  08
15C6:  MOVF   55,W
15C7:  MOVLB  0F
15C8:  MOVWF  41
15C9:  CLRF   42
15CA:  MOVF   3F,W
15CB:  MOVLB  0E
15CC:  MOVWF  66
....................     writedata[26] = misf_meas_use_counter & 0xFF;
15CD:  MOVLB  08
15CE:  MOVF   52,W
15CF:  MOVLB  0E
15D0:  MOVWF  67
.................... 
....................     // 27: misf_meas_loop_counter
....................     writedata[27] = misf_meas_loop_counter;
15D1:  MOVF   75,W
15D2:  MOVWF  68
.................... 
....................     // 2831: misf_meas_uncopyed_counterMSBLSB
....................     writedata[28] = (misf_meas_uncopyed_counter >> 24) & 0xFF;
15D3:  MOVLB  08
15D4:  MOVF   59,W
15D5:  MOVLB  0F
15D6:  MOVWF  3F
15D7:  CLRF   40
15D8:  CLRF   41
15D9:  CLRF   42
15DA:  MOVF   3F,W
15DB:  MOVLB  0E
15DC:  MOVWF  69
....................     writedata[29] = (misf_meas_uncopyed_counter >> 16) & 0xFF;
15DD:  MOVLB  08
15DE:  MOVF   58,W
15DF:  MOVLB  0F
15E0:  MOVWF  3F
15E1:  MOVLB  08
15E2:  MOVF   59,W
15E3:  MOVLB  0F
15E4:  MOVWF  40
15E5:  CLRF   41
15E6:  CLRF   42
15E7:  MOVF   3F,W
15E8:  MOVLB  0E
15E9:  MOVWF  6A
....................     writedata[30] = (misf_meas_uncopyed_counter >> 8) & 0xFF;
15EA:  MOVLB  08
15EB:  MOVF   57,W
15EC:  MOVLB  0F
15ED:  MOVWF  3F
15EE:  MOVLB  08
15EF:  MOVF   58,W
15F0:  MOVLB  0F
15F1:  MOVWF  40
15F2:  MOVLB  08
15F3:  MOVF   59,W
15F4:  MOVLB  0F
15F5:  MOVWF  41
15F6:  CLRF   42
15F7:  MOVF   3F,W
15F8:  MOVLB  0E
15F9:  MOVWF  6B
....................     writedata[31] = misf_meas_uncopyed_counter & 0xFF;
15FA:  MOVLB  08
15FB:  MOVF   56,W
15FC:  MOVLB  0E
15FD:  MOVWF  6C
.................... 
....................     if (!is_connect(mis_fm)) {
15FE:  MOVLB  08
15FF:  MOVF   5D,W
1600:  MOVLB  0F
1601:  MOVWF  41
1602:  MOVLB  08
1603:  MOVF   5C,W
1604:  MOVLB  0F
1605:  MOVWF  40
1606:  MOVLB  08
1607:  MOVF   5B,W
1608:  MOVLB  0F
1609:  MOVWF  3F
160A:  MOVLB  08
160B:  MOVF   5A,W
160C:  MOVLB  0F
160D:  MOVWF  3E
160E:  MOVLP  08
160F:  MOVLB  00
1610:  CALL   2D3
1611:  MOVLP  10
1612:  MOVF   78,F
1613:  BTFSS  03.2
1614:  GOTO   61F
....................         fprintf(PC, "Mission Flash is not connected\r\n");
1615:  MOVLW  9A
1616:  MOVLB  03
1617:  MOVWF  11
1618:  MOVLW  01
1619:  MOVWF  12
161A:  MOVLP  08
161B:  MOVLB  00
161C:  CALL   0CC
161D:  MOVLP  10
....................         return;
161E:  GOTO   652
....................     }
....................     subsector_4kByte_erase(mis_fm, ADDRESS_MANEGE_START); // 4KB
161F:  MOVLB  08
1620:  MOVF   5D,W
1621:  MOVLB  0F
1622:  MOVWF  41
1623:  MOVLB  08
1624:  MOVF   5C,W
1625:  MOVLB  0F
1626:  MOVWF  40
1627:  MOVLB  08
1628:  MOVF   5B,W
1629:  MOVLB  0F
162A:  MOVWF  3F
162B:  MOVLB  08
162C:  MOVF   5A,W
162D:  MOVLB  0F
162E:  MOVWF  3E
162F:  CLRF   45
1630:  CLRF   44
1631:  CLRF   43
1632:  CLRF   42
1633:  MOVLB  00
1634:  CALL   23B
....................     // Flash 
....................     write_data_bytes(mis_fm, ADDRESS_MANEGE_START, writedata, PACKET_SIZE);
1635:  MOVLB  08
1636:  MOVF   5D,W
1637:  MOVLB  0F
1638:  MOVWF  41
1639:  MOVLB  08
163A:  MOVF   5C,W
163B:  MOVLB  0F
163C:  MOVWF  40
163D:  MOVLB  08
163E:  MOVF   5B,W
163F:  MOVLB  0F
1640:  MOVWF  3F
1641:  MOVLB  08
1642:  MOVF   5A,W
1643:  MOVLB  0F
1644:  MOVWF  3E
1645:  CLRF   45
1646:  CLRF   44
1647:  CLRF   43
1648:  CLRF   42
1649:  MOVLW  24
164A:  MOVWF  47
164B:  MOVLW  8D
164C:  MOVWF  46
164D:  CLRF   49
164E:  MOVLW  40
164F:  MOVWF  48
1650:  MOVLB  00
1651:  CALL   0A5
.................... }
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #endif // MMJ_CIGS_FLASH_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... #define PICLOG_DEBUG
.................... 
.................... void piclog_make(unsigned int8 function, unsigned int8 parameter)
*
13AF:  MOVF   7A,W
13B0:  MOVLB  0E
13B1:  MOVWF  47
13B2:  MOVF   79,W
13B3:  MOVWF  46
13B4:  MOVF   78,W
13B5:  MOVWF  45
13B6:  MOVF   77,W
13B7:  MOVWF  44
.................... {
....................     unsigned int8 piclog[PICLOG_PACKET_SIZE];
....................     int32 time = get_current_sec();
....................     piclog[0] = (time >> 24) & 0xFF; // Time high byte
13B8:  CLRF   4F
13B9:  CLRF   50
13BA:  CLRF   51
13BB:  MOVF   47,W
13BC:  MOVWF  3E
....................     piclog[1] = (time >> 16) & 0xFF;
13BD:  CLRF   50
13BE:  CLRF   51
13BF:  MOVF   46,W
13C0:  MOVWF  3F
....................     piclog[2] = (time >> 8) & 0xFF;  // Time middle byte
13C1:  CLRF   51
13C2:  MOVF   45,W
13C3:  MOVWF  40
....................     piclog[3] = time & 0xFF;         // Time low byte
13C4:  MOVF   44,W
13C5:  MOVWF  41
....................     piclog[4] = function;            // Function code
13C6:  MOVF   3C,W
13C7:  MOVWF  42
....................     piclog[5] = parameter;           // Parameter code
13C8:  MOVF   3D,W
13C9:  MOVWF  43
.................... 
....................     #ifdef PICLOG_DEBUG
....................         fprintf(PC, "[PICLOG] : ");
13CA:  MOVLW  AB
13CB:  MOVLB  03
13CC:  MOVWF  11
13CD:  MOVLW  01
13CE:  MOVWF  12
13CF:  MOVLP  08
13D0:  MOVLB  00
13D1:  CALL   0CC
13D2:  MOVLP  10
....................         for (unsigned int8 i = 0; i < PICLOG_PACKET_SIZE; i++) {
13D3:  MOVLB  0E
13D4:  CLRF   48
13D5:  MOVF   48,W
13D6:  SUBLW  05
13D7:  BTFSS  03.0
13D8:  GOTO   3F3
....................             fprintf(PC, "%02X ", piclog[i]);
13D9:  MOVLW  7E
13DA:  ADDWF  48,W
13DB:  MOVWF  04
13DC:  MOVLW  24
13DD:  MOVWF  05
13DE:  BTFSC  03.0
13DF:  INCF   05,F
13E0:  MOVF   00,W
13E1:  MOVWF  4D
13E2:  MOVWF  4E
13E3:  MOVLW  37
13E4:  MOVWF  4F
13E5:  MOVLP  08
13E6:  MOVLB  00
13E7:  CALL   470
13E8:  MOVLP  10
13E9:  MOVLW  20
13EA:  MOVLB  0F
13EB:  MOVWF  43
13EC:  MOVLP  08
13ED:  MOVLB  00
13EE:  CALL   0A7
13EF:  MOVLP  10
13F0:  MOVLB  0E
13F1:  INCF   48,F
13F2:  GOTO   3D5
....................         }
....................         fprintf(PC, "\r\n");
13F3:  MOVLW  0D
13F4:  MOVLB  0F
13F5:  MOVWF  43
13F6:  MOVLP  08
13F7:  MOVLB  00
13F8:  CALL   0A7
13F9:  MOVLP  10
13FA:  MOVLW  0A
13FB:  MOVLB  0F
13FC:  MOVWF  43
13FD:  MOVLP  08
13FE:  MOVLB  00
13FF:  CALL   0A7
1400:  MOVLP  10
....................     #endif
.................... 
....................     unsigned int32 write_address = ADDRESS_MISF_PICLOG_DATA_START + misf_piclog_use_counter;
1401:  MOVLB  08
1402:  MOVF   4A,W
1403:  MOVLB  0E
1404:  MOVWF  49
1405:  MOVLB  08
1406:  MOVF   4B,W
1407:  MOVLB  0E
1408:  MOVWF  4A
1409:  MOVLW  02
140A:  MOVLB  08
140B:  ADDWF  4C,W
140C:  MOVLB  0E
140D:  MOVWF  4B
140E:  MOVLW  00
140F:  MOVLB  08
1410:  ADDWFC 4D,W
1411:  MOVLB  0E
1412:  MOVWF  4C
....................     //fprintf(PC, "Write PICLOG to address: 0x%08LX\r\n", write_address);
....................     
....................     if(is_connect(mis_fm) == FALSE) {
1413:  MOVLB  08
1414:  MOVF   5D,W
1415:  MOVLB  0F
1416:  MOVWF  41
1417:  MOVLB  08
1418:  MOVF   5C,W
1419:  MOVLB  0F
141A:  MOVWF  40
141B:  MOVLB  08
141C:  MOVF   5B,W
141D:  MOVLB  0F
141E:  MOVWF  3F
141F:  MOVLB  08
1420:  MOVF   5A,W
1421:  MOVLB  0F
1422:  MOVWF  3E
1423:  MOVLP  08
1424:  MOVLB  00
1425:  CALL   2D3
1426:  MOVLP  10
1427:  MOVF   78,F
1428:  BTFSS  03.2
1429:  GOTO   434
....................         fprintf(PC, "Mission Flash is not connected\r\n");
142A:  MOVLW  B1
142B:  MOVLB  03
142C:  MOVWF  11
142D:  MOVLW  01
142E:  MOVWF  12
142F:  MOVLP  08
1430:  MOVLB  00
1431:  CALL   0CC
1432:  MOVLP  10
....................         return;
1433:  GOTO   652
....................     }
....................     
....................     write_data_bytes(mis_fm, write_address, piclog, PICLOG_PACKET_SIZE);
1434:  MOVLB  08
1435:  MOVF   5D,W
1436:  MOVLB  0F
1437:  MOVWF  41
1438:  MOVLB  08
1439:  MOVF   5C,W
143A:  MOVLB  0F
143B:  MOVWF  40
143C:  MOVLB  08
143D:  MOVF   5B,W
143E:  MOVLB  0F
143F:  MOVWF  3F
1440:  MOVLB  08
1441:  MOVF   5A,W
1442:  MOVLB  0F
1443:  MOVWF  3E
1444:  MOVLB  0E
1445:  MOVF   4C,W
1446:  MOVLB  0F
1447:  MOVWF  45
1448:  MOVLB  0E
1449:  MOVF   4B,W
144A:  MOVLB  0F
144B:  MOVWF  44
144C:  MOVLB  0E
144D:  MOVF   4A,W
144E:  MOVLB  0F
144F:  MOVWF  43
1450:  MOVLB  0E
1451:  MOVF   49,W
1452:  MOVLB  0F
1453:  MOVWF  42
1454:  MOVLW  24
1455:  MOVWF  47
1456:  MOVLW  7E
1457:  MOVWF  46
1458:  CLRF   49
1459:  MOVLW  06
145A:  MOVWF  48
145B:  MOVLB  00
145C:  CALL   0A5
....................     
....................     // Update the counters
....................     misf_piclog_use_counter += PICLOG_PACKET_SIZE;
145D:  MOVLW  06
145E:  MOVLB  08
145F:  ADDWF  4A,F
1460:  MOVLW  00
1461:  ADDWFC 4B,F
1462:  ADDWFC 4C,F
1463:  ADDWFC 4D,F
....................     misf_piclog_uncopyed_counter += PICLOG_PACKET_SIZE;
1464:  MOVLW  06
1465:  ADDWF  4E,F
1466:  MOVLW  00
1467:  ADDWFC 4F,F
1468:  ADDWFC 50,F
1469:  ADDWFC 51,F
....................     misf_piclog_write_counter += PICLOG_PACKET_SIZE;
146A:  MOVLW  06
146B:  ADDWF  74,F
.................... 
....................     // Next Packet
....................     if (misf_piclog_write_counter + PICLOG_PACKET_SIZE >=  PACKET_SIZE) {
146C:  ADDWF  74,W
146D:  SUBLW  3F
146E:  BTFSC  03.0
146F:  GOTO   4AC
....................         write_address = ADDRESS_MISF_PICLOG_DATA_START + misf_piclog_use_counter;
1470:  MOVF   4A,W
1471:  MOVLB  0E
1472:  MOVWF  49
1473:  MOVLB  08
1474:  MOVF   4B,W
1475:  MOVLB  0E
1476:  MOVWF  4A
1477:  MOVLW  02
1478:  MOVLB  08
1479:  ADDWF  4C,W
147A:  MOVLB  0E
147B:  MOVWF  4B
147C:  MOVLW  00
147D:  MOVLB  08
147E:  ADDWFC 4D,W
147F:  MOVLB  0E
1480:  MOVWF  4C
....................         write_data_bytes(mis_fm, write_address, PICLOG_BLANK_DATA, PICLOG_PACKET_SIZE);
1481:  MOVLB  08
1482:  MOVF   5D,W
1483:  MOVLB  0F
1484:  MOVWF  41
1485:  MOVLB  08
1486:  MOVF   5C,W
1487:  MOVLB  0F
1488:  MOVWF  40
1489:  MOVLB  08
148A:  MOVF   5B,W
148B:  MOVLB  0F
148C:  MOVWF  3F
148D:  MOVLB  08
148E:  MOVF   5A,W
148F:  MOVLB  0F
1490:  MOVWF  3E
1491:  MOVLB  0E
1492:  MOVF   4C,W
1493:  MOVLB  0F
1494:  MOVWF  45
1495:  MOVLB  0E
1496:  MOVF   4B,W
1497:  MOVLB  0F
1498:  MOVWF  44
1499:  MOVLB  0E
149A:  MOVF   4A,W
149B:  MOVLB  0F
149C:  MOVWF  43
149D:  MOVLB  0E
149E:  MOVF   49,W
149F:  MOVLB  0F
14A0:  MOVWF  42
14A1:  MOVLW  22
14A2:  MOVWF  47
14A3:  MOVLW  9E
14A4:  MOVWF  46
14A5:  CLRF   49
14A6:  MOVLW  06
14A7:  MOVWF  48
14A8:  MOVLB  00
14A9:  CALL   0A5
....................         misf_piclog_write_counter = 0;
14AA:  CLRF   74
14AB:  MOVLB  08
....................     }
.................... 
.................... 
....................     write_misf_address_area(); // Update the address area after writing
....................     
....................     /*
....................     // Add CRC Check
....................     if (misf_piclog_write_counter >= MISF_PICLOG_MAX_COUNT) {
....................         write_address = ADDRESS_MISF_PICLOG_DATA_START + misf_piclog_use_counter;
....................         write_data_bytes(mis_fm, write_address, *PICLOG_BLANK_DATA, PICLOG_BLANK_SIZE);
....................         unsigned int8 piclog_data_header[PICLOG_BLANK_SIZE] = {0x00, 0x00, 0x00}; // Initialize blank data
....................         misf_piclog_write_counter = 0; // Reset if max count reached
....................     }
....................     */
....................     #ifdef PICLOG_DEBUG
....................         //fprintf(PC, "PICLOG written: %02X %02X %02X %02X %02X %02X\r\n", piclog_data.bytes[0], data[1], data[2], data[3], data[4], data[5]);
....................     #endif
*
1652:  RETURN
.................... }
.................... 
.................... 
.................... #endif // MMJ_CIGS_PICLOG_H
.................... //------------------End of File------------------
.................... 
.................... #include "../../lib/ad7490.h"
.................... #ifndef     AD7490_H
.................... #define     AD7490_H
.................... 
.................... #ifdef AD7490_DEBUG
....................    #define DEBUG_PORT PC
.................... #endif
.................... 
.................... typedef struct AD7490_STREAM
.................... {
....................     int8 spi_stream; // SPI stream number
....................     int16 cs_pin;    // Chip Select pin number
.................... };
.................... //0x8B30
.................... 
.................... 
.................... 
.................... typedef union AD7490_RESISTOR
.................... {
....................     unsigned int16 value; // 16-bit value for direct access
....................     struct fields
....................     {
....................         unsigned int blank3 :1 ; // bit 0 (LSB)
....................         unsigned int blank2 :1   ; // bit 1
....................         unsigned int blank1 :1   ; // bit 2
....................         unsigned int blank0 :1   ; // bit 3
....................         unsigned int coding:1       ; // bit 12
....................         unsigned int range   :1    ; // bit 5
....................         unsigned int weak_tri:1     ; // bit 4
....................         unsigned int shadow:1   ; // bit 13
....................         unsigned int write:1    ; // bit 15 (MSB)
....................         unsigned int seq :1     ; // bit 14
....................         unsigned int add3 :1    ; // bit 11
....................         unsigned int add2  :1   ; // bit 10
....................         unsigned int add1   :1  ; // bit 9
....................         unsigned int add0    :1 ; // bit 8
....................         unsigned int pm1    :1  ; // bit 7
....................         unsigned int pm0     :1 ; // bit 6
....................     } fields;
.................... } AD7490_RESISTOR;
.................... 
.................... unsigned int8 coding; // 1: Two's complement, 0: Binary
.................... unsigned int8 write;  // 1: Write operation, 0: Read operation
.................... unsigned int8 seq;    // 1: Sequential mode, 0: Random mode
.................... unsigned int8 range; // 1: Range mode, 0: Normal mode
.................... unsigned int8 weak_tri; // 1: Weak trigger, 0: Strong trigger
.................... unsigned int8 shadow; // 1: Shadow register, 0: Direct access
.................... unsigned int16 ad7490_readdata(unsigned int16 channel);
.................... //AD7490_RESISTOR reg;
.................... 
.................... AD7490_RESISTOR reg = {0}; // Initialize the AD7490_RESISTOR union
.................... 
.................... // Public Function 
.................... void ad7490_init(void);
.................... unsigned int16 ad7490_read(int8 channel);
.................... 
.................... unsigned int16 ad7490_make_cmd(int8 channel);
.................... 
.................... // Private Functions
.................... void set_add(int8 channel);
.................... void set_pm(int8 powermode);
.................... void print_bits(unsigned int16 data);
.................... // Resistor Settings
.................... #define AD7490_EN_WRITE 0b1
.................... 
.................... // Power Mode Register
.................... #define AD7490_PM_NORMAL 0b00000000
.................... #define AD7490_PM_SHUTDOWN 0b00000001
.................... #define AD7490_PM_AUTO_SHUTDOWN 0b00000010
.................... #define AD7490_PM_AUTO_STANDBY 0b00000011
.................... 
.................... 
.................... // ADC Channel Register
.................... #define AD7490_VIN0 0b0000
.................... #define AD7490_VIN1 0b0001
.................... #define AD7490_VIN2 0b0010
.................... #define AD7490_VIN3 0b0011
.................... #define AD7490_VIN4 0b0100
.................... #define AD7490_VIN5 0b0101
.................... #define AD7490_VIN6 0b0110
.................... #define AD7490_VIN7 0b0111
.................... #define AD7490_VIN8 0b1000
.................... #define AD7490_VIN9 0b1001
.................... #define AD7490_VIN10 0b1010
.................... #define AD7490_VIN11 0b1011
.................... #define AD7490_VIN12 0b1100
.................... #define AD7490_VIN13 0b1101
.................... #define AD7490_VIN14 0b1110
.................... #define AD7490_VIN15 0b1111
.................... 
.................... 
.................... #include "src/ad7490.c"
.................... #include "../ad7490.h"
.................... #ifndef     AD7490_H
.................... #define     AD7490_H
.................... 
.................... #ifdef AD7490_DEBUG
....................    #define DEBUG_PORT PC
.................... #endif
.................... 
.................... typedef struct AD7490_STREAM
.................... {
....................     int8 spi_stream; // SPI stream number
....................     int16 cs_pin;    // Chip Select pin number
.................... };
.................... //0x8B30
.................... 
.................... 
.................... 
.................... typedef union AD7490_RESISTOR
.................... {
....................     unsigned int16 value; // 16-bit value for direct access
....................     struct fields
....................     {
....................         unsigned int blank3 :1 ; // bit 0 (LSB)
....................         unsigned int blank2 :1   ; // bit 1
....................         unsigned int blank1 :1   ; // bit 2
....................         unsigned int blank0 :1   ; // bit 3
....................         unsigned int coding:1       ; // bit 12
....................         unsigned int range   :1    ; // bit 5
....................         unsigned int weak_tri:1     ; // bit 4
....................         unsigned int shadow:1   ; // bit 13
....................         unsigned int write:1    ; // bit 15 (MSB)
....................         unsigned int seq :1     ; // bit 14
....................         unsigned int add3 :1    ; // bit 11
....................         unsigned int add2  :1   ; // bit 10
....................         unsigned int add1   :1  ; // bit 9
....................         unsigned int add0    :1 ; // bit 8
....................         unsigned int pm1    :1  ; // bit 7
....................         unsigned int pm0     :1 ; // bit 6
....................     } fields;
.................... } AD7490_RESISTOR;
.................... 
.................... unsigned int8 coding; // 1: Two's complement, 0: Binary
.................... unsigned int8 write;  // 1: Write operation, 0: Read operation
.................... unsigned int8 seq;    // 1: Sequential mode, 0: Random mode
.................... unsigned int8 range; // 1: Range mode, 0: Normal mode
.................... unsigned int8 weak_tri; // 1: Weak trigger, 0: Strong trigger
.................... unsigned int8 shadow; // 1: Shadow register, 0: Direct access
.................... unsigned int16 ad7490_readdata(unsigned int16 channel);
.................... //AD7490_RESISTOR reg;
.................... 
.................... AD7490_RESISTOR reg = {0}; // Initialize the AD7490_RESISTOR union
.................... 
.................... // Public Function 
.................... void ad7490_init(void);
.................... unsigned int16 ad7490_read(int8 channel);
.................... 
.................... unsigned int16 ad7490_make_cmd(int8 channel);
.................... 
.................... // Private Functions
.................... void set_add(int8 channel);
.................... void set_pm(int8 powermode);
.................... void print_bits(unsigned int16 data);
.................... // Resistor Settings
.................... #define AD7490_EN_WRITE 0b1
.................... 
.................... // Power Mode Register
.................... #define AD7490_PM_NORMAL 0b00000000
.................... #define AD7490_PM_SHUTDOWN 0b00000001
.................... #define AD7490_PM_AUTO_SHUTDOWN 0b00000010
.................... #define AD7490_PM_AUTO_STANDBY 0b00000011
.................... 
.................... 
.................... // ADC Channel Register
.................... #define AD7490_VIN0 0b0000
.................... #define AD7490_VIN1 0b0001
.................... #define AD7490_VIN2 0b0010
.................... #define AD7490_VIN3 0b0011
.................... #define AD7490_VIN4 0b0100
.................... #define AD7490_VIN5 0b0101
.................... #define AD7490_VIN6 0b0110
.................... #define AD7490_VIN7 0b0111
.................... #define AD7490_VIN8 0b1000
.................... #define AD7490_VIN9 0b1001
.................... #define AD7490_VIN10 0b1010
.................... #define AD7490_VIN11 0b1011
.................... #define AD7490_VIN12 0b1100
.................... #define AD7490_VIN13 0b1101
.................... #define AD7490_VIN14 0b1110
.................... #define AD7490_VIN15 0b1111
.................... 
.................... 
.................... #include "src/ad7490.c"
.................... 
.................... #endif // AD7490_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... 
.................... 
.................... //#define AD7490_DEBUG
.................... 
.................... unsigned int16 ad7490_readdata(unsigned int16 channel)
.................... {
....................     //output_low(ADC_CS); // Set CS pin low to select the ADC
....................     spi_xfer(ADC_STREAM, channel); // Dummy transfer to start communication
*
1770:  MOVLB  04
1771:  BCF    15.5
1772:  MOVLW  40
1773:  MOVWF  14
1774:  MOVLW  FF
1775:  MOVWF  12
1776:  MOVLW  3A
1777:  MOVWF  15
1778:  MOVLB  0B
1779:  MOVF   2B,W
177A:  MOVWF  38
177B:  MOVF   2A,W
177C:  MOVWF  37
177D:  MOVLB  00
177E:  CALL   751
....................     //output_high(ADC_CS); // Set CS pin high to end communication
....................     #ifdef AD7490_DEBUG
....................         fprintf(PC, "\t[ADC] << %04LX\r\n", channel);
....................     #endif
....................     //output_high(ADC_CS); // Set CS pin high to end communication
....................     //delay_us(10); // Wait for the ADC to process the command
....................     //output_low(ADC_CS); // Set CS pin low to select the ADC again
....................     unsigned int16 ans = spi_xfer(ADC_STREAM);
177F:  MOVLB  04
1780:  BCF    15.5
1781:  MOVLW  40
1782:  MOVWF  14
1783:  MOVLW  FF
1784:  MOVWF  12
1785:  MOVLW  3A
1786:  MOVWF  15
1787:  MOVLB  0B
1788:  CLRF   38
1789:  MOVLW  03
178A:  MOVWF  37
178B:  MOVLB  00
178C:  CALL   751
178D:  MOVF   78,W
178E:  MOVLB  0B
178F:  MOVWF  2D
1790:  MOVF   77,W
1791:  MOVWF  2C
....................     //output_high(ADC_CS); // Set CS pin low to select the ADC again
....................     return ans & 0x0FFF; //Conver LSB <--> MSB
1792:  MOVF   2C,W
1793:  MOVWF  77
1794:  MOVF   2D,W
1795:  ANDLW  0F
1796:  MOVWF  7A
1797:  MOVF   2C,W
1798:  MOVWF  78
1799:  MOVF   7A,W
179A:  MOVWF  79
179B:  MOVLB  00
179C:  RETURN
.................... }
.................... 
.................... 
.................... 
.................... void ad7490_init()
.................... {  
....................     fprintf(PC, "AD7490 Initialize\r\n");
*
098B:  MOVLW  C2
098C:  MOVLB  03
098D:  MOVWF  11
098E:  MOVLW  01
098F:  MOVWF  12
0990:  MOVLB  00
0991:  CALL   0CC
....................     // Set default register values
....................     reg.fields.coding = 1; // 1: Two's complement, 0: Binary
0992:  MOVLB  08
0993:  BSF    63.4
....................     reg.fields.write = 1;
0994:  BSF    64.0
....................     reg.fields.seq = 0; 
0995:  BCF    64.1
....................     reg.fields.range = 1;
0996:  BSF    63.5
....................     reg.fields.weak_tri = 0; // 1: Weak trigger, 0: Strong trigger
0997:  BCF    63.6
....................     reg.fields.shadow = 0; // 1: Shadow register, 0: Direct access
0998:  BCF    63.7
....................     coding = 1;
0999:  MOVLW  01
099A:  MOVWF  76
....................     write = 1;
099B:  MOVWF  7B
....................     seq = 0;
099C:  CLRF   7C
....................     range = 1;
099D:  MOVWF  7D
....................     weak_tri = 0;
099E:  CLRF   7E
....................     shadow = 0;
099F:  CLRF   62
....................     fprintf(PC, "\tComplete\r\n");
09A0:  MOVLW  CC
09A1:  MOVLB  03
09A2:  MOVWF  11
09A3:  MOVLW  01
09A4:  MOVWF  12
09A5:  MOVLB  00
09A6:  CALL   0CC
09A7:  MOVLP  38
09A8:  GOTO   4EC (RETURN)
.................... }
.................... 
.................... unsigned int16 ad7490_read(int8 channel)
.................... {   
....................     //AD7490_RESISTOR reg;
....................         reg.fields.coding = 1; // 1: Two's complement, 0: Binary
*
2800:  MOVLB  08
2801:  BSF    63.4
....................     reg.fields.write = 1;
2802:  BSF    64.0
....................     reg.fields.seq = 0; 
2803:  BCF    64.1
....................     reg.fields.range = 1;
2804:  BSF    63.5
....................     reg.fields.weak_tri = 0; // 1: Weak trigger, 0: Strong trigger
2805:  BCF    63.6
....................     reg.fields.shadow = 0; // 1: Shadow register, 0: Direct access
2806:  BCF    63.7
....................     set_add(channel);
2807:  MOVLB  0B
2808:  MOVF   30,W
2809:  MOVWF  37
....................     set_pm(AD7490_PM_AUTO_STANDBY); // Set power mode to normal
*
2835:  MOVLW  03
2836:  MOVLB  0B
2837:  MOVWF  37
.................... 
....................     unsigned int16 cmd = ad7490_make_cmd(channel);
*
2848:  MOVLB  0B
2849:  MOVF   30,W
284A:  MOVWF  37
*
2B2F:  MOVF   79,W
2B30:  MOVWF  32
2B31:  MOVF   78,W
2B32:  MOVWF  31
....................     
....................     output_low(ADC_CS); // Set CS pin low to select the ADC
2B33:  MOVLB  01
2B34:  BCF    0F.2
2B35:  MOVLB  02
2B36:  BCF    0F.2
....................     spi_xfer(ADC_STREAM, cmd); // Dummy transfer to start communication
2B37:  MOVLB  04
2B38:  BCF    15.5
2B39:  MOVLW  40
2B3A:  MOVWF  14
2B3B:  MOVLW  FF
2B3C:  MOVWF  12
2B3D:  MOVLW  3A
2B3E:  MOVWF  15
2B3F:  MOVLB  0B
2B40:  MOVF   32,W
2B41:  MOVWF  38
2B42:  MOVF   31,W
2B43:  MOVWF  37
2B44:  MOVLP  10
2B45:  MOVLB  00
2B46:  CALL   751
2B47:  MOVLP  28
....................     #ifdef AD7490_DEBUG
....................         //fprintf(PC, "AD7490 Read Channel: %d\r\n", channel);
....................         fprintf(PC,"\t[ADC] << %04LX\r\n", reg.value);
....................     #endif
....................     output_high(ADC_CS); // Set CS pin high to end communication
2B48:  MOVLB  01
2B49:  BCF    0F.2
2B4A:  MOVLB  02
2B4B:  BSF    0F.2
....................     delay_us(10); // Wait for the ADC to process the command
2B4C:  MOVLW  0D
2B4D:  MOVWF  77
2B4E:  DECFSZ 77,F
2B4F:  GOTO   34E
....................     output_low(ADC_CS); // Set CS pin low to select the ADC again
2B50:  MOVLB  01
2B51:  BCF    0F.2
2B52:  MOVLB  02
2B53:  BCF    0F.2
....................     unsigned int16 ans = spi_xfer(ADC_STREAM);
2B54:  MOVLB  04
2B55:  BCF    15.5
2B56:  MOVLW  40
2B57:  MOVWF  14
2B58:  MOVLW  FF
2B59:  MOVWF  12
2B5A:  MOVLW  3A
2B5B:  MOVWF  15
2B5C:  MOVLB  0B
2B5D:  CLRF   38
2B5E:  MOVLW  03
2B5F:  MOVWF  37
2B60:  MOVLP  10
2B61:  MOVLB  00
2B62:  CALL   751
2B63:  MOVLP  28
2B64:  MOVF   78,W
2B65:  MOVLB  0B
2B66:  MOVWF  34
2B67:  MOVF   77,W
2B68:  MOVWF  33
....................     output_high(ADC_CS); // Set CS pin high to end communication
2B69:  MOVLB  01
2B6A:  BCF    0F.2
2B6B:  MOVLB  02
2B6C:  BSF    0F.2
....................     unsigned int16 readdata = ans & 0x0FFF; //Conver LSB <--> MSB
2B6D:  MOVLB  0B
2B6E:  MOVF   33,W
2B6F:  MOVWF  35
2B70:  MOVF   34,W
2B71:  ANDLW  0F
2B72:  MOVWF  36
....................     //unsigned int16 readdata = 0;
....................     
....................     #ifdef AD7490_DEBUG
....................         fprintf(PC,"\t[ADC] >> %04LX\r\n", readdata);
....................     #endif
....................     return readdata;
2B73:  MOVF   35,W
2B74:  MOVWF  78
2B75:  MOVF   36,W
2B76:  MOVWF  79
2B77:  MOVLB  00
2B78:  RETURN
.................... }
.................... 
.................... void set_add(int8 channel)
.................... {
....................     reg.fields.add0 = (channel >> 0) & 0x1;
*
280A:  MOVF   37,W
280B:  ANDLW  01
280C:  MOVWF  78
280D:  MOVLB  08
280E:  BCF    64.5
280F:  BTFSC  78.0
2810:  BSF    64.5
....................     reg.fields.add1 = (channel >> 1) & 0x1;
2811:  BCF    03.0
2812:  MOVLB  0B
2813:  RRF    37,W
2814:  ANDLW  01
2815:  MOVWF  78
2816:  MOVLB  08
2817:  BCF    64.4
2818:  BTFSC  78.0
2819:  BSF    64.4
....................     reg.fields.add2 = (channel >> 2) & 0x1;
281A:  MOVLB  0B
281B:  RRF    37,W
281C:  MOVWF  77
281D:  RRF    77,F
281E:  MOVLW  3F
281F:  ANDWF  77,F
2820:  MOVF   77,W
2821:  ANDLW  01
2822:  MOVWF  78
2823:  MOVLB  08
2824:  BCF    64.3
2825:  BTFSC  78.0
2826:  BSF    64.3
....................     reg.fields.add3 = (channel >> 3) & 0x1;
2827:  MOVLB  0B
2828:  RRF    37,W
2829:  MOVWF  77
282A:  RRF    77,F
282B:  RRF    77,F
282C:  MOVLW  1F
282D:  ANDWF  77,F
282E:  MOVF   77,W
282F:  ANDLW  01
2830:  MOVWF  78
2831:  MOVLB  08
2832:  BCF    64.2
2833:  BTFSC  78.0
2834:  BSF    64.2
.................... }
.................... 
.................... void set_pm(int8 powermode)
.................... {
....................     reg.fields.pm0 = (powermode >> 0) & 0x1;
*
2838:  MOVF   37,W
2839:  ANDLW  01
283A:  MOVWF  78
283B:  MOVLB  08
283C:  BCF    64.7
283D:  BTFSC  78.0
283E:  BSF    64.7
....................     reg.fields.pm1 = (powermode >> 1) & 0x1;
283F:  BCF    03.0
2840:  MOVLB  0B
2841:  RRF    37,W
2842:  ANDLW  01
2843:  MOVWF  78
2844:  MOVLB  08
2845:  BCF    64.6
2846:  BTFSC  78.0
2847:  BSF    64.6
....................     
.................... }
.................... 
.................... void set_blank()
.................... {
....................     reg.fields.blank0 = 0;
....................     reg.fields.blank1 = 0;
....................     reg.fields.blank2 = 0;
....................     reg.fields.blank3 = 0;
.................... }
.................... 
.................... unsigned int16 ad7490_make_cmd(int8 channel)
*
284B:  CLRF   39
284C:  CLRF   38
.................... {
....................     unsigned int16 cmd = 0x0000;
.................... 
....................     // WRITE (Bit11)
....................     cmd |= (write & 0x01) << 11;
284D:  MOVF   7B,W
284E:  ANDLW  01
284F:  MOVLW  00
2850:  IORWF  38,F
....................     fprintf(PC, "\tWRITE : %d (%04LX)\r\n", write, cmd);
2851:  MOVLW  D2
2852:  MOVLB  03
2853:  MOVWF  11
2854:  MOVLW  01
2855:  MOVWF  12
2856:  BCF    03.0
2857:  MOVLW  09
2858:  MOVLB  0C
2859:  MOVWF  5E
285A:  MOVLP  08
285B:  MOVLB  00
285C:  CALL   416
285D:  MOVLP  28
285E:  MOVF   7B,W
285F:  MOVLB  0C
2860:  MOVWF  5B
2861:  MOVLW  18
2862:  MOVWF  5C
2863:  MOVLP  18
2864:  MOVLB  00
2865:  CALL   78C
2866:  MOVLP  28
2867:  MOVLW  20
2868:  MOVLB  0F
2869:  MOVWF  43
286A:  MOVLP  08
286B:  MOVLB  00
286C:  CALL   0A7
286D:  MOVLP  28
286E:  MOVLW  28
286F:  MOVLB  0F
2870:  MOVWF  43
2871:  MOVLP  08
2872:  MOVLB  00
2873:  CALL   0A7
2874:  MOVLP  28
2875:  MOVLB  0B
2876:  MOVF   39,W
2877:  MOVLB  0E
2878:  MOVWF  4E
2879:  MOVLW  37
287A:  MOVWF  4F
287B:  MOVLP  08
287C:  MOVLB  00
287D:  CALL   470
287E:  MOVLP  28
287F:  MOVLB  0B
2880:  MOVF   38,W
2881:  MOVLB  0E
2882:  MOVWF  4E
2883:  MOVLW  37
2884:  MOVWF  4F
2885:  MOVLP  08
2886:  MOVLB  00
2887:  CALL   470
2888:  MOVLP  28
2889:  MOVLW  29
288A:  MOVLB  0F
288B:  MOVWF  43
288C:  MOVLP  08
288D:  MOVLB  00
288E:  CALL   0A7
288F:  MOVLP  28
2890:  MOVLW  0D
2891:  MOVLB  0F
2892:  MOVWF  43
2893:  MOVLP  08
2894:  MOVLB  00
2895:  CALL   0A7
2896:  MOVLP  28
2897:  MOVLW  0A
2898:  MOVLB  0F
2899:  MOVWF  43
289A:  MOVLP  08
289B:  MOVLB  00
289C:  CALL   0A7
289D:  MOVLP  28
.................... 
....................     // SEQ (Bit10)
....................     cmd |= (seq & 0x01) << 10;
289E:  MOVF   7C,W
289F:  ANDLW  01
28A0:  MOVLW  00
28A1:  MOVLB  0B
28A2:  IORWF  38,F
....................     fprintf(PC, "\tSEQ   : %d (%04LX)\r\n", seq, cmd);
28A3:  MOVLW  DD
28A4:  MOVLB  03
28A5:  MOVWF  11
28A6:  MOVLW  01
28A7:  MOVWF  12
28A8:  BCF    03.0
28A9:  MOVLW  09
28AA:  MOVLB  0C
28AB:  MOVWF  5E
28AC:  MOVLP  08
28AD:  MOVLB  00
28AE:  CALL   416
28AF:  MOVLP  28
28B0:  MOVF   7C,W
28B1:  MOVLB  0C
28B2:  MOVWF  5B
28B3:  MOVLW  18
28B4:  MOVWF  5C
28B5:  MOVLP  18
28B6:  MOVLB  00
28B7:  CALL   78C
28B8:  MOVLP  28
28B9:  MOVLW  20
28BA:  MOVLB  0F
28BB:  MOVWF  43
28BC:  MOVLP  08
28BD:  MOVLB  00
28BE:  CALL   0A7
28BF:  MOVLP  28
28C0:  MOVLW  28
28C1:  MOVLB  0F
28C2:  MOVWF  43
28C3:  MOVLP  08
28C4:  MOVLB  00
28C5:  CALL   0A7
28C6:  MOVLP  28
28C7:  MOVLB  0B
28C8:  MOVF   39,W
28C9:  MOVLB  0E
28CA:  MOVWF  4E
28CB:  MOVLW  37
28CC:  MOVWF  4F
28CD:  MOVLP  08
28CE:  MOVLB  00
28CF:  CALL   470
28D0:  MOVLP  28
28D1:  MOVLB  0B
28D2:  MOVF   38,W
28D3:  MOVLB  0E
28D4:  MOVWF  4E
28D5:  MOVLW  37
28D6:  MOVWF  4F
28D7:  MOVLP  08
28D8:  MOVLB  00
28D9:  CALL   470
28DA:  MOVLP  28
28DB:  MOVLW  29
28DC:  MOVLB  0F
28DD:  MOVWF  43
28DE:  MOVLP  08
28DF:  MOVLB  00
28E0:  CALL   0A7
28E1:  MOVLP  28
28E2:  MOVLW  0D
28E3:  MOVLB  0F
28E4:  MOVWF  43
28E5:  MOVLP  08
28E6:  MOVLB  00
28E7:  CALL   0A7
28E8:  MOVLP  28
28E9:  MOVLW  0A
28EA:  MOVLB  0F
28EB:  MOVWF  43
28EC:  MOVLP  08
28ED:  MOVLB  00
28EE:  CALL   0A7
28EF:  MOVLP  28
.................... 
....................     // ADDR (Bit9-6)
....................     cmd |= (channel & 0x0F) << 6;
28F0:  MOVLB  0B
28F1:  MOVF   37,W
28F2:  ANDLW  0F
28F3:  MOVWF  77
28F4:  SWAPF  77,F
28F5:  RLF    77,F
28F6:  RLF    77,F
28F7:  MOVLW  C0
28F8:  ANDWF  77,F
28F9:  MOVF   77,W
28FA:  IORWF  38,F
....................     fprintf(PC, "\tADDR  : %d (%04LX)\r\n", channel, cmd);
28FB:  MOVLW  E8
28FC:  MOVLB  03
28FD:  MOVWF  11
28FE:  MOVLW  01
28FF:  MOVWF  12
2900:  BCF    03.0
2901:  MOVLW  09
2902:  MOVLB  0C
2903:  MOVWF  5E
2904:  MOVLP  08
2905:  MOVLB  00
2906:  CALL   416
2907:  MOVLP  28
2908:  MOVLB  0B
2909:  MOVF   37,W
290A:  MOVLB  0C
290B:  MOVWF  5B
290C:  MOVLW  18
290D:  MOVWF  5C
290E:  MOVLP  18
290F:  MOVLB  00
2910:  CALL   78C
2911:  MOVLP  28
2912:  MOVLW  20
2913:  MOVLB  0F
2914:  MOVWF  43
2915:  MOVLP  08
2916:  MOVLB  00
2917:  CALL   0A7
2918:  MOVLP  28
2919:  MOVLW  28
291A:  MOVLB  0F
291B:  MOVWF  43
291C:  MOVLP  08
291D:  MOVLB  00
291E:  CALL   0A7
291F:  MOVLP  28
2920:  MOVLB  0B
2921:  MOVF   39,W
2922:  MOVLB  0E
2923:  MOVWF  4E
2924:  MOVLW  37
2925:  MOVWF  4F
2926:  MOVLP  08
2927:  MOVLB  00
2928:  CALL   470
2929:  MOVLP  28
292A:  MOVLB  0B
292B:  MOVF   38,W
292C:  MOVLB  0E
292D:  MOVWF  4E
292E:  MOVLW  37
292F:  MOVWF  4F
2930:  MOVLP  08
2931:  MOVLB  00
2932:  CALL   470
2933:  MOVLP  28
2934:  MOVLW  29
2935:  MOVLB  0F
2936:  MOVWF  43
2937:  MOVLP  08
2938:  MOVLB  00
2939:  CALL   0A7
293A:  MOVLP  28
293B:  MOVLW  0D
293C:  MOVLB  0F
293D:  MOVWF  43
293E:  MOVLP  08
293F:  MOVLB  00
2940:  CALL   0A7
2941:  MOVLP  28
2942:  MOVLW  0A
2943:  MOVLB  0F
2944:  MOVWF  43
2945:  MOVLP  08
2946:  MOVLB  00
2947:  CALL   0A7
2948:  MOVLP  28
.................... 
....................     // PM1/PM0 (Bit5-4)
....................     cmd |= (AD7490_PM_AUTO_STANDBY & 0x03) << 4;
2949:  MOVLW  30
294A:  MOVLB  0B
294B:  IORWF  38,F
....................     fprintf(PC, "\tPM     : %d (%04LX)\r\n", AD7490_PM_AUTO_STANDBY, cmd);
294C:  MOVLW  F3
294D:  MOVLB  03
294E:  MOVWF  11
294F:  MOVLW  01
2950:  MOVWF  12
2951:  BCF    03.0
2952:  MOVLW  0A
2953:  MOVLB  0C
2954:  MOVWF  5E
2955:  MOVLP  08
2956:  MOVLB  00
2957:  CALL   416
2958:  MOVLP  28
2959:  MOVLW  03
295A:  MOVLB  0C
295B:  MOVWF  5B
295C:  MOVLW  18
295D:  MOVWF  5C
295E:  MOVLP  18
295F:  MOVLB  00
2960:  CALL   78C
2961:  MOVLP  28
2962:  MOVLW  20
2963:  MOVLB  0F
2964:  MOVWF  43
2965:  MOVLP  08
2966:  MOVLB  00
2967:  CALL   0A7
2968:  MOVLP  28
2969:  MOVLW  28
296A:  MOVLB  0F
296B:  MOVWF  43
296C:  MOVLP  08
296D:  MOVLB  00
296E:  CALL   0A7
296F:  MOVLP  28
2970:  MOVLB  0B
2971:  MOVF   39,W
2972:  MOVLB  0E
2973:  MOVWF  4E
2974:  MOVLW  37
2975:  MOVWF  4F
2976:  MOVLP  08
2977:  MOVLB  00
2978:  CALL   470
2979:  MOVLP  28
297A:  MOVLB  0B
297B:  MOVF   38,W
297C:  MOVLB  0E
297D:  MOVWF  4E
297E:  MOVLW  37
297F:  MOVWF  4F
2980:  MOVLP  08
2981:  MOVLB  00
2982:  CALL   470
2983:  MOVLP  28
2984:  MOVLW  29
2985:  MOVLB  0F
2986:  MOVWF  43
2987:  MOVLP  08
2988:  MOVLB  00
2989:  CALL   0A7
298A:  MOVLP  28
298B:  MOVLW  0D
298C:  MOVLB  0F
298D:  MOVWF  43
298E:  MOVLP  08
298F:  MOVLB  00
2990:  CALL   0A7
2991:  MOVLP  28
2992:  MOVLW  0A
2993:  MOVLB  0F
2994:  MOVWF  43
2995:  MOVLP  08
2996:  MOVLB  00
2997:  CALL   0A7
2998:  MOVLP  28
.................... 
....................     // SHADOW (Bit3)
....................     cmd |= (shadow & 0x01) << 3;
2999:  MOVLB  08
299A:  MOVF   62,W
299B:  ANDLW  01
299C:  MOVWF  77
299D:  RLF    77,F
299E:  RLF    77,F
299F:  RLF    77,F
29A0:  MOVLW  F8
29A1:  ANDWF  77,F
29A2:  MOVF   77,W
29A3:  MOVLB  0B
29A4:  IORWF  38,F
....................     fprintf(PC, "\tSHADOW : %d (%04LX)\r\n", shadow, cmd);
29A5:  MOVLW  FF
29A6:  MOVLB  03
29A7:  MOVWF  11
29A8:  MOVLW  01
29A9:  MOVWF  12
29AA:  BCF    03.0
29AB:  MOVLW  0A
29AC:  MOVLB  0C
29AD:  MOVWF  5E
29AE:  MOVLP  08
29AF:  MOVLB  00
29B0:  CALL   416
29B1:  MOVLP  28
29B2:  MOVLB  08
29B3:  MOVF   62,W
29B4:  MOVLB  0C
29B5:  MOVWF  5B
29B6:  MOVLW  18
29B7:  MOVWF  5C
29B8:  MOVLP  18
29B9:  MOVLB  00
29BA:  CALL   78C
29BB:  MOVLP  28
29BC:  MOVLW  20
29BD:  MOVLB  0F
29BE:  MOVWF  43
29BF:  MOVLP  08
29C0:  MOVLB  00
29C1:  CALL   0A7
29C2:  MOVLP  28
29C3:  MOVLW  28
29C4:  MOVLB  0F
29C5:  MOVWF  43
29C6:  MOVLP  08
29C7:  MOVLB  00
29C8:  CALL   0A7
29C9:  MOVLP  28
29CA:  MOVLB  0B
29CB:  MOVF   39,W
29CC:  MOVLB  0E
29CD:  MOVWF  4E
29CE:  MOVLW  37
29CF:  MOVWF  4F
29D0:  MOVLP  08
29D1:  MOVLB  00
29D2:  CALL   470
29D3:  MOVLP  28
29D4:  MOVLB  0B
29D5:  MOVF   38,W
29D6:  MOVLB  0E
29D7:  MOVWF  4E
29D8:  MOVLW  37
29D9:  MOVWF  4F
29DA:  MOVLP  08
29DB:  MOVLB  00
29DC:  CALL   470
29DD:  MOVLP  28
29DE:  MOVLW  29
29DF:  MOVLB  0F
29E0:  MOVWF  43
29E1:  MOVLP  08
29E2:  MOVLB  00
29E3:  CALL   0A7
29E4:  MOVLP  28
29E5:  MOVLW  0D
29E6:  MOVLB  0F
29E7:  MOVWF  43
29E8:  MOVLP  08
29E9:  MOVLB  00
29EA:  CALL   0A7
29EB:  MOVLP  28
29EC:  MOVLW  0A
29ED:  MOVLB  0F
29EE:  MOVWF  43
29EF:  MOVLP  08
29F0:  MOVLB  00
29F1:  CALL   0A7
29F2:  MOVLP  28
.................... 
....................     // WEAK/TRI (Bit2)
....................     cmd |= (weak_tri & 0x01) << 2;
29F3:  MOVF   7E,W
29F4:  ANDLW  01
29F5:  MOVWF  77
29F6:  RLF    77,F
29F7:  RLF    77,F
29F8:  MOVLW  FC
29F9:  ANDWF  77,F
29FA:  MOVF   77,W
29FB:  MOVLB  0B
29FC:  IORWF  38,F
....................     fprintf(PC, "\tWEAK/TRI : %d (%04LX)\r\n", weak_tri, cmd);
29FD:  MOVLW  0B
29FE:  MOVLB  03
29FF:  MOVWF  11
2A00:  MOVLW  02
2A01:  MOVWF  12
2A02:  BCF    03.0
2A03:  MOVLW  0C
2A04:  MOVLB  0C
2A05:  MOVWF  5E
2A06:  MOVLP  08
2A07:  MOVLB  00
2A08:  CALL   416
2A09:  MOVLP  28
2A0A:  MOVF   7E,W
2A0B:  MOVLB  0C
2A0C:  MOVWF  5B
2A0D:  MOVLW  18
2A0E:  MOVWF  5C
2A0F:  MOVLP  18
2A10:  MOVLB  00
2A11:  CALL   78C
2A12:  MOVLP  28
2A13:  MOVLW  20
2A14:  MOVLB  0F
2A15:  MOVWF  43
2A16:  MOVLP  08
2A17:  MOVLB  00
2A18:  CALL   0A7
2A19:  MOVLP  28
2A1A:  MOVLW  28
2A1B:  MOVLB  0F
2A1C:  MOVWF  43
2A1D:  MOVLP  08
2A1E:  MOVLB  00
2A1F:  CALL   0A7
2A20:  MOVLP  28
2A21:  MOVLB  0B
2A22:  MOVF   39,W
2A23:  MOVLB  0E
2A24:  MOVWF  4E
2A25:  MOVLW  37
2A26:  MOVWF  4F
2A27:  MOVLP  08
2A28:  MOVLB  00
2A29:  CALL   470
2A2A:  MOVLP  28
2A2B:  MOVLB  0B
2A2C:  MOVF   38,W
2A2D:  MOVLB  0E
2A2E:  MOVWF  4E
2A2F:  MOVLW  37
2A30:  MOVWF  4F
2A31:  MOVLP  08
2A32:  MOVLB  00
2A33:  CALL   470
2A34:  MOVLP  28
2A35:  MOVLW  29
2A36:  MOVLB  0F
2A37:  MOVWF  43
2A38:  MOVLP  08
2A39:  MOVLB  00
2A3A:  CALL   0A7
2A3B:  MOVLP  28
2A3C:  MOVLW  0D
2A3D:  MOVLB  0F
2A3E:  MOVWF  43
2A3F:  MOVLP  08
2A40:  MOVLB  00
2A41:  CALL   0A7
2A42:  MOVLP  28
2A43:  MOVLW  0A
2A44:  MOVLB  0F
2A45:  MOVWF  43
2A46:  MOVLP  08
2A47:  MOVLB  00
2A48:  CALL   0A7
2A49:  MOVLP  28
.................... 
....................     // RANGE (Bit1)
....................     cmd |= (range & 0x01) << 1;
2A4A:  MOVF   7D,W
2A4B:  ANDLW  01
2A4C:  MOVWF  77
2A4D:  BCF    03.0
2A4E:  RLF    77,F
2A4F:  MOVF   77,W
2A50:  MOVLB  0B
2A51:  IORWF  38,F
....................     fprintf(PC, "\tRANGE  : %d (%04LX)\r\n", range, cmd);
2A52:  MOVLW  18
2A53:  MOVLB  03
2A54:  MOVWF  11
2A55:  MOVLW  02
2A56:  MOVWF  12
2A57:  BCF    03.0
2A58:  MOVLW  0A
2A59:  MOVLB  0C
2A5A:  MOVWF  5E
2A5B:  MOVLP  08
2A5C:  MOVLB  00
2A5D:  CALL   416
2A5E:  MOVLP  28
2A5F:  MOVF   7D,W
2A60:  MOVLB  0C
2A61:  MOVWF  5B
2A62:  MOVLW  18
2A63:  MOVWF  5C
2A64:  MOVLP  18
2A65:  MOVLB  00
2A66:  CALL   78C
2A67:  MOVLP  28
2A68:  MOVLW  20
2A69:  MOVLB  0F
2A6A:  MOVWF  43
2A6B:  MOVLP  08
2A6C:  MOVLB  00
2A6D:  CALL   0A7
2A6E:  MOVLP  28
2A6F:  MOVLW  28
2A70:  MOVLB  0F
2A71:  MOVWF  43
2A72:  MOVLP  08
2A73:  MOVLB  00
2A74:  CALL   0A7
2A75:  MOVLP  28
2A76:  MOVLB  0B
2A77:  MOVF   39,W
2A78:  MOVLB  0E
2A79:  MOVWF  4E
2A7A:  MOVLW  37
2A7B:  MOVWF  4F
2A7C:  MOVLP  08
2A7D:  MOVLB  00
2A7E:  CALL   470
2A7F:  MOVLP  28
2A80:  MOVLB  0B
2A81:  MOVF   38,W
2A82:  MOVLB  0E
2A83:  MOVWF  4E
2A84:  MOVLW  37
2A85:  MOVWF  4F
2A86:  MOVLP  08
2A87:  MOVLB  00
2A88:  CALL   470
2A89:  MOVLP  28
2A8A:  MOVLW  29
2A8B:  MOVLB  0F
2A8C:  MOVWF  43
2A8D:  MOVLP  08
2A8E:  MOVLB  00
2A8F:  CALL   0A7
2A90:  MOVLP  28
2A91:  MOVLW  0D
2A92:  MOVLB  0F
2A93:  MOVWF  43
2A94:  MOVLP  08
2A95:  MOVLB  00
2A96:  CALL   0A7
2A97:  MOVLP  28
2A98:  MOVLW  0A
2A99:  MOVLB  0F
2A9A:  MOVWF  43
2A9B:  MOVLP  08
2A9C:  MOVLB  00
2A9D:  CALL   0A7
2A9E:  MOVLP  28
.................... 
....................     // CODING (Bit0)
....................     cmd |= (coding & 0x01) << 0;
2A9F:  MOVF   76,W
2AA0:  ANDLW  01
2AA1:  MOVLB  0B
2AA2:  IORWF  38,F
....................     fprintf(PC, "\tCODING : %d (%04LX)\r\n", coding, cmd);
2AA3:  MOVLW  24
2AA4:  MOVLB  03
2AA5:  MOVWF  11
2AA6:  MOVLW  02
2AA7:  MOVWF  12
2AA8:  BCF    03.0
2AA9:  MOVLW  0A
2AAA:  MOVLB  0C
2AAB:  MOVWF  5E
2AAC:  MOVLP  08
2AAD:  MOVLB  00
2AAE:  CALL   416
2AAF:  MOVLP  28
2AB0:  MOVF   76,W
2AB1:  MOVLB  0C
2AB2:  MOVWF  5B
2AB3:  MOVLW  18
2AB4:  MOVWF  5C
2AB5:  MOVLP  18
2AB6:  MOVLB  00
2AB7:  CALL   78C
2AB8:  MOVLP  28
2AB9:  MOVLW  20
2ABA:  MOVLB  0F
2ABB:  MOVWF  43
2ABC:  MOVLP  08
2ABD:  MOVLB  00
2ABE:  CALL   0A7
2ABF:  MOVLP  28
2AC0:  MOVLW  28
2AC1:  MOVLB  0F
2AC2:  MOVWF  43
2AC3:  MOVLP  08
2AC4:  MOVLB  00
2AC5:  CALL   0A7
2AC6:  MOVLP  28
2AC7:  MOVLB  0B
2AC8:  MOVF   39,W
2AC9:  MOVLB  0E
2ACA:  MOVWF  4E
2ACB:  MOVLW  37
2ACC:  MOVWF  4F
2ACD:  MOVLP  08
2ACE:  MOVLB  00
2ACF:  CALL   470
2AD0:  MOVLP  28
2AD1:  MOVLB  0B
2AD2:  MOVF   38,W
2AD3:  MOVLB  0E
2AD4:  MOVWF  4E
2AD5:  MOVLW  37
2AD6:  MOVWF  4F
2AD7:  MOVLP  08
2AD8:  MOVLB  00
2AD9:  CALL   470
2ADA:  MOVLP  28
2ADB:  MOVLW  29
2ADC:  MOVLB  0F
2ADD:  MOVWF  43
2ADE:  MOVLP  08
2ADF:  MOVLB  00
2AE0:  CALL   0A7
2AE1:  MOVLP  28
2AE2:  MOVLW  0D
2AE3:  MOVLB  0F
2AE4:  MOVWF  43
2AE5:  MOVLP  08
2AE6:  MOVLB  00
2AE7:  CALL   0A7
2AE8:  MOVLP  28
2AE9:  MOVLW  0A
2AEA:  MOVLB  0F
2AEB:  MOVWF  43
2AEC:  MOVLP  08
2AED:  MOVLB  00
2AEE:  CALL   0A7
2AEF:  MOVLP  28
.................... 
....................     //  (12bit16bit)
....................     cmd <<= 4;
2AF0:  MOVLB  0B
2AF1:  RLF    38,F
2AF2:  RLF    39,F
2AF3:  RLF    38,F
2AF4:  RLF    39,F
2AF5:  RLF    38,F
2AF6:  RLF    39,F
2AF7:  RLF    38,F
2AF8:  RLF    39,F
2AF9:  MOVLW  F0
2AFA:  ANDWF  38,F
....................     fprintf(PC, "\t[AD7490] Final Command : %04LX\r\n", cmd);
2AFB:  MOVLW  30
2AFC:  MOVLB  03
2AFD:  MOVWF  11
2AFE:  MOVLW  02
2AFF:  MOVWF  12
2B00:  BCF    03.0
2B01:  MOVLW  1A
2B02:  MOVLB  0C
2B03:  MOVWF  5E
2B04:  MOVLP  08
2B05:  MOVLB  00
2B06:  CALL   416
2B07:  MOVLP  28
2B08:  MOVLB  0B
2B09:  MOVF   39,W
2B0A:  MOVLB  0E
2B0B:  MOVWF  4E
2B0C:  MOVLW  37
2B0D:  MOVWF  4F
2B0E:  MOVLP  08
2B0F:  MOVLB  00
2B10:  CALL   470
2B11:  MOVLP  28
2B12:  MOVLB  0B
2B13:  MOVF   38,W
2B14:  MOVLB  0E
2B15:  MOVWF  4E
2B16:  MOVLW  37
2B17:  MOVWF  4F
2B18:  MOVLP  08
2B19:  MOVLB  00
2B1A:  CALL   470
2B1B:  MOVLP  28
2B1C:  MOVLW  0D
2B1D:  MOVLB  0F
2B1E:  MOVWF  43
2B1F:  MOVLP  08
2B20:  MOVLB  00
2B21:  CALL   0A7
2B22:  MOVLP  28
2B23:  MOVLW  0A
2B24:  MOVLB  0F
2B25:  MOVWF  43
2B26:  MOVLP  08
2B27:  MOVLB  00
2B28:  CALL   0A7
2B29:  MOVLP  28
.................... 
....................     return cmd;
2B2A:  MOVLB  0B
2B2B:  MOVF   38,W
2B2C:  MOVWF  78
2B2D:  MOVF   39,W
2B2E:  MOVWF  79
.................... }
.................... 
.................... 
.................... #endif // AD7490_H
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_flash.h"
.................... #ifndef  MMJ_CIGS_FLASH_H
.................... #define  MMJ_CIGS_FLASH_H
.................... 
.................... 
.................... 
.................... 
.................... // MIS_FM Function
.................... void misf_init(void);
.................... void update_misf_data_header(void);
.................... void write_misf_address_area(void);
.................... 
.................... 
.................... 
.................... #define PACKET_SIZE 64
.................... #define MISF_DATA_HEADER_SIZE 64 // MISF
.................... #define MISF_PICLOG_MAX_COUNT 60
.................... 
.................... 
.................... 
.................... 
.................... // __________MISF-ADDRESS__________
.................... #define ADDRESS_MISF_START              0x000000
.................... #define ADDRESS_MISF_END                0xF42400
.................... #define ADDRESS_MANEGE_START            0x000000
.................... #define ADDRESS_MANEGE_END              0x00FFFF
.................... #define ADDRESS_MISF_PICLOG_INDEX_START 0x010000
.................... #define ADDRESS_MISF_PICLOG_INDEX_END   0x01FFFF
.................... #define ADDRESS_MISF_PICLOG_DATA_START  0x020000
.................... #define ADDRESS_MISF_PICLOG_DATA_END    0x15FFFF
.................... #define ADDRESS_MISF_MEASUREMENT_START  0x160000
.................... #define ADDRESS_MISF_MEASUREMENT_END    0x95FFFF
.................... 
.................... //
.................... #define SECTOR_64K_BYTE 0x10000 // 64KByte
.................... #define SECTOR_32K_BYTE 0x8000  // 32KByte
.................... #define SECTOR_4K_BYTE  0x1000  // 4KByte
.................... 
.................... // Counter
.................... unsigned int32  smf_piclog_use_counter;
.................... unsigned int8   smf_piclog_loop_counter;
.................... unsigned int32  smf_meas_use_counter;
.................... unsigned int8   smf_meas_loop_counter;
.................... 
.................... unsigned int32  misf_piclog_use_counter;
.................... unsigned int8   misf_piclog_loop_counter;
.................... unsigned int32  misf_piclog_uncopyed_counter;
.................... unsigned int8   misf_piclog_write_counter;
.................... unsigned int32  misf_meas_use_counter;
.................... unsigned int8   misf_meas_loop_counter;
.................... unsigned int32  misf_meas_uncopyed_counter;
.................... 
.................... 
.................... #define DATA_HEADER_SIZE 64 
.................... 
.................... 
.................... 
.................... 
.................... // ___________SMF-ADDRESS___________
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_flash.c"
.................... 
.................... #endif // MMJ_CIGS_FLASH_H
.................... //------------------End of File------------------
.................... 
.................... #include "../../lib/mission_tools.h"
.................... #ifndef MISSION_TOOLS_H
.................... #define MISSION_TOOLS_H
.................... 
.................... #include "communication_driver.h"
.................... #ifndef COMMUNICATION_DRIVER_H
.................... #define COMMUNICATION_DRIVER_H
.................... 
.................... #include "communication.h"
.................... #ifndef COMMUNICATION_H
.................... #define COMMUNICATION_H
.................... 
.................... // __________ device IDs ______________
.................... 
.................... #define GS        0x00
.................... #define MAIN_PIC  0x01
.................... #define COM_PIC   0x02
.................... #define RESET_PIC 0x03
.................... #define FAB_PIC   0x04
.................... #define BOSS_PIC  0x05
.................... #define APRS_PIC  0x06
.................... #define CAM_MCU   0x07
.................... #define CHO_MCU   0x08
.................... #define NAKA_PIC  0x09
.................... #define SATO_PIC  0x0A
.................... #define BHU_MCU   0x0B
.................... #define CIGS_PIC  0x0C
.................... 
.................... #define SELF_DEVICE_ID CIGS_PIC // <- change to your device name
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... // ____________ SFD ______________
.................... 
.................... #define SFD 0xAA
.................... 
.................... 
.................... // ____________ typedef _____________
.................... 
.................... typedef struct {
....................     int8 id;
....................     int8 length;
.................... } FrameID;
.................... 
.................... #define CONTENT_MAX 9
.................... typedef struct {
....................     int8 frame_id;
....................     unsigned int8 size;
....................     int1 is_exist;
....................     unsigned int8 content[CONTENT_MAX];
.................... } Command;
.................... 
.................... #include "./frame.h"
.................... #ifndef FRAME_CONTENT_H
.................... #define FRAME_CONTENT_H
.................... 
.................... 
.................... // __________ Receives _________
.................... 
.................... #define UPLINK_COMMAND        0x00
.................... #define STATUS_CHECK          0x01
.................... #define IS_SMF_AVAILABLE      0x02
.................... 
.................... #define UPLINK_COMMAND_LENGTH     9
.................... #define STATUS_CHECK_LENGTH       0
.................... #define IS_SMF_AVAILABLE_LENGTH   1
.................... 
.................... volatile FrameID frame_ids[] = {
....................    {UPLINK_COMMAND, UPLINK_COMMAND_LENGTH}, 
....................    {STATUS_CHECK, STATUS_CHECK_LENGTH}, 
....................    {IS_SMF_AVAILABLE, IS_SMF_AVAILABLE_LENGTH}
.................... };
.................... 
.................... 
.................... // __________ Transmits _____________
.................... 
.................... typedef enum {
....................    MIS_MCU_STATUS = 0x03,
....................    ACK = 0x0F
.................... } TransmitFrameId;
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... // ______ Receive _______
.................... 
.................... Command make_receive_command(unsigned int8 receive_signal[], int8 receive_signal_size);
.................... 
.................... static int8 trim_receive_signal_header(unsigned int8 receive_signal[], int8 receive_signal_size);
.................... 
.................... static int8 get_content_size(unsigned int8 frame_id);
.................... 
.................... static int1 check_crc(unsigned int8 frame[], int8 receive_frame_size);
.................... 
.................... static int1 check_device_id(unsigned int8 device_id);
.................... 
.................... 
.................... // ______ Transmit _______
.................... 
.................... void transmit_command(TransmitFrameId frame_id, unsigned int8 content[], int8 size);
.................... 
.................... static void transmit(unsigned int8 data[], int8 data_size);
.................... 
.................... // ______ Common _________
.................... 
.................... static unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size);
.................... 
.................... #include "./src/communication.c"
.................... #include "../mission_tools.h"
.................... #ifndef MISSION_TOOLS_H
.................... #define MISSION_TOOLS_H
.................... 
.................... #include "communication_driver.h"
.................... 
.................... 
.................... // ________________ fuctions ____________
.................... 
.................... // Check and reply to messages received from BOSS PIC
.................... void check_and_respond_to_boss();
.................... 
.................... // Request using SMF to BOSS PIC
.................... // !!!After use, you must call `void finished_use_smf()`
.................... int1 req_use_smf();
.................... 
.................... // Call after using SMF
.................... void finished_use_smf();
.................... 
.................... //unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size);
.................... 
.................... #include "./src/mission_tools.c"
.................... 
.................... #endif
.................... 
.................... 
.................... Command make_receive_command(unsigned int8 receive_signal[], int8 receive_signal_size)
.................... {
....................    Command command = {0, 0, FALSE,{0x00}};
*
1800:  MOVLB  0B
1801:  CLRF   24
1802:  CLRF   25
1803:  CLRF   26
1804:  CLRF   27
1805:  CLRF   28
1806:  CLRF   29
1807:  CLRF   2A
1808:  CLRF   2B
1809:  CLRF   2C
180A:  CLRF   2D
180B:  CLRF   2E
180C:  CLRF   2F
....................    fprintf(PC, "\r\nStart make_receive_command\r\n");
180D:  MOVLW  41
180E:  MOVLB  03
180F:  MOVWF  11
1810:  MOVLW  02
1811:  MOVWF  12
1812:  MOVLP  08
1813:  MOVLB  00
1814:  CALL   0CC
1815:  MOVLP  18
....................    fprintf(PC, "\t[BOSS] >>> ");
1816:  MOVLW  51
1817:  MOVLB  03
1818:  MOVWF  11
1819:  MOVLW  02
181A:  MOVWF  12
181B:  MOVLP  08
181C:  MOVLB  00
181D:  CALL   0CC
181E:  MOVLP  18
....................    for (int8 i = 0; i < receive_signal_size; i++)
181F:  MOVLB  0B
1820:  CLRF   30
1821:  MOVF   23,W
1822:  SUBWF  30,W
1823:  BTFSC  03.0
1824:  GOTO   03F
....................       fprintf(PC, "%X ", receive_signal[i]);
1825:  MOVF   30,W
1826:  ADDWF  21,W
1827:  MOVWF  04
1828:  MOVLW  00
1829:  ADDWFC 22,W
182A:  MOVWF  05
182B:  MOVF   00,W
182C:  MOVWF  37
182D:  MOVLB  0E
182E:  MOVWF  4E
182F:  MOVLW  37
1830:  MOVWF  4F
1831:  MOVLP  08
1832:  MOVLB  00
1833:  CALL   470
1834:  MOVLP  18
1835:  MOVLW  20
1836:  MOVLB  0F
1837:  MOVWF  43
1838:  MOVLP  08
1839:  MOVLB  00
183A:  CALL   0A7
183B:  MOVLP  18
183C:  MOVLB  0B
183D:  INCF   30,F
183E:  GOTO   021
....................    fprintf(PC, "\r\n");
183F:  MOVLW  0D
1840:  MOVLB  0F
1841:  MOVWF  43
1842:  MOVLP  08
1843:  MOVLB  00
1844:  CALL   0A7
1845:  MOVLP  18
1846:  MOVLW  0A
1847:  MOVLB  0F
1848:  MOVWF  43
1849:  MOVLP  08
184A:  MOVLB  00
184B:  CALL   0A7
184C:  MOVLP  18
.................... 
....................    int8 frame_start_position = trim_receive_signal_header(receive_signal, receive_signal_size);
184D:  MOVLB  0B
184E:  MOVF   22,W
184F:  MOVWF  38
1850:  MOVF   21,W
1851:  MOVWF  37
1852:  MOVF   23,W
1853:  MOVWF  39
*
1890:  MOVF   78,W
1891:  MOVWF  31
....................    if (frame_start_position == -1)
1892:  MOVF   31,W
1893:  SUBLW  FF
1894:  BTFSS  03.2
1895:  GOTO   09B
....................       return command;
1896:  MOVLW  A4
1897:  MOVWF  78
1898:  MOVLW  05
1899:  MOVWF  79
189A:  GOTO   227
....................       
....................    unsigned int8 *frame = &receive_signal[frame_start_position];
....................    
....................    int8 frame_id = frame[0] & 0x0F;
....................    int8 content_size = get_content_size(frame_id);
189B:  MOVF   31,W
189C:  ADDWF  21,W
189D:  MOVWF  32
189E:  MOVLW  00
189F:  ADDWFC 22,W
18A0:  MOVWF  33
18A1:  MOVF   32,W
18A2:  MOVWF  04
18A3:  MOVF   33,W
18A4:  MOVWF  05
18A5:  ADDFSR 00,FSR0
18A6:  MOVF   00,W
18A7:  ANDLW  0F
18A8:  MOVWF  34
18A9:  MOVF   34,W
18AA:  MOVWF  37
*
18F2:  MOVF   78,W
18F3:  MOVWF  35
....................    if (content_size == -1)
18F4:  MOVF   35,W
18F5:  SUBLW  FF
18F6:  BTFSS  03.2
18F7:  GOTO   0FD
....................       return command;
18F8:  MOVLW  A4
18F9:  MOVWF  78
18FA:  MOVLW  05
18FB:  MOVWF  79
18FC:  GOTO   227
....................       
....................    unsigned int8 receive_frame_size = receive_signal_size - frame_start_position;
18FD:  MOVF   31,W
18FE:  SUBWF  23,W
18FF:  MOVWF  36
....................    
....................    if (!check_crc(frame, receive_frame_size))
1900:  MOVF   33,W
1901:  MOVWF  38
1902:  MOVF   32,W
1903:  MOVWF  37
1904:  MOVF   36,W
1905:  MOVWF  39
*
197E:  MOVF   78,F
197F:  BTFSS  03.2
1980:  GOTO   186
....................       return command;
1981:  MOVLW  A4
1982:  MOVWF  78
1983:  MOVLW  05
1984:  MOVWF  79
1985:  GOTO   227
....................    
....................    if(!check_device_id((frame[0] & 0xF0) >> 4))
1986:  MOVF   32,W
1987:  MOVWF  04
1988:  MOVF   33,W
1989:  MOVWF  05
198A:  ADDFSR 00,FSR0
198B:  MOVF   00,W
198C:  ANDLW  F0
198D:  MOVWF  77
198E:  SWAPF  77,W
198F:  MOVWF  37
1990:  MOVLW  0F
1991:  ANDWF  37,F
1992:  MOVF   37,W
1993:  MOVWF  38
*
19F2:  MOVF   78,F
19F3:  BTFSS  03.2
19F4:  GOTO   1FA
....................       return command;
19F5:  MOVLW  A4
19F6:  MOVWF  78
19F7:  MOVLW  05
19F8:  MOVWF  79
19F9:  GOTO   227
.................... 
....................    command.frame_id = frame_id;
19FA:  MOVF   34,W
19FB:  MOVWF  24
....................    memcpy(command.content, &frame[1], receive_frame_size-2); // '2' is for Decive ID, Frame ID and CRC
19FC:  MOVLW  01
19FD:  ADDWF  32,W
19FE:  MOVWF  37
19FF:  MOVLW  00
1A00:  ADDWFC 33,W
1A01:  MOVWF  38
1A02:  MOVLW  02
1A03:  SUBWF  36,W
1A04:  MOVWF  39
1A05:  MOVF   38,W
1A06:  MOVWF  05
1A07:  MOVF   37,W
1A08:  MOVWF  04
1A09:  MOVF   39,W
1A0A:  MOVWF  78
1A0B:  BTFSC  03.2
1A0C:  GOTO   215
1A0D:  MOVLW  23
1A0E:  MOVWF  07
1A0F:  MOVLW  77
1A10:  MOVWF  06
1A11:  MOVIW  [FSR0++],W
1A12:  MOVWI  W,[FSR1++]
1A13:  DECFSZ 78,F
1A14:  GOTO   211
....................    command.size = receive_frame_size-2;
1A15:  MOVLW  02
1A16:  SUBWF  36,W
1A17:  MOVWF  25
....................    command.is_exist = TRUE;
1A18:  BSF    26.0
....................    //fprintf(PC, "\t-> Frame ID: %X\r\n", command.frame_id);
....................    //fprintf(PC, "\t-> Content size: %d\r\n", command.size);
....................    //fprintf(PC, "\t-> is_exist: %d\r\n", command.is_exist);
....................    fprintf(PC, "End make_recive_command\r\n\r\n");
1A19:  MOVLW  58
1A1A:  MOVLB  03
1A1B:  MOVWF  11
1A1C:  MOVLW  02
1A1D:  MOVWF  12
1A1E:  MOVLP  08
1A1F:  MOVLB  00
1A20:  CALL   0CC
1A21:  MOVLP  18
....................    return command;
1A22:  MOVLW  A4
1A23:  MOVWF  78
1A24:  MOVLW  05
1A25:  MOVWF  79
1A26:  MOVLB  0B
1A27:  MOVLP  38
1A28:  MOVLB  00
1A29:  GOTO   51F (RETURN)
.................... }
.................... 
.................... static int8 trim_receive_signal_header(unsigned int8 receive_signal[], int8 receive_signal_size)
*
1854:  CLRF   3A
.................... {
....................    int8 i = 0;
....................    for(i = 0; i < receive_signal_size-1; i++) // if SFD find 
1855:  CLRF   3A
1856:  MOVLW  01
1857:  SUBWF  39,W
1858:  SUBWF  3A,W
1859:  BTFSC  03.0
185A:  GOTO   06B
....................       if(receive_signal[i] == SFD)
185B:  MOVF   3A,W
185C:  ADDWF  37,W
185D:  MOVWF  04
185E:  MOVLW  00
185F:  ADDWFC 38,W
1860:  MOVWF  05
1861:  MOVF   00,W
1862:  SUBLW  AA
1863:  BTFSS  03.2
1864:  GOTO   069
....................          return i+1;
1865:  MOVLW  01
1866:  ADDWF  3A,W
1867:  MOVWF  78
1868:  GOTO   090
1869:  INCF   3A,F
186A:  GOTO   056
....................    if (receive_signal[i] == SFD)
186B:  MOVF   3A,W
186C:  ADDWF  37,W
186D:  MOVWF  04
186E:  MOVLW  00
186F:  ADDWFC 38,W
1870:  MOVWF  05
1871:  MOVF   00,W
1872:  SUBLW  AA
1873:  BTFSS  03.2
1874:  GOTO   083
....................    {
....................       fprintf(PC, "signal end with SFD\r\n");
1875:  MOVLW  66
1876:  MOVLB  03
1877:  MOVWF  11
1878:  MOVLW  02
1879:  MOVWF  12
187A:  MOVLP  08
187B:  MOVLB  00
187C:  CALL   0CC
187D:  MOVLP  18
....................       return -1;
187E:  MOVLW  FF
187F:  MOVWF  78
1880:  MOVLB  0B
1881:  GOTO   090
....................    }
1882:  GOTO   090
....................    else
....................    {
....................       fprintf(PC, "don't find SFD\r\n");
1883:  MOVLW  71
1884:  MOVLB  03
1885:  MOVWF  11
1886:  MOVLW  02
1887:  MOVWF  12
1888:  MOVLP  08
1889:  MOVLB  00
188A:  CALL   0CC
188B:  MOVLP  18
....................       return -1;
188C:  MOVLW  FF
188D:  MOVWF  78
188E:  MOVLB  0B
188F:  GOTO   090
....................    }
....................    
.................... }
.................... 
.................... static int8 get_content_size(unsigned int8 frame_id)
.................... {
....................    for (int i = 0; i < (sizeof(frame_ids) / sizeof(frame_ids[0])); i++)
*
18AB:  CLRF   38
18AC:  MOVF   38,W
18AD:  SUBLW  02
18AE:  BTFSS  03.0
18AF:  GOTO   0CA
....................       if (frame_id == frame_ids[i].id)
18B0:  BCF    03.0
18B1:  RLF    38,W
18B2:  ADDLW  C5
18B3:  MOVWF  04
18B4:  MOVLW  22
18B5:  MOVWF  05
18B6:  BTFSC  03.0
18B7:  INCF   05,F
18B8:  MOVF   00,W
18B9:  SUBWF  37,W
18BA:  BTFSS  03.2
18BB:  GOTO   0C8
....................          return frame_ids[i].length;
18BC:  BCF    03.0
18BD:  RLF    38,W
18BE:  ADDLW  01
18BF:  ADDLW  C5
18C0:  MOVWF  04
18C1:  MOVLW  22
18C2:  MOVWF  05
18C3:  BTFSC  03.0
18C4:  INCF   05,F
18C5:  MOVF   00,W
18C6:  MOVWF  78
18C7:  GOTO   0F2
18C8:  INCF   38,F
18C9:  GOTO   0AC
....................          
....................    fprintf(PC, "\t-> Invalid Frame ID received: %X\r\n", frame_id);
18CA:  MOVLW  7A
18CB:  MOVLB  03
18CC:  MOVWF  11
18CD:  MOVLW  02
18CE:  MOVWF  12
18CF:  BCF    03.0
18D0:  MOVLW  1F
18D1:  MOVLB  0C
18D2:  MOVWF  5E
18D3:  MOVLP  08
18D4:  MOVLB  00
18D5:  CALL   416
18D6:  MOVLP  18
18D7:  MOVLB  0B
18D8:  MOVF   37,W
18D9:  MOVLB  0E
18DA:  MOVWF  4E
18DB:  MOVLW  37
18DC:  MOVWF  4F
18DD:  MOVLP  08
18DE:  MOVLB  00
18DF:  CALL   470
18E0:  MOVLP  18
18E1:  MOVLW  0D
18E2:  MOVLB  0F
18E3:  MOVWF  43
18E4:  MOVLP  08
18E5:  MOVLB  00
18E6:  CALL   0A7
18E7:  MOVLP  18
18E8:  MOVLW  0A
18E9:  MOVLB  0F
18EA:  MOVWF  43
18EB:  MOVLP  08
18EC:  MOVLB  00
18ED:  CALL   0A7
18EE:  MOVLP  18
....................    return -1;
18EF:  MOVLW  FF
18F0:  MOVWF  78
18F1:  MOVLB  0B
.................... }
.................... 
.................... static int1 check_crc(unsigned int8 frame[], int8 receive_frame_size)
*
1906:  MOVLW  01
1907:  SUBWF  39,W
1908:  ADDWF  37,W
1909:  MOVWF  04
190A:  MOVLW  00
190B:  ADDWFC 38,W
190C:  MOVWF  05
190D:  MOVF   00,W
190E:  MOVWF  3A
190F:  MOVLW  01
1910:  SUBWF  39,W
1911:  MOVWF  3C
1912:  MOVF   38,W
1913:  MOVWF  3E
1914:  MOVF   37,W
1915:  MOVWF  3D
1916:  MOVF   3C,W
1917:  MOVWF  3F
1918:  MOVLP  08
1919:  MOVLB  00
191A:  CALL   7C3
191B:  MOVLP  18
191C:  MOVF   78,W
191D:  MOVLB  0B
191E:  MOVWF  3B
.................... {
....................    unsigned int8 received_crc = frame[receive_frame_size-1]; // '1' is for crc
....................    unsigned int8 collect_crc = calc_crc8(frame, receive_frame_size-1);
....................    if (received_crc == collect_crc)
191F:  MOVF   3B,W
1920:  SUBWF  3A,W
1921:  BTFSS  03.2
1922:  GOTO   127
....................       return TRUE;
1923:  MOVLW  01
1924:  MOVWF  78
1925:  GOTO   17E
1926:  GOTO   17E
....................    else
....................    {
....................       fprintf(PC, "\t-> CRC error!\r\n");
1927:  MOVLW  8C
1928:  MOVLB  03
1929:  MOVWF  11
192A:  MOVLW  02
192B:  MOVWF  12
192C:  MOVLP  08
192D:  MOVLB  00
192E:  CALL   0CC
192F:  MOVLP  18
....................       fprintf(PC, "\t\t-> received CRC: %X\r\n", received_crc);
1930:  MOVLW  95
1931:  MOVLB  03
1932:  MOVWF  11
1933:  MOVLW  02
1934:  MOVWF  12
1935:  BCF    03.0
1936:  MOVLW  13
1937:  MOVLB  0C
1938:  MOVWF  5E
1939:  MOVLP  08
193A:  MOVLB  00
193B:  CALL   416
193C:  MOVLP  18
193D:  MOVLB  0B
193E:  MOVF   3A,W
193F:  MOVLB  0E
1940:  MOVWF  4E
1941:  MOVLW  37
1942:  MOVWF  4F
1943:  MOVLP  08
1944:  MOVLB  00
1945:  CALL   470
1946:  MOVLP  18
1947:  MOVLW  0D
1948:  MOVLB  0F
1949:  MOVWF  43
194A:  MOVLP  08
194B:  MOVLB  00
194C:  CALL   0A7
194D:  MOVLP  18
194E:  MOVLW  0A
194F:  MOVLB  0F
1950:  MOVWF  43
1951:  MOVLP  08
1952:  MOVLB  00
1953:  CALL   0A7
1954:  MOVLP  18
....................       fprintf(PC, "\t\t   collect CRC : %X\r\n", collect_crc);
1955:  MOVLW  A1
1956:  MOVLB  03
1957:  MOVWF  11
1958:  MOVLW  02
1959:  MOVWF  12
195A:  BCF    03.0
195B:  MOVLW  13
195C:  MOVLB  0C
195D:  MOVWF  5E
195E:  MOVLP  08
195F:  MOVLB  00
1960:  CALL   416
1961:  MOVLP  18
1962:  MOVLB  0B
1963:  MOVF   3B,W
1964:  MOVLB  0E
1965:  MOVWF  4E
1966:  MOVLW  37
1967:  MOVWF  4F
1968:  MOVLP  08
1969:  MOVLB  00
196A:  CALL   470
196B:  MOVLP  18
196C:  MOVLW  0D
196D:  MOVLB  0F
196E:  MOVWF  43
196F:  MOVLP  08
1970:  MOVLB  00
1971:  CALL   0A7
1972:  MOVLP  18
1973:  MOVLW  0A
1974:  MOVLB  0F
1975:  MOVWF  43
1976:  MOVLP  08
1977:  MOVLB  00
1978:  CALL   0A7
1979:  MOVLP  18
....................       return FALSE;
197A:  MOVLW  00
197B:  MOVWF  78
197C:  MOVLB  0B
197D:  GOTO   17E
....................    }
.................... }
.................... 
.................... static int1 check_device_id(unsigned int8 device_id)
.................... {
....................    if (SELF_DEVICE_ID == device_id)
*
1994:  MOVF   38,W
1995:  SUBLW  0C
1996:  BTFSS  03.2
1997:  GOTO   19C
....................       return TRUE;
1998:  MOVLW  01
1999:  MOVWF  78
199A:  GOTO   1F2
199B:  GOTO   1F2
....................    else
....................    {
....................       fprintf(PC, "\t-> Invalid device ID received\r\n");
199C:  MOVLW  AD
199D:  MOVLB  03
199E:  MOVWF  11
199F:  MOVLW  02
19A0:  MOVWF  12
19A1:  MOVLP  08
19A2:  MOVLB  00
19A3:  CALL   0CC
19A4:  MOVLP  18
....................       fprintf(PC, "\t\t-> received:     %X\r\n", device_id);
19A5:  MOVLW  BE
19A6:  MOVLB  03
19A7:  MOVWF  11
19A8:  MOVLW  02
19A9:  MOVWF  12
19AA:  BCF    03.0
19AB:  MOVLW  13
19AC:  MOVLB  0C
19AD:  MOVWF  5E
19AE:  MOVLP  08
19AF:  MOVLB  00
19B0:  CALL   416
19B1:  MOVLP  18
19B2:  MOVLB  0B
19B3:  MOVF   38,W
19B4:  MOVLB  0E
19B5:  MOVWF  4E
19B6:  MOVLW  37
19B7:  MOVWF  4F
19B8:  MOVLP  08
19B9:  MOVLB  00
19BA:  CALL   470
19BB:  MOVLP  18
19BC:  MOVLW  0D
19BD:  MOVLB  0F
19BE:  MOVWF  43
19BF:  MOVLP  08
19C0:  MOVLB  00
19C1:  CALL   0A7
19C2:  MOVLP  18
19C3:  MOVLW  0A
19C4:  MOVLB  0F
19C5:  MOVWF  43
19C6:  MOVLP  08
19C7:  MOVLB  00
19C8:  CALL   0A7
19C9:  MOVLP  18
....................       fprintf(PC, "\t\t   My device ID: %X\r\n", SELF_DEVICE_ID);
19CA:  MOVLW  CA
19CB:  MOVLB  03
19CC:  MOVWF  11
19CD:  MOVLW  02
19CE:  MOVWF  12
19CF:  BCF    03.0
19D0:  MOVLW  13
19D1:  MOVLB  0C
19D2:  MOVWF  5E
19D3:  MOVLP  08
19D4:  MOVLB  00
19D5:  CALL   416
19D6:  MOVLP  18
19D7:  MOVLW  0C
19D8:  MOVLB  0E
19D9:  MOVWF  4E
19DA:  MOVLW  37
19DB:  MOVWF  4F
19DC:  MOVLP  08
19DD:  MOVLB  00
19DE:  CALL   470
19DF:  MOVLP  18
19E0:  MOVLW  0D
19E1:  MOVLB  0F
19E2:  MOVWF  43
19E3:  MOVLP  08
19E4:  MOVLB  00
19E5:  CALL   0A7
19E6:  MOVLP  18
19E7:  MOVLW  0A
19E8:  MOVLB  0F
19E9:  MOVWF  43
19EA:  MOVLP  08
19EB:  MOVLB  00
19EC:  CALL   0A7
19ED:  MOVLP  18
....................       return FALSE;  
19EE:  MOVLW  00
19EF:  MOVWF  78
19F0:  MOVLB  0B
19F1:  GOTO   1F2
....................    }
.................... }
.................... 
.................... 
.................... // _______ Transmit _______
.................... 
.................... void transmit_command(TransmitFrameId frame_id, unsigned int8 content[], int8 size)
.................... {
....................    unsigned int8 data[16];
....................    data[0] = SFD;
*
1676:  MOVLW  AA
1677:  MOVLB  0B
1678:  MOVWF  24
....................    data[1] = (BOSS_PIC << 4) | frame_id;
1679:  MOVF   20,W
167A:  IORLW  50
167B:  MOVWF  25
....................    memcpy(&data[2], content, size);
167C:  MOVF   22,W
167D:  MOVWF  05
167E:  MOVF   21,W
167F:  MOVWF  04
1680:  MOVF   23,W
1681:  MOVWF  78
1682:  BTFSC  03.2
1683:  GOTO   68C
1684:  MOVLW  23
1685:  MOVWF  07
1686:  MOVLW  76
1687:  MOVWF  06
1688:  MOVIW  [FSR0++],W
1689:  MOVWI  W,[FSR1++]
168A:  DECFSZ 78,F
168B:  GOTO   688
....................    int8 payload_size = 2 + size; // '2' is for Device ID and Frame ID plus CRC
168C:  MOVLW  02
168D:  ADDWF  23,W
168E:  MOVWF  34
....................    data[payload_size] = calc_crc8(&data[1], payload_size-1); // '1' is for CRC
168F:  MOVLW  74
1690:  ADDWF  34,W
1691:  MOVWF  78
1692:  MOVLW  23
1693:  MOVWF  7A
1694:  BTFSC  03.0
1695:  INCF   7A,F
1696:  MOVF   78,W
1697:  MOVWF  37
1698:  MOVF   7A,W
1699:  MOVWF  38
169A:  MOVLW  01
169B:  SUBWF  34,W
169C:  MOVWF  39
169D:  MOVLW  23
169E:  MOVWF  3E
169F:  MOVLW  75
16A0:  MOVWF  3D
16A1:  MOVF   39,W
16A2:  MOVWF  3F
16A3:  MOVLP  08
16A4:  MOVLB  00
16A5:  CALL   7C3
16A6:  MOVLP  10
16A7:  MOVLB  0B
16A8:  MOVF   38,W
16A9:  MOVWF  05
16AA:  MOVF   37,W
16AB:  MOVWF  04
16AC:  MOVF   78,W
16AD:  MOVWF  00
....................    int8 data_size = payload_size + 1; // '1' is for CRC
16AE:  MOVLW  01
16AF:  ADDWF  34,W
16B0:  MOVWF  35
....................    
....................    transmit(data, data_size);
16B1:  MOVLW  23
16B2:  MOVWF  38
16B3:  MOVLW  74
16B4:  MOVWF  37
16B5:  MOVF   35,W
16B6:  MOVWF  39
*
1704:  RETURN
.................... }
.................... 
.................... static void transmit(unsigned int8 data[], int8 data_size)
.................... {
....................    for(int i = 0; i < data_size; i++)
*
16B7:  CLRF   3A
16B8:  MOVF   39,W
16B9:  SUBWF  3A,W
16BA:  BTFSC  03.0
16BB:  GOTO   6CD
....................       fputc(data[i], BOSS);
16BC:  MOVF   3A,W
16BD:  ADDWF  37,W
16BE:  MOVWF  04
16BF:  MOVLW  00
16C0:  ADDWFC 38,W
16C1:  MOVWF  05
16C2:  MOVF   00,W
16C3:  MOVWF  3C
16C4:  MOVF   3C,W
*
16CA:  MOVLB  0B
16CB:  INCF   3A,F
16CC:  GOTO   6B8
....................       
....................    fprintf(PC, "\t[BOSS] <<< ");
16CD:  MOVLW  D6
16CE:  MOVLB  03
16CF:  MOVWF  11
16D0:  MOVLW  02
16D1:  MOVWF  12
16D2:  MOVLP  08
16D3:  MOVLB  00
16D4:  CALL   0CC
16D5:  MOVLP  10
....................    for(int i = 0; i < data_size; i++)
16D6:  MOVLB  0B
16D7:  CLRF   3B
16D8:  MOVF   39,W
16D9:  SUBWF  3B,W
16DA:  BTFSC  03.0
16DB:  GOTO   6F6
....................       fprintf(PC, "%X ", data[i]);
16DC:  MOVF   3B,W
16DD:  ADDWF  37,W
16DE:  MOVWF  04
16DF:  MOVLW  00
16E0:  ADDWFC 38,W
16E1:  MOVWF  05
16E2:  MOVF   00,W
16E3:  MOVWF  3C
16E4:  MOVLB  0E
16E5:  MOVWF  4E
16E6:  MOVLW  37
16E7:  MOVWF  4F
16E8:  MOVLP  08
16E9:  MOVLB  00
16EA:  CALL   470
16EB:  MOVLP  10
16EC:  MOVLW  20
16ED:  MOVLB  0F
16EE:  MOVWF  43
16EF:  MOVLP  08
16F0:  MOVLB  00
16F1:  CALL   0A7
16F2:  MOVLP  10
16F3:  MOVLB  0B
16F4:  INCF   3B,F
16F5:  GOTO   6D8
....................    fprintf(PC, "\r\n");
16F6:  MOVLW  0D
16F7:  MOVLB  0F
16F8:  MOVWF  43
16F9:  MOVLP  08
16FA:  MOVLB  00
16FB:  CALL   0A7
16FC:  MOVLP  10
16FD:  MOVLW  0A
16FE:  MOVLB  0F
16FF:  MOVWF  43
1700:  MOVLP  08
1701:  MOVLB  00
1702:  CALL   0A7
1703:  MOVLP  10
.................... }
.................... 
.................... 
.................... // ______ Common _______
.................... 
.................... static unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size)
*
0FC3:  MOVLB  0B
0FC4:  MOVF   3D,W
0FC5:  MOVWF  04
0FC6:  MOVF   3E,W
0FC7:  MOVWF  05
0FC8:  MOVIW  [FSR0+00],W
0FC9:  MOVWF  40
0FCA:  MOVLW  01
0FCB:  MOVWF  41
.................... {
....................    unsigned int8 crc = frame[0], i = 1;
....................    while(i < payload_size)
0FCC:  MOVF   3F,W
0FCD:  SUBWF  41,W
0FCE:  BTFSC  03.0
0FCF:  GOTO   7DA
....................       crc ^= frame[i++];
0FD0:  MOVF   41,W
0FD1:  INCF   41,F
0FD2:  ADDWF  3D,W
0FD3:  MOVWF  04
0FD4:  MOVLW  00
0FD5:  ADDWFC 3E,W
0FD6:  MOVWF  05
0FD7:  MOVF   00,W
0FD8:  XORWF  40,F
0FD9:  GOTO   7CC
....................    return crc;
0FDA:  MOVF   40,W
0FDB:  MOVWF  78
0FDC:  MOVLB  00
0FDD:  RETURN
.................... }
.................... 
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... 
.................... // This is redundant, but it is a process to hide the Communication library as a driver.
.................... Command make_command(unsigned int8 receive_signal[], int8 receive_signal_size);
.................... 
.................... #Separate
.................... void transmit_ack();
.................... #Separate
.................... void transmit_status();
.................... #Separate
.................... int1 req_use_smf();
.................... 
.................... 
.................... #include "./src/communication_driver.c"
.................... Command make_command(unsigned int8 receive_signal[], int8 receive_signal_size)
.................... {
....................    Command command = make_receive_command(receive_signal, receive_signal_size);
....................    fprintf(PC, "\t-> Frame ID: %X\r\n", command.frame_id);
....................    fprintf(PC, "\t-> Content size: %d\r\n", command.size);
....................    return command;
.................... }
.................... #Separate
.................... void transmit_ack()
.................... {
....................    transmit_command(ACK, 0, 0);
0FDE:  MOVLW  0F
0FDF:  MOVLB  0B
0FE0:  MOVWF  20
0FE1:  CLRF   22
0FE2:  CLRF   21
0FE3:  CLRF   23
0FE4:  MOVLP  10
0FE5:  MOVLB  00
0FE6:  CALL   676
0FE7:  MOVLP  08
0FE8:  RETURN
.................... }
.................... #Separate
.................... void transmit_status()
.................... {
....................    transmit_command(MIS_MCU_STATUS, &status, 4);
*
2E2B:  MOVLW  03
2E2C:  MOVLB  0B
2E2D:  MOVWF  20
2E2E:  MOVLW  20
2E2F:  MOVWF  22
2E30:  MOVLW  09
2E31:  MOVWF  21
2E32:  MOVLW  04
2E33:  MOVWF  23
2E34:  MOVLP  10
2E35:  MOVLB  00
2E36:  CALL   676
2E37:  MOVLP  28
2E38:  MOVLP  28
2E39:  GOTO   64D (RETURN)
.................... }
.................... 
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... 
.................... // ________________ fuctions ____________
.................... 
.................... // Check and reply to messages received from BOSS PIC
.................... void check_and_respond_to_boss();
.................... 
.................... // Request using SMF to BOSS PIC
.................... // !!!After use, you must call `void finished_use_smf()`
.................... int1 req_use_smf();
.................... 
.................... // Call after using SMF
.................... void finished_use_smf();
.................... 
.................... //unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size);
.................... 
.................... #include "./src/mission_tools.c"
.................... int1 req_use_smf()
.................... {
....................    fprintf(PC, "Start SMF using reqest seaquence\r\n");
....................    status[0] = SMF_USE_REQ;
....................    is_use_smf_req_in_mission = TRUE;
....................    
....................    while (TRUE)
....................    {
....................       for (int16 i = 0; i < 1200; i++) // 10 min
....................       {
....................          if (boss_receive_buffer_size > 0)
....................          {
....................             Command command = make_receive_command(boss_receive_buffer, boss_receive_buffer_size);
....................             clear_receive_signal(boss_receive_buffer, &boss_receive_buffer_size);
....................             if (command.frame_id == STATUS_CHECK)
....................             {
....................                transmit_status();
....................                break;
....................             }
....................             else
....................             {
....................                fprintf(PC, "Error! Receiving command inconsistent with the design\r\n");
....................             }
....................          }
....................          delay_ms(500);
....................       }
....................       
....................       for (int16 i = 0; i < 1200; i++) // 10 min
....................       {
....................          if (boss_receive_buffer_size > 0)
....................          {
....................             Command command = make_receive_command(boss_receive_buffer, boss_receive_buffer_size); 
....................             clear_receive_signal(boss_receive_buffer, &boss_receive_buffer_size);
....................             if (command.frame_id == IS_SMF_AVAILABLE)
....................             {
....................                if (command.content[0] == ALLOW)
....................                {
....................                   fprintf(PC, "SMF use request allowed\r\n");
....................                   transmit_ack();
....................                   goto NEXT;
....................                }
....................                else
....................                {
....................                   fprintf(PC, "SMF use request denyed\r\n");
....................                   fprintf(PC, "Retry request to BOSS PIC\r\n");
....................                   transmit_ack();
....................                   break;
....................                }
....................             }
....................             else
....................             {
....................                fprintf(PC, "Error! Receiving command inconsistent with the design\r\n");
....................             }
....................          }
....................          delay_ms(500);
....................       }
....................    }
....................    
.................... NEXT:
....................    is_use_smf_req_in_mission = FALSE;
....................    status[0] = COPYING;
....................    return TRUE;
....................    fprintf(PC, "End SMF using reqest seaquence\r\n");
.................... }
.................... 
.................... 
.................... void finished_use_smf()
.................... {
....................    status[0] = EXECUTING_MISSION;
.................... }
.................... 
.................... void check_and_respond_to_boss()
.................... {
....................    if (kbhit())
....................    {
....................       fgetc(BOSS);
....................       transmit_status();
....................    }
.................... }
.................... /*
.................... unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size)
.................... {
....................    unsigned int8 crc = frame[0], i = 1;
....................    while(i < payload_size)
....................       crc ^= frame[i++];
....................    return crc;
.................... }
.................... */
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... /*
.................... struct AD7490_STREAM ad7490_stream = {
....................     ADC_STREAM,    // spi_stream
....................     ADC_CS  // cs_pin
.................... };
.................... */
.................... 
.................... 
.................... void io_init()
.................... {
....................     fprintf(PC, "IO Initialize\r\n");
*
091A:  MOVLW  76
091B:  MOVLB  03
091C:  MOVWF  11
091D:  MOVLW  03
091E:  MOVWF  12
091F:  MOVLB  00
0920:  CALL   0CC
....................     output_low(CONNECT_CIGS);
0921:  MOVLB  01
0922:  BCF    10.0
0923:  MOVLB  02
0924:  BCF    10.0
....................     output_low(EN_NPWR);
0925:  MOVLB  01
0926:  BCF    0C.4
0927:  MOVLB  02
0928:  BCF    0C.4
....................     fprintf(PC, "\tComplete\r\n");
0929:  MOVLW  7E
092A:  MOVLB  03
092B:  MOVWF  11
092C:  MOVLW  03
092D:  MOVWF  12
092E:  MOVLB  00
092F:  CALL   0CC
0930:  MOVLP  38
0931:  GOTO   4E0 (RETURN)
.................... }
.................... 
.................... void adc_init()
.................... {
....................    fprintf(PC, "ADC Initialize\r\n");
0932:  MOVLW  84
0933:  MOVLB  03
0934:  MOVWF  11
0935:  MOVLW  03
0936:  MOVWF  12
0937:  MOVLB  00
0938:  CALL   0CC
....................     //setup ADC
....................    setup_oscillator(OSC_16MHZ);   //oscillator speed (crystal)
0939:  MOVLW  78
093A:  MOVLB  01
093B:  MOVWF  19
....................    setup_adc_ports(CIGS_VOLT | CIGS_CURR | TEMP_BOT | TEMP_TOP | PD , DAC_VSS_FVR);
093C:  BCF    1E.0
093D:  BCF    1E.1
093E:  BCF    1E.2
093F:  MOVLW  00
0940:  MOVLB  03
0941:  MOVWF  0C
0942:  MOVWF  10
0943:  MOVWF  0D
0944:  MOVLW  EB
0945:  MOVWF  0F
....................    setup_adc(ADC_CLOCK_DIV_64);
0946:  MOVLB  01
0947:  BCF    1E.4
0948:  BSF    1E.5
0949:  BSF    1E.6
094A:  BCF    1E.7
094B:  BSF    1D.0
.................... 
....................    //setup DAC
....................    setup_dac(DAC_OUTPUT2 | DAC_VSS_VDD);                                        //DAC output at pin DAC output1 from 0-VDD volts  
094C:  MOVLW  90
094D:  MOVLB  02
094E:  MOVWF  18
....................    dac_write(50);                                                               
094F:  MOVLW  32
0950:  MOVWF  19
....................    fprintf(PC, "\tComplete\r\n");
0951:  MOVLW  8D
0952:  MOVLB  03
0953:  MOVWF  11
0954:  MOVLW  03
0955:  MOVWF  12
0956:  MOVLB  00
0957:  CALL   0CC
0958:  MOVLP  38
0959:  GOTO   4E3 (RETURN)
.................... }
.................... 
.................... #Separate
.................... void sweep(unsigned int8 parameter[])
.................... {
....................     // 
....................     fprintf(PC, "Start SWEEP\r\n");
....................     unsigned int8 measurement_step = parameter[1]; // Get the measurement step from the parameter array
....................     fprintf(PC, "\tSweep step : %u\r\n", measurement_step);
....................     output_high(CONNECT_CIGS);
.................... 
....................     // read header data
....................     measured_time = get_current_sec(); // read time from timer0
....................     measured_pd = ad7490_read(ADC_PD); // read PD value
....................     measured_temp_top = ad7490_read(ADC_TEMP_TOP); // read temperature at top
....................     measured_temp_bot = ad7490_read(ADC_TEMP_BOT); // read temperature at bottom
....................     measured_open_voltage = ad7490_read(ADC_CIGS_VOLT); // read open voltage at CIGS
.................... 
....................     for (unsigned int16 count = 0; count < measurement_step; count++)
....................     {    
....................         // set DAC value
....................         dac_write(count);
....................         delay_ms(100); // wait for the DAC to stabilize
.................... 
....................         // read CIGS voltage and current      
....................         delay_us(10); // wait for the ADC to stabilize
....................         data_buffer[count*2] = ad7490_read(ADC_CIGS_VOLT);
....................         data_buffer[count*2+1] = ad7490_read(ADC_CIGS_CURR); // read voltage at adc pin
....................     }
.................... 
....................     output_low(CONNECT_CIGS);
....................     fprintf(PC, "END SWEEP\r\n");
.................... 
....................     fprintf(PC, "Start CIGS data conversion\r\n");
....................     unsigned int8 packetdata[PACKET_SIZE] = {0x00};
....................     
....................     make_meas_header(packetdata, parameter); // Create measurement header
....................     unsigned int8 packetbytecounter = 21; // Start after header size
....................     
....................     for (unsigned int8 i = 0; i < measurement_step; i++)
....................     {        
....................         packetdata[i*3]      = (data_buffer[i*2] >> 4) & 0xFF;
....................         packetdata[i*3+1]    = (data_buffer[i*2] & 0x0F) << 4 | (data_buffer[i*2+1] >>8 )& 0x0F;
....................         packetdata[i*3+2]    = data_buffer[i*2+1] & 0xFF;
....................         packetbytecounter += 3; // Each CIGS data takes 3 bytes
.................... 
....................         if (packetbytecounter == PACKET_SIZE-1) {
....................             // Add CRC
....................             packetdata[PACKET_SIZE-2] = calc_crc8(packetdata, PACKET_SIZE-1);            
....................             
....................             // Flash 
....................             unsigned int32 write_address = ADDRESS_MISF_MEASUREMENT_START + misf_meas_use_counter;
....................             write_data_bytes(mis_fm, write_address, packetdata, PACKET_SIZE);
.................... 
....................             // 
....................             misf_meas_use_counter += PACKET_SIZE;
....................             misf_meas_uncopyed_counter += PACKET_SIZE;
....................             write_misf_address_area();
....................         }
....................     }
.................... 
....................     if (packetbytecounter < PACKET_SIZE) {
....................         // Fill the remaining bytes with 0x00
....................         for (unsigned int8 j = packetbytecounter; j < PACKET_SIZE; j++) {
....................             packetdata[j] = 0x00;
....................         }
....................         // Flash 
....................         unsigned int32 write_address = ADDRESS_MISF_MEASUREMENT_START + misf_meas_use_counter;
....................         write_data_bytes(mis_fm, write_address, packetdata, PACKET_SIZE);
....................         
....................         // 
....................         misf_meas_use_counter += PACKET_SIZE;
....................         misf_meas_uncopyed_counter += PACKET_SIZE;
....................         write_misf_address_area();
....................     }
.................... 
.................... }
.................... 
.................... void make_meas_header(unsigned int8 *packetdata, unsigned int8 *cmd)
.................... {
....................     packetdata[0] = START_MAKER; // Header start
....................     packetdata[1] = START_MAKER; // Header start
....................     
....................     // Add uplink cmd
....................     packetdata[2]  = cmd[0]; // Command ID
....................     packetdata[3]  = cmd[1]; // Param1
....................     packetdata[4]  = cmd[2]; // Param2
....................     packetdata[5]  = cmd[3]; // Param3 
....................     packetdata[6]  = cmd[4]; // Param4
....................     packetdata[7]  = cmd[5]; // Param5
....................     packetdata[8]  = cmd[6]; // Param6
....................     packetdata[9]  = cmd[7]; // Param7
....................     packetdata[10] = cmd[8]; // Reserved byte
.................... 
....................     // Add timestamp
....................     packetdata[11] = measured_time >> 24 & 0xFF; // Time high byte
....................     packetdata[12] = measured_time >> 16 & 0xFF; //
....................     packetdata[13] = measured_time >> 8 & 0xFF;  // Time middle byte
....................     packetdata[14] = measured_time & 0xFF;         // Time low
....................     
....................     
....................     //cigs_data[i*3+1]    = (data_buffer[i*2] & 0x0F) << 4 | (data_buffer[i*2+1] >>8 )& 0x0F;
.................... 
....................     // Add PD value
....................     packetdata[15] = ( measured_pd >> 4 ) &  0xFF; // PD start low byte
....................     packetdata[16] = ( measured_pd & 0x0F ) << 4 | ( measured_open_voltage >>8 )& 0x0F;
....................     packetdata[17] = measured_open_voltage & 0xFF; // PD end
....................     packetdata[18] = ( measured_temp_top >> 4 ) &  0xFF; // PD start low byte
....................     packetdata[19] = ( measured_temp_top & 0x0F ) << 4 | ( measured_temp_bot >>8 )& 0x0F;
....................     packetdata[20] = measured_temp_bot & 0xFF; // PD end
.................... }
.................... 
.................... 
.................... 
.................... #endif
.................... //------------------End of File------------------
.................... 
.................... #include "../../lib/smf_queue.h"
.................... #ifndef SMF_QUEUE_H
.................... #define SMF_QUEUE_H
.................... 
.................... 
.................... 
.................... typedef enum {
....................    APRS_DATA,  // <- assign your missoins
....................    IN_VEHICLE, 
....................    ECOSYSTEM_DATA, 
....................    APRS_PIC_LOG
.................... } MissionType;
.................... 
.................... typedef struct {
....................    unsigned int32 start_address;
....................    unsigned int32 end_address;
....................    int8 mission_flag;
.................... } MissionTypeStruct;
.................... 
.................... typedef struct {
....................     MissionType   mission_type;
....................     unsigned int32 src;
....................     unsigned int32 size;
.................... } SmfDataStruct;
.................... 
.................... #define SMF_DATA_SIZE 16
.................... typedef struct {
....................    SmfDataStruct smf_data[SMF_DATA_SIZE];
....................    int8 smf_data_head;
....................    int8 smf_data_tail;
.................... } SmfQueueStruct;
.................... 
.................... // _____________________ values _________________
.................... 
.................... volatile SmfQueueStruct smf_queue = {0};
.................... 
.................... 
.................... // ___________________ functions ________________
.................... 
.................... #separate
.................... void enqueue_smf_data(SmfDataStruct *data);
.................... #separate
.................... SmfDataStruct *dequeue_smf_data();
.................... #separate
.................... int1 is_empty_smf_data(void);
.................... #separate
.................... MissionTypeStruct getMissionTypeStruct(MissionType mis_type);
.................... 
.................... #include "./src/smf_queue.c"
.................... #separate
.................... void enqueue_smf_data(SmfDataStruct *data)
.................... {   
....................    int8 next_tail = (smf_queue.smf_data_tail + 1) % SMF_DATA_SIZE;
.................... 
....................    if(next_tail == smf_queue.smf_data_head)
....................       fprintf(PC, "SMF data list is full!!!\r\n");
....................       
....................    else
....................    {
....................       smf_queue.smf_data[smf_queue.smf_data_tail].mission_type = data->mission_type;
....................       smf_queue.smf_data[smf_queue.smf_data_tail].src         = data->src;
....................       smf_queue.smf_data[smf_queue.smf_data_tail].size        = data->size;
.................... 
....................       smf_queue.smf_data_tail = next_tail;
....................    }
.................... }
.................... 
.................... #separate
.................... SmfDataStruct *dequeue_smf_data()
.................... {
....................    if (smf_queue.smf_data_head == smf_queue.smf_data_tail)
*
2E62:  MOVLB  0A
2E63:  MOVF   5C,W
2E64:  SUBWF  5B,W
2E65:  BTFSS  03.2
2E66:  GOTO   676
....................    {
....................       fprintf(PC, "SMF data list is empty\r\n");
2E67:  MOVLW  C7
2E68:  MOVLB  03
2E69:  MOVWF  11
2E6A:  MOVLW  03
2E6B:  MOVWF  12
2E6C:  MOVLP  08
2E6D:  MOVLB  00
2E6E:  CALL   0CC
2E6F:  MOVLP  28
....................       return 0x00;
2E70:  MOVLW  00
2E71:  MOVWF  78
2E72:  MOVWF  79
2E73:  GOTO   6B1
....................    }
2E74:  GOTO   6B1
2E75:  MOVLB  0A
....................    else
....................    {
....................       int8 current_head = smf_queue.smf_data_head;
2E76:  MOVF   5B,W
2E77:  MOVLB  0C
2E78:  MOVWF  41
....................       smf_queue.smf_data_head = (smf_queue.smf_data_head + 1) % SMF_DATA_SIZE;
2E79:  MOVLW  01
2E7A:  MOVLB  0A
2E7B:  ADDWF  5B,W
2E7C:  ANDLW  0F
2E7D:  MOVWF  5B
....................       return &smf_queue.smf_data[current_head];
2E7E:  MOVLB  0C
2E7F:  MOVF   41,W
2E80:  MOVWF  42
2E81:  MOVLW  09
2E82:  MOVWF  43
*
2EA7:  MOVF   78,W
2EA8:  ADDLW  CB
2EA9:  MOVWF  78
2EAA:  MOVLW  22
2EAB:  MOVWF  7A
2EAC:  BTFSC  03.0
2EAD:  INCF   7A,F
2EAE:  MOVF   7A,W
2EAF:  MOVWF  79
2EB0:  MOVLB  00
....................    }
2EB1:  MOVLP  30
2EB2:  GOTO   67E (RETURN)
.................... }
.................... #separate
.................... int1 is_empty_smf_data(void)
.................... {
....................    return smf_queue.smf_data_head == smf_queue.smf_data_tail;
*
27F3:  MOVLB  0A
27F4:  MOVF   5C,W
27F5:  SUBWF  5B,W
27F6:  BTFSC  03.2
27F7:  GOTO   7FA
27F8:  MOVLW  00
27F9:  GOTO   7FB
27FA:  MOVLW  01
27FB:  MOVWF  78
27FC:  MOVLB  00
27FD:  RETURN
.................... }
.................... 
.................... #separate
.................... MissionTypeStruct getMissionTypeStruct(MissionType mis_type)
.................... {
....................    MissionTypeStruct mis_struct = {0};
*
2EB3:  MOVLB  0C
2EB4:  CLRF   60
2EB5:  CLRF   61
2EB6:  CLRF   62
2EB7:  CLRF   63
2EB8:  CLRF   64
2EB9:  CLRF   65
2EBA:  CLRF   66
2EBB:  CLRF   67
2EBC:  CLRF   68
....................    
....................    if (mis_type == APRS_DATA)
2EBD:  MOVF   5F,F
2EBE:  BTFSS  03.2
2EBF:  GOTO   6D1
....................    {
....................       mis_struct.start_address   = 0x02400000;
2EC0:  MOVLW  02
2EC1:  MOVWF  63
2EC2:  MOVLW  40
2EC3:  MOVWF  62
2EC4:  CLRF   61
2EC5:  CLRF   60
....................       mis_struct.end_address     = 0x02500FFF;
2EC6:  MOVLW  02
2EC7:  MOVWF  67
2EC8:  MOVLW  50
2EC9:  MOVWF  66
2ECA:  MOVLW  0F
2ECB:  MOVWF  65
2ECC:  MOVLW  FF
2ECD:  MOVWF  64
....................       mis_struct.mission_flag    = 0b10000000;
2ECE:  MOVLW  80
2ECF:  MOVWF  68
....................    }
2ED0:  GOTO   71B
....................    else if (mis_type == IN_VEHICLE)
2ED1:  DECFSZ 5F,W
2ED2:  GOTO   6E5
....................    {
....................       mis_struct.start_address   = 0x02501000;
2ED3:  MOVLW  02
2ED4:  MOVWF  63
2ED5:  MOVLW  50
2ED6:  MOVWF  62
2ED7:  MOVLW  10
2ED8:  MOVWF  61
2ED9:  CLRF   60
....................       mis_struct.end_address     = 0x02501FFF;
2EDA:  MOVLW  02
2EDB:  MOVWF  67
2EDC:  MOVLW  50
2EDD:  MOVWF  66
2EDE:  MOVLW  1F
2EDF:  MOVWF  65
2EE0:  MOVLW  FF
2EE1:  MOVWF  64
....................       mis_struct.mission_flag    = 0b10000001;  
2EE2:  MOVLW  81
2EE3:  MOVWF  68
....................    }
2EE4:  GOTO   71B
....................    else if (mis_type == ECOSYSTEM_DATA)
2EE5:  MOVF   5F,W
2EE6:  SUBLW  02
2EE7:  BTFSS  03.2
2EE8:  GOTO   6FB
....................    {
....................       mis_struct.start_address   = 0x02506000;
2EE9:  MOVLW  02
2EEA:  MOVWF  63
2EEB:  MOVLW  50
2EEC:  MOVWF  62
2EED:  MOVLW  60
2EEE:  MOVWF  61
2EEF:  CLRF   60
....................       mis_struct.end_address     = 0x02516FFF;
2EF0:  MOVLW  02
2EF1:  MOVWF  67
2EF2:  MOVLW  51
2EF3:  MOVWF  66
2EF4:  MOVLW  6F
2EF5:  MOVWF  65
2EF6:  MOVLW  FF
2EF7:  MOVWF  64
....................       mis_struct.mission_flag    = 0b10000011;  
2EF8:  MOVLW  83
2EF9:  MOVWF  68
....................    }
2EFA:  GOTO   71B
....................    else if (mis_type == APRS_PIC_LOG)
2EFB:  MOVF   5F,W
2EFC:  SUBLW  03
2EFD:  BTFSS  03.2
2EFE:  GOTO   711
....................    {
....................       mis_struct.start_address   = 0x02517000;
2EFF:  MOVLW  02
2F00:  MOVWF  63
2F01:  MOVLW  51
2F02:  MOVWF  62
2F03:  MOVLW  70
2F04:  MOVWF  61
2F05:  CLRF   60
....................       mis_struct.end_address     = 0x02517FFF;
2F06:  MOVLW  02
2F07:  MOVWF  67
2F08:  MOVLW  51
2F09:  MOVWF  66
2F0A:  MOVLW  7F
2F0B:  MOVWF  65
2F0C:  MOVLW  FF
2F0D:  MOVWF  64
....................       mis_struct.mission_flag    = 0b10000100;  
2F0E:  MOVLW  84
2F0F:  MOVWF  68
....................    }
2F10:  GOTO   71B
....................    else
....................    {
....................       // undefined mission type. output `ff` as default
....................       mis_struct.start_address   = 0xFFFFFFFF;
2F11:  MOVLW  FF
2F12:  MOVWF  63
2F13:  MOVWF  62
2F14:  MOVWF  61
2F15:  MOVWF  60
....................       mis_struct.end_address     = 0xFFFFFFFF;
2F16:  MOVWF  67
2F17:  MOVWF  66
2F18:  MOVWF  65
2F19:  MOVWF  64
....................       mis_struct.mission_flag    = 0b11111111; 
2F1A:  MOVWF  68
....................    }
....................    
....................    return mis_struct;
2F1B:  MOVLW  60
2F1C:  MOVWF  78
2F1D:  MOVLW  06
2F1E:  MOVWF  79
2F1F:  MOVLP  30
2F20:  MOVLB  00
2F21:  GOTO   12C (RETURN)
.................... }
.................... 
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... #include "../../lib/mt25q.h"
.................... #ifndef MT25Q_H
.................... #define MT25Q_H
.................... 
.................... // =========
.................... //#define MT25Q_DEBUG
.................... // =========
.................... 
.................... 
.................... #define FLASH_STREAM0 MIS_FM_STREAM     // <- Align the names to `config.h` Stream name
.................... #define FLASH_STREAM1 SMF_STREAM
.................... #define FLASH_STREAM2 SMF_STREAM // dont use
.................... #define FLASH_STREAM3 SMF_STREAM // dont use
.................... typedef enum spi_stream{
....................     SPI_0,
....................     SPI_1,
....................     SPI_2,
....................     SPI_3,
.................... }SpiStreamId;
.................... 
.................... #define MT25QL128ABA 0x00     //Mission Flash
.................... #define MT25QL01GBBB 0x01     //SMF,CF
.................... typedef struct select_stream_to_flash{
....................     SpiStreamId spi_stream_id;
....................     unsigned int8 flash_model;
....................     int16 cs_pin;
.................... }Flash;
.................... 
.................... 
.................... Flash mis_fm = {SPI_0, MT25QL128ABA, MIS_FM_CS};
.................... Flash smf = {SPI_1, MT25QL01GBBB, SMF_CS};
.................... 
.................... 
.................... 
.................... // ===================== Function List =====================
.................... // Public Functions
.................... #Separate
.................... int1 is_connect(Flash flash_stream);
.................... #Separate
.................... void write_data_bytes(Flash flash_stream, unsigned int32 write_start_address, int8 *write_data, unsigned int16 write_amount);      
.................... #Separate
.................... void read_data_bytes(Flash flash_stream, unsigned int32 read_start_address, int8 *read_data, unsigned int32 read_amount);  
.................... #Separate
.................... void sector_erase(Flash flash_stream, unsigned int32 sector_address);
.................... #Separate
.................... void subsector_32kByte_erase(Flash flash_stream, unsigned int32 subsector_address);  
.................... #Separate                               
.................... void subsector_4kByte_erase(Flash flash_stream, unsigned int32 subsector_address);      
.................... 
.................... //Private Functions
.................... #Separate 
.................... void flash_setting(Flash flash_stream);
.................... #Separate 
.................... int8 status_register(Flash flash_stream);
.................... #Separate 
.................... int8 read_id(Flash flash_stream);
.................... #Separate 
.................... int8 read_data_byte(Flash flash_stream, unsigned int32 read_address);                                               
.................... #Separate 
.................... void write_data_byte(Flash flash_stream, unsigned int32 write_address,int8 write_data);                             
....................         //
.................... 
.................... 
.................... // ===================== Flash Commands =====================
.................... #define CMD_READ_ID                     0x9F
.................... #define CMD_READ_STATUS_REGISTER        0x05
.................... #define CMD_READ                        0x03//for MT25QL128ABA
.................... #define CMD_4BYTE_READ                  0x13//for MT25QL01GBBB
.................... #define CMD_WRITE_ENABLE                0x06
.................... #define CMD_PAGE_PROGRAM                0x02//for MT25QL128ABA
.................... #define CMD_4BYTE_PAGE_PROGRAM          0x12//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_4KB_ERASE         0x20//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_4KB_ERASE   0x21//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_32KB_ERASE        0x52//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_32KB_ERASE  0x5C//for MT25QL01GBBB
.................... #define CMD_SECTOR_ERASE                0xD8//for MT25QL128ABA
.................... #define CMD_4BYTE_SECTOR_ERASE          0xDC//for MT25QL01GBBB
.................... 
.................... // ====================== Value List =====================
.................... #define MANUFACTURER_ID_MICRON 0x20 // Manufacturer ID for Micron flash
.................... #define READ_ID_DATASIZE 4 // 20 bytes for read ID data
.................... 
.................... 
.................... // ====================== Data Structures =====================
.................... typedef union
.................... {
.................... unsigned int8 bytes[READ_ID_DATASIZE]; // 20 bytes for read ID
.................... struct {
....................     unsigned int8 manufacturer_id; // 1 byte
....................     unsigned int8 memory_type;     // 1 byte
....................     unsigned int8 capacity;        // 1 byte
....................     unsigned int8 reserved;    
.................... } fields;
.................... }READ_ID_DATA;
.................... 
.................... #include "./src/mt25q.c"
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... #include "../../lib/mission_tools.h"
.................... #ifndef MISSION_TOOLS_H
.................... #define MISSION_TOOLS_H
.................... 
.................... #include "communication_driver.h"
.................... 
.................... 
.................... // ________________ fuctions ____________
.................... 
.................... // Check and reply to messages received from BOSS PIC
.................... void check_and_respond_to_boss();
.................... 
.................... // Request using SMF to BOSS PIC
.................... // !!!After use, you must call `void finished_use_smf()`
.................... int1 req_use_smf();
.................... 
.................... // Call after using SMF
.................... void finished_use_smf();
.................... 
.................... //unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size);
.................... 
.................... #include "./src/mission_tools.c"
.................... 
.................... #endif
.................... 
.................... 
.................... #include "../../lib/ad7490.h"
.................... #ifndef     AD7490_H
.................... #define     AD7490_H
.................... 
.................... #ifdef AD7490_DEBUG
....................    #define DEBUG_PORT PC
.................... #endif
.................... 
.................... typedef struct AD7490_STREAM
.................... {
....................     int8 spi_stream; // SPI stream number
....................     int16 cs_pin;    // Chip Select pin number
.................... };
.................... //0x8B30
.................... 
.................... 
.................... 
.................... typedef union AD7490_RESISTOR
.................... {
....................     unsigned int16 value; // 16-bit value for direct access
....................     struct fields
....................     {
....................         unsigned int blank3 :1 ; // bit 0 (LSB)
....................         unsigned int blank2 :1   ; // bit 1
....................         unsigned int blank1 :1   ; // bit 2
....................         unsigned int blank0 :1   ; // bit 3
....................         unsigned int coding:1       ; // bit 12
....................         unsigned int range   :1    ; // bit 5
....................         unsigned int weak_tri:1     ; // bit 4
....................         unsigned int shadow:1   ; // bit 13
....................         unsigned int write:1    ; // bit 15 (MSB)
....................         unsigned int seq :1     ; // bit 14
....................         unsigned int add3 :1    ; // bit 11
....................         unsigned int add2  :1   ; // bit 10
....................         unsigned int add1   :1  ; // bit 9
....................         unsigned int add0    :1 ; // bit 8
....................         unsigned int pm1    :1  ; // bit 7
....................         unsigned int pm0     :1 ; // bit 6
....................     } fields;
.................... } AD7490_RESISTOR;
.................... 
.................... unsigned int8 coding; // 1: Two's complement, 0: Binary
.................... unsigned int8 write;  // 1: Write operation, 0: Read operation
.................... unsigned int8 seq;    // 1: Sequential mode, 0: Random mode
.................... unsigned int8 range; // 1: Range mode, 0: Normal mode
.................... unsigned int8 weak_tri; // 1: Weak trigger, 0: Strong trigger
.................... unsigned int8 shadow; // 1: Shadow register, 0: Direct access
.................... unsigned int16 ad7490_readdata(unsigned int16 channel);
.................... //AD7490_RESISTOR reg;
.................... 
.................... AD7490_RESISTOR reg = {0}; // Initialize the AD7490_RESISTOR union
.................... 
.................... // Public Function 
.................... void ad7490_init(void);
.................... unsigned int16 ad7490_read(int8 channel);
.................... 
.................... unsigned int16 ad7490_make_cmd(int8 channel);
.................... 
.................... // Private Functions
.................... void set_add(int8 channel);
.................... void set_pm(int8 powermode);
.................... void print_bits(unsigned int16 data);
.................... // Resistor Settings
.................... #define AD7490_EN_WRITE 0b1
.................... 
.................... // Power Mode Register
.................... #define AD7490_PM_NORMAL 0b00000000
.................... #define AD7490_PM_SHUTDOWN 0b00000001
.................... #define AD7490_PM_AUTO_SHUTDOWN 0b00000010
.................... #define AD7490_PM_AUTO_STANDBY 0b00000011
.................... 
.................... 
.................... // ADC Channel Register
.................... #define AD7490_VIN0 0b0000
.................... #define AD7490_VIN1 0b0001
.................... #define AD7490_VIN2 0b0010
.................... #define AD7490_VIN3 0b0011
.................... #define AD7490_VIN4 0b0100
.................... #define AD7490_VIN5 0b0101
.................... #define AD7490_VIN6 0b0110
.................... #define AD7490_VIN7 0b0111
.................... #define AD7490_VIN8 0b1000
.................... #define AD7490_VIN9 0b1001
.................... #define AD7490_VIN10 0b1010
.................... #define AD7490_VIN11 0b1011
.................... #define AD7490_VIN12 0b1100
.................... #define AD7490_VIN13 0b1101
.................... #define AD7490_VIN14 0b1110
.................... #define AD7490_VIN15 0b1111
.................... 
.................... 
.................... #include "src/ad7490.c"
.................... 
.................... #endif // AD7490_H
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_flash.h"
.................... #ifndef  MMJ_CIGS_FLASH_H
.................... #define  MMJ_CIGS_FLASH_H
.................... 
.................... 
.................... 
.................... 
.................... // MIS_FM Function
.................... void misf_init(void);
.................... void update_misf_data_header(void);
.................... void write_misf_address_area(void);
.................... 
.................... 
.................... 
.................... #define PACKET_SIZE 64
.................... #define MISF_DATA_HEADER_SIZE 64 // MISF
.................... #define MISF_PICLOG_MAX_COUNT 60
.................... 
.................... 
.................... 
.................... 
.................... // __________MISF-ADDRESS__________
.................... #define ADDRESS_MISF_START              0x000000
.................... #define ADDRESS_MISF_END                0xF42400
.................... #define ADDRESS_MANEGE_START            0x000000
.................... #define ADDRESS_MANEGE_END              0x00FFFF
.................... #define ADDRESS_MISF_PICLOG_INDEX_START 0x010000
.................... #define ADDRESS_MISF_PICLOG_INDEX_END   0x01FFFF
.................... #define ADDRESS_MISF_PICLOG_DATA_START  0x020000
.................... #define ADDRESS_MISF_PICLOG_DATA_END    0x15FFFF
.................... #define ADDRESS_MISF_MEASUREMENT_START  0x160000
.................... #define ADDRESS_MISF_MEASUREMENT_END    0x95FFFF
.................... 
.................... //
.................... #define SECTOR_64K_BYTE 0x10000 // 64KByte
.................... #define SECTOR_32K_BYTE 0x8000  // 32KByte
.................... #define SECTOR_4K_BYTE  0x1000  // 4KByte
.................... 
.................... // Counter
.................... unsigned int32  smf_piclog_use_counter;
.................... unsigned int8   smf_piclog_loop_counter;
.................... unsigned int32  smf_meas_use_counter;
.................... unsigned int8   smf_meas_loop_counter;
.................... 
.................... unsigned int32  misf_piclog_use_counter;
.................... unsigned int8   misf_piclog_loop_counter;
.................... unsigned int32  misf_piclog_uncopyed_counter;
.................... unsigned int8   misf_piclog_write_counter;
.................... unsigned int32  misf_meas_use_counter;
.................... unsigned int8   misf_meas_loop_counter;
.................... unsigned int32  misf_meas_uncopyed_counter;
.................... 
.................... 
.................... #define DATA_HEADER_SIZE 64 
.................... 
.................... 
.................... 
.................... 
.................... // ___________SMF-ADDRESS___________
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_flash.c"
.................... 
.................... #endif // MMJ_CIGS_FLASH_H
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_piclog.h"
.................... #ifndef     MMJ_CIGS_PICLOG_H
.................... #define     MMJ_CIGS_PICLOG_H
.................... 
.................... #define PICLOG_PACKET_SIZE 6
.................... unsigned int8 PICLOG_STARTUP = 0x00;
.................... 
.................... // PICLOG Parameter
.................... #define PICLOG_PARAM_START 0x01
.................... #define PICLOG_PARAM_END 0x02
.................... 
.................... 
.................... // PICLOG
.................... typedef union {
....................     struct {
....................         unsigned int32  time;
....................         unsigned int8   function;
....................         unsigned int8   parameter;
....................     };
....................     unsigned int8 bytes[PICLOG_PACKET_SIZE];  
.................... } PICLOG;
.................... 
.................... // extern.c
.................... #define PICLOG_BLANK_SIZE 4 // PICLOG
.................... unsigned int8 PICLOG_BLANK_DATA[PICLOG_BLANK_SIZE] = {0x00, 0x00, 0x00, 0x00}; // PICLOG
.................... void piclog_make(unsigned int8 function, unsigned int8 parameter);
.................... void piclog_write(unsigned int8 *data);
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_piclog.c"
.................... 
.................... #endif // MMJ_CIGS_PICLOG_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... // ___________________ Mode Functions ______________________
.................... void mode_dummy(unsigned int8 uplinkcmd[])
.................... {
....................    fprintf(PC, "Start MODE DUMMY\r\n");
*
1A2A:  MOVLW  D4
1A2B:  MOVLB  03
1A2C:  MOVWF  11
1A2D:  MOVLW  03
1A2E:  MOVWF  12
1A2F:  MOVLP  08
1A30:  MOVLB  00
1A31:  CALL   0CC
1A32:  MOVLP  18
.................... 
....................    DUMMY_CMD dummy_cmd;
....................    dummy_cmd.id = uplinkcmd[0]; // Get the command ID from the uplink command
1A33:  MOVLB  0B
1A34:  MOVF   25,W
1A35:  MOVWF  04
1A36:  MOVF   26,W
1A37:  MOVWF  05
1A38:  MOVIW  [FSR0+00],W
1A39:  MOVWF  27
....................    dummy_cmd.param1 = 
....................       ((unsigned int32)uplinkcmd[1] << 24) |
....................       ((unsigned int32)uplinkcmd[2] << 16) |
....................       ((unsigned int32)uplinkcmd[3] << 8)  |
....................       ((unsigned int32)uplinkcmd[4]);
1A3A:  MOVF   25,W
1A3B:  MOVWF  04
1A3C:  MOVF   26,W
1A3D:  MOVWF  05
1A3E:  ADDFSR 01,FSR0
1A3F:  MOVF   00,W
1A40:  CLRF   31
1A41:  CLRF   30
1A42:  CLRF   2F
1A43:  MOVWF  2E
1A44:  MOVWF  31
1A45:  CLRF   2E
1A46:  CLRF   2F
1A47:  CLRF   30
1A48:  MOVF   25,W
1A49:  MOVWF  04
1A4A:  MOVF   26,W
1A4B:  MOVWF  05
1A4C:  ADDFSR 02,FSR0
1A4D:  MOVF   00,W
1A4E:  CLRF   36
1A4F:  CLRF   35
1A50:  CLRF   34
1A51:  MOVWF  33
1A52:  MOVF   34,W
1A53:  MOVWF  7A
1A54:  MOVF   33,W
1A55:  MOVWF  79
1A56:  CLRF   77
1A57:  CLRF   78
1A58:  MOVF   77,W
1A59:  IORWF  2E,F
1A5A:  MOVF   78,W
1A5B:  IORWF  2F,F
1A5C:  MOVF   33,W
1A5D:  IORWF  30,F
1A5E:  MOVF   34,W
1A5F:  IORWF  31,F
1A60:  MOVF   25,W
1A61:  MOVWF  04
1A62:  MOVF   26,W
1A63:  MOVWF  05
1A64:  ADDFSR 03,FSR0
1A65:  MOVF   00,W
1A66:  CLRF   36
1A67:  CLRF   35
1A68:  CLRF   34
1A69:  MOVWF  33
1A6A:  MOVF   35,W
1A6B:  MOVWF  7A
1A6C:  MOVF   34,W
1A6D:  MOVWF  79
1A6E:  MOVF   33,W
1A6F:  MOVWF  78
1A70:  CLRF   77
1A71:  MOVF   77,W
1A72:  IORWF  2E,F
1A73:  MOVF   33,W
1A74:  IORWF  2F,F
1A75:  MOVF   34,W
1A76:  IORWF  30,F
1A77:  MOVF   35,W
1A78:  IORWF  31,F
1A79:  MOVF   25,W
1A7A:  MOVWF  04
1A7B:  MOVF   26,W
1A7C:  MOVWF  05
1A7D:  MOVIW  [FSR0+04],W
1A7E:  MOVWF  77
1A7F:  CLRF   78
1A80:  CLRF   79
1A81:  CLRF   7A
1A82:  MOVF   77,W
1A83:  IORWF  2E,W
1A84:  MOVWF  28
1A85:  MOVF   78,W
1A86:  IORWF  2F,W
1A87:  MOVWF  29
1A88:  MOVF   79,W
1A89:  IORWF  30,W
1A8A:  MOVWF  2A
1A8B:  MOVF   7A,W
1A8C:  IORWF  31,W
1A8D:  MOVWF  2B
....................    dummy_cmd.param2 = 
....................       ((unsigned int16)uplinkcmd[5] << 8) |
....................       ((unsigned int16)uplinkcmd[6]);
1A8E:  MOVF   25,W
1A8F:  MOVWF  04
1A90:  MOVF   26,W
1A91:  MOVWF  05
1A92:  ADDFSR 05,FSR0
1A93:  MOVF   00,W
1A94:  CLRF   2F
1A95:  MOVWF  2E
1A96:  MOVWF  2F
1A97:  CLRF   2E
1A98:  MOVF   25,W
1A99:  MOVWF  04
1A9A:  MOVF   26,W
1A9B:  MOVWF  05
1A9C:  MOVIW  [FSR0+06],W
1A9D:  CLRF   7A
1A9E:  IORWF  2E,W
1A9F:  MOVWF  2C
1AA0:  MOVF   7A,W
1AA1:  IORWF  2F,W
1AA2:  MOVWF  2D
....................    fprintf(PC, "\tMODE     : %02X\r\n", dummy_cmd.id);
1AA3:  MOVLW  DE
1AA4:  MOVLB  03
1AA5:  MOVWF  11
1AA6:  MOVLW  03
1AA7:  MOVWF  12
1AA8:  BCF    03.0
1AA9:  MOVLW  0C
1AAA:  MOVLB  0C
1AAB:  MOVWF  5E
1AAC:  MOVLP  08
1AAD:  MOVLB  00
1AAE:  CALL   416
1AAF:  MOVLP  18
1AB0:  MOVLB  0B
1AB1:  MOVF   27,W
1AB2:  MOVLB  0E
1AB3:  MOVWF  4E
1AB4:  MOVLW  37
1AB5:  MOVWF  4F
1AB6:  MOVLP  08
1AB7:  MOVLB  00
1AB8:  CALL   470
1AB9:  MOVLP  18
1ABA:  MOVLW  0D
1ABB:  MOVLB  0F
1ABC:  MOVWF  43
1ABD:  MOVLP  08
1ABE:  MOVLB  00
1ABF:  CALL   0A7
1AC0:  MOVLP  18
1AC1:  MOVLW  0A
1AC2:  MOVLB  0F
1AC3:  MOVWF  43
1AC4:  MOVLP  08
1AC5:  MOVLB  00
1AC6:  CALL   0A7
1AC7:  MOVLP  18
....................    fprintf(PC, "\tParam1   : 0x%08LX\r\n", dummy_cmd.param1);
1AC8:  MOVLW  E8
1AC9:  MOVLB  03
1ACA:  MOVWF  11
1ACB:  MOVLW  03
1ACC:  MOVWF  12
1ACD:  BCF    03.0
1ACE:  MOVLW  0E
1ACF:  MOVLB  0C
1AD0:  MOVWF  5E
1AD1:  MOVLP  08
1AD2:  MOVLB  00
1AD3:  CALL   416
1AD4:  MOVLP  18
1AD5:  MOVLB  0B
1AD6:  MOVF   2B,W
1AD7:  MOVLB  0E
1AD8:  MOVWF  4E
1AD9:  MOVLW  37
1ADA:  MOVWF  4F
1ADB:  MOVLP  08
1ADC:  MOVLB  00
1ADD:  CALL   470
1ADE:  MOVLP  18
1ADF:  MOVLB  0B
1AE0:  MOVF   2A,W
1AE1:  MOVLB  0E
1AE2:  MOVWF  4E
1AE3:  MOVLW  37
1AE4:  MOVWF  4F
1AE5:  MOVLP  08
1AE6:  MOVLB  00
1AE7:  CALL   470
1AE8:  MOVLP  18
1AE9:  MOVLB  0B
1AEA:  MOVF   29,W
1AEB:  MOVLB  0E
1AEC:  MOVWF  4E
1AED:  MOVLW  37
1AEE:  MOVWF  4F
1AEF:  MOVLP  08
1AF0:  MOVLB  00
1AF1:  CALL   470
1AF2:  MOVLP  18
1AF3:  MOVLB  0B
1AF4:  MOVF   28,W
1AF5:  MOVLB  0E
1AF6:  MOVWF  4E
1AF7:  MOVLW  37
1AF8:  MOVWF  4F
1AF9:  MOVLP  08
1AFA:  MOVLB  00
1AFB:  CALL   470
1AFC:  MOVLP  18
1AFD:  MOVLW  0D
1AFE:  MOVLB  0F
1AFF:  MOVWF  43
1B00:  MOVLP  08
1B01:  MOVLB  00
1B02:  CALL   0A7
1B03:  MOVLP  18
1B04:  MOVLW  0A
1B05:  MOVLB  0F
1B06:  MOVWF  43
1B07:  MOVLP  08
1B08:  MOVLB  00
1B09:  CALL   0A7
1B0A:  MOVLP  18
....................    fprintf(PC, "\tParam2   : 0x%04LX\r\n", dummy_cmd.param2);
1B0B:  MOVLW  F3
1B0C:  MOVLB  03
1B0D:  MOVWF  11
1B0E:  MOVLW  03
1B0F:  MOVWF  12
1B10:  BCF    03.0
1B11:  MOVLW  0E
1B12:  MOVLB  0C
1B13:  MOVWF  5E
1B14:  MOVLP  08
1B15:  MOVLB  00
1B16:  CALL   416
1B17:  MOVLP  18
1B18:  MOVLB  0B
1B19:  MOVF   2D,W
1B1A:  MOVLB  0E
1B1B:  MOVWF  4E
1B1C:  MOVLW  37
1B1D:  MOVWF  4F
1B1E:  MOVLP  08
1B1F:  MOVLB  00
1B20:  CALL   470
1B21:  MOVLP  18
1B22:  MOVLB  0B
1B23:  MOVF   2C,W
1B24:  MOVLB  0E
1B25:  MOVWF  4E
1B26:  MOVLW  37
1B27:  MOVWF  4F
1B28:  MOVLP  08
1B29:  MOVLB  00
1B2A:  CALL   470
1B2B:  MOVLP  18
1B2C:  MOVLW  0D
1B2D:  MOVLB  0F
1B2E:  MOVWF  43
1B2F:  MOVLP  08
1B30:  MOVLB  00
1B31:  CALL   0A7
1B32:  MOVLP  18
1B33:  MOVLW  0A
1B34:  MOVLB  0F
1B35:  MOVWF  43
1B36:  MOVLP  08
1B37:  MOVLB  00
1B38:  CALL   0A7
1B39:  MOVLP  18
.................... 
....................    piclog_make(dummy_cmd.id, PICLOG_PARAM_START); // Log the command execution
1B3A:  MOVLB  0B
1B3B:  MOVF   27,W
1B3C:  MOVLB  0E
1B3D:  MOVWF  3C
1B3E:  MOVLW  01
1B3F:  MOVWF  3D
1B40:  MOVLP  10
1B41:  MOVLB  00
1B42:  CALL   3A7
1B43:  MOVLP  18
.................... 
....................    // This is a dummy function for testing purposes
....................    // You can add your own code here
....................    piclog_make(dummy_cmd.id, PICLOG_PARAM_END); // Log the end of the command execution
1B44:  MOVLB  0B
1B45:  MOVF   27,W
1B46:  MOVLB  0E
1B47:  MOVWF  3C
1B48:  MOVLW  02
1B49:  MOVWF  3D
1B4A:  MOVLP  10
1B4B:  MOVLB  00
1B4C:  CALL   3A7
1B4D:  MOVLP  18
....................    fprintf(PC, "End MODE DUMMY\r\n");
1B4E:  MOVLW  FE
1B4F:  MOVLB  03
1B50:  MOVWF  11
1B51:  MOVLW  03
1B52:  MOVWF  12
1B53:  MOVLP  08
1B54:  MOVLB  00
1B55:  CALL   0CC
1B56:  MOVLP  18
1B57:  MOVLP  28
1B58:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... 
.................... 
.................... // _________________ Oparation Mode ______________________
.................... #Separate
.................... void mode_measure(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start MODE MEASURE\r\n");
.................... 
.................... 
....................    unsigned int8 sweep_step = parameter[0]; // Get the measurement step from the parameter array
....................    piclog_make(parameter[0], PICLOG_PARAM_START); // Log the command execution
....................    //adc_init();
....................    sweep(parameter);
....................    
....................    
.................... }
.................... 
.................... #Separate
.................... void mode_measure_voltage()
.................... {
....................    fprintf(PC, "Start MODE MEASURE Voltage\r\n");
....................    while(TRUE)
....................    {
....................       unsigned int16 cigs_value;
....................       set_adc_channel(CIGS_VOLT);
....................       cigs_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................       //fprintf(PC, "cigs_value: %04X\r\n", cigs_value);
....................       delay_ms(1000); // wait for the ADC to stabilize
....................    }
.................... }
.................... 
.................... #Separate
.................... void mode_copy_SMF()
.................... {
....................    /*
....................    unsigned int8 smf_data[SMF_DATA_SIZE] = {0x00};
....................    unsigned int32 src = 0x00000000;
....................    unsigned int32 dest = 0x00000000;
....................    unsigned int32 size = 0x00000000;
....................    for (int i = 0; i < SMF_DATA_SIZE; i++)
....................    {
....................       smf_data[i] = read_data_byte_spi_id(src + i);
....................       fprintf(PC, "smf_data[%d]: %X\r\n", i, smf_data[i]);
....................    }
....................    enqueue_smf_data(src, dest, size);
....................    fprintf(PC, "enqueue_smf_data\r\n");
....................    */
.................... }
.................... 
.................... #Separate
.................... void mode_iv_meas_adc()
.................... {
.................... 
....................    fprintf(PC, "Start SWEEP\r\n");
*
2BC8:  MOVLW  21
2BC9:  MOVLB  03
2BCA:  MOVWF  11
2BCB:  MOVLW  04
2BCC:  MOVWF  12
2BCD:  MOVLP  08
2BCE:  MOVLB  00
2BCF:  CALL   0CC
2BD0:  MOVLP  28
....................    unsigned int8 measurement_step = 100; // Get the measurement step from the parameter array
2BD1:  MOVLW  64
2BD2:  MOVLB  0B
2BD3:  MOVWF  25
....................    fprintf(PC, "\tSweep step : %u\r\n", measurement_step);
2BD4:  MOVLW  28
2BD5:  MOVLB  03
2BD6:  MOVWF  11
2BD7:  MOVLW  04
2BD8:  MOVWF  12
2BD9:  BCF    03.0
2BDA:  MOVLW  0E
2BDB:  MOVLB  0C
2BDC:  MOVWF  5E
2BDD:  MOVLP  08
2BDE:  MOVLB  00
2BDF:  CALL   416
2BE0:  MOVLP  28
2BE1:  MOVLB  0B
2BE2:  MOVF   25,W
2BE3:  MOVLB  0C
2BE4:  MOVWF  4C
2BE5:  MOVLW  1B
2BE6:  MOVWF  4D
2BE7:  MOVLP  10
2BE8:  MOVLB  00
2BE9:  CALL   705
2BEA:  MOVLP  28
2BEB:  MOVLW  0D
2BEC:  MOVLB  0F
2BED:  MOVWF  43
2BEE:  MOVLP  08
2BEF:  MOVLB  00
2BF0:  CALL   0A7
2BF1:  MOVLP  28
2BF2:  MOVLW  0A
2BF3:  MOVLB  0F
2BF4:  MOVWF  43
2BF5:  MOVLP  08
2BF6:  MOVLB  00
2BF7:  CALL   0A7
2BF8:  MOVLP  28
....................    output_high(CONNECT_CIGS);
2BF9:  MOVLB  01
2BFA:  BCF    10.0
2BFB:  MOVLB  02
2BFC:  BSF    10.0
.................... 
....................    // read temperature
....................    set_adc_channel(TEMP_TOP);
2BFD:  MOVLW  20
2BFE:  MOVWF  78
2BFF:  MOVLB  01
2C00:  MOVF   1D,W
2C01:  ANDLW  83
2C02:  IORWF  78,W
2C03:  MOVWF  1D
2C04:  MOVLW  0F
2C05:  MOVWF  78
2C06:  MOVF   1F,W
2C07:  ANDLW  F0
2C08:  IORWF  78,W
2C09:  MOVWF  1F
....................    delay_us(10); // wait for the ADC to stabilize
2C0A:  MOVLW  0D
2C0B:  MOVWF  77
2C0C:  DECFSZ 77,F
2C0D:  GOTO   40C
....................    measured_temp_top = ad7490_read(AD7490_VIN0); // read voltage at adc pin
2C0E:  MOVLB  0B
2C0F:  CLRF   30
2C10:  MOVLB  00
2C11:  CALL   000
2C12:  MOVF   79,W
2C13:  MOVLB  08
2C14:  MOVWF  3B
2C15:  MOVF   78,W
2C16:  MOVWF  3A
....................    set_adc_channel(TEMP_BOT);
2C17:  MOVLW  0C
2C18:  MOVWF  78
2C19:  MOVLB  01
2C1A:  MOVF   1D,W
2C1B:  ANDLW  83
2C1C:  IORWF  78,W
2C1D:  MOVWF  1D
2C1E:  MOVLW  0F
2C1F:  MOVWF  78
2C20:  MOVF   1F,W
2C21:  ANDLW  F0
2C22:  IORWF  78,W
2C23:  MOVWF  1F
....................    delay_us(10); // wait for the ADC to stabilize
2C24:  MOVLW  0D
2C25:  MOVWF  77
2C26:  DECFSZ 77,F
2C27:  GOTO   426
....................    measured_temp_bot = ad7490_read(AD7490_VIN0); // read voltage at adc pin
2C28:  MOVLB  0B
2C29:  CLRF   30
2C2A:  MOVLB  00
2C2B:  CALL   000
2C2C:  MOVF   79,W
2C2D:  MOVLB  08
2C2E:  MOVWF  3D
2C2F:  MOVF   78,W
2C30:  MOVWF  3C
....................    unsigned int32 current;   
....................     // read PD value
....................     set_adc_channel(PD);
2C31:  MOVLW  00
2C32:  MOVWF  78
2C33:  MOVLB  01
2C34:  MOVF   1D,W
2C35:  ANDLW  83
2C36:  IORWF  78,W
2C37:  MOVWF  1D
2C38:  MOVLW  0F
2C39:  MOVWF  78
2C3A:  MOVF   1F,W
2C3B:  ANDLW  F0
2C3C:  IORWF  78,W
2C3D:  MOVWF  1F
....................     delay_us(10); // wait for the ADC to stabilize
2C3E:  MOVLW  0D
2C3F:  MOVWF  77
2C40:  DECFSZ 77,F
2C41:  GOTO   440
....................     // = ad7490_read(AD7490_VIN0); // voltage at adc pin
....................     
....................     // read timestamp
....................     //measured_time = timer0_get_time(); // read time from timer0
.................... 
....................    // CIGS value
....................    for (unsigned int16 count = 0; count < measurement_step; count++)
2C42:  MOVLB  0B
2C43:  CLRF   2B
2C44:  CLRF   2A
2C45:  MOVF   2B,F
2C46:  BTFSS  03.2
2C47:  GOTO   4EC
2C48:  MOVF   25,W
2C49:  SUBWF  2A,W
2C4A:  BTFSC  03.0
2C4B:  GOTO   4EC
....................    {    
....................       // set DAC value
....................       dac_write(count);
2C4C:  MOVF   2A,W
2C4D:  MOVLB  02
2C4E:  MOVWF  19
....................       delay_us(100); // wait for the DAC to stabilize
2C4F:  MOVLW  85
2C50:  MOVWF  77
2C51:  DECFSZ 77,F
2C52:  GOTO   451
.................... 
....................       // read CIGS voltage and current
....................       set_adc_channel(CIGS_VOLT);       
2C53:  MOVLW  00
2C54:  MOVWF  78
2C55:  MOVLB  01
2C56:  MOVF   1D,W
2C57:  ANDLW  83
2C58:  IORWF  78,W
2C59:  MOVWF  1D
2C5A:  MOVLW  0F
2C5B:  MOVWF  78
2C5C:  MOVF   1F,W
2C5D:  ANDLW  F0
2C5E:  IORWF  78,W
2C5F:  MOVWF  1F
....................       delay_us(10); // wait for the ADC to stabilize
2C60:  MOVLW  0D
2C61:  MOVWF  77
2C62:  DECFSZ 77,F
2C63:  GOTO   462
....................       data_buffer[count*2] =ad7490_read(AD7490_VIN0);  // read voltage at adc pin
2C64:  BCF    03.0
2C65:  MOVLB  0B
2C66:  RLF    2A,W
2C67:  MOVWF  2E
2C68:  RLF    2B,W
2C69:  MOVWF  2F
2C6A:  BCF    03.0
2C6B:  RLF    2E,W
2C6C:  MOVWF  79
2C6D:  RLF    2F,W
2C6E:  MOVWF  7A
2C6F:  MOVF   79,W
2C70:  ADDLW  3A
2C71:  MOVWF  78
2C72:  MOVLW  20
2C73:  ADDWFC 7A,F
2C74:  MOVF   78,W
2C75:  MOVWF  2E
2C76:  MOVF   7A,W
2C77:  MOVWF  2F
2C78:  CLRF   30
2C79:  MOVLB  00
2C7A:  CALL   000
2C7B:  MOVLB  0B
2C7C:  MOVF   2F,W
2C7D:  MOVWF  05
2C7E:  MOVF   2E,W
2C7F:  MOVWF  04
2C80:  MOVF   78,W
2C81:  MOVWF  00
2C82:  MOVF   79,W
2C83:  MOVWI  W,[FSR0+01]
....................       
....................       set_adc_channel(CIGS_CURR);
2C84:  MOVLW  04
2C85:  MOVWF  78
2C86:  MOVLB  01
2C87:  MOVF   1D,W
2C88:  ANDLW  83
2C89:  IORWF  78,W
2C8A:  MOVWF  1D
2C8B:  MOVLW  0F
2C8C:  MOVWF  78
2C8D:  MOVF   1F,W
2C8E:  ANDLW  F0
2C8F:  IORWF  78,W
2C90:  MOVWF  1F
....................       current = 0; // reset current value
2C91:  MOVLB  0B
2C92:  CLRF   29
2C93:  CLRF   28
2C94:  CLRF   27
2C95:  CLRF   26
....................       for(int k=0; k<10; k++)
2C96:  CLRF   2C
2C97:  MOVF   2C,W
2C98:  SUBLW  09
2C99:  BTFSS  03.0
2C9A:  GOTO   4AC
....................       {
....................                                           //  routing nth channel to adc//verYOMOGI 20220214update,byUCHIDA
....................             delay_us(10);
2C9B:  MOVLW  0D
2C9C:  MOVWF  77
2C9D:  DECFSZ 77,F
2C9E:  GOTO   49D
....................             current = current + ad7490_read(AD7490_VIN0); 
2C9F:  CLRF   30
2CA0:  MOVLB  00
2CA1:  CALL   000
2CA2:  MOVF   78,W
2CA3:  MOVLB  0B
2CA4:  ADDWF  26,F
2CA5:  MOVF   79,W
2CA6:  ADDWFC 27,F
2CA7:  MOVLW  00
2CA8:  ADDWFC 28,F
2CA9:  ADDWFC 29,F
2CAA:  INCF   2C,F
2CAB:  GOTO   497
....................       }    
....................       
....................       current = current / 10; // average the current value
2CAC:  BCF    03.1
2CAD:  MOVF   29,W
2CAE:  MOVLB  0D
2CAF:  MOVWF  23
2CB0:  MOVLB  0B
2CB1:  MOVF   28,W
2CB2:  MOVLB  0D
2CB3:  MOVWF  22
2CB4:  MOVLB  0B
2CB5:  MOVF   27,W
2CB6:  MOVLB  0D
2CB7:  MOVWF  21
2CB8:  MOVLB  0B
2CB9:  MOVF   26,W
2CBA:  MOVLB  0D
2CBB:  MOVWF  20
2CBC:  CLRF   27
2CBD:  CLRF   26
2CBE:  CLRF   25
2CBF:  MOVLW  0A
2CC0:  MOVWF  24
2CC1:  MOVLB  00
2CC2:  CALL   379
2CC3:  MOVF   7A,W
2CC4:  MOVLB  0B
2CC5:  MOVWF  29
2CC6:  MOVF   79,W
2CC7:  MOVWF  28
2CC8:  MOVF   78,W
2CC9:  MOVWF  27
2CCA:  MOVF   77,W
2CCB:  MOVWF  26
.................... 
....................       delay_us(10); // wait for the ADC to stabilize
2CCC:  MOVLW  0D
2CCD:  MOVWF  77
2CCE:  DECFSZ 77,F
2CCF:  GOTO   4CE
....................       data_buffer[count*2+1] = current; // store the current value in the buffer
2CD0:  BCF    03.0
2CD1:  RLF    2A,W
2CD2:  MOVWF  2E
2CD3:  RLF    2B,W
2CD4:  MOVWF  2F
2CD5:  MOVLW  01
2CD6:  ADDWF  2E,F
2CD7:  MOVLW  00
2CD8:  ADDWFC 2F,F
2CD9:  BCF    03.0
2CDA:  RLF    2E,W
2CDB:  MOVWF  79
2CDC:  RLF    2F,W
2CDD:  MOVWF  7A
2CDE:  MOVF   79,W
2CDF:  ADDLW  3A
2CE0:  MOVWF  04
2CE1:  MOVLW  20
2CE2:  ADDWFC 7A,W
2CE3:  MOVWF  05
2CE4:  MOVF   26,W
2CE5:  MOVWF  00
2CE6:  MOVF   27,W
2CE7:  MOVWI  W,[FSR0+01]
2CE8:  INCF   2A,F
2CE9:  BTFSC  03.2
2CEA:  INCF   2B,F
2CEB:  GOTO   445
....................       //data_buffer[count*2+1] = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................    }
.................... 
....................    fprintf(PC, "END SWEEP\r\n");
2CEC:  MOVLW  32
2CED:  MOVLB  03
2CEE:  MOVWF  11
2CEF:  MOVLW  04
2CF0:  MOVWF  12
2CF1:  MOVLP  08
2CF2:  MOVLB  00
2CF3:  CALL   0CC
2CF4:  MOVLP  28
....................    // read PD value
....................    set_adc_channel(PD);
2CF5:  MOVLW  00
2CF6:  MOVWF  78
2CF7:  MOVLB  01
2CF8:  MOVF   1D,W
2CF9:  ANDLW  83
2CFA:  IORWF  78,W
2CFB:  MOVWF  1D
2CFC:  MOVLW  0F
2CFD:  MOVWF  78
2CFE:  MOVF   1F,W
2CFF:  ANDLW  F0
2D00:  IORWF  78,W
2D01:  MOVWF  1F
....................    //measured_pd_end = read_adc(ADC_START_AND_READ); // read voltage at adc pin
.................... 
....................    //convert_cigs_data(measurement_step);
....................    //convert_header_data();    
....................    output_low(CONNECT_CIGS);
2D02:  BCF    10.0
2D03:  MOVLB  02
2D04:  BCF    10.0
2D05:  MOVLB  00
2D06:  RETURN
.................... }
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... //___________________ Debug Mode _______________
.................... #Separate
.................... void mode_test_temp()
.................... {
....................    while (TRUE)
....................    {   
....................       set_adc_channel(TEMP_TOP);
....................       unsigned int16 temp_top_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................       set_adc_channel(TEMP_BOT);
....................       unsigned int16 temp_bot_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................       fprintf(PC, "temp_top: %X\r\n", temp_top_value);
....................       fprintf(PC, "temp_bot: %X\r\n", temp_bot_value);
....................       delay_ms(1000);
....................    }
.................... }
.................... 
.................... #Separate
.................... void mode_test_PD()
.................... {
....................    while (TRUE)
....................    {
....................       unsigned int16 pd_value;
....................       set_adc_channel(PD);
....................       pd_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................       fprintf(PC, "pd_value: %X\r\n", pd_value);
....................       delay_ms(1000);
....................    }
.................... }
.................... 
.................... #Separate
.................... void mode_test_CIGS()
.................... {
....................    unsigned int16 cigs_value = 0;
....................    set_adc_channel(3);
....................    cigs_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................    fprintf(PC, "cigs_value: %X\r\n", cigs_value);
.................... }
.................... 
.................... #Separate
.................... void mode_test_current()
.................... {
....................    unsigned int16 current_value = 0;
....................    set_adc_channel(3);
....................    current_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................    fprintf(PC, "current_value: %X\r\n", current_value);
.................... }
.................... 
.................... #Separate
.................... void mode_test_voltage()
.................... {
....................    unsigned int16 voltage_value = 0;
....................    set_adc_channel(3);
....................    voltage_value = read_adc(ADC_START_AND_READ); // read voltage at adc pin
....................    fprintf(PC, "voltage_value: %X\r\n", voltage_value);
.................... }
.................... 
.................... #separate
.................... void mode_test_iv()
*
1B59:  MOVLW  64
1B5A:  MOVLB  0B
1B5B:  MOVWF  25
.................... {
....................    unsigned int8 measurement_step = 100; // Get the measurement step from the parameter array
....................    fprintf(PC, "Start MODE TEST IV\r\n");
1B5C:  MOVLW  6D
1B5D:  MOVLB  03
1B5E:  MOVWF  11
1B5F:  MOVLW  04
1B60:  MOVWF  12
1B61:  MOVLP  08
1B62:  MOVLB  00
1B63:  CALL   0CC
1B64:  MOVLP  18
....................    fprintf(PC, "\tSweep step : %u\r\n", measurement_step);
1B65:  MOVLW  78
1B66:  MOVLB  03
1B67:  MOVWF  11
1B68:  MOVLW  04
1B69:  MOVWF  12
1B6A:  BCF    03.0
1B6B:  MOVLW  0E
1B6C:  MOVLB  0C
1B6D:  MOVWF  5E
1B6E:  MOVLP  08
1B6F:  MOVLB  00
1B70:  CALL   416
1B71:  MOVLP  18
1B72:  MOVLB  0B
1B73:  MOVF   25,W
1B74:  MOVLB  0C
1B75:  MOVWF  4C
1B76:  MOVLW  1B
1B77:  MOVWF  4D
1B78:  MOVLP  10
1B79:  MOVLB  00
1B7A:  CALL   705
1B7B:  MOVLP  18
1B7C:  MOVLW  0D
1B7D:  MOVLB  0F
1B7E:  MOVWF  43
1B7F:  MOVLP  08
1B80:  MOVLB  00
1B81:  CALL   0A7
1B82:  MOVLP  18
1B83:  MOVLW  0A
1B84:  MOVLB  0F
1B85:  MOVWF  43
1B86:  MOVLP  08
1B87:  MOVLB  00
1B88:  CALL   0A7
1B89:  MOVLP  18
....................    //unsigned int16 test = 0x9330;
....................    //fprintf (PC, "Test value: %04LX\r\n", test);
....................    output_high(EN_MEAS_VOL);
1B8A:  MOVLB  01
1B8B:  BCF    0C.5
1B8C:  MOVLB  02
1B8D:  BSF    0C.5
....................    output_high(CONNECT_CIGS);
1B8E:  MOVLB  01
1B8F:  BCF    10.0
1B90:  MOVLB  02
1B91:  BSF    10.0
....................    output_low(EN_NPWR); // Enable NPWR
1B92:  MOVLB  01
1B93:  BCF    0C.4
1B94:  MOVLB  02
1B95:  BCF    0C.4
....................    unsigned int16 readdata;
....................    setup_dac(DAC_OUTPUT2 | DAC_VSS_VDD);   
1B96:  MOVLW  90
1B97:  MOVWF  18
....................    for (unsigned int16 count = 0; count < measurement_step; count++)
1B98:  MOVLB  0B
1B99:  CLRF   29
1B9A:  CLRF   28
1B9B:  MOVF   29,F
1B9C:  BTFSS  03.2
1B9D:  GOTO   40F
1B9E:  MOVF   25,W
1B9F:  SUBWF  28,W
1BA0:  BTFSC  03.0
1BA1:  GOTO   40F
....................    {    
....................       // set DAC value
....................       dac_write(count);
1BA2:  MOVF   28,W
1BA3:  MOVLB  02
1BA4:  MOVWF  19
....................       delay_ms(100); // wait for the DAC to stabilize
1BA5:  MOVLW  64
1BA6:  MOVLB  0F
1BA7:  MOVWF  57
1BA8:  MOVLP  08
1BA9:  MOVLB  00
1BAA:  CALL   7AD
1BAB:  MOVLP  18
....................       readdata = ad7490_readdata(0x8330);  // read voltage at adc pin
1BAC:  MOVLW  83
1BAD:  MOVLB  0B
1BAE:  MOVWF  2B
1BAF:  MOVLW  30
1BB0:  MOVWF  2A
1BB1:  MOVLP  10
1BB2:  MOVLB  00
1BB3:  CALL   770
1BB4:  MOVLP  18
1BB5:  MOVF   79,W
1BB6:  MOVLB  0B
1BB7:  MOVWF  27
1BB8:  MOVF   78,W
1BB9:  MOVWF  26
....................       fprintf(PC, "%04LX, ", readdata);
1BBA:  MOVF   27,W
1BBB:  MOVLB  0E
1BBC:  MOVWF  4E
1BBD:  MOVLW  37
1BBE:  MOVWF  4F
1BBF:  MOVLP  08
1BC0:  MOVLB  00
1BC1:  CALL   470
1BC2:  MOVLP  18
1BC3:  MOVLB  0B
1BC4:  MOVF   26,W
1BC5:  MOVLB  0E
1BC6:  MOVWF  4E
1BC7:  MOVLW  37
1BC8:  MOVWF  4F
1BC9:  MOVLP  08
1BCA:  MOVLB  00
1BCB:  CALL   470
1BCC:  MOVLP  18
1BCD:  MOVLW  2C
1BCE:  MOVLB  0F
1BCF:  MOVWF  43
1BD0:  MOVLP  08
1BD1:  MOVLB  00
1BD2:  CALL   0A7
1BD3:  MOVLP  18
1BD4:  MOVLW  20
1BD5:  MOVLB  0F
1BD6:  MOVWF  43
1BD7:  MOVLP  08
1BD8:  MOVLB  00
1BD9:  CALL   0A7
1BDA:  MOVLP  18
....................       readdata = ad7490_readdata(0xAF30);  // read voltage at adc pin
1BDB:  MOVLW  AF
1BDC:  MOVLB  0B
1BDD:  MOVWF  2B
1BDE:  MOVLW  30
1BDF:  MOVWF  2A
1BE0:  MOVLP  10
1BE1:  MOVLB  00
1BE2:  CALL   770
1BE3:  MOVLP  18
1BE4:  MOVF   79,W
1BE5:  MOVLB  0B
1BE6:  MOVWF  27
1BE7:  MOVF   78,W
1BE8:  MOVWF  26
....................       fprintf(PC, "%04LX\r\n", readdata);
1BE9:  MOVF   27,W
1BEA:  MOVLB  0E
1BEB:  MOVWF  4E
1BEC:  MOVLW  37
1BED:  MOVWF  4F
1BEE:  MOVLP  08
1BEF:  MOVLB  00
1BF0:  CALL   470
1BF1:  MOVLP  18
1BF2:  MOVLB  0B
1BF3:  MOVF   26,W
1BF4:  MOVLB  0E
1BF5:  MOVWF  4E
1BF6:  MOVLW  37
1BF7:  MOVWF  4F
1BF8:  MOVLP  08
1BF9:  MOVLB  00
1BFA:  CALL   470
1BFB:  MOVLP  18
1BFC:  MOVLW  0D
1BFD:  MOVLB  0F
1BFE:  MOVWF  43
1BFF:  MOVLP  08
1C00:  MOVLB  00
1C01:  CALL   0A7
1C02:  MOVLP  18
1C03:  MOVLW  0A
1C04:  MOVLB  0F
1C05:  MOVWF  43
1C06:  MOVLP  08
1C07:  MOVLB  00
1C08:  CALL   0A7
1C09:  MOVLP  18
1C0A:  MOVLB  0B
1C0B:  INCF   28,F
1C0C:  BTFSC  03.2
1C0D:  INCF   29,F
1C0E:  GOTO   39B
....................    }
1C0F:  MOVLP  28
1C10:  MOVLB  00
1C11:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... 
.................... 
.................... // ========================== Flash command ============================
.................... 
.................... #Separate
.................... void mode_flash_erase_all(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Erase All\r\n");
*
179D:  MOVLW  82
179E:  MOVLB  03
179F:  MOVWF  11
17A0:  MOVLW  04
17A1:  MOVWF  12
17A2:  MOVLP  08
17A3:  MOVLB  00
17A4:  CALL   0CC
17A5:  MOVLP  10
....................    unsigned int8 cmd = parameter[0]; // Get the command ID from the parameter array
17A6:  MOVLB  0B
17A7:  MOVF   25,W
17A8:  MOVWF  04
17A9:  MOVF   26,W
17AA:  MOVWF  05
17AB:  MOVIW  [FSR0+00],W
17AC:  MOVWF  27
....................    piclog_make(cmd, 0x00); // Log the command execution
17AD:  MOVF   27,W
17AE:  MOVLB  0E
17AF:  MOVWF  3C
17B0:  CLRF   3D
17B1:  MOVLB  00
17B2:  CALL   3A7
....................    for (unsigned int32 address = ADDRESS_MISF_START; address < ADDRESS_MISF_END; address += SECTOR_64K_BYTE) {
17B3:  MOVLB  0B
17B4:  CLRF   2B
17B5:  CLRF   2A
17B6:  CLRF   29
17B7:  CLRF   28
17B8:  MOVF   2B,F
17B9:  BTFSS  03.2
17BA:  GOTO   7E7
17BB:  MOVF   2A,W
17BC:  SUBLW  F4
17BD:  BTFSS  03.0
17BE:  GOTO   7E7
17BF:  BTFSS  03.2
17C0:  GOTO   7C5
17C1:  MOVF   29,W
17C2:  SUBLW  23
17C3:  BTFSS  03.0
17C4:  GOTO   7E7
....................       sector_erase(mis_fm, address); // Erase each sector
17C5:  MOVLB  08
17C6:  MOVF   5D,W
17C7:  MOVLB  0B
17C8:  MOVWF  31
17C9:  MOVLB  08
17CA:  MOVF   5C,W
17CB:  MOVLB  0B
17CC:  MOVWF  30
17CD:  MOVLB  08
17CE:  MOVF   5B,W
17CF:  MOVLB  0B
17D0:  MOVWF  2F
17D1:  MOVLB  08
17D2:  MOVF   5A,W
17D3:  MOVLB  0B
17D4:  MOVWF  2E
17D5:  MOVF   2B,W
17D6:  MOVWF  35
17D7:  MOVF   2A,W
17D8:  MOVWF  34
17D9:  MOVF   29,W
17DA:  MOVWF  33
17DB:  MOVF   28,W
17DC:  MOVWF  32
17DD:  MOVLP  18
17DE:  MOVLB  00
17DF:  CALL   412
17E0:  MOVLP  10
17E1:  MOVLW  01
17E2:  MOVLB  0B
17E3:  ADDWF  2A,F
17E4:  MOVLW  00
17E5:  ADDWFC 2B,F
17E6:  GOTO   7B8
....................    }
....................    piclog_make(cmd, PICLOG_PARAM_END); // Log the end of the command execution
17E7:  MOVF   27,W
17E8:  MOVLB  0E
17E9:  MOVWF  3C
17EA:  MOVLW  02
17EB:  MOVWF  3D
17EC:  MOVLB  00
17ED:  CALL   3A7
....................    fprintf(PC, "End Flash Erase All\r\n");
17EE:  MOVLW  8E
17EF:  MOVLB  03
17F0:  MOVWF  11
17F1:  MOVLW  04
17F2:  MOVWF  12
17F3:  MOVLP  08
17F4:  MOVLB  00
17F5:  CALL   0CC
17F6:  MOVLP  10
17F7:  MOVLP  28
17F8:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_erase_1sector(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Erase 1 Sector\r\n");
*
1DB3:  MOVLW  99
1DB4:  MOVLB  03
1DB5:  MOVWF  11
1DB6:  MOVLW  04
1DB7:  MOVWF  12
1DB8:  MOVLP  08
1DB9:  MOVLB  00
1DBA:  CALL   0CC
1DBB:  MOVLP  18
....................    unsigned int8 cmd = parameter[0]; // Get the command ID from the parameter array
....................    unsigned int32 sector_address = 
....................       ((unsigned int32)parameter[1] << 24) |
....................       ((unsigned int32)parameter[2] << 16) |
....................       ((unsigned int32)parameter[3] << 8)  |
....................       ((unsigned int32)parameter[4]);
1DBC:  MOVLB  0B
1DBD:  MOVF   25,W
1DBE:  MOVWF  04
1DBF:  MOVF   26,W
1DC0:  MOVWF  05
1DC1:  ADDFSR 00,FSR0
1DC2:  MOVF   00,W
1DC3:  MOVWF  27
1DC4:  MOVF   25,W
1DC5:  MOVWF  04
1DC6:  MOVF   26,W
1DC7:  MOVWF  05
1DC8:  ADDFSR 01,FSR0
1DC9:  MOVF   00,W
1DCA:  CLRF   31
1DCB:  CLRF   30
1DCC:  CLRF   2F
1DCD:  MOVWF  2E
1DCE:  MOVWF  31
1DCF:  CLRF   2E
1DD0:  CLRF   2F
1DD1:  CLRF   30
1DD2:  MOVF   25,W
1DD3:  MOVWF  04
1DD4:  MOVF   26,W
1DD5:  MOVWF  05
1DD6:  ADDFSR 02,FSR0
1DD7:  MOVF   00,W
1DD8:  CLRF   36
1DD9:  CLRF   35
1DDA:  CLRF   34
1DDB:  MOVWF  33
1DDC:  MOVF   34,W
1DDD:  MOVWF  7A
1DDE:  MOVF   33,W
1DDF:  MOVWF  79
1DE0:  CLRF   77
1DE1:  CLRF   78
1DE2:  MOVF   77,W
1DE3:  IORWF  2E,F
1DE4:  MOVF   78,W
1DE5:  IORWF  2F,F
1DE6:  MOVF   33,W
1DE7:  IORWF  30,F
1DE8:  MOVF   34,W
1DE9:  IORWF  31,F
1DEA:  MOVF   25,W
1DEB:  MOVWF  04
1DEC:  MOVF   26,W
1DED:  MOVWF  05
1DEE:  ADDFSR 03,FSR0
1DEF:  MOVF   00,W
1DF0:  CLRF   36
1DF1:  CLRF   35
1DF2:  CLRF   34
1DF3:  MOVWF  33
1DF4:  MOVF   35,W
1DF5:  MOVWF  7A
1DF6:  MOVF   34,W
1DF7:  MOVWF  79
1DF8:  MOVF   33,W
1DF9:  MOVWF  78
1DFA:  CLRF   77
1DFB:  MOVF   77,W
1DFC:  IORWF  2E,F
1DFD:  MOVF   33,W
1DFE:  IORWF  2F,F
1DFF:  MOVF   34,W
1E00:  IORWF  30,F
1E01:  MOVF   35,W
1E02:  IORWF  31,F
1E03:  MOVF   25,W
1E04:  MOVWF  04
1E05:  MOVF   26,W
1E06:  MOVWF  05
1E07:  MOVIW  [FSR0+04],W
1E08:  MOVWF  77
1E09:  CLRF   78
1E0A:  CLRF   79
1E0B:  CLRF   7A
1E0C:  MOVF   77,W
1E0D:  IORWF  2E,W
1E0E:  MOVWF  28
1E0F:  MOVF   78,W
1E10:  IORWF  2F,W
1E11:  MOVWF  29
1E12:  MOVF   79,W
1E13:  IORWF  30,W
1E14:  MOVWF  2A
1E15:  MOVF   7A,W
1E16:  IORWF  31,W
1E17:  MOVWF  2B
.................... 
....................    fprintf(PC, "\tSector Address: 0x%08LX\r\n", sector_address);
1E18:  MOVLW  A8
1E19:  MOVLB  03
1E1A:  MOVWF  11
1E1B:  MOVLW  04
1E1C:  MOVWF  12
1E1D:  BCF    03.0
1E1E:  MOVLW  13
1E1F:  MOVLB  0C
1E20:  MOVWF  5E
1E21:  MOVLP  08
1E22:  MOVLB  00
1E23:  CALL   416
1E24:  MOVLP  18
1E25:  MOVLB  0B
1E26:  MOVF   2B,W
1E27:  MOVLB  0E
1E28:  MOVWF  4E
1E29:  MOVLW  37
1E2A:  MOVWF  4F
1E2B:  MOVLP  08
1E2C:  MOVLB  00
1E2D:  CALL   470
1E2E:  MOVLP  18
1E2F:  MOVLB  0B
1E30:  MOVF   2A,W
1E31:  MOVLB  0E
1E32:  MOVWF  4E
1E33:  MOVLW  37
1E34:  MOVWF  4F
1E35:  MOVLP  08
1E36:  MOVLB  00
1E37:  CALL   470
1E38:  MOVLP  18
1E39:  MOVLB  0B
1E3A:  MOVF   29,W
1E3B:  MOVLB  0E
1E3C:  MOVWF  4E
1E3D:  MOVLW  37
1E3E:  MOVWF  4F
1E3F:  MOVLP  08
1E40:  MOVLB  00
1E41:  CALL   470
1E42:  MOVLP  18
1E43:  MOVLB  0B
1E44:  MOVF   28,W
1E45:  MOVLB  0E
1E46:  MOVWF  4E
1E47:  MOVLW  37
1E48:  MOVWF  4F
1E49:  MOVLP  08
1E4A:  MOVLB  00
1E4B:  CALL   470
1E4C:  MOVLP  18
1E4D:  MOVLW  0D
1E4E:  MOVLB  0F
1E4F:  MOVWF  43
1E50:  MOVLP  08
1E51:  MOVLB  00
1E52:  CALL   0A7
1E53:  MOVLP  18
1E54:  MOVLW  0A
1E55:  MOVLB  0F
1E56:  MOVWF  43
1E57:  MOVLP  08
1E58:  MOVLB  00
1E59:  CALL   0A7
1E5A:  MOVLP  18
....................    piclog_make(cmd, PICLOG_PARAM_START); // Log the command execution
1E5B:  MOVLB  0B
1E5C:  MOVF   27,W
1E5D:  MOVLB  0E
1E5E:  MOVWF  3C
1E5F:  MOVLW  01
1E60:  MOVWF  3D
1E61:  MOVLP  10
1E62:  MOVLB  00
1E63:  CALL   3A7
1E64:  MOVLP  18
....................    
....................    sector_erase(mis_fm, sector_address);
1E65:  MOVLB  08
1E66:  MOVF   5D,W
1E67:  MOVLB  0B
1E68:  MOVWF  31
1E69:  MOVLB  08
1E6A:  MOVF   5C,W
1E6B:  MOVLB  0B
1E6C:  MOVWF  30
1E6D:  MOVLB  08
1E6E:  MOVF   5B,W
1E6F:  MOVLB  0B
1E70:  MOVWF  2F
1E71:  MOVLB  08
1E72:  MOVF   5A,W
1E73:  MOVLB  0B
1E74:  MOVWF  2E
1E75:  MOVF   2B,W
1E76:  MOVWF  35
1E77:  MOVF   2A,W
1E78:  MOVWF  34
1E79:  MOVF   29,W
1E7A:  MOVWF  33
1E7B:  MOVF   28,W
1E7C:  MOVWF  32
1E7D:  MOVLB  00
1E7E:  CALL   412
....................    piclog_make(cmd, PICLOG_PARAM_END); // Log the end of the command execution
1E7F:  MOVLB  0B
1E80:  MOVF   27,W
1E81:  MOVLB  0E
1E82:  MOVWF  3C
1E83:  MOVLW  02
1E84:  MOVWF  3D
1E85:  MOVLP  10
1E86:  MOVLB  00
1E87:  CALL   3A7
1E88:  MOVLP  18
....................    fprintf(PC, "End Flash Erase 1 Sector\r\n");
1E89:  MOVLW  B6
1E8A:  MOVLB  03
1E8B:  MOVWF  11
1E8C:  MOVLW  04
1E8D:  MOVWF  12
1E8E:  MOVLP  08
1E8F:  MOVLB  00
1E90:  CALL   0CC
1E91:  MOVLP  18
1E92:  MOVLP  28
1E93:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_erase_4kbyte_subsector(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Copy 1 Sector\r\n");
1E94:  MOVLW  C4
1E95:  MOVLB  03
1E96:  MOVWF  11
1E97:  MOVLW  04
1E98:  MOVWF  12
1E99:  MOVLP  08
1E9A:  MOVLB  00
1E9B:  CALL   0CC
1E9C:  MOVLP  18
....................    unsigned int8 cmd = parameter[0]; // Get the command ID from the parameter array
....................    unsigned int32 subsector_address =
....................       ((unsigned int32)parameter[1] << 24) |
....................       ((unsigned int32)parameter[2] << 16) |
....................       ((unsigned int32)parameter[3] << 8)  |
....................       ((unsigned int32)parameter[4]);
1E9D:  MOVLB  0B
1E9E:  MOVF   25,W
1E9F:  MOVWF  04
1EA0:  MOVF   26,W
1EA1:  MOVWF  05
1EA2:  ADDFSR 00,FSR0
1EA3:  MOVF   00,W
1EA4:  MOVWF  27
1EA5:  MOVF   25,W
1EA6:  MOVWF  04
1EA7:  MOVF   26,W
1EA8:  MOVWF  05
1EA9:  ADDFSR 01,FSR0
1EAA:  MOVF   00,W
1EAB:  CLRF   31
1EAC:  CLRF   30
1EAD:  CLRF   2F
1EAE:  MOVWF  2E
1EAF:  MOVWF  31
1EB0:  CLRF   2E
1EB1:  CLRF   2F
1EB2:  CLRF   30
1EB3:  MOVF   25,W
1EB4:  MOVWF  04
1EB5:  MOVF   26,W
1EB6:  MOVWF  05
1EB7:  ADDFSR 02,FSR0
1EB8:  MOVF   00,W
1EB9:  CLRF   36
1EBA:  CLRF   35
1EBB:  CLRF   34
1EBC:  MOVWF  33
1EBD:  MOVF   34,W
1EBE:  MOVWF  7A
1EBF:  MOVF   33,W
1EC0:  MOVWF  79
1EC1:  CLRF   77
1EC2:  CLRF   78
1EC3:  MOVF   77,W
1EC4:  IORWF  2E,F
1EC5:  MOVF   78,W
1EC6:  IORWF  2F,F
1EC7:  MOVF   33,W
1EC8:  IORWF  30,F
1EC9:  MOVF   34,W
1ECA:  IORWF  31,F
1ECB:  MOVF   25,W
1ECC:  MOVWF  04
1ECD:  MOVF   26,W
1ECE:  MOVWF  05
1ECF:  ADDFSR 03,FSR0
1ED0:  MOVF   00,W
1ED1:  CLRF   36
1ED2:  CLRF   35
1ED3:  CLRF   34
1ED4:  MOVWF  33
1ED5:  MOVF   35,W
1ED6:  MOVWF  7A
1ED7:  MOVF   34,W
1ED8:  MOVWF  79
1ED9:  MOVF   33,W
1EDA:  MOVWF  78
1EDB:  CLRF   77
1EDC:  MOVF   77,W
1EDD:  IORWF  2E,F
1EDE:  MOVF   33,W
1EDF:  IORWF  2F,F
1EE0:  MOVF   34,W
1EE1:  IORWF  30,F
1EE2:  MOVF   35,W
1EE3:  IORWF  31,F
1EE4:  MOVF   25,W
1EE5:  MOVWF  04
1EE6:  MOVF   26,W
1EE7:  MOVWF  05
1EE8:  MOVIW  [FSR0+04],W
1EE9:  MOVWF  77
1EEA:  CLRF   78
1EEB:  CLRF   79
1EEC:  CLRF   7A
1EED:  MOVF   77,W
1EEE:  IORWF  2E,W
1EEF:  MOVWF  28
1EF0:  MOVF   78,W
1EF1:  IORWF  2F,W
1EF2:  MOVWF  29
1EF3:  MOVF   79,W
1EF4:  IORWF  30,W
1EF5:  MOVWF  2A
1EF6:  MOVF   7A,W
1EF7:  IORWF  31,W
1EF8:  MOVWF  2B
....................    
....................    fprintf(PC, "\tSubsector Address: 0x%08LX\r\n", subsector_address);
1EF9:  MOVLW  D2
1EFA:  MOVLB  03
1EFB:  MOVWF  11
1EFC:  MOVLW  04
1EFD:  MOVWF  12
1EFE:  BCF    03.0
1EFF:  MOVLW  16
1F00:  MOVLB  0C
1F01:  MOVWF  5E
1F02:  MOVLP  08
1F03:  MOVLB  00
1F04:  CALL   416
1F05:  MOVLP  18
1F06:  MOVLB  0B
1F07:  MOVF   2B,W
1F08:  MOVLB  0E
1F09:  MOVWF  4E
1F0A:  MOVLW  37
1F0B:  MOVWF  4F
1F0C:  MOVLP  08
1F0D:  MOVLB  00
1F0E:  CALL   470
1F0F:  MOVLP  18
1F10:  MOVLB  0B
1F11:  MOVF   2A,W
1F12:  MOVLB  0E
1F13:  MOVWF  4E
1F14:  MOVLW  37
1F15:  MOVWF  4F
1F16:  MOVLP  08
1F17:  MOVLB  00
1F18:  CALL   470
1F19:  MOVLP  18
1F1A:  MOVLB  0B
1F1B:  MOVF   29,W
1F1C:  MOVLB  0E
1F1D:  MOVWF  4E
1F1E:  MOVLW  37
1F1F:  MOVWF  4F
1F20:  MOVLP  08
1F21:  MOVLB  00
1F22:  CALL   470
1F23:  MOVLP  18
1F24:  MOVLB  0B
1F25:  MOVF   28,W
1F26:  MOVLB  0E
1F27:  MOVWF  4E
1F28:  MOVLW  37
1F29:  MOVWF  4F
1F2A:  MOVLP  08
1F2B:  MOVLB  00
1F2C:  CALL   470
1F2D:  MOVLP  18
1F2E:  MOVLW  0D
1F2F:  MOVLB  0F
1F30:  MOVWF  43
1F31:  MOVLP  08
1F32:  MOVLB  00
1F33:  CALL   0A7
1F34:  MOVLP  18
1F35:  MOVLW  0A
1F36:  MOVLB  0F
1F37:  MOVWF  43
1F38:  MOVLP  08
1F39:  MOVLB  00
1F3A:  CALL   0A7
1F3B:  MOVLP  18
....................    piclog_make(cmd, PICLOG_PARAM_START); // Log the command execution
1F3C:  MOVLB  0B
1F3D:  MOVF   27,W
1F3E:  MOVLB  0E
1F3F:  MOVWF  3C
1F40:  MOVLW  01
1F41:  MOVWF  3D
1F42:  MOVLP  10
1F43:  MOVLB  00
1F44:  CALL   3A7
1F45:  MOVLP  18
....................    
....................    subsector_4kByte_erase(mis_fm, 0x00000000);
1F46:  MOVLB  08
1F47:  MOVF   5D,W
1F48:  MOVLB  0F
1F49:  MOVWF  41
1F4A:  MOVLB  08
1F4B:  MOVF   5C,W
1F4C:  MOVLB  0F
1F4D:  MOVWF  40
1F4E:  MOVLB  08
1F4F:  MOVF   5B,W
1F50:  MOVLB  0F
1F51:  MOVWF  3F
1F52:  MOVLB  08
1F53:  MOVF   5A,W
1F54:  MOVLB  0F
1F55:  MOVWF  3E
1F56:  CLRF   45
1F57:  CLRF   44
1F58:  CLRF   43
1F59:  CLRF   42
1F5A:  MOVLP  10
1F5B:  MOVLB  00
1F5C:  CALL   23B
1F5D:  MOVLP  18
....................    piclog_make(cmd, PICLOG_PARAM_END); // Log the end of the command execution
1F5E:  MOVLB  0B
1F5F:  MOVF   27,W
1F60:  MOVLB  0E
1F61:  MOVWF  3C
1F62:  MOVLW  02
1F63:  MOVWF  3D
1F64:  MOVLP  10
1F65:  MOVLB  00
1F66:  CALL   3A7
1F67:  MOVLP  18
....................    fprintf(PC, "End Flash Copy 1 Sector\r\n");
1F68:  MOVLW  E1
1F69:  MOVLB  03
1F6A:  MOVWF  11
1F6B:  MOVLW  04
1F6C:  MOVWF  12
1F6D:  MOVLP  08
1F6E:  MOVLB  00
1F6F:  CALL   0CC
1F70:  MOVLP  18
1F71:  MOVLP  28
1F72:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_write_demo(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Write Demo\r\n");
*
2000:  MOVLW  EE
2001:  MOVLB  03
2002:  MOVWF  11
2003:  MOVLW  04
2004:  MOVWF  12
2005:  MOVLP  08
2006:  MOVLB  00
2007:  CALL   0CC
2008:  MOVLP  20
....................    piclog_make(parameter[0], PICLOG_PARAM_START); // Log the command execution
2009:  MOVLB  0B
200A:  MOVF   25,W
200B:  MOVWF  04
200C:  MOVF   26,W
200D:  MOVWF  05
200E:  ADDFSR 00,FSR0
200F:  MOVF   00,W
2010:  MOVLB  0C
2011:  MOVWF  2E
2012:  MOVLB  0E
2013:  MOVWF  3C
2014:  MOVLW  01
2015:  MOVWF  3D
2016:  MOVLP  10
2017:  MOVLB  00
2018:  CALL   3A7
2019:  MOVLP  20
.................... 
....................    FLASH_WRITE_PARAM flash_write_param = {0};
201A:  MOVLB  0B
201B:  CLRF   27
201C:  CLRF   28
201D:  CLRF   29
201E:  CLRF   2A
201F:  CLRF   2B
2020:  CLRF   2C
2021:  CLRF   2D
....................    
....................    flash_write_param.id = parameter[0];
2022:  MOVF   25,W
2023:  MOVWF  04
2024:  MOVF   26,W
2025:  MOVWF  05
2026:  MOVIW  [FSR0+00],W
2027:  MOVWF  27
....................    flash_write_param.writeaddress =
....................    ((unsigned int32)parameter[1] << 24) |
....................    ((unsigned int32)parameter[2] << 16) |
....................    ((unsigned int32)parameter[3] << 8)  |
....................    ((unsigned int32)parameter[4]);
2028:  MOVF   25,W
2029:  MOVWF  04
202A:  MOVF   26,W
202B:  MOVWF  05
202C:  ADDFSR 01,FSR0
202D:  MOVF   00,W
202E:  MOVLB  0C
202F:  CLRF   31
2030:  CLRF   30
2031:  CLRF   2F
2032:  MOVWF  2E
2033:  MOVWF  31
2034:  CLRF   2E
2035:  CLRF   2F
2036:  CLRF   30
2037:  MOVLB  0B
2038:  MOVF   25,W
2039:  MOVWF  04
203A:  MOVF   26,W
203B:  MOVWF  05
203C:  ADDFSR 02,FSR0
203D:  MOVF   00,W
203E:  MOVLB  0C
203F:  CLRF   36
2040:  CLRF   35
2041:  CLRF   34
2042:  MOVWF  33
2043:  MOVF   34,W
2044:  MOVWF  7A
2045:  MOVF   33,W
2046:  MOVWF  79
2047:  CLRF   77
2048:  CLRF   78
2049:  MOVF   77,W
204A:  IORWF  2E,F
204B:  MOVF   78,W
204C:  IORWF  2F,F
204D:  MOVF   33,W
204E:  IORWF  30,F
204F:  MOVF   34,W
2050:  IORWF  31,F
2051:  MOVLB  0B
2052:  MOVF   25,W
2053:  MOVWF  04
2054:  MOVF   26,W
2055:  MOVWF  05
2056:  ADDFSR 03,FSR0
2057:  MOVF   00,W
2058:  MOVLB  0C
2059:  CLRF   36
205A:  CLRF   35
205B:  CLRF   34
205C:  MOVWF  33
205D:  MOVF   35,W
205E:  MOVWF  7A
205F:  MOVF   34,W
2060:  MOVWF  79
2061:  MOVF   33,W
2062:  MOVWF  78
2063:  CLRF   77
2064:  MOVF   77,W
2065:  IORWF  2E,F
2066:  MOVF   33,W
2067:  IORWF  2F,F
2068:  MOVF   34,W
2069:  IORWF  30,F
206A:  MOVF   35,W
206B:  IORWF  31,F
206C:  MOVLB  0B
206D:  MOVF   25,W
206E:  MOVWF  04
206F:  MOVF   26,W
2070:  MOVWF  05
2071:  MOVIW  [FSR0+04],W
2072:  MOVWF  77
2073:  CLRF   78
2074:  CLRF   79
2075:  CLRF   7A
2076:  MOVF   77,W
2077:  MOVLB  0C
2078:  IORWF  2E,W
2079:  MOVLB  0B
207A:  MOVWF  28
207B:  MOVF   78,W
207C:  MOVLB  0C
207D:  IORWF  2F,W
207E:  MOVLB  0B
207F:  MOVWF  29
2080:  MOVF   79,W
2081:  MOVLB  0C
2082:  IORWF  30,W
2083:  MOVLB  0B
2084:  MOVWF  2A
2085:  MOVF   7A,W
2086:  MOVLB  0C
2087:  IORWF  31,W
2088:  MOVLB  0B
2089:  MOVWF  2B
....................    flash_write_param.packetnum =
....................    ((unsigned int16)parameter[7] << 8) |
....................    ((unsigned int16)parameter[8]);
208A:  MOVF   25,W
208B:  MOVWF  04
208C:  MOVF   26,W
208D:  MOVWF  05
208E:  ADDFSR 07,FSR0
208F:  MOVF   00,W
2090:  MOVLB  0C
2091:  CLRF   2F
2092:  MOVWF  2E
2093:  MOVWF  2F
2094:  CLRF   2E
2095:  MOVLB  0B
2096:  MOVF   25,W
2097:  MOVWF  04
2098:  MOVF   26,W
2099:  MOVWF  05
209A:  MOVIW  [FSR0+08],W
209B:  CLRF   7A
209C:  MOVLB  0C
209D:  IORWF  2E,W
209E:  MOVLB  0B
209F:  MOVWF  2C
20A0:  MOVF   7A,W
20A1:  MOVLB  0C
20A2:  IORWF  2F,W
20A3:  MOVLB  0B
20A4:  MOVWF  2D
.................... 
....................    fprintf(PC, "\tMODE     : %02X\r\n", flash_write_param.id);
20A5:  MOVLW  FB
20A6:  MOVLB  03
20A7:  MOVWF  11
20A8:  MOVLW  04
20A9:  MOVWF  12
20AA:  BCF    03.0
20AB:  MOVLW  0C
20AC:  MOVLB  0C
20AD:  MOVWF  5E
20AE:  MOVLP  08
20AF:  MOVLB  00
20B0:  CALL   416
20B1:  MOVLP  20
20B2:  MOVLB  0B
20B3:  MOVF   27,W
20B4:  MOVLB  0E
20B5:  MOVWF  4E
20B6:  MOVLW  37
20B7:  MOVWF  4F
20B8:  MOVLP  08
20B9:  MOVLB  00
20BA:  CALL   470
20BB:  MOVLP  20
20BC:  MOVLW  0D
20BD:  MOVLB  0F
20BE:  MOVWF  43
20BF:  MOVLP  08
20C0:  MOVLB  00
20C1:  CALL   0A7
20C2:  MOVLP  20
20C3:  MOVLW  0A
20C4:  MOVLB  0F
20C5:  MOVWF  43
20C6:  MOVLP  08
20C7:  MOVLB  00
20C8:  CALL   0A7
20C9:  MOVLP  20
....................    fprintf(PC, "\tAddress  : 0x%08LX\r\n", flash_write_param.writeaddress);
20CA:  MOVLW  05
20CB:  MOVLB  03
20CC:  MOVWF  11
20CD:  MOVLW  05
20CE:  MOVWF  12
20CF:  BCF    03.0
20D0:  MOVLW  0E
20D1:  MOVLB  0C
20D2:  MOVWF  5E
20D3:  MOVLP  08
20D4:  MOVLB  00
20D5:  CALL   416
20D6:  MOVLP  20
20D7:  MOVLB  0B
20D8:  MOVF   2B,W
20D9:  MOVLB  0E
20DA:  MOVWF  4E
20DB:  MOVLW  37
20DC:  MOVWF  4F
20DD:  MOVLP  08
20DE:  MOVLB  00
20DF:  CALL   470
20E0:  MOVLP  20
20E1:  MOVLB  0B
20E2:  MOVF   2A,W
20E3:  MOVLB  0E
20E4:  MOVWF  4E
20E5:  MOVLW  37
20E6:  MOVWF  4F
20E7:  MOVLP  08
20E8:  MOVLB  00
20E9:  CALL   470
20EA:  MOVLP  20
20EB:  MOVLB  0B
20EC:  MOVF   29,W
20ED:  MOVLB  0E
20EE:  MOVWF  4E
20EF:  MOVLW  37
20F0:  MOVWF  4F
20F1:  MOVLP  08
20F2:  MOVLB  00
20F3:  CALL   470
20F4:  MOVLP  20
20F5:  MOVLB  0B
20F6:  MOVF   28,W
20F7:  MOVLB  0E
20F8:  MOVWF  4E
20F9:  MOVLW  37
20FA:  MOVWF  4F
20FB:  MOVLP  08
20FC:  MOVLB  00
20FD:  CALL   470
20FE:  MOVLP  20
20FF:  MOVLW  0D
2100:  MOVLB  0F
2101:  MOVWF  43
2102:  MOVLP  08
2103:  MOVLB  00
2104:  CALL   0A7
2105:  MOVLP  20
2106:  MOVLW  0A
2107:  MOVLB  0F
2108:  MOVWF  43
2109:  MOVLP  08
210A:  MOVLB  00
210B:  CALL   0A7
210C:  MOVLP  20
....................    fprintf(PC, "\tPacketNum: 0x%04LX\r\n", flash_write_param.packetnum);
210D:  MOVLW  10
210E:  MOVLB  03
210F:  MOVWF  11
2110:  MOVLW  05
2111:  MOVWF  12
2112:  BCF    03.0
2113:  MOVLW  0E
2114:  MOVLB  0C
2115:  MOVWF  5E
2116:  MOVLP  08
2117:  MOVLB  00
2118:  CALL   416
2119:  MOVLP  20
211A:  MOVLB  0B
211B:  MOVF   2D,W
211C:  MOVLB  0E
211D:  MOVWF  4E
211E:  MOVLW  37
211F:  MOVWF  4F
2120:  MOVLP  08
2121:  MOVLB  00
2122:  CALL   470
2123:  MOVLP  20
2124:  MOVLB  0B
2125:  MOVF   2C,W
2126:  MOVLB  0E
2127:  MOVWF  4E
2128:  MOVLW  37
2129:  MOVWF  4F
212A:  MOVLP  08
212B:  MOVLB  00
212C:  CALL   470
212D:  MOVLP  20
212E:  MOVLW  0D
212F:  MOVLB  0F
2130:  MOVWF  43
2131:  MOVLP  08
2132:  MOVLB  00
2133:  CALL   0A7
2134:  MOVLP  20
2135:  MOVLW  0A
2136:  MOVLB  0F
2137:  MOVWF  43
2138:  MOVLP  08
2139:  MOVLB  00
213A:  CALL   0A7
213B:  MOVLP  20
.................... 
....................    piclog_make(flash_write_param.id, 0x00); // Log the command execution
213C:  MOVLB  0B
213D:  MOVF   27,W
213E:  MOVLB  0E
213F:  MOVWF  3C
2140:  CLRF   3D
2141:  MOVLP  10
2142:  MOVLB  00
2143:  CALL   3A7
2144:  MOVLP  20
....................    
....................    unsigned int8 writedata[64];
....................    unsigned int16 p; // packet index
....................    unsigned int16 base_value;
.................... 
....................    fprintf(PC, "Write Data\r\n");
2145:  MOVLW  1B
2146:  MOVLB  03
2147:  MOVWF  11
2148:  MOVLW  05
2149:  MOVWF  12
214A:  MOVLP  08
214B:  MOVLB  00
214C:  CALL   0CC
214D:  MOVLP  20
....................    for (p = 0; p < flash_write_param.packetnum; p++)
214E:  MOVLB  0B
214F:  CLRF   6F
2150:  CLRF   6E
2151:  MOVF   6F,W
2152:  SUBWF  2D,W
2153:  BTFSS  03.0
2154:  GOTO   1F2
2155:  BTFSS  03.2
2156:  GOTO   15B
2157:  MOVF   2C,W
2158:  SUBWF  6E,W
2159:  BTFSC  03.0
215A:  GOTO   1F2
....................    {
....................       base_value = p * PACKET_SIZE;  // 
215B:  RLF    6E,W
215C:  MOVLB  0C
215D:  MOVWF  20
215E:  MOVLB  0B
215F:  RLF    6F,W
2160:  MOVLB  0C
2161:  MOVWF  21
2162:  RLF    20,F
2163:  RLF    21,F
2164:  RLF    20,F
2165:  RLF    21,F
2166:  RLF    20,F
2167:  RLF    21,F
2168:  RLF    20,F
2169:  RLF    21,F
216A:  RLF    20,F
216B:  RLF    21,F
216C:  MOVLW  C0
216D:  ANDWF  20,F
.................... 
....................       for (unsigned int8 i = 0; i < PACKET_SIZE; i++)
216E:  CLRF   22
216F:  MOVF   22,W
2170:  SUBLW  3F
2171:  BTFSS  03.0
2172:  GOTO   19E
....................       {
....................          writedata[i] = (base_value + i) & 0xFF; // 0x000xFF
2173:  MOVLW  7E
2174:  ADDWF  22,W
2175:  MOVWF  04
2176:  MOVLW  23
2177:  MOVWF  05
2178:  BTFSC  03.0
2179:  INCF   05,F
217A:  MOVF   22,W
217B:  ADDWF  20,W
217C:  MOVWF  30
217D:  MOVLW  00
217E:  ADDWFC 21,W
217F:  MOVWF  31
2180:  CLRF   7A
2181:  MOVF   30,W
2182:  MOVWF  00
....................          fprintf(PC, "%02X ", writedata[i]); // 
2183:  MOVLW  7E
2184:  ADDWF  22,W
2185:  MOVWF  04
2186:  MOVLW  23
2187:  MOVWF  05
2188:  BTFSC  03.0
2189:  INCF   05,F
218A:  MOVF   00,W
218B:  MOVWF  2E
218C:  MOVLB  0E
218D:  MOVWF  4E
218E:  MOVLW  37
218F:  MOVWF  4F
2190:  MOVLP  08
2191:  MOVLB  00
2192:  CALL   470
2193:  MOVLP  20
2194:  MOVLW  20
2195:  MOVLB  0F
2196:  MOVWF  43
2197:  MOVLP  08
2198:  MOVLB  00
2199:  CALL   0A7
219A:  MOVLP  20
219B:  MOVLB  0C
219C:  INCF   22,F
219D:  GOTO   16F
....................       }
.................... 
....................       unsigned int32 current_address = flash_write_param.writeaddress + (p * PACKET_SIZE);
219E:  MOVLB  0B
219F:  RLF    6E,W
21A0:  MOVWF  79
21A1:  RLF    6F,W
21A2:  MOVWF  7A
21A3:  RLF    79,F
21A4:  RLF    7A,F
21A5:  RLF    79,F
21A6:  RLF    7A,F
21A7:  RLF    79,F
21A8:  RLF    7A,F
21A9:  RLF    79,F
21AA:  RLF    7A,F
21AB:  RLF    79,F
21AC:  RLF    7A,F
21AD:  MOVLW  C0
21AE:  ANDWF  79,F
21AF:  MOVF   79,W
21B0:  ADDWF  28,W
21B1:  MOVLB  0C
21B2:  MOVWF  23
21B3:  MOVF   7A,W
21B4:  MOVLB  0B
21B5:  ADDWFC 29,W
21B6:  MOVLB  0C
21B7:  MOVWF  24
21B8:  MOVLW  00
21B9:  MOVLB  0B
21BA:  ADDWFC 2A,W
21BB:  MOVLB  0C
21BC:  MOVWF  25
21BD:  MOVLW  00
21BE:  MOVLB  0B
21BF:  ADDWFC 2B,W
21C0:  MOVLB  0C
21C1:  MOVWF  26
.................... 
....................       write_data_bytes(mis_fm, current_address, writedata, PACKET_SIZE);
21C2:  MOVLB  08
21C3:  MOVF   5D,W
21C4:  MOVLB  0F
21C5:  MOVWF  41
21C6:  MOVLB  08
21C7:  MOVF   5C,W
21C8:  MOVLB  0F
21C9:  MOVWF  40
21CA:  MOVLB  08
21CB:  MOVF   5B,W
21CC:  MOVLB  0F
21CD:  MOVWF  3F
21CE:  MOVLB  08
21CF:  MOVF   5A,W
21D0:  MOVLB  0F
21D1:  MOVWF  3E
21D2:  MOVLB  0C
21D3:  MOVF   26,W
21D4:  MOVLB  0F
21D5:  MOVWF  45
21D6:  MOVLB  0C
21D7:  MOVF   25,W
21D8:  MOVLB  0F
21D9:  MOVWF  44
21DA:  MOVLB  0C
21DB:  MOVF   24,W
21DC:  MOVLB  0F
21DD:  MOVWF  43
21DE:  MOVLB  0C
21DF:  MOVF   23,W
21E0:  MOVLB  0F
21E1:  MOVWF  42
21E2:  MOVLW  23
21E3:  MOVWF  47
21E4:  MOVLW  7E
21E5:  MOVWF  46
21E6:  CLRF   49
21E7:  MOVLW  40
21E8:  MOVWF  48
21E9:  MOVLP  10
21EA:  MOVLB  00
21EB:  CALL   0A5
21EC:  MOVLP  20
21ED:  MOVLB  0B
21EE:  INCF   6E,F
21EF:  BTFSC  03.2
21F0:  INCF   6F,F
21F1:  GOTO   151
....................    }
.................... 
....................    piclog_make(flash_write_param.id, PICLOG_PARAM_END); // Log the end of the command execution
21F2:  MOVF   27,W
21F3:  MOVLB  0E
21F4:  MOVWF  3C
21F5:  MOVLW  02
21F6:  MOVWF  3D
21F7:  MOVLP  10
21F8:  MOVLB  00
21F9:  CALL   3A7
21FA:  MOVLP  20
....................    fprintf(PC, "\r\n");
21FB:  MOVLW  0D
21FC:  MOVLB  0F
21FD:  MOVWF  43
21FE:  MOVLP  08
21FF:  MOVLB  00
2200:  CALL   0A7
2201:  MOVLP  20
2202:  MOVLW  0A
2203:  MOVLB  0F
2204:  MOVWF  43
2205:  MOVLP  08
2206:  MOVLB  00
2207:  CALL   0A7
2208:  MOVLP  20
....................    fprintf(PC, "End Flash Write Demo\r\n");
2209:  MOVLW  22
220A:  MOVLB  03
220B:  MOVWF  11
220C:  MOVLW  05
220D:  MOVWF  12
220E:  MOVLP  08
220F:  MOVLB  00
2210:  CALL   0CC
2211:  MOVLP  20
2212:  MOVLP  28
2213:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_write_4kbyte_subsecotr(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Write 4kByte Subsector\r\n");
2214:  MOVLW  2E
2215:  MOVLB  03
2216:  MOVWF  11
2217:  MOVLW  05
2218:  MOVWF  12
2219:  MOVLP  08
221A:  MOVLB  00
221B:  CALL   0CC
221C:  MOVLP  20
....................    piclog_make(parameter[0], PICLOG_PARAM_START); // Log the command execution
221D:  MOVLB  0B
221E:  MOVF   25,W
221F:  MOVWF  04
2220:  MOVF   26,W
2221:  MOVWF  05
2222:  ADDFSR 00,FSR0
2223:  MOVF   00,W
2224:  MOVLB  0E
2225:  MOVWF  3B
2226:  MOVWF  3C
2227:  MOVLW  01
2228:  MOVWF  3D
2229:  MOVLP  10
222A:  MOVLB  00
222B:  CALL   3A7
222C:  MOVLP  20
....................    flash_setting(mis_fm);
222D:  MOVLB  08
222E:  MOVF   5D,W
222F:  MOVLB  0E
2230:  MOVWF  42
2231:  MOVLB  08
2232:  MOVF   5C,W
2233:  MOVLB  0E
2234:  MOVWF  41
2235:  MOVLB  08
2236:  MOVF   5B,W
2237:  MOVLB  0E
2238:  MOVWF  40
2239:  MOVLB  08
223A:  MOVF   5A,W
223B:  MOVLB  0E
223C:  MOVWF  3F
223D:  MOVLP  18
223E:  MOVLB  00
223F:  CALL   773
2240:  MOVLP  20
....................    unsigned int32 write_address = 0x00000000;
....................    int8 write_data[256] = {0x01, 0x02, 0x03, 0x04}; // Example data
2241:  MOVLB  0B
2242:  CLRF   2A
2243:  CLRF   29
2244:  CLRF   28
2245:  CLRF   27
2246:  MOVLW  01
2247:  MOVWF  2B
2248:  MOVLW  02
2249:  MOVWF  2C
224A:  MOVLW  03
224B:  MOVWF  2D
224C:  MOVLW  04
224D:  MOVWF  2E
224E:  CLRF   2F
224F:  CLRF   30
2250:  CLRF   31
2251:  CLRF   32
2252:  CLRF   33
2253:  CLRF   34
2254:  CLRF   35
2255:  CLRF   36
2256:  CLRF   37
2257:  CLRF   38
2258:  CLRF   39
2259:  CLRF   3A
225A:  CLRF   3B
225B:  CLRF   3C
225C:  CLRF   3D
225D:  CLRF   3E
225E:  CLRF   3F
225F:  CLRF   40
2260:  CLRF   41
2261:  CLRF   42
2262:  CLRF   43
2263:  CLRF   44
2264:  CLRF   45
2265:  CLRF   46
2266:  CLRF   47
2267:  CLRF   48
2268:  CLRF   49
2269:  CLRF   4A
226A:  CLRF   4B
226B:  CLRF   4C
226C:  CLRF   4D
226D:  CLRF   4E
226E:  CLRF   4F
226F:  CLRF   50
2270:  CLRF   51
2271:  CLRF   52
2272:  CLRF   53
2273:  CLRF   54
2274:  CLRF   55
2275:  CLRF   56
2276:  CLRF   57
2277:  CLRF   58
2278:  CLRF   59
2279:  CLRF   5A
227A:  CLRF   5B
227B:  CLRF   5C
227C:  CLRF   5D
227D:  CLRF   5E
227E:  CLRF   5F
227F:  CLRF   60
2280:  CLRF   61
2281:  CLRF   62
2282:  CLRF   63
2283:  CLRF   64
2284:  CLRF   65
2285:  CLRF   66
2286:  CLRF   67
2287:  CLRF   68
2288:  CLRF   69
2289:  CLRF   6A
228A:  CLRF   6B
228B:  CLRF   6C
228C:  CLRF   6D
228D:  CLRF   6E
228E:  CLRF   6F
228F:  MOVLB  0C
2290:  CLRF   20
2291:  CLRF   21
2292:  CLRF   22
2293:  CLRF   23
2294:  CLRF   24
2295:  CLRF   25
2296:  CLRF   26
2297:  CLRF   27
2298:  CLRF   28
2299:  CLRF   29
229A:  CLRF   2A
229B:  CLRF   2B
229C:  CLRF   2C
229D:  CLRF   2D
229E:  CLRF   2E
229F:  CLRF   2F
22A0:  CLRF   30
22A1:  CLRF   31
22A2:  CLRF   32
22A3:  CLRF   33
22A4:  CLRF   34
22A5:  CLRF   35
22A6:  CLRF   36
22A7:  CLRF   37
22A8:  CLRF   38
22A9:  CLRF   39
22AA:  CLRF   3A
22AB:  CLRF   3B
22AC:  CLRF   3C
22AD:  CLRF   3D
22AE:  CLRF   3E
22AF:  CLRF   3F
22B0:  CLRF   40
22B1:  CLRF   41
22B2:  CLRF   42
22B3:  CLRF   43
22B4:  CLRF   44
22B5:  CLRF   45
22B6:  CLRF   46
22B7:  CLRF   47
22B8:  CLRF   48
22B9:  CLRF   49
22BA:  CLRF   4A
22BB:  CLRF   4B
22BC:  CLRF   4C
22BD:  CLRF   4D
22BE:  CLRF   4E
22BF:  CLRF   4F
22C0:  CLRF   50
22C1:  CLRF   51
22C2:  CLRF   52
22C3:  CLRF   53
22C4:  CLRF   54
22C5:  CLRF   55
22C6:  CLRF   56
22C7:  CLRF   57
22C8:  CLRF   58
22C9:  CLRF   59
22CA:  CLRF   5A
22CB:  CLRF   5B
22CC:  CLRF   5C
22CD:  CLRF   5D
22CE:  CLRF   5E
22CF:  CLRF   5F
22D0:  CLRF   60
22D1:  CLRF   61
22D2:  CLRF   62
22D3:  CLRF   63
22D4:  CLRF   64
22D5:  CLRF   65
22D6:  CLRF   66
22D7:  CLRF   67
22D8:  CLRF   68
22D9:  CLRF   69
22DA:  CLRF   6A
22DB:  CLRF   6B
22DC:  CLRF   6C
22DD:  CLRF   6D
22DE:  CLRF   6E
22DF:  CLRF   6F
22E0:  MOVLB  0D
22E1:  CLRF   20
22E2:  CLRF   21
22E3:  CLRF   22
22E4:  CLRF   23
22E5:  CLRF   24
22E6:  CLRF   25
22E7:  CLRF   26
22E8:  CLRF   27
22E9:  CLRF   28
22EA:  CLRF   29
22EB:  CLRF   2A
22EC:  CLRF   2B
22ED:  CLRF   2C
22EE:  CLRF   2D
22EF:  CLRF   2E
22F0:  CLRF   2F
22F1:  CLRF   30
22F2:  CLRF   31
22F3:  CLRF   32
22F4:  CLRF   33
22F5:  CLRF   34
22F6:  CLRF   35
22F7:  CLRF   36
22F8:  CLRF   37
22F9:  CLRF   38
22FA:  CLRF   39
22FB:  CLRF   3A
22FC:  CLRF   3B
22FD:  CLRF   3C
22FE:  CLRF   3D
22FF:  CLRF   3E
2300:  CLRF   3F
2301:  CLRF   40
2302:  CLRF   41
2303:  CLRF   42
2304:  CLRF   43
2305:  CLRF   44
2306:  CLRF   45
2307:  CLRF   46
2308:  CLRF   47
2309:  CLRF   48
230A:  CLRF   49
230B:  CLRF   4A
230C:  CLRF   4B
230D:  CLRF   4C
230E:  CLRF   4D
230F:  CLRF   4E
2310:  CLRF   4F
2311:  CLRF   50
2312:  CLRF   51
2313:  CLRF   52
2314:  CLRF   53
2315:  CLRF   54
2316:  CLRF   55
2317:  CLRF   56
2318:  CLRF   57
2319:  CLRF   58
231A:  CLRF   59
231B:  CLRF   5A
231C:  CLRF   5B
231D:  CLRF   5C
231E:  CLRF   5D
231F:  CLRF   5E
2320:  CLRF   5F
2321:  CLRF   60
2322:  CLRF   61
2323:  CLRF   62
2324:  CLRF   63
2325:  CLRF   64
2326:  CLRF   65
2327:  CLRF   66
2328:  CLRF   67
2329:  CLRF   68
232A:  CLRF   69
232B:  CLRF   6A
232C:  CLRF   6B
232D:  CLRF   6C
232E:  CLRF   6D
232F:  CLRF   6E
2330:  CLRF   6F
2331:  MOVLB  0E
2332:  CLRF   20
2333:  CLRF   21
2334:  CLRF   22
2335:  CLRF   23
2336:  CLRF   24
2337:  CLRF   25
2338:  CLRF   26
2339:  CLRF   27
233A:  CLRF   28
233B:  CLRF   29
233C:  CLRF   2A
233D:  CLRF   2B
233E:  CLRF   2C
233F:  CLRF   2D
2340:  CLRF   2E
2341:  CLRF   2F
2342:  CLRF   30
2343:  CLRF   31
2344:  CLRF   32
2345:  CLRF   33
2346:  CLRF   34
2347:  CLRF   35
2348:  CLRF   36
2349:  CLRF   37
234A:  CLRF   38
234B:  CLRF   39
234C:  CLRF   3A
....................    write_data_bytes(mis_fm, write_address, write_data, 256);
234D:  MOVLB  08
234E:  MOVF   5D,W
234F:  MOVLB  0F
2350:  MOVWF  41
2351:  MOVLB  08
2352:  MOVF   5C,W
2353:  MOVLB  0F
2354:  MOVWF  40
2355:  MOVLB  08
2356:  MOVF   5B,W
2357:  MOVLB  0F
2358:  MOVWF  3F
2359:  MOVLB  08
235A:  MOVF   5A,W
235B:  MOVLB  0F
235C:  MOVWF  3E
235D:  MOVLB  0B
235E:  MOVF   2A,W
235F:  MOVLB  0F
2360:  MOVWF  45
2361:  MOVLB  0B
2362:  MOVF   29,W
2363:  MOVLB  0F
2364:  MOVWF  44
2365:  MOVLB  0B
2366:  MOVF   28,W
2367:  MOVLB  0F
2368:  MOVWF  43
2369:  MOVLB  0B
236A:  MOVF   27,W
236B:  MOVLB  0F
236C:  MOVWF  42
236D:  MOVLW  23
236E:  MOVWF  47
236F:  MOVLW  7B
2370:  MOVWF  46
2371:  MOVLW  01
2372:  MOVWF  49
2373:  CLRF   48
2374:  MOVLP  10
2375:  MOVLB  00
2376:  CALL   0A5
2377:  MOVLP  20
....................    piclog_make(parameter[0], PICLOG_PARAM_END); // Log the end of the command execution
2378:  MOVLB  0B
2379:  MOVF   25,W
237A:  MOVWF  04
237B:  MOVF   26,W
237C:  MOVWF  05
237D:  ADDFSR 00,FSR0
237E:  MOVF   00,W
237F:  MOVLB  0E
2380:  MOVWF  3B
2381:  MOVWF  3C
2382:  MOVLW  02
2383:  MOVWF  3D
2384:  MOVLP  10
2385:  MOVLB  00
2386:  CALL   3A7
2387:  MOVLP  20
....................    fprintf(PC, "End Flash Write 4kByte Subsector\r\n");
2388:  MOVLW  41
2389:  MOVLB  03
238A:  MOVWF  11
238B:  MOVLW  05
238C:  MOVWF  12
238D:  MOVLP  08
238E:  MOVLB  00
238F:  CALL   0CC
2390:  MOVLP  20
2391:  MOVLP  28
2392:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_read(unsigned int8 uplinkcmd[])
.................... {
....................    fprintf(PC, "Start Flash Read\r\n");
2393:  MOVLW  53
2394:  MOVLB  03
2395:  MOVWF  11
2396:  MOVLW  05
2397:  MOVWF  12
2398:  MOVLP  08
2399:  MOVLB  00
239A:  CALL   0CC
239B:  MOVLP  20
....................    piclog_make(uplinkcmd[0], PICLOG_PARAM_START); // Log the command execution
239C:  MOVLB  0B
239D:  MOVF   25,W
239E:  MOVWF  04
239F:  MOVF   26,W
23A0:  MOVWF  05
23A1:  ADDFSR 00,FSR0
23A2:  MOVF   00,W
23A3:  MOVLB  0C
23A4:  MOVWF  2E
23A5:  MOVLB  0E
23A6:  MOVWF  3C
23A7:  MOVLW  01
23A8:  MOVWF  3D
23A9:  MOVLP  10
23AA:  MOVLB  00
23AB:  CALL   3A7
23AC:  MOVLP  20
....................    FLASH_PARAM flash_param = {0};
23AD:  MOVLB  0B
23AE:  CLRF   27
23AF:  CLRF   28
23B0:  CLRF   29
23B1:  CLRF   2A
23B2:  CLRF   2B
23B3:  CLRF   2C
23B4:  CLRF   2D
....................    // for(unsigned int8 i = 0; i < PARAMETER_LENGTH; i++)
....................    // {
....................    //    fprintf(PC, "Parameter[%d]: %02X\r\n", i, parameter[i]);
....................    // }
....................    flash_param.id = uplinkcmd[0];
23B5:  MOVF   25,W
23B6:  MOVWF  04
23B7:  MOVF   26,W
23B8:  MOVWF  05
23B9:  MOVIW  [FSR0+00],W
23BA:  MOVWF  27
....................    flash_param.readaddress = 
....................    ((unsigned int32)uplinkcmd[1] << 24) |
....................    ((unsigned int32)uplinkcmd[2] << 16) |
....................    ((unsigned int32)uplinkcmd[3] << 8)  |
....................    ((unsigned int32)uplinkcmd[4]);
23BB:  MOVF   25,W
23BC:  MOVWF  04
23BD:  MOVF   26,W
23BE:  MOVWF  05
23BF:  ADDFSR 01,FSR0
23C0:  MOVF   00,W
23C1:  MOVLB  0C
23C2:  CLRF   31
23C3:  CLRF   30
23C4:  CLRF   2F
23C5:  MOVWF  2E
23C6:  MOVWF  31
23C7:  CLRF   2E
23C8:  CLRF   2F
23C9:  CLRF   30
23CA:  MOVLB  0B
23CB:  MOVF   25,W
23CC:  MOVWF  04
23CD:  MOVF   26,W
23CE:  MOVWF  05
23CF:  ADDFSR 02,FSR0
23D0:  MOVF   00,W
23D1:  MOVLB  0C
23D2:  CLRF   36
23D3:  CLRF   35
23D4:  CLRF   34
23D5:  MOVWF  33
23D6:  MOVF   34,W
23D7:  MOVWF  7A
23D8:  MOVF   33,W
23D9:  MOVWF  79
23DA:  CLRF   77
23DB:  CLRF   78
23DC:  MOVF   77,W
23DD:  IORWF  2E,F
23DE:  MOVF   78,W
23DF:  IORWF  2F,F
23E0:  MOVF   33,W
23E1:  IORWF  30,F
23E2:  MOVF   34,W
23E3:  IORWF  31,F
23E4:  MOVLB  0B
23E5:  MOVF   25,W
23E6:  MOVWF  04
23E7:  MOVF   26,W
23E8:  MOVWF  05
23E9:  ADDFSR 03,FSR0
23EA:  MOVF   00,W
23EB:  MOVLB  0C
23EC:  CLRF   36
23ED:  CLRF   35
23EE:  CLRF   34
23EF:  MOVWF  33
23F0:  MOVF   35,W
23F1:  MOVWF  7A
23F2:  MOVF   34,W
23F3:  MOVWF  79
23F4:  MOVF   33,W
23F5:  MOVWF  78
23F6:  CLRF   77
23F7:  MOVF   77,W
23F8:  IORWF  2E,F
23F9:  MOVF   33,W
23FA:  IORWF  2F,F
23FB:  MOVF   34,W
23FC:  IORWF  30,F
23FD:  MOVF   35,W
23FE:  IORWF  31,F
23FF:  MOVLB  0B
2400:  MOVF   25,W
2401:  MOVWF  04
2402:  MOVF   26,W
2403:  MOVWF  05
2404:  MOVIW  [FSR0+04],W
2405:  MOVWF  77
2406:  CLRF   78
2407:  CLRF   79
2408:  CLRF   7A
2409:  MOVF   77,W
240A:  MOVLB  0C
240B:  IORWF  2E,W
240C:  MOVLB  0B
240D:  MOVWF  2A
240E:  MOVF   78,W
240F:  MOVLB  0C
2410:  IORWF  2F,W
2411:  MOVLB  0B
2412:  MOVWF  2B
2413:  MOVF   79,W
2414:  MOVLB  0C
2415:  IORWF  30,W
2416:  MOVLB  0B
2417:  MOVWF  2C
2418:  MOVF   7A,W
2419:  MOVLB  0C
241A:  IORWF  31,W
241B:  MOVLB  0B
241C:  MOVWF  2D
.................... 
....................    flash_param.readpacketnum =
....................     ((unsigned int16)uplinkcmd[7] << 8) |
....................     ((unsigned int16)uplinkcmd[8]);
241D:  MOVF   25,W
241E:  MOVWF  04
241F:  MOVF   26,W
2420:  MOVWF  05
2421:  ADDFSR 07,FSR0
2422:  MOVF   00,W
2423:  MOVLB  0C
2424:  CLRF   2F
2425:  MOVWF  2E
2426:  MOVWF  2F
2427:  CLRF   2E
2428:  MOVLB  0B
2429:  MOVF   25,W
242A:  MOVWF  04
242B:  MOVF   26,W
242C:  MOVWF  05
242D:  MOVIW  [FSR0+08],W
242E:  CLRF   7A
242F:  MOVLB  0C
2430:  IORWF  2E,W
2431:  MOVLB  0B
2432:  MOVWF  28
2433:  MOVF   7A,W
2434:  MOVLB  0C
2435:  IORWF  2F,W
2436:  MOVLB  0B
2437:  MOVWF  29
.................... 
....................    fprintf(PC, "\tMODE     : %02X\r\n", flash_param.id);
2438:  MOVLW  5D
2439:  MOVLB  03
243A:  MOVWF  11
243B:  MOVLW  05
243C:  MOVWF  12
243D:  BCF    03.0
243E:  MOVLW  0C
243F:  MOVLB  0C
2440:  MOVWF  5E
2441:  MOVLP  08
2442:  MOVLB  00
2443:  CALL   416
2444:  MOVLP  20
2445:  MOVLB  0B
2446:  MOVF   27,W
2447:  MOVLB  0E
2448:  MOVWF  4E
2449:  MOVLW  37
244A:  MOVWF  4F
244B:  MOVLP  08
244C:  MOVLB  00
244D:  CALL   470
244E:  MOVLP  20
244F:  MOVLW  0D
2450:  MOVLB  0F
2451:  MOVWF  43
2452:  MOVLP  08
2453:  MOVLB  00
2454:  CALL   0A7
2455:  MOVLP  20
2456:  MOVLW  0A
2457:  MOVLB  0F
2458:  MOVWF  43
2459:  MOVLP  08
245A:  MOVLB  00
245B:  CALL   0A7
245C:  MOVLP  20
....................    fprintf(PC, "\tAddress  : 0x%08LX\r\n", flash_param.readaddress);
245D:  MOVLW  67
245E:  MOVLB  03
245F:  MOVWF  11
2460:  MOVLW  05
2461:  MOVWF  12
2462:  BCF    03.0
2463:  MOVLW  0E
2464:  MOVLB  0C
2465:  MOVWF  5E
2466:  MOVLP  08
2467:  MOVLB  00
2468:  CALL   416
2469:  MOVLP  20
246A:  MOVLB  0B
246B:  MOVF   2D,W
246C:  MOVLB  0E
246D:  MOVWF  4E
246E:  MOVLW  37
246F:  MOVWF  4F
2470:  MOVLP  08
2471:  MOVLB  00
2472:  CALL   470
2473:  MOVLP  20
2474:  MOVLB  0B
2475:  MOVF   2C,W
2476:  MOVLB  0E
2477:  MOVWF  4E
2478:  MOVLW  37
2479:  MOVWF  4F
247A:  MOVLP  08
247B:  MOVLB  00
247C:  CALL   470
247D:  MOVLP  20
247E:  MOVLB  0B
247F:  MOVF   2B,W
2480:  MOVLB  0E
2481:  MOVWF  4E
2482:  MOVLW  37
2483:  MOVWF  4F
2484:  MOVLP  08
2485:  MOVLB  00
2486:  CALL   470
2487:  MOVLP  20
2488:  MOVLB  0B
2489:  MOVF   2A,W
248A:  MOVLB  0E
248B:  MOVWF  4E
248C:  MOVLW  37
248D:  MOVWF  4F
248E:  MOVLP  08
248F:  MOVLB  00
2490:  CALL   470
2491:  MOVLP  20
2492:  MOVLW  0D
2493:  MOVLB  0F
2494:  MOVWF  43
2495:  MOVLP  08
2496:  MOVLB  00
2497:  CALL   0A7
2498:  MOVLP  20
2499:  MOVLW  0A
249A:  MOVLB  0F
249B:  MOVWF  43
249C:  MOVLP  08
249D:  MOVLB  00
249E:  CALL   0A7
249F:  MOVLP  20
....................    fprintf(PC, "\tPacketNum: 0x%04LX\r\n", flash_param.readpacketnum);
24A0:  MOVLW  72
24A1:  MOVLB  03
24A2:  MOVWF  11
24A3:  MOVLW  05
24A4:  MOVWF  12
24A5:  BCF    03.0
24A6:  MOVLW  0E
24A7:  MOVLB  0C
24A8:  MOVWF  5E
24A9:  MOVLP  08
24AA:  MOVLB  00
24AB:  CALL   416
24AC:  MOVLP  20
24AD:  MOVLB  0B
24AE:  MOVF   29,W
24AF:  MOVLB  0E
24B0:  MOVWF  4E
24B1:  MOVLW  37
24B2:  MOVWF  4F
24B3:  MOVLP  08
24B4:  MOVLB  00
24B5:  CALL   470
24B6:  MOVLP  20
24B7:  MOVLB  0B
24B8:  MOVF   28,W
24B9:  MOVLB  0E
24BA:  MOVWF  4E
24BB:  MOVLW  37
24BC:  MOVWF  4F
24BD:  MOVLP  08
24BE:  MOVLB  00
24BF:  CALL   470
24C0:  MOVLP  20
24C1:  MOVLW  0D
24C2:  MOVLB  0F
24C3:  MOVWF  43
24C4:  MOVLP  08
24C5:  MOVLB  00
24C6:  CALL   0A7
24C7:  MOVLP  20
24C8:  MOVLW  0A
24C9:  MOVLB  0F
24CA:  MOVWF  43
24CB:  MOVLP  08
24CC:  MOVLB  00
24CD:  CALL   0A7
24CE:  MOVLP  20
....................    
....................    piclog_make(flash_param.id, 0x00);
24CF:  MOVLB  0B
24D0:  MOVF   27,W
24D1:  MOVLB  0E
24D2:  MOVWF  3C
24D3:  CLRF   3D
24D4:  MOVLP  10
24D5:  MOVLB  00
24D6:  CALL   3A7
24D7:  MOVLP  20
....................    
.................... 
....................    unsigned int8 readdata[PACKET_SIZE] = {0x00}; // Initialize read data buffer
24D8:  MOVLB  0B
24D9:  CLRF   2E
24DA:  CLRF   2F
24DB:  CLRF   30
24DC:  CLRF   31
24DD:  CLRF   32
24DE:  CLRF   33
24DF:  CLRF   34
24E0:  CLRF   35
24E1:  CLRF   36
24E2:  CLRF   37
24E3:  CLRF   38
24E4:  CLRF   39
24E5:  CLRF   3A
24E6:  CLRF   3B
24E7:  CLRF   3C
24E8:  CLRF   3D
24E9:  CLRF   3E
24EA:  CLRF   3F
24EB:  CLRF   40
24EC:  CLRF   41
24ED:  CLRF   42
24EE:  CLRF   43
24EF:  CLRF   44
24F0:  CLRF   45
24F1:  CLRF   46
24F2:  CLRF   47
24F3:  CLRF   48
24F4:  CLRF   49
24F5:  CLRF   4A
24F6:  CLRF   4B
24F7:  CLRF   4C
24F8:  CLRF   4D
24F9:  CLRF   4E
24FA:  CLRF   4F
24FB:  CLRF   50
24FC:  CLRF   51
24FD:  CLRF   52
24FE:  CLRF   53
24FF:  CLRF   54
2500:  CLRF   55
2501:  CLRF   56
2502:  CLRF   57
2503:  CLRF   58
2504:  CLRF   59
2505:  CLRF   5A
2506:  CLRF   5B
2507:  CLRF   5C
2508:  CLRF   5D
2509:  CLRF   5E
250A:  CLRF   5F
250B:  CLRF   60
250C:  CLRF   61
250D:  CLRF   62
250E:  CLRF   63
250F:  CLRF   64
2510:  CLRF   65
2511:  CLRF   66
2512:  CLRF   67
2513:  CLRF   68
2514:  CLRF   69
2515:  CLRF   6A
2516:  CLRF   6B
2517:  CLRF   6C
2518:  CLRF   6D
....................    unsigned int32 read_address;
....................    fprintf(PC, "READ DATA\r\n");
2519:  MOVLW  7D
251A:  MOVLB  03
251B:  MOVWF  11
251C:  MOVLW  05
251D:  MOVWF  12
251E:  MOVLP  08
251F:  MOVLB  00
2520:  CALL   0CC
2521:  MOVLP  20
.................... 
....................    if(is_connect(mis_fm) == FALSE) {
2522:  MOVLB  08
2523:  MOVF   5D,W
2524:  MOVLB  0F
2525:  MOVWF  41
2526:  MOVLB  08
2527:  MOVF   5C,W
2528:  MOVLB  0F
2529:  MOVWF  40
252A:  MOVLB  08
252B:  MOVF   5B,W
252C:  MOVLB  0F
252D:  MOVWF  3F
252E:  MOVLB  08
252F:  MOVF   5A,W
2530:  MOVLB  0F
2531:  MOVWF  3E
2532:  MOVLP  08
2533:  MOVLB  00
2534:  CALL   2D3
2535:  MOVLP  20
2536:  MOVF   78,F
2537:  BTFSS  03.2
2538:  GOTO   543
....................       fprintf(PC, "Mission Flash is not connected\r\n");
2539:  MOVLW  83
253A:  MOVLB  03
253B:  MOVWF  11
253C:  MOVLW  05
253D:  MOVWF  12
253E:  MOVLP  08
253F:  MOVLB  00
2540:  CALL   0CC
2541:  MOVLP  20
....................       return;
2542:  GOTO   60A
....................    }
.................... 
....................    for (unsigned int32 packetcount = 0; packetcount < flash_param.readpacketnum; packetcount++){
2543:  MOVLB  0C
2544:  CLRF   27
2545:  CLRF   26
2546:  CLRF   25
2547:  CLRF   24
2548:  MOVF   27,F
2549:  BTFSS  03.2
254A:  GOTO   5F7
254B:  MOVF   26,F
254C:  BTFSS  03.2
254D:  GOTO   5F7
254E:  MOVF   25,W
254F:  MOVLB  0B
2550:  SUBWF  29,W
2551:  BTFSC  03.0
2552:  GOTO   555
2553:  MOVLB  0C
2554:  GOTO   5F7
2555:  BTFSS  03.2
2556:  GOTO   55D
2557:  MOVF   28,W
2558:  MOVLB  0C
2559:  SUBWF  24,W
255A:  BTFSC  03.0
255B:  GOTO   5F7
255C:  MOVLB  0B
....................       read_address = flash_param.readaddress + packetcount * PACKET_SIZE;
255D:  MOVLB  0C
255E:  RLF    24,W
255F:  MOVWF  77
2560:  RLF    25,W
2561:  MOVWF  78
2562:  RLF    26,W
2563:  MOVWF  79
2564:  RLF    27,W
2565:  MOVWF  7A
2566:  RLF    77,F
2567:  RLF    78,F
2568:  RLF    79,F
2569:  RLF    7A,F
256A:  RLF    77,F
256B:  RLF    78,F
256C:  RLF    79,F
256D:  RLF    7A,F
256E:  RLF    77,F
256F:  RLF    78,F
2570:  RLF    79,F
2571:  RLF    7A,F
2572:  RLF    77,F
2573:  RLF    78,F
2574:  RLF    79,F
2575:  RLF    7A,F
2576:  RLF    77,F
2577:  RLF    78,F
2578:  RLF    79,F
2579:  RLF    7A,F
257A:  MOVLW  C0
257B:  ANDWF  77,F
257C:  MOVF   77,W
257D:  MOVLB  0B
257E:  ADDWF  2A,W
257F:  MOVLB  0C
2580:  MOVWF  20
2581:  MOVF   78,W
2582:  MOVLB  0B
2583:  ADDWFC 2B,W
2584:  MOVLB  0C
2585:  MOVWF  21
2586:  MOVF   79,W
2587:  MOVLB  0B
2588:  ADDWFC 2C,W
2589:  MOVLB  0C
258A:  MOVWF  22
258B:  MOVF   7A,W
258C:  MOVLB  0B
258D:  ADDWFC 2D,W
258E:  MOVLB  0C
258F:  MOVWF  23
.................... 
....................       //fprintf(PC, "Packet %lu: Address 0x%08LX\r\n", packetcount, read_address);
....................       
....................       read_data_bytes(mis_fm, read_address, readdata, PACKET_SIZE);
2590:  MOVLB  08
2591:  MOVF   5D,W
2592:  MOVLB  0E
2593:  MOVWF  42
2594:  MOVLB  08
2595:  MOVF   5C,W
2596:  MOVLB  0E
2597:  MOVWF  41
2598:  MOVLB  08
2599:  MOVF   5B,W
259A:  MOVLB  0E
259B:  MOVWF  40
259C:  MOVLB  08
259D:  MOVF   5A,W
259E:  MOVLB  0E
259F:  MOVWF  3F
25A0:  MOVLB  0C
25A1:  MOVF   23,W
25A2:  MOVLB  0E
25A3:  MOVWF  46
25A4:  MOVLB  0C
25A5:  MOVF   22,W
25A6:  MOVLB  0E
25A7:  MOVWF  45
25A8:  MOVLB  0C
25A9:  MOVF   21,W
25AA:  MOVLB  0E
25AB:  MOVWF  44
25AC:  MOVLB  0C
25AD:  MOVF   20,W
25AE:  MOVLB  0E
25AF:  MOVWF  43
25B0:  MOVLW  23
25B1:  MOVWF  48
25B2:  MOVLW  7E
25B3:  MOVWF  47
25B4:  CLRF   4C
25B5:  CLRF   4B
25B6:  CLRF   4A
25B7:  MOVLW  40
25B8:  MOVWF  49
25B9:  MOVLP  08
25BA:  MOVLB  00
25BB:  CALL   321
25BC:  MOVLP  20
....................       for (unsigned int8 bytecount = 0; bytecount < PACKET_SIZE; bytecount++){
25BD:  MOVLB  0B
25BE:  CLRF   6E
25BF:  MOVF   6E,W
25C0:  SUBLW  3F
25C1:  BTFSS  03.0
25C2:  GOTO   5DF
....................          fprintf(PC,"%02X ",readdata[bytecount]);
25C3:  MOVLW  7E
25C4:  ADDWF  6E,W
25C5:  MOVWF  04
25C6:  MOVLW  23
25C7:  MOVWF  05
25C8:  BTFSC  03.0
25C9:  INCF   05,F
25CA:  MOVF   00,W
25CB:  MOVLB  0C
25CC:  MOVWF  2E
25CD:  MOVLB  0E
25CE:  MOVWF  4E
25CF:  MOVLW  37
25D0:  MOVWF  4F
25D1:  MOVLP  08
25D2:  MOVLB  00
25D3:  CALL   470
25D4:  MOVLP  20
25D5:  MOVLW  20
25D6:  MOVLB  0F
25D7:  MOVWF  43
25D8:  MOVLP  08
25D9:  MOVLB  00
25DA:  CALL   0A7
25DB:  MOVLP  20
25DC:  MOVLB  0B
25DD:  INCF   6E,F
25DE:  GOTO   5BF
....................       }
....................       fprintf(PC,"\r\n");
25DF:  MOVLW  0D
25E0:  MOVLB  0F
25E1:  MOVWF  43
25E2:  MOVLP  08
25E3:  MOVLB  00
25E4:  CALL   0A7
25E5:  MOVLP  20
25E6:  MOVLW  0A
25E7:  MOVLB  0F
25E8:  MOVWF  43
25E9:  MOVLP  08
25EA:  MOVLB  00
25EB:  CALL   0A7
25EC:  MOVLP  20
25ED:  MOVLW  01
25EE:  MOVLB  0C
25EF:  ADDWF  24,F
25F0:  BTFSC  03.0
25F1:  INCF   25,F
25F2:  BTFSC  03.2
25F3:  INCF   26,F
25F4:  BTFSC  03.2
25F5:  INCF   27,F
25F6:  GOTO   548
....................    }
....................    piclog_make(flash_param.id, PICLOG_PARAM_END); // Log the end of the command execution
25F7:  MOVLB  0B
25F8:  MOVF   27,W
25F9:  MOVLB  0E
25FA:  MOVWF  3C
25FB:  MOVLW  02
25FC:  MOVWF  3D
25FD:  MOVLP  10
25FE:  MOVLB  00
25FF:  CALL   3A7
2600:  MOVLP  20
....................    fprintf(PC, "End Flash Read\r\n");
2601:  MOVLW  94
2602:  MOVLB  03
2603:  MOVWF  11
2604:  MOVLW  05
2605:  MOVWF  12
2606:  MOVLP  08
2607:  MOVLB  00
2608:  CALL   0CC
2609:  MOVLP  20
260A:  MOVLP  28
260B:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_read_address(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Read Address\r\n");
260C:  MOVLW  9D
260D:  MOVLB  03
260E:  MOVWF  11
260F:  MOVLW  05
2610:  MOVWF  12
2611:  MOVLP  08
2612:  MOVLB  00
2613:  CALL   0CC
2614:  MOVLP  20
....................    flash_setting(mis_fm);
2615:  MOVLB  08
2616:  MOVF   5D,W
2617:  MOVLB  0E
2618:  MOVWF  42
2619:  MOVLB  08
261A:  MOVF   5C,W
261B:  MOVLB  0E
261C:  MOVWF  41
261D:  MOVLB  08
261E:  MOVF   5B,W
261F:  MOVLB  0E
2620:  MOVWF  40
2621:  MOVLB  08
2622:  MOVF   5A,W
2623:  MOVLB  0E
2624:  MOVWF  3F
2625:  MOVLP  18
2626:  MOVLB  00
2627:  CALL   773
2628:  MOVLP  20
....................    unsigned int32 read_address = 0x00000000;
....................    int8 read_data[4];
2629:  MOVLB  0B
262A:  CLRF   2A
262B:  CLRF   29
262C:  CLRF   28
262D:  CLRF   27
....................    read_data_bytes(mis_fm, read_address, read_data, 4);
262E:  MOVLB  08
262F:  MOVF   5D,W
2630:  MOVLB  0E
2631:  MOVWF  42
2632:  MOVLB  08
2633:  MOVF   5C,W
2634:  MOVLB  0E
2635:  MOVWF  41
2636:  MOVLB  08
2637:  MOVF   5B,W
2638:  MOVLB  0E
2639:  MOVWF  40
263A:  MOVLB  08
263B:  MOVF   5A,W
263C:  MOVLB  0E
263D:  MOVWF  3F
263E:  MOVLB  0B
263F:  MOVF   2A,W
2640:  MOVLB  0E
2641:  MOVWF  46
2642:  MOVLB  0B
2643:  MOVF   29,W
2644:  MOVLB  0E
2645:  MOVWF  45
2646:  MOVLB  0B
2647:  MOVF   28,W
2648:  MOVLB  0E
2649:  MOVWF  44
264A:  MOVLB  0B
264B:  MOVF   27,W
264C:  MOVLB  0E
264D:  MOVWF  43
264E:  MOVLW  23
264F:  MOVWF  48
2650:  MOVLW  7B
2651:  MOVWF  47
2652:  CLRF   4C
2653:  CLRF   4B
2654:  CLRF   4A
2655:  MOVLW  04
2656:  MOVWF  49
2657:  MOVLP  08
2658:  MOVLB  00
2659:  CALL   321
265A:  MOVLP  20
....................    fprintf(PC, "Read Data: %02X %02X %02X %02X\r\n", read_data[0], read_data[1], read_data[2], read_data[3]);
265B:  MOVLW  AB
265C:  MOVLB  03
265D:  MOVWF  11
265E:  MOVLW  05
265F:  MOVWF  12
2660:  BCF    03.0
2661:  MOVLW  0B
2662:  MOVLB  0C
2663:  MOVWF  5E
2664:  MOVLP  08
2665:  MOVLB  00
2666:  CALL   416
2667:  MOVLP  20
2668:  MOVLB  0B
2669:  MOVF   2B,W
266A:  MOVLB  0E
266B:  MOVWF  4E
266C:  MOVLW  37
266D:  MOVWF  4F
266E:  MOVLP  08
266F:  MOVLB  00
2670:  CALL   470
2671:  MOVLP  20
2672:  MOVLW  20
2673:  MOVLB  0F
2674:  MOVWF  43
2675:  MOVLP  08
2676:  MOVLB  00
2677:  CALL   0A7
2678:  MOVLP  20
2679:  MOVLB  0B
267A:  MOVF   2C,W
267B:  MOVLB  0E
267C:  MOVWF  4E
267D:  MOVLW  37
267E:  MOVWF  4F
267F:  MOVLP  08
2680:  MOVLB  00
2681:  CALL   470
2682:  MOVLP  20
2683:  MOVLW  20
2684:  MOVLB  0F
2685:  MOVWF  43
2686:  MOVLP  08
2687:  MOVLB  00
2688:  CALL   0A7
2689:  MOVLP  20
268A:  MOVLB  0B
268B:  MOVF   2D,W
268C:  MOVLB  0E
268D:  MOVWF  4E
268E:  MOVLW  37
268F:  MOVWF  4F
2690:  MOVLP  08
2691:  MOVLB  00
2692:  CALL   470
2693:  MOVLP  20
2694:  MOVLW  20
2695:  MOVLB  0F
2696:  MOVWF  43
2697:  MOVLP  08
2698:  MOVLB  00
2699:  CALL   0A7
269A:  MOVLP  20
269B:  MOVLB  0B
269C:  MOVF   2E,W
269D:  MOVLB  0E
269E:  MOVWF  4E
269F:  MOVLW  37
26A0:  MOVWF  4F
26A1:  MOVLP  08
26A2:  MOVLB  00
26A3:  CALL   470
26A4:  MOVLP  20
26A5:  MOVLW  0D
26A6:  MOVLB  0F
26A7:  MOVWF  43
26A8:  MOVLP  08
26A9:  MOVLB  00
26AA:  CALL   0A7
26AB:  MOVLP  20
26AC:  MOVLW  0A
26AD:  MOVLB  0F
26AE:  MOVWF  43
26AF:  MOVLP  08
26B0:  MOVLB  00
26B1:  CALL   0A7
26B2:  MOVLP  20
....................    fprintf(PC, "End Flash Read Address\r\n");
26B3:  MOVLW  BC
26B4:  MOVLB  03
26B5:  MOVWF  11
26B6:  MOVLW  05
26B7:  MOVWF  12
26B8:  MOVLP  08
26B9:  MOVLB  00
26BA:  CALL   0CC
26BB:  MOVLP  20
26BC:  MOVLP  28
26BD:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_smf_copy(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash SMF Copy\r\n");
26BE:  MOVLW  C9
26BF:  MOVLB  03
26C0:  MOVWF  11
26C1:  MOVLW  05
26C2:  MOVWF  12
26C3:  MOVLP  08
26C4:  MOVLB  00
26C5:  CALL   0CC
26C6:  MOVLP  20
....................    flash_setting(mis_fm);
26C7:  MOVLB  08
26C8:  MOVF   5D,W
26C9:  MOVLB  0E
26CA:  MOVWF  42
26CB:  MOVLB  08
26CC:  MOVF   5C,W
26CD:  MOVLB  0E
26CE:  MOVWF  41
26CF:  MOVLB  08
26D0:  MOVF   5B,W
26D1:  MOVLB  0E
26D2:  MOVWF  40
26D3:  MOVLB  08
26D4:  MOVF   5A,W
26D5:  MOVLB  0E
26D6:  MOVWF  3F
26D7:  MOVLP  18
26D8:  MOVLB  00
26D9:  CALL   773
26DA:  MOVLP  20
....................    flash_setting(smf);
26DB:  MOVLB  08
26DC:  MOVF   61,W
26DD:  MOVLB  0E
26DE:  MOVWF  42
26DF:  MOVLB  08
26E0:  MOVF   60,W
26E1:  MOVLB  0E
26E2:  MOVWF  41
26E3:  MOVLB  08
26E4:  MOVF   5F,W
26E5:  MOVLB  0E
26E6:  MOVWF  40
26E7:  MOVLB  08
26E8:  MOVF   5E,W
26E9:  MOVLB  0E
26EA:  MOVWF  3F
26EB:  MOVLP  18
26EC:  MOVLB  00
26ED:  CALL   773
26EE:  MOVLP  20
....................    
....................    // Example copy operation
....................    unsigned int32 src_address = 0x00000000;
....................    unsigned int32 dest_address = 0x00001000; // Example destination address
....................    int8 read_data[256];
26EF:  MOVLB  0B
26F0:  CLRF   2A
26F1:  CLRF   29
26F2:  CLRF   28
26F3:  CLRF   27
26F4:  CLRF   2E
26F5:  CLRF   2D
26F6:  MOVLW  10
26F7:  MOVWF  2C
26F8:  CLRF   2B
....................    read_data_bytes(mis_fm, src_address, read_data, 256);
26F9:  MOVLB  08
26FA:  MOVF   5D,W
26FB:  MOVLB  0E
26FC:  MOVWF  42
26FD:  MOVLB  08
26FE:  MOVF   5C,W
26FF:  MOVLB  0E
2700:  MOVWF  41
2701:  MOVLB  08
2702:  MOVF   5B,W
2703:  MOVLB  0E
2704:  MOVWF  40
2705:  MOVLB  08
2706:  MOVF   5A,W
2707:  MOVLB  0E
2708:  MOVWF  3F
2709:  MOVLB  0B
270A:  MOVF   2A,W
270B:  MOVLB  0E
270C:  MOVWF  46
270D:  MOVLB  0B
270E:  MOVF   29,W
270F:  MOVLB  0E
2710:  MOVWF  45
2711:  MOVLB  0B
2712:  MOVF   28,W
2713:  MOVLB  0E
2714:  MOVWF  44
2715:  MOVLB  0B
2716:  MOVF   27,W
2717:  MOVLB  0E
2718:  MOVWF  43
2719:  MOVLW  23
271A:  MOVWF  48
271B:  MOVLW  7F
271C:  MOVWF  47
271D:  CLRF   4C
271E:  CLRF   4B
271F:  MOVLW  01
2720:  MOVWF  4A
2721:  CLRF   49
2722:  MOVLP  08
2723:  MOVLB  00
2724:  CALL   321
2725:  MOVLP  20
....................    write_data_bytes(smf, dest_address, read_data, 256);
2726:  MOVLB  08
2727:  MOVF   61,W
2728:  MOVLB  0F
2729:  MOVWF  41
272A:  MOVLB  08
272B:  MOVF   60,W
272C:  MOVLB  0F
272D:  MOVWF  40
272E:  MOVLB  08
272F:  MOVF   5F,W
2730:  MOVLB  0F
2731:  MOVWF  3F
2732:  MOVLB  08
2733:  MOVF   5E,W
2734:  MOVLB  0F
2735:  MOVWF  3E
2736:  MOVLB  0B
2737:  MOVF   2E,W
2738:  MOVLB  0F
2739:  MOVWF  45
273A:  MOVLB  0B
273B:  MOVF   2D,W
273C:  MOVLB  0F
273D:  MOVWF  44
273E:  MOVLB  0B
273F:  MOVF   2C,W
2740:  MOVLB  0F
2741:  MOVWF  43
2742:  MOVLB  0B
2743:  MOVF   2B,W
2744:  MOVLB  0F
2745:  MOVWF  42
2746:  MOVLW  23
2747:  MOVWF  47
2748:  MOVLW  7F
2749:  MOVWF  46
274A:  MOVLW  01
274B:  MOVWF  49
274C:  CLRF   48
274D:  MOVLP  10
274E:  MOVLB  00
274F:  CALL   0A5
2750:  MOVLP  20
....................    
....................    fprintf(PC, "End Flash SMF Copy\r\n");
2751:  MOVLW  D5
2752:  MOVLB  03
2753:  MOVWF  11
2754:  MOVLW  05
2755:  MOVWF  12
2756:  MOVLP  08
2757:  MOVLB  00
2758:  CALL   0CC
2759:  MOVLP  20
275A:  MOVLP  28
275B:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... #Separate
.................... void mode_flash_smf_read(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash SMF Read\r\n");
....................    int8 read_data[256];
....................    //read_data_bytes(smf, read_address, read_data, 256);
....................    fprintf(PC, "Read Data: ");
....................    for (int i = 0; i < 256; i++)
....................    {
....................       fprintf(PC, "%02X ", read_data[i]);
....................    }
....................    fprintf(PC, "\r\nEnd Flash SMF Read\r\n");
.................... }
.................... 
.................... #Separate
.................... void mode_flash_smf_write(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash SMF Write\r\n");
....................    flash_setting(smf);
....................    unsigned int32 write_address = 0x00000000;
....................    int8 write_data[256] = {0x01, 0x02, 0x03, 0x04}; // Example data
....................    write_data_bytes(smf, write_address, write_data, 256);
....................    fprintf(PC, "End Flash SMF Write\r\n");
.................... }
....................   
.................... #Separate
.................... void mode_flash_address_reset(unsigned int8 parameter[])
.................... {
....................    fprintf(PC, "Start Flash Address Reset\r\n");
275C:  MOVLW  15
275D:  MOVLB  03
275E:  MOVWF  11
275F:  MOVLW  06
2760:  MOVWF  12
2761:  MOVLP  08
2762:  MOVLB  00
2763:  CALL   0CC
2764:  MOVLP  20
....................    piclog_make(parameter[0], PICLOG_PARAM_START); // Log the command execution
2765:  MOVLB  0B
2766:  MOVF   25,W
2767:  MOVWF  04
2768:  MOVF   26,W
2769:  MOVWF  05
276A:  ADDFSR 00,FSR0
276B:  MOVF   00,W
276C:  MOVWF  67
276D:  MOVLB  0E
276E:  MOVWF  3C
276F:  MOVLW  01
2770:  MOVWF  3D
2771:  MOVLP  10
2772:  MOVLB  00
2773:  CALL   3A7
2774:  MOVLP  20
....................    unsigned int8 writedata[PACKET_SIZE] = {0x00}; // Initialize write data to zero
2775:  MOVLB  0B
2776:  CLRF   27
2777:  CLRF   28
2778:  CLRF   29
2779:  CLRF   2A
277A:  CLRF   2B
277B:  CLRF   2C
277C:  CLRF   2D
277D:  CLRF   2E
277E:  CLRF   2F
277F:  CLRF   30
2780:  CLRF   31
2781:  CLRF   32
2782:  CLRF   33
2783:  CLRF   34
2784:  CLRF   35
2785:  CLRF   36
2786:  CLRF   37
2787:  CLRF   38
2788:  CLRF   39
2789:  CLRF   3A
278A:  CLRF   3B
278B:  CLRF   3C
278C:  CLRF   3D
278D:  CLRF   3E
278E:  CLRF   3F
278F:  CLRF   40
2790:  CLRF   41
2791:  CLRF   42
2792:  CLRF   43
2793:  CLRF   44
2794:  CLRF   45
2795:  CLRF   46
2796:  CLRF   47
2797:  CLRF   48
2798:  CLRF   49
2799:  CLRF   4A
279A:  CLRF   4B
279B:  CLRF   4C
279C:  CLRF   4D
279D:  CLRF   4E
279E:  CLRF   4F
279F:  CLRF   50
27A0:  CLRF   51
27A1:  CLRF   52
27A2:  CLRF   53
27A3:  CLRF   54
27A4:  CLRF   55
27A5:  CLRF   56
27A6:  CLRF   57
27A7:  CLRF   58
27A8:  CLRF   59
27A9:  CLRF   5A
27AA:  CLRF   5B
27AB:  CLRF   5C
27AC:  CLRF   5D
27AD:  CLRF   5E
27AE:  CLRF   5F
27AF:  CLRF   60
27B0:  CLRF   61
27B1:  CLRF   62
27B2:  CLRF   63
27B3:  CLRF   64
27B4:  CLRF   65
27B5:  CLRF   66
....................    
....................    write_data_bytes(mis_fm, ADDRESS_MANEGE_START, writedata, PACKET_SIZE);
27B6:  MOVLB  08
27B7:  MOVF   5D,W
27B8:  MOVLB  0F
27B9:  MOVWF  41
27BA:  MOVLB  08
27BB:  MOVF   5C,W
27BC:  MOVLB  0F
27BD:  MOVWF  40
27BE:  MOVLB  08
27BF:  MOVF   5B,W
27C0:  MOVLB  0F
27C1:  MOVWF  3F
27C2:  MOVLB  08
27C3:  MOVF   5A,W
27C4:  MOVLB  0F
27C5:  MOVWF  3E
27C6:  CLRF   45
27C7:  CLRF   44
27C8:  CLRF   43
27C9:  CLRF   42
27CA:  MOVLW  23
27CB:  MOVWF  47
27CC:  MOVLW  77
27CD:  MOVWF  46
27CE:  CLRF   49
27CF:  MOVLW  40
27D0:  MOVWF  48
27D1:  MOVLP  10
27D2:  MOVLB  00
27D3:  CALL   0A5
27D4:  MOVLP  20
....................    misf_init(); // Update the address area after writing
27D5:  MOVLP  08
27D6:  CALL   497
27D7:  MOVLP  20
.................... 
.................... 
....................    piclog_make(parameter[0], PICLOG_PARAM_END); // Log the end of the command execution
27D8:  MOVLB  0B
27D9:  MOVF   25,W
27DA:  MOVWF  04
27DB:  MOVF   26,W
27DC:  MOVWF  05
27DD:  ADDFSR 00,FSR0
27DE:  MOVF   00,W
27DF:  MOVWF  67
27E0:  MOVLB  0E
27E1:  MOVWF  3C
27E2:  MOVLW  02
27E3:  MOVWF  3D
27E4:  MOVLP  10
27E5:  MOVLB  00
27E6:  CALL   3A7
27E7:  MOVLP  20
....................    fprintf(PC, "End Flash Address Reset\r\n");
27E8:  MOVLW  23
27E9:  MOVLB  03
27EA:  MOVWF  11
27EB:  MOVLW  06
27EC:  MOVWF  12
27ED:  MOVLP  08
27EE:  MOVLB  00
27EF:  CALL   0CC
27F0:  MOVLP  20
27F1:  MOVLP  28
27F2:  GOTO   5ED (RETURN)
.................... }
.................... 
.................... 
.................... #endif // MMJ_CIGS_MODE_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... 
.................... // SerialCommunication
.................... #include "../lib/communication_driver.h"
.................... #ifndef COMMUNICATION_DRIVER_H
.................... #define COMMUNICATION_DRIVER_H
.................... 
.................... #include "communication.h"
.................... 
.................... 
.................... // This is redundant, but it is a process to hide the Communication library as a driver.
.................... Command make_command(unsigned int8 receive_signal[], int8 receive_signal_size);
.................... 
.................... #Separate
.................... void transmit_ack();
.................... #Separate
.................... void transmit_status();
.................... #Separate
.................... int1 req_use_smf();
.................... 
.................... 
.................... #include "./src/communication_driver.c"
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... // Copy to SMF
.................... #include "../lib/data_copy.h"
.................... #ifndef DATA_COPY_H
.................... #define DATA_COPY_H
.................... 
.................... #include "smf_queue.h"
.................... #ifndef SMF_QUEUE_H
.................... #define SMF_QUEUE_H
.................... 
.................... 
.................... 
.................... typedef enum {
....................    APRS_DATA,  // <- assign your missoins
....................    IN_VEHICLE, 
....................    ECOSYSTEM_DATA, 
....................    APRS_PIC_LOG
.................... } MissionType;
.................... 
.................... typedef struct {
....................    unsigned int32 start_address;
....................    unsigned int32 end_address;
....................    int8 mission_flag;
.................... } MissionTypeStruct;
.................... 
.................... typedef struct {
....................     MissionType   mission_type;
....................     unsigned int32 src;
....................     unsigned int32 size;
.................... } SmfDataStruct;
.................... 
.................... #define SMF_DATA_SIZE 16
.................... typedef struct {
....................    SmfDataStruct smf_data[SMF_DATA_SIZE];
....................    int8 smf_data_head;
....................    int8 smf_data_tail;
.................... } SmfQueueStruct;
.................... 
.................... // _____________________ values _________________
.................... 
.................... volatile SmfQueueStruct smf_queue = {0};
.................... 
.................... 
.................... // ___________________ functions ________________
.................... 
.................... #separate
.................... void enqueue_smf_data(SmfDataStruct *data);
.................... #separate
.................... SmfDataStruct *dequeue_smf_data();
.................... #separate
.................... int1 is_empty_smf_data(void);
.................... #separate
.................... MissionTypeStruct getMissionTypeStruct(MissionType mis_type);
.................... 
.................... #include "./src/smf_queue.c"
.................... 
.................... #endif
.................... 
.................... 
.................... //#include "flash.h"
.................... 
.................... #Separate
.................... void copy_data(void);
.................... #Separate
.................... void initialize_mission(smfDataStruct* smf_data, MissionTypeStruct* mission_type,
....................                         unsigned int32* mis_start_address, unsigned int32* mis_end_address,
....................                         unsigned int32* write_src, unsigned int32* write_size,
....................                         unsigned int8* loop_count, unsigned int32* used_size);
.................... #Separate
.................... void check_and_erase_if_wrap(unsigned int32 data_region_start, unsigned int32 data_region_end);
.................... #Separate
.................... void erase_write_area(unsigned int32 data_write_addr, unsigned int32 write_size, unsigned int32 mis_end_address);
.................... #Separate
.................... void write_mission_data(unsigned int32 write_src, unsigned int32 write_size, unsigned int32 data_write_addr, int8* buffer, unsigned int32* used_size);
.................... #Separate
.................... void update_size_area(unsigned int32 mis_start_address, unsigned int32 used_size, unsigned int8 loop_count);
.................... 
.................... #include "./src/data_copy.c"
.................... //#include "../../cigs/mmj_cigs_config.h"
.................... #include "../mt25q.h"
.................... #ifndef MT25Q_H
.................... #define MT25Q_H
.................... 
.................... // =========
.................... //#define MT25Q_DEBUG
.................... // =========
.................... 
.................... 
.................... #define FLASH_STREAM0 MIS_FM_STREAM     // <- Align the names to `config.h` Stream name
.................... #define FLASH_STREAM1 SMF_STREAM
.................... #define FLASH_STREAM2 SMF_STREAM // dont use
.................... #define FLASH_STREAM3 SMF_STREAM // dont use
.................... typedef enum spi_stream{
....................     SPI_0,
....................     SPI_1,
....................     SPI_2,
....................     SPI_3,
.................... }SpiStreamId;
.................... 
.................... #define MT25QL128ABA 0x00     //Mission Flash
.................... #define MT25QL01GBBB 0x01     //SMF,CF
.................... typedef struct select_stream_to_flash{
....................     SpiStreamId spi_stream_id;
....................     unsigned int8 flash_model;
....................     int16 cs_pin;
.................... }Flash;
.................... 
.................... 
.................... Flash mis_fm = {SPI_0, MT25QL128ABA, MIS_FM_CS};
.................... Flash smf = {SPI_1, MT25QL01GBBB, SMF_CS};
.................... 
.................... 
.................... 
.................... // ===================== Function List =====================
.................... // Public Functions
.................... #Separate
.................... int1 is_connect(Flash flash_stream);
.................... #Separate
.................... void write_data_bytes(Flash flash_stream, unsigned int32 write_start_address, int8 *write_data, unsigned int16 write_amount);      
.................... #Separate
.................... void read_data_bytes(Flash flash_stream, unsigned int32 read_start_address, int8 *read_data, unsigned int32 read_amount);  
.................... #Separate
.................... void sector_erase(Flash flash_stream, unsigned int32 sector_address);
.................... #Separate
.................... void subsector_32kByte_erase(Flash flash_stream, unsigned int32 subsector_address);  
.................... #Separate                               
.................... void subsector_4kByte_erase(Flash flash_stream, unsigned int32 subsector_address);      
.................... 
.................... //Private Functions
.................... #Separate 
.................... void flash_setting(Flash flash_stream);
.................... #Separate 
.................... int8 status_register(Flash flash_stream);
.................... #Separate 
.................... int8 read_id(Flash flash_stream);
.................... #Separate 
.................... int8 read_data_byte(Flash flash_stream, unsigned int32 read_address);                                               
.................... #Separate 
.................... void write_data_byte(Flash flash_stream, unsigned int32 write_address,int8 write_data);                             
....................         //
.................... 
.................... 
.................... // ===================== Flash Commands =====================
.................... #define CMD_READ_ID                     0x9F
.................... #define CMD_READ_STATUS_REGISTER        0x05
.................... #define CMD_READ                        0x03//for MT25QL128ABA
.................... #define CMD_4BYTE_READ                  0x13//for MT25QL01GBBB
.................... #define CMD_WRITE_ENABLE                0x06
.................... #define CMD_PAGE_PROGRAM                0x02//for MT25QL128ABA
.................... #define CMD_4BYTE_PAGE_PROGRAM          0x12//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_4KB_ERASE         0x20//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_4KB_ERASE   0x21//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_32KB_ERASE        0x52//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_32KB_ERASE  0x5C//for MT25QL01GBBB
.................... #define CMD_SECTOR_ERASE                0xD8//for MT25QL128ABA
.................... #define CMD_4BYTE_SECTOR_ERASE          0xDC//for MT25QL01GBBB
.................... 
.................... // ====================== Value List =====================
.................... #define MANUFACTURER_ID_MICRON 0x20 // Manufacturer ID for Micron flash
.................... #define READ_ID_DATASIZE 4 // 20 bytes for read ID data
.................... 
.................... 
.................... // ====================== Data Structures =====================
.................... typedef union
.................... {
.................... unsigned int8 bytes[READ_ID_DATASIZE]; // 20 bytes for read ID
.................... struct {
....................     unsigned int8 manufacturer_id; // 1 byte
....................     unsigned int8 memory_type;     // 1 byte
....................     unsigned int8 capacity;        // 1 byte
....................     unsigned int8 reserved;    
.................... } fields;
.................... }READ_ID_DATA;
.................... 
.................... #include "./src/mt25q.c"
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... 
.................... #include <stdint.h>
.................... ///////////////////////////////////////////////////////////////////////////
.................... ////                                                                   ////
.................... ////                           stdint.h                                ////
.................... ////                                                                   ////
.................... //// Standard integer definitions.                                     ////
.................... ////                                                                   ////
.................... ///////////////////////////////////////////////////////////////////////////
.................... ////        (C) Copyright 1996,2008 Custom Computer Services           ////
.................... //// This source code may only be used by licensed users of the CCS C  ////
.................... //// compiler.  This source code may only be distributed to other      ////
.................... //// licensed users of the CCS C compiler.  No other use, reproduction ////
.................... //// or distribution is permitted without written permission.          ////
.................... //// Derivative programs created using this software in object code    ////
.................... //// form are not restricted in any way.                               ////
.................... ///////////////////////////////////////////////////////////////////////////
.................... 
.................... #ifndef _STDINT
.................... 
.................... #define _STDINT
.................... 
.................... //////////// exact width
.................... 
.................... typedef signed int8 int8_t;
.................... typedef unsigned int8 uint8_t;
.................... typedef signed int16 int16_t;
.................... typedef unsigned int16 uint16_t;
.................... typedef signed int32 int32_t;
.................... typedef unsigned int32 uint32_t;
.................... 
.................... #if defined(__PCD__)
.................... //typedef signed int24 int24_t;
.................... //typedef unsigned int24 uint24_t;
.................... typedef signed int64 int64_t;
.................... typedef unsigned int64 uint64_t;
.................... #endif
.................... 
.................... #define INT8_MAX  (127)
.................... #define INT8_MIN  (-128)
.................... #define UINT8_MAX (255)
.................... 
.................... #define INT16_MAX  (32767)
.................... #define INT16_MIN  (-32768)
.................... #define UINT16_MAX (65535)
.................... 
.................... #define INT32_MAX  (2147483647)
.................... #define INT32_MIN  (-2147483648)
.................... #define UINT32_MAX (4294967295)
.................... 
.................... #if defined(__PCD__)
.................... //#define INT24_MAX  (8388607)
.................... //#define INT24_MIN  (-8388608)
.................... //#define UINT24_MAX (16777215)
.................... 
.................... #define INT64_MAX  (9223372036854775807)
.................... #define INT64_MIN  (-9223372036854775808)
.................... #define UINT64_MAX (18446744073709551615)
.................... #endif
.................... 
.................... ///////// minimum width
.................... 
.................... typedef signed int8 int_least8_t;
.................... typedef unsigned int8 uint_least8_t;
.................... typedef signed int16 int_least16_t;
.................... typedef unsigned int16 uint_least16_t;
.................... typedef signed int32 int_least32_t;
.................... typedef unsigned int32 uint_least32_t;
.................... 
.................... #if defined(__PCD__)
.................... //typedef signed int24 int_least24_t;
.................... //typedef unsigned int24 uint_least24_t;
.................... typedef signed int64 int_least64_t;
.................... typedef unsigned int64 uint_least64_t;
.................... #endif
.................... 
.................... #define INT_LEAST8_MAX  (127)
.................... #define INT_LEAST8_MIN  (-128)
.................... #define UINT_LEAST8_MAX (255)
.................... 
.................... #define INT_LEAST16_MAX  (32767)
.................... #define INT_LEAST16_MIN  (-32768)
.................... #define UINT_LEAST16_MAX (65535)
.................... 
.................... #define INT_LEAST32_MAX  (2147483647)
.................... #define INT_LEAST32_MIN  (-2147483648)
.................... #define UINT_LEAST32_MAX (4294967295)
.................... 
.................... #if defined(__PCD__)
.................... //#define INT_LEAST24_MAX  (8388607)
.................... //#define INT_LEAST24_MIN  (-8388608)
.................... //#define UINT_LEAST24_MAX (16777215)
.................... 
.................... #define INT_LEAST64_MAX  (9223372036854775807)
.................... #define INT_LEAST64_MIN  (-9223372036854775808)
.................... #define UINT_LEAST64_MAX (18446744073709551615)
.................... #endif
.................... 
.................... ///////// fastest width
.................... 
.................... #if defined(__PCD__)
.................... typedef signed int16 int_fast8_t;
.................... typedef unsigned int16 uint_fast8_t;
.................... #define INT_FAST8_MAX  (32767)
.................... #define INT_FAST8_MIN  (-32768)
.................... #define UINT_FAST8_MAX (65535)
.................... typedef signed int16 int_fast16_t;
.................... typedef unsigned int16 uint_fast16_t;
.................... //typedef signed int24 int_fast24_t;
.................... //typedef unsigned int24 uint_fast24_t;
.................... typedef signed int64 int_fast64_t;
.................... typedef unsigned int64 uint_fast64_t;
.................... #else
.................... typedef signed int8 int_fast8_t;
.................... typedef unsigned int8 uint_fast8_t;
.................... #define INT_FAST8_MAX  (127)
.................... #define INT_FAST8_MIN  (-128)
.................... #define UINT_FAST8_MAX (255)
.................... typedef signed int16 int_fast16_t;
.................... typedef unsigned int16 uint_fast16_t;
.................... #endif
.................... 
.................... typedef signed int32 int_fast32_t;
.................... typedef unsigned int32 uint_fast32_t;
.................... 
.................... #define INT_FAST16_MAX  (32767)
.................... #define INT_FAST16_MIN  (-32768)
.................... #define UINT_FAST16_MAX (65535)
.................... 
.................... #define INT_FAST32_MAX  (2147483647)
.................... #define INT_FAST32_MIN  (-2147483648)
.................... #define UINT_FAST32_MAX (4294967295)
.................... 
.................... #if defined(__PCD__)
.................... //#define INT_FAST24_MAX  (8388607)
.................... //#define INT_FAST24_MIN  (-8388608)
.................... //#define UINT_FAST24_MAX (16777215)
.................... 
.................... #define INT_FAST64_MAX  (9223372036854775807)
.................... #define INT_FAST64_MIN  (-9223372036854775808)
.................... #define UINT_FAST64_MAX (18446744073709551615)
.................... #endif
.................... 
.................... //////////// big enough to hold pointers (OPTIONAL)
.................... 
.................... #if defined(__PCD__)
....................    typedef unsigned int32 uintptr_t;
....................    typedef signed int32 intptr_t;
.................... #else
....................    typedef unsigned int16 uintptr_t;
....................    typedef signed int16 intptr_t;
.................... #endif
.................... 
.................... #define INT8_C(val) ((int8_t)val)
.................... #define UINT8_C(val) ((uint8_t)val)
.................... #define INT16_C(val) ((int16_t)val)
.................... #define UINT16_C(val) ((uint16_t)val)
.................... #define INT32_C(val) ((int32_t)val)
.................... #define UINT32_C(val) ((uint32_t)val)
.................... 
.................... #if defined(__PCD__)
.................... #define INT64_C(val) ((int64_t)val)
.................... #define UINT64_C(val) ((uint64_t)val)
.................... #endif
.................... 
.................... /// TODO:
.................... /// INTPTRN_MIN INTPTRN_MAX UINTPTRN_MAX
.................... 
.................... 
.................... /////////// greatest width (OPTIONAL)
.................... 
.................... #ifdef __PCD__
....................    typedef signed int64 intmax_t;
....................    typedef unsigned int64 uintmax_t;
....................    
....................    #define INTMAXN_MAX  (9223372036854775807)
....................    #define INTMAXN_MIN  (-9223372036854775808)
....................    #define UINTMAXN_MAX (18446744073709551615)
....................    
....................    #define INTMAX_C(value) ((signed int64)val)
....................    #define UINTMAX_C(value) ((unsigned int64)val)
.................... #else
....................    typedef signed int32 intmax_t;
....................    typedef unsigned int32 uintmax_t;
....................    
....................    #define INTMAXN_MAX  (2147483647)
....................    #define INTMAXN_MIN  (-2147483648)
....................    #define UINTMAXN_MAX (4294967295)
....................    
....................    #define INTMAX_C(value) ((signed int32)val)
....................    #define UINTMAX_C(value) ((unsigned int32)val)
.................... #endif
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... #define MAX_READ_SIZE 64
.................... #define SIZE_AREA_SIZE 0x1000
.................... #define SUBSECTOR_SIZE 0x1000 // (4096bytes)
.................... 
.................... #Separate
.................... #separate
.................... void copy_data()
.................... {
....................     fprintf(PC, "\r\n____________________\r\n");
*
363D:  MOVLW  30
363E:  MOVLB  03
363F:  MOVWF  11
3640:  MOVLW  06
3641:  MOVWF  12
3642:  MOVLP  08
3643:  MOVLB  00
3644:  CALL   0CC
3645:  MOVLP  30
....................     fprintf(PC, "___Start copy_data__\r\n");
3646:  MOVLW  3D
3647:  MOVLB  03
3648:  MOVWF  11
3649:  MOVLW  06
364A:  MOVWF  12
364B:  MOVLP  08
364C:  MOVLB  00
364D:  CALL   0CC
364E:  MOVLP  30
.................... 
....................     int8 buffer[MAX_READ_SIZE];
.................... 
....................     for (int8 i = 0; !is_empty_smf_data(); i++)
364F:  MOVLB  0B
3650:  CLRF   5F
3651:  MOVLP  20
3652:  MOVLB  00
3653:  CALL   7F3
3654:  MOVLP  30
3655:  MOVF   78,F
3656:  BTFSS  03.2
3657:  GOTO   78C
....................     {
....................         fprintf(PC, "Start [%d th] data copy\r\n\r\n", i);
3658:  MOVLW  49
3659:  MOVLB  03
365A:  MOVWF  11
365B:  MOVLW  06
365C:  MOVWF  12
365D:  BCF    03.0
365E:  MOVLW  07
365F:  MOVLB  0C
3660:  MOVWF  5E
3661:  MOVLP  08
3662:  MOVLB  00
3663:  CALL   416
3664:  MOVLP  30
3665:  MOVLB  0B
3666:  MOVF   5F,W
3667:  MOVLB  0C
3668:  MOVWF  5B
3669:  MOVLW  18
366A:  MOVWF  5C
366B:  MOVLP  18
366C:  MOVLB  00
366D:  CALL   78C
366E:  MOVLP  30
366F:  MOVLW  4D
3670:  MOVLB  03
3671:  MOVWF  11
3672:  MOVLW  06
3673:  MOVWF  12
3674:  BSF    03.0
3675:  MOVLW  12
3676:  MOVLB  0C
3677:  MOVWF  5E
3678:  MOVLP  08
3679:  MOVLB  00
367A:  CALL   416
367B:  MOVLP  30
.................... 
....................         smfDataStruct *smf_data = dequeue_smf_data();
....................         MissionTypeStruct mission_type;
....................         unsigned int32 mis_start_address, mis_end_address, write_src, write_size;
....................         uint8_t loop_count;
....................         unsigned int32 used_size;
367C:  MOVLP  28
367D:  GOTO   662
367E:  MOVLP  30
367F:  MOVF   79,W
3680:  MOVLB  0B
3681:  MOVWF  61
3682:  MOVF   78,W
3683:  MOVWF  60
.................... 
....................         initialize_mission(smf_data, &mission_type, &mis_start_address, &mis_end_address, &write_src, &write_size, &loop_count, &used_size);
3684:  MOVF   61,W
3685:  MOVLB  0C
3686:  MOVWF  42
3687:  MOVLB  0B
3688:  MOVF   60,W
3689:  MOVLB  0C
368A:  MOVWF  41
368B:  MOVLW  23
368C:  MOVWF  44
368D:  MOVLW  B2
368E:  MOVWF  43
368F:  MOVLW  23
3690:  MOVWF  46
3691:  MOVLW  BB
3692:  MOVWF  45
3693:  MOVLW  23
3694:  MOVWF  48
3695:  MOVLW  C0
3696:  MOVWF  47
3697:  MOVLW  23
3698:  MOVWF  4A
3699:  MOVLW  C4
369A:  MOVWF  49
369B:  MOVLW  23
369C:  MOVWF  4C
369D:  MOVLW  C8
369E:  MOVWF  4B
369F:  MOVLW  23
36A0:  MOVWF  4E
36A1:  MOVLW  BF
36A2:  MOVWF  4D
36A3:  MOVLW  23
36A4:  MOVWF  50
36A5:  MOVLW  CC
36A6:  MOVWF  4F
36A7:  MOVLB  00
36A8:  GOTO   11A
....................         status[i+1] = mission_type.mission_flag;
36A9:  MOVLW  01
36AA:  MOVLB  0B
36AB:  ADDWF  5F,W
36AC:  ADDLW  09
36AD:  MOVWF  04
36AE:  MOVLW  20
36AF:  MOVWF  05
36B0:  BTFSC  03.0
36B1:  INCF   05,F
36B2:  MOVF   6A,W
36B3:  MOVWF  00
.................... 
....................         unsigned int32 data_region_start = mis_start_address + SUBSECTOR_SIZE;
....................         unsigned int32 data_region_end = mis_end_address;
....................         unsigned int32 data_region_size = data_region_end - data_region_start;
....................         unsigned int32 data_write_addr = data_region_start + used_size;
36B4:  MOVF   6B,W
36B5:  MOVLB  0C
36B6:  MOVWF  30
36B7:  MOVLW  10
36B8:  MOVLB  0B
36B9:  ADDWF  6C,W
36BA:  MOVLB  0C
36BB:  MOVWF  31
36BC:  MOVLW  00
36BD:  MOVLB  0B
36BE:  ADDWFC 6D,W
36BF:  MOVLB  0C
36C0:  MOVWF  32
36C1:  MOVLW  00
36C2:  MOVLB  0B
36C3:  ADDWFC 6E,W
36C4:  MOVLB  0C
36C5:  MOVWF  33
36C6:  MOVF   23,W
36C7:  MOVWF  37
36C8:  MOVF   22,W
36C9:  MOVWF  36
36CA:  MOVF   21,W
36CB:  MOVWF  35
36CC:  MOVF   20,W
36CD:  MOVWF  34
36CE:  MOVF   30,W
36CF:  SUBWF  34,W
36D0:  MOVWF  38
36D1:  MOVF   31,W
36D2:  SUBWFC 35,W
36D3:  MOVWF  39
36D4:  MOVF   32,W
36D5:  SUBWFC 36,W
36D6:  MOVWF  3A
36D7:  MOVF   33,W
36D8:  SUBWFC 37,W
36D9:  MOVWF  3B
36DA:  MOVF   2C,W
36DB:  ADDWF  30,W
36DC:  MOVWF  3C
36DD:  MOVF   2D,W
36DE:  ADDWFC 31,W
36DF:  MOVWF  3D
36E0:  MOVF   2E,W
36E1:  ADDWFC 32,W
36E2:  MOVWF  3E
36E3:  MOVF   2F,W
36E4:  ADDWFC 33,W
36E5:  MOVWF  3F
.................... 
....................         if ((used_size + write_size) > data_region_size)
36E6:  MOVF   28,W
36E7:  ADDWF  2C,W
36E8:  MOVWF  40
36E9:  MOVF   29,W
36EA:  ADDWFC 2D,W
36EB:  MOVWF  41
36EC:  MOVF   2A,W
36ED:  ADDWFC 2E,W
36EE:  MOVWF  42
36EF:  MOVF   2B,W
36F0:  ADDWFC 2F,W
36F1:  MOVWF  43
36F2:  MOVF   3B,W
36F3:  SUBWF  43,W
36F4:  BTFSS  03.0
36F5:  GOTO   72B
36F6:  BTFSS  03.2
36F7:  GOTO   708
36F8:  MOVF   3A,W
36F9:  SUBWF  42,W
36FA:  BTFSS  03.0
36FB:  GOTO   72B
36FC:  BTFSS  03.2
36FD:  GOTO   708
36FE:  MOVF   39,W
36FF:  SUBWF  41,W
3700:  BTFSS  03.0
3701:  GOTO   72B
3702:  BTFSS  03.2
3703:  GOTO   708
3704:  MOVF   40,W
3705:  SUBWF  38,W
3706:  BTFSC  03.0
3707:  GOTO   72B
....................         {
....................             check_and_erase_if_wrap(data_region_start, data_region_end);
3708:  MOVF   33,W
3709:  MOVWF  44
370A:  MOVF   32,W
370B:  MOVWF  43
370C:  MOVF   31,W
370D:  MOVWF  42
370E:  MOVF   30,W
370F:  MOVWF  41
3710:  MOVF   37,W
3711:  MOVWF  48
3712:  MOVF   36,W
3713:  MOVWF  47
3714:  MOVF   35,W
3715:  MOVWF  46
3716:  MOVF   34,W
3717:  MOVWF  45
3718:  MOVLP  28
3719:  MOVLB  00
371A:  GOTO   79F
371B:  MOVLP  30
....................             loop_count++;
371C:  MOVLB  0B
371D:  INCF   6F,F
....................             used_size = 0;
371E:  MOVLB  0C
371F:  CLRF   2F
3720:  CLRF   2E
3721:  CLRF   2D
3722:  CLRF   2C
....................             data_write_addr = data_region_start;
3723:  MOVF   33,W
3724:  MOVWF  3F
3725:  MOVF   32,W
3726:  MOVWF  3E
3727:  MOVF   31,W
3728:  MOVWF  3D
3729:  MOVF   30,W
372A:  MOVWF  3C
....................         }
.................... 
....................         erase_write_area(data_write_addr, write_size, mis_end_address);
372B:  MOVF   3F,W
372C:  MOVWF  44
372D:  MOVF   3E,W
372E:  MOVWF  43
372F:  MOVF   3D,W
3730:  MOVWF  42
3731:  MOVF   3C,W
3732:  MOVWF  41
3733:  MOVF   2B,W
3734:  MOVWF  48
3735:  MOVF   2A,W
3736:  MOVWF  47
3737:  MOVF   29,W
3738:  MOVWF  46
3739:  MOVF   28,W
373A:  MOVWF  45
373B:  MOVF   23,W
373C:  MOVWF  4C
373D:  MOVF   22,W
373E:  MOVWF  4B
373F:  MOVF   21,W
3740:  MOVWF  4A
3741:  MOVF   20,W
3742:  MOVWF  49
3743:  MOVLB  00
3744:  GOTO   4E1
.................... 
....................         write_mission_data(write_src, write_size, data_write_addr, buffer, &used_size);
3745:  MOVLB  0C
3746:  MOVF   27,W
3747:  MOVWF  44
3748:  MOVF   26,W
3749:  MOVWF  43
374A:  MOVF   25,W
374B:  MOVWF  42
374C:  MOVF   24,W
374D:  MOVWF  41
374E:  MOVF   2B,W
374F:  MOVWF  48
3750:  MOVF   2A,W
3751:  MOVWF  47
3752:  MOVF   29,W
3753:  MOVWF  46
3754:  MOVF   28,W
3755:  MOVWF  45
3756:  MOVF   3F,W
3757:  MOVWF  4C
3758:  MOVF   3E,W
3759:  MOVWF  4B
375A:  MOVF   3D,W
375B:  MOVWF  4A
375C:  MOVF   3C,W
375D:  MOVWF  49
375E:  MOVLW  23
375F:  MOVWF  4E
3760:  MOVLW  6F
3761:  MOVWF  4D
3762:  MOVLW  23
3763:  MOVWF  50
3764:  MOVLW  CC
3765:  MOVWF  4F
3766:  MOVLB  00
3767:  GOTO   563
.................... 
....................         update_size_area(mis_start_address, used_size, loop_count);
3768:  MOVLB  0B
3769:  MOVF   6E,W
376A:  MOVLB  0C
376B:  MOVWF  44
376C:  MOVLB  0B
376D:  MOVF   6D,W
376E:  MOVLB  0C
376F:  MOVWF  43
3770:  MOVLB  0B
3771:  MOVF   6C,W
3772:  MOVLB  0C
3773:  MOVWF  42
3774:  MOVLB  0B
3775:  MOVF   6B,W
3776:  MOVLB  0C
3777:  MOVWF  41
3778:  MOVF   2F,W
3779:  MOVWF  48
377A:  MOVF   2E,W
377B:  MOVWF  47
377C:  MOVF   2D,W
377D:  MOVWF  46
377E:  MOVF   2C,W
377F:  MOVWF  45
3780:  MOVLB  0B
3781:  MOVF   6F,W
3782:  MOVLB  0C
3783:  MOVWF  49
3784:  MOVLP  38
3785:  MOVLB  00
3786:  GOTO   1DB
3787:  MOVLP  30
3788:  MOVLB  0B
3789:  INCF   5F,F
378A:  GOTO   651
378B:  MOVLB  00
....................     }
.................... 
....................     fprintf(PC, "\r\n___End copy_data____\r\n");
378C:  MOVLW  57
378D:  MOVLB  03
378E:  MOVWF  11
378F:  MOVLW  06
3790:  MOVWF  12
3791:  MOVLP  08
3792:  MOVLB  00
3793:  CALL   0CC
3794:  MOVLP  30
....................     fprintf(PC, "____________________\r\n\r\n");
3795:  MOVLW  64
3796:  MOVLB  03
3797:  MOVWF  11
3798:  MOVLW  06
3799:  MOVWF  12
379A:  MOVLP  08
379B:  MOVLB  00
379C:  CALL   0CC
379D:  MOVLP  30
379E:  MOVLP  30
379F:  GOTO   7CA (RETURN)
.................... }
.................... 
.................... #separate
.................... void initialize_mission(smfDataStruct* smf_data, MissionTypeStruct* mission_type,
....................                         unsigned int32* mis_start_address, unsigned int32* mis_end_address,
....................                         unsigned int32* write_src, unsigned int32* write_size,
....................                         unsigned int8* loop_count, unsigned int32* used_size)
.................... {
....................     *mission_type = getMissionTypeStruct(smf_data->mission_type);
*
311A:  MOVLB  0C
311B:  MOVF   44,W
311C:  MOVWF  7A
311D:  MOVF   43,W
311E:  MOVWF  56
311F:  MOVF   7A,W
3120:  MOVWF  57
3121:  MOVF   41,W
3122:  MOVWF  04
3123:  MOVF   42,W
3124:  MOVWF  05
3125:  ADDFSR 00,FSR0
3126:  MOVF   00,W
3127:  MOVWF  58
3128:  MOVWF  5F
3129:  MOVLP  28
312A:  MOVLB  00
312B:  GOTO   6B3
312C:  MOVLP  30
312D:  MOVF   79,W
312E:  MOVWF  7A
312F:  MOVF   78,W
3130:  MOVWF  04
3131:  MOVF   7A,W
3132:  MOVWF  05
3133:  MOVLW  09
3134:  MOVWF  78
3135:  MOVLB  0C
3136:  MOVF   57,W
3137:  MOVWF  07
3138:  MOVF   56,W
3139:  MOVWF  06
313A:  MOVIW  [FSR0++],W
313B:  MOVWI  W,[FSR1++]
313C:  DECFSZ 78,F
313D:  GOTO   13A
....................     *mis_start_address = mission_type->start_address;
313E:  MOVF   46,W
313F:  MOVWF  7A
3140:  MOVF   7A,W
3141:  MOVWF  57
3142:  MOVF   43,W
3143:  MOVWF  04
3144:  MOVF   44,W
3145:  MOVWF  05
3146:  ADDFSR 00,FSR0
3147:  MOVF   00,W
3148:  MOVWF  77
3149:  ADDFSR 01,FSR0
314A:  MOVF   00,W
314B:  MOVWF  78
314C:  ADDFSR 01,FSR0
314D:  MOVF   00,W
314E:  MOVWF  79
314F:  ADDFSR 01,FSR0
3150:  MOVF   00,W
3151:  MOVWF  7A
3152:  ADDFSR 3D,FSR0
3153:  MOVF   7A,W
3154:  MOVWF  5B
3155:  MOVF   79,W
3156:  MOVWF  5A
3157:  MOVF   78,W
3158:  MOVWF  59
3159:  MOVF   77,W
315A:  MOVWF  58
315B:  MOVF   57,W
315C:  MOVWF  05
315D:  MOVF   45,W
315E:  MOVWF  04
315F:  MOVF   58,W
3160:  MOVWF  00
3161:  MOVF   59,W
3162:  MOVWI  W,[FSR0+01]
3163:  MOVF   5A,W
3164:  MOVWI  W,[FSR0+02]
3165:  MOVF   5B,W
3166:  MOVWI  W,[FSR0+03]
....................     *mis_end_address = mission_type->end_address;
3167:  MOVF   43,W
3168:  MOVWF  04
3169:  MOVF   44,W
316A:  MOVWF  05
316B:  ADDFSR 04,FSR0
316C:  MOVF   00,W
316D:  MOVWF  77
316E:  ADDFSR 01,FSR0
316F:  MOVF   00,W
3170:  MOVWF  78
3171:  ADDFSR 01,FSR0
3172:  MOVF   00,W
3173:  MOVWF  79
3174:  ADDFSR 01,FSR0
3175:  MOVF   00,W
3176:  MOVWF  7A
3177:  ADDFSR 3D,FSR0
3178:  MOVF   7A,W
3179:  MOVWF  5B
317A:  MOVF   79,W
317B:  MOVWF  5A
317C:  MOVF   78,W
317D:  MOVWF  59
317E:  MOVF   77,W
317F:  MOVWF  58
3180:  MOVF   48,W
3181:  MOVWF  05
3182:  MOVF   47,W
3183:  MOVWF  04
3184:  MOVF   58,W
3185:  MOVWF  00
3186:  MOVF   59,W
3187:  MOVWI  W,[FSR0+01]
3188:  MOVF   5A,W
3189:  MOVWI  W,[FSR0+02]
318A:  MOVF   5B,W
318B:  MOVWI  W,[FSR0+03]
....................     *write_src = smf_data->src;
318C:  MOVF   41,W
318D:  MOVWF  04
318E:  MOVF   42,W
318F:  MOVWF  05
3190:  ADDFSR 01,FSR0
3191:  MOVF   00,W
3192:  MOVWF  77
3193:  ADDFSR 01,FSR0
3194:  MOVF   00,W
3195:  MOVWF  78
3196:  ADDFSR 01,FSR0
3197:  MOVF   00,W
3198:  MOVWF  79
3199:  ADDFSR 01,FSR0
319A:  MOVF   00,W
319B:  MOVWF  7A
319C:  ADDFSR 3D,FSR0
319D:  MOVF   7A,W
319E:  MOVWF  5B
319F:  MOVF   79,W
31A0:  MOVWF  5A
31A1:  MOVF   78,W
31A2:  MOVWF  59
31A3:  MOVF   77,W
31A4:  MOVWF  58
31A5:  MOVF   4A,W
31A6:  MOVWF  05
31A7:  MOVF   49,W
31A8:  MOVWF  04
31A9:  MOVF   58,W
31AA:  MOVWF  00
31AB:  MOVF   59,W
31AC:  MOVWI  W,[FSR0+01]
31AD:  MOVF   5A,W
31AE:  MOVWI  W,[FSR0+02]
31AF:  MOVF   5B,W
31B0:  MOVWI  W,[FSR0+03]
....................     *write_size = smf_data->size;
31B1:  MOVF   41,W
31B2:  MOVWF  04
31B3:  MOVF   42,W
31B4:  MOVWF  05
31B5:  ADDFSR 05,FSR0
31B6:  MOVF   00,W
31B7:  MOVWF  77
31B8:  ADDFSR 01,FSR0
31B9:  MOVF   00,W
31BA:  MOVWF  78
31BB:  ADDFSR 01,FSR0
31BC:  MOVF   00,W
31BD:  MOVWF  79
31BE:  ADDFSR 01,FSR0
31BF:  MOVF   00,W
31C0:  MOVWF  7A
31C1:  ADDFSR 3D,FSR0
31C2:  MOVF   7A,W
31C3:  MOVWF  5B
31C4:  MOVF   79,W
31C5:  MOVWF  5A
31C6:  MOVF   78,W
31C7:  MOVWF  59
31C8:  MOVF   77,W
31C9:  MOVWF  58
31CA:  MOVF   4C,W
31CB:  MOVWF  05
31CC:  MOVF   4B,W
31CD:  MOVWF  04
31CE:  MOVF   58,W
31CF:  MOVWF  00
31D0:  MOVF   59,W
31D1:  MOVWI  W,[FSR0+01]
31D2:  MOVF   5A,W
31D3:  MOVWI  W,[FSR0+02]
31D4:  MOVF   5B,W
31D5:  MOVWI  W,[FSR0+03]
.................... 
....................     fprintf(PC, "In smf mission data start   address: %LX\r\n", *mis_start_address);
31D6:  MOVF   46,W
31D7:  MOVWF  7A
31D8:  MOVF   45,W
31D9:  MOVWF  04
31DA:  MOVF   46,W
31DB:  MOVWF  05
31DC:  MOVF   00,W
31DD:  MOVWF  56
31DE:  ADDFSR 01,FSR0
31DF:  MOVF   00,W
31E0:  MOVWF  57
31E1:  ADDFSR 01,FSR0
31E2:  MOVF   00,W
31E3:  MOVWF  58
31E4:  ADDFSR 01,FSR0
31E5:  MOVF   00,W
31E6:  MOVWF  59
31E7:  ADDFSR 3D,FSR0
31E8:  MOVLW  71
31E9:  MOVLB  03
31EA:  MOVWF  11
31EB:  MOVLW  06
31EC:  MOVWF  12
31ED:  BCF    03.0
31EE:  MOVLW  25
31EF:  MOVLB  0C
31F0:  MOVWF  5E
31F1:  MOVLP  08
31F2:  MOVLB  00
31F3:  CALL   416
31F4:  MOVLP  30
31F5:  MOVLB  0C
31F6:  MOVF   59,W
31F7:  MOVLB  0E
31F8:  MOVWF  4E
31F9:  MOVLW  37
31FA:  MOVWF  4F
31FB:  MOVLP  08
31FC:  MOVLB  00
31FD:  CALL   470
31FE:  MOVLP  30
31FF:  MOVLB  0C
3200:  MOVF   58,W
3201:  MOVLB  0E
3202:  MOVWF  4E
3203:  MOVLW  37
3204:  MOVWF  4F
3205:  MOVLP  08
3206:  MOVLB  00
3207:  CALL   470
3208:  MOVLP  30
3209:  MOVLB  0C
320A:  MOVF   57,W
320B:  MOVLB  0E
320C:  MOVWF  4E
320D:  MOVLW  37
320E:  MOVWF  4F
320F:  MOVLP  08
3210:  MOVLB  00
3211:  CALL   470
3212:  MOVLP  30
3213:  MOVLB  0C
3214:  MOVF   56,W
3215:  MOVLB  0E
3216:  MOVWF  4E
3217:  MOVLW  37
3218:  MOVWF  4F
3219:  MOVLP  08
321A:  MOVLB  00
321B:  CALL   470
321C:  MOVLP  30
321D:  MOVLW  0D
321E:  MOVLB  0F
321F:  MOVWF  43
3220:  MOVLP  08
3221:  MOVLB  00
3222:  CALL   0A7
3223:  MOVLP  30
3224:  MOVLW  0A
3225:  MOVLB  0F
3226:  MOVWF  43
3227:  MOVLP  08
3228:  MOVLB  00
3229:  CALL   0A7
322A:  MOVLP  30
....................     fprintf(PC, "In smf mission data end     address: %LX\r\n", *mis_end_address);
322B:  MOVLB  0C
322C:  MOVF   48,W
322D:  MOVWF  7A
322E:  MOVF   47,W
322F:  MOVWF  04
3230:  MOVF   48,W
3231:  MOVWF  05
3232:  MOVF   00,W
3233:  MOVWF  56
3234:  ADDFSR 01,FSR0
3235:  MOVF   00,W
3236:  MOVWF  57
3237:  ADDFSR 01,FSR0
3238:  MOVF   00,W
3239:  MOVWF  58
323A:  ADDFSR 01,FSR0
323B:  MOVF   00,W
323C:  MOVWF  59
323D:  ADDFSR 3D,FSR0
323E:  MOVLW  87
323F:  MOVLB  03
3240:  MOVWF  11
3241:  MOVLW  06
3242:  MOVWF  12
3243:  BCF    03.0
3244:  MOVLW  25
3245:  MOVLB  0C
3246:  MOVWF  5E
3247:  MOVLP  08
3248:  MOVLB  00
3249:  CALL   416
324A:  MOVLP  30
324B:  MOVLB  0C
324C:  MOVF   59,W
324D:  MOVLB  0E
324E:  MOVWF  4E
324F:  MOVLW  37
3250:  MOVWF  4F
3251:  MOVLP  08
3252:  MOVLB  00
3253:  CALL   470
3254:  MOVLP  30
3255:  MOVLB  0C
3256:  MOVF   58,W
3257:  MOVLB  0E
3258:  MOVWF  4E
3259:  MOVLW  37
325A:  MOVWF  4F
325B:  MOVLP  08
325C:  MOVLB  00
325D:  CALL   470
325E:  MOVLP  30
325F:  MOVLB  0C
3260:  MOVF   57,W
3261:  MOVLB  0E
3262:  MOVWF  4E
3263:  MOVLW  37
3264:  MOVWF  4F
3265:  MOVLP  08
3266:  MOVLB  00
3267:  CALL   470
3268:  MOVLP  30
3269:  MOVLB  0C
326A:  MOVF   56,W
326B:  MOVLB  0E
326C:  MOVWF  4E
326D:  MOVLW  37
326E:  MOVWF  4F
326F:  MOVLP  08
3270:  MOVLB  00
3271:  CALL   470
3272:  MOVLP  30
3273:  MOVLW  0D
3274:  MOVLB  0F
3275:  MOVWF  43
3276:  MOVLP  08
3277:  MOVLB  00
3278:  CALL   0A7
3279:  MOVLP  30
327A:  MOVLW  0A
327B:  MOVLB  0F
327C:  MOVWF  43
327D:  MOVLP  08
327E:  MOVLB  00
327F:  CALL   0A7
3280:  MOVLP  30
....................     fprintf(PC, "In MIS FM Write source data address: %LX\r\n", *write_src);
3281:  MOVLB  0C
3282:  MOVF   4A,W
3283:  MOVWF  7A
3284:  MOVF   49,W
3285:  MOVWF  04
3286:  MOVF   4A,W
3287:  MOVWF  05
3288:  MOVF   00,W
3289:  MOVWF  56
328A:  ADDFSR 01,FSR0
328B:  MOVF   00,W
328C:  MOVWF  57
328D:  ADDFSR 01,FSR0
328E:  MOVF   00,W
328F:  MOVWF  58
3290:  ADDFSR 01,FSR0
3291:  MOVF   00,W
3292:  MOVWF  59
3293:  ADDFSR 3D,FSR0
3294:  MOVLW  9D
3295:  MOVLB  03
3296:  MOVWF  11
3297:  MOVLW  06
3298:  MOVWF  12
3299:  BCF    03.0
329A:  MOVLW  25
329B:  MOVLB  0C
329C:  MOVWF  5E
329D:  MOVLP  08
329E:  MOVLB  00
329F:  CALL   416
32A0:  MOVLP  30
32A1:  MOVLB  0C
32A2:  MOVF   59,W
32A3:  MOVLB  0E
32A4:  MOVWF  4E
32A5:  MOVLW  37
32A6:  MOVWF  4F
32A7:  MOVLP  08
32A8:  MOVLB  00
32A9:  CALL   470
32AA:  MOVLP  30
32AB:  MOVLB  0C
32AC:  MOVF   58,W
32AD:  MOVLB  0E
32AE:  MOVWF  4E
32AF:  MOVLW  37
32B0:  MOVWF  4F
32B1:  MOVLP  08
32B2:  MOVLB  00
32B3:  CALL   470
32B4:  MOVLP  30
32B5:  MOVLB  0C
32B6:  MOVF   57,W
32B7:  MOVLB  0E
32B8:  MOVWF  4E
32B9:  MOVLW  37
32BA:  MOVWF  4F
32BB:  MOVLP  08
32BC:  MOVLB  00
32BD:  CALL   470
32BE:  MOVLP  30
32BF:  MOVLB  0C
32C0:  MOVF   56,W
32C1:  MOVLB  0E
32C2:  MOVWF  4E
32C3:  MOVLW  37
32C4:  MOVWF  4F
32C5:  MOVLP  08
32C6:  MOVLB  00
32C7:  CALL   470
32C8:  MOVLP  30
32C9:  MOVLW  0D
32CA:  MOVLB  0F
32CB:  MOVWF  43
32CC:  MOVLP  08
32CD:  MOVLB  00
32CE:  CALL   0A7
32CF:  MOVLP  30
32D0:  MOVLW  0A
32D1:  MOVLB  0F
32D2:  MOVWF  43
32D3:  MOVLP  08
32D4:  MOVLB  00
32D5:  CALL   0A7
32D6:  MOVLP  30
....................     fprintf(PC, "In MIS FM Write data size          : %lu\r\n\r\n", *write_size);
32D7:  MOVLB  0C
32D8:  MOVF   4C,W
32D9:  MOVWF  7A
32DA:  MOVF   4B,W
32DB:  MOVWF  04
32DC:  MOVF   4C,W
32DD:  MOVWF  05
32DE:  MOVF   00,W
32DF:  MOVWF  56
32E0:  ADDFSR 01,FSR0
32E1:  MOVF   00,W
32E2:  MOVWF  57
32E3:  ADDFSR 01,FSR0
32E4:  MOVF   00,W
32E5:  MOVWF  58
32E6:  ADDFSR 01,FSR0
32E7:  MOVF   00,W
32E8:  MOVWF  59
32E9:  ADDFSR 3D,FSR0
32EA:  MOVLW  B3
32EB:  MOVLB  03
32EC:  MOVWF  11
32ED:  MOVLW  06
32EE:  MOVWF  12
32EF:  BCF    03.0
32F0:  MOVLW  25
32F1:  MOVLB  0C
32F2:  MOVWF  5E
32F3:  MOVLP  08
32F4:  MOVLB  00
32F5:  CALL   416
32F6:  MOVLP  30
32F7:  MOVLW  41
32F8:  MOVWF  04
32F9:  MOVLB  0C
32FA:  MOVF   59,W
32FB:  MOVWF  61
32FC:  MOVF   58,W
32FD:  MOVWF  60
32FE:  MOVF   57,W
32FF:  MOVWF  5F
3300:  MOVF   56,W
3301:  MOVWF  5E
3302:  MOVLP  28
3303:  MOVLB  00
3304:  CALL   722
3305:  MOVLP  30
3306:  MOVLW  C7
3307:  MOVLB  03
3308:  MOVWF  11
3309:  MOVLW  06
330A:  MOVWF  12
330B:  BCF    03.0
330C:  MOVLW  04
330D:  MOVLB  0C
330E:  MOVWF  5E
330F:  MOVLP  08
3310:  MOVLB  00
3311:  CALL   416
3312:  MOVLP  30
.................... 
....................     unsigned int8 used_size_bytes[4];
....................     read_data_bytes(smf, *mis_start_address, used_size_bytes, 4);
3313:  MOVLB  0C
3314:  MOVF   46,W
3315:  MOVWF  7A
3316:  MOVF   45,W
3317:  MOVWF  04
3318:  MOVF   46,W
3319:  MOVWF  05
331A:  MOVF   00,W
331B:  MOVWF  56
331C:  ADDFSR 01,FSR0
331D:  MOVF   00,W
331E:  MOVWF  57
331F:  ADDFSR 01,FSR0
3320:  MOVF   00,W
3321:  MOVWF  58
3322:  ADDFSR 01,FSR0
3323:  MOVF   00,W
3324:  MOVWF  59
3325:  ADDFSR 3D,FSR0
3326:  MOVLB  08
3327:  MOVF   61,W
3328:  MOVLB  0E
3329:  MOVWF  42
332A:  MOVLB  08
332B:  MOVF   60,W
332C:  MOVLB  0E
332D:  MOVWF  41
332E:  MOVLB  08
332F:  MOVF   5F,W
3330:  MOVLB  0E
3331:  MOVWF  40
3332:  MOVLB  08
3333:  MOVF   5E,W
3334:  MOVLB  0E
3335:  MOVWF  3F
3336:  MOVLB  0C
3337:  MOVF   59,W
3338:  MOVLB  0E
3339:  MOVWF  46
333A:  MOVLB  0C
333B:  MOVF   58,W
333C:  MOVLB  0E
333D:  MOVWF  45
333E:  MOVLB  0C
333F:  MOVF   57,W
3340:  MOVLB  0E
3341:  MOVWF  44
3342:  MOVLB  0C
3343:  MOVF   56,W
3344:  MOVLB  0E
3345:  MOVWF  43
3346:  MOVLW  23
3347:  MOVWF  48
3348:  MOVLW  F1
3349:  MOVWF  47
334A:  CLRF   4C
334B:  CLRF   4B
334C:  CLRF   4A
334D:  MOVLW  04
334E:  MOVWF  49
334F:  MOVLP  08
3350:  MOVLB  00
3351:  CALL   321
3352:  MOVLP  30
....................     *used_size = 
....................        ((unsigned int32)used_size_bytes[3] << 24) |
....................        ((unsigned int32)used_size_bytes[2] << 16) |
....................        ((unsigned int32)used_size_bytes[1] << 8)  |
....................        ((unsigned int32)used_size_bytes[0]);
3353:  MOVLB  0C
3354:  MOVF   4F,W
3355:  MOVWF  04
3356:  MOVF   50,W
3357:  MOVWF  05
3358:  CLRF   5B
3359:  CLRF   5A
335A:  CLRF   59
335B:  MOVF   54,W
335C:  MOVWF  58
335D:  MOVWF  5B
335E:  CLRF   58
335F:  CLRF   59
3360:  CLRF   5A
3361:  CLRF   60
3362:  CLRF   5F
3363:  CLRF   5E
3364:  MOVF   5E,W
3365:  MOVWF  7A
3366:  CLRF   77
3367:  CLRF   78
3368:  MOVF   77,W
3369:  IORWF  58,F
336A:  MOVF   78,W
336B:  IORWF  59,F
336C:  MOVF   53,W
336D:  IORWF  5A,F
336E:  MOVF   5E,W
336F:  IORWF  5B,F
3370:  CLRF   60
3371:  CLRF   5F
3372:  CLRF   5E
3373:  MOVF   5F,W
3374:  MOVWF  7A
3375:  MOVF   5E,W
3376:  MOVWF  79
3377:  MOVF   52,W
3378:  MOVWF  78
3379:  CLRF   77
337A:  MOVF   77,W
337B:  IORWF  58,F
337C:  MOVF   52,W
337D:  IORWF  59,F
337E:  MOVF   5E,W
337F:  IORWF  5A,F
3380:  MOVF   5F,W
3381:  IORWF  5B,F
3382:  CLRF   78
3383:  CLRF   79
3384:  CLRF   7A
3385:  MOVF   51,W
3386:  IORWF  58,W
3387:  MOVWF  77
3388:  MOVF   78,W
3389:  IORWF  59,W
338A:  MOVWF  78
338B:  MOVF   79,W
338C:  IORWF  5A,W
338D:  MOVWF  79
338E:  MOVF   7A,W
338F:  IORWF  5B,W
3390:  MOVWF  7A
3391:  MOVF   77,W
3392:  MOVWF  00
3393:  MOVF   78,W
3394:  MOVWI  W,[FSR0+01]
3395:  MOVF   79,W
3396:  MOVWI  W,[FSR0+02]
3397:  MOVF   7A,W
3398:  MOVWI  W,[FSR0+03]
....................     *loop_count = read_data_byte(smf, *mis_start_address + 4);
3399:  MOVF   4D,W
339A:  MOVWF  56
339B:  MOVF   4E,W
339C:  MOVWF  57
339D:  MOVF   46,W
339E:  MOVWF  7A
339F:  MOVF   45,W
33A0:  MOVWF  04
33A1:  MOVF   46,W
33A2:  MOVWF  05
33A3:  MOVF   00,W
33A4:  MOVWF  58
33A5:  ADDFSR 01,FSR0
33A6:  MOVF   00,W
33A7:  MOVWF  59
33A8:  ADDFSR 01,FSR0
33A9:  MOVF   00,W
33AA:  MOVWF  5A
33AB:  ADDFSR 01,FSR0
33AC:  MOVF   00,W
33AD:  MOVWF  5B
33AE:  ADDFSR 3D,FSR0
33AF:  MOVLW  04
33B0:  ADDWF  58,F
33B1:  MOVLW  00
33B2:  ADDWFC 59,F
33B3:  ADDWFC 5A,F
33B4:  ADDWFC 5B,F
33B5:  MOVLB  08
33B6:  MOVF   61,W
33B7:  MOVLB  0C
33B8:  MOVWF  5F
33B9:  MOVLB  08
33BA:  MOVF   60,W
33BB:  MOVLB  0C
33BC:  MOVWF  5E
33BD:  MOVLB  08
33BE:  MOVF   5F,W
33BF:  MOVLB  0C
33C0:  MOVWF  5D
33C1:  MOVLB  08
33C2:  MOVF   5E,W
33C3:  MOVLB  0C
33C4:  MOVWF  5C
33C5:  MOVF   5B,W
33C6:  MOVWF  63
33C7:  MOVF   5A,W
33C8:  MOVWF  62
33C9:  MOVF   59,W
33CA:  MOVWF  61
33CB:  MOVF   58,W
33CC:  MOVWF  60
33CD:  MOVLB  00
33CE:  GOTO   000
33CF:  MOVLB  0C
33D0:  MOVF   57,W
33D1:  MOVWF  05
33D2:  MOVF   56,W
33D3:  MOVWF  04
33D4:  MOVF   78,W
33D5:  MOVWF  00
.................... 
....................     fprintf(PC, "Size area read\r\n");
33D6:  MOVLW  CA
33D7:  MOVLB  03
33D8:  MOVWF  11
33D9:  MOVLW  06
33DA:  MOVWF  12
33DB:  MOVLP  08
33DC:  MOVLB  00
33DD:  CALL   0CC
33DE:  MOVLP  30
....................     fprintf(PC, "used_size = %lu (src 0x%08LX)\r\n", *used_size, *mis_start_address);
33DF:  MOVLB  0C
33E0:  MOVF   4F,W
33E1:  MOVWF  04
33E2:  MOVF   50,W
33E3:  MOVWF  05
33E4:  MOVF   00,W
33E5:  MOVWF  56
33E6:  ADDFSR 01,FSR0
33E7:  MOVF   00,W
33E8:  MOVWF  57
33E9:  ADDFSR 01,FSR0
33EA:  MOVF   00,W
33EB:  MOVWF  58
33EC:  ADDFSR 01,FSR0
33ED:  MOVF   00,W
33EE:  MOVWF  59
33EF:  ADDFSR 3D,FSR0
33F0:  MOVF   46,W
33F1:  MOVWF  7A
33F2:  MOVF   45,W
33F3:  MOVWF  04
33F4:  MOVF   46,W
33F5:  MOVWF  05
33F6:  MOVF   00,W
33F7:  MOVWF  5A
33F8:  ADDFSR 01,FSR0
33F9:  MOVF   00,W
33FA:  MOVWF  5B
33FB:  ADDFSR 01,FSR0
33FC:  MOVF   00,W
33FD:  MOVWF  5C
33FE:  ADDFSR 01,FSR0
33FF:  MOVF   00,W
3400:  MOVWF  5D
3401:  ADDFSR 3D,FSR0
3402:  MOVLW  D3
3403:  MOVLB  03
3404:  MOVWF  11
3405:  MOVLW  06
3406:  MOVWF  12
3407:  BCF    03.0
3408:  MOVLW  0C
3409:  MOVLB  0C
340A:  MOVWF  5E
340B:  MOVLP  08
340C:  MOVLB  00
340D:  CALL   416
340E:  MOVLP  30
340F:  MOVLW  41
3410:  MOVWF  04
3411:  MOVLB  0C
3412:  MOVF   59,W
3413:  MOVWF  61
3414:  MOVF   58,W
3415:  MOVWF  60
3416:  MOVF   57,W
3417:  MOVWF  5F
3418:  MOVF   56,W
3419:  MOVWF  5E
341A:  MOVLP  28
341B:  MOVLB  00
341C:  CALL   722
341D:  MOVLP  30
341E:  MOVLW  DA
341F:  MOVLB  03
3420:  MOVWF  11
3421:  MOVLW  06
3422:  MOVWF  12
3423:  BSF    03.0
3424:  MOVLW  08
3425:  MOVLB  0C
3426:  MOVWF  5E
3427:  MOVLP  08
3428:  MOVLB  00
3429:  CALL   416
342A:  MOVLP  30
342B:  MOVLB  0C
342C:  MOVF   5D,W
342D:  MOVLB  0E
342E:  MOVWF  4E
342F:  MOVLW  37
3430:  MOVWF  4F
3431:  MOVLP  08
3432:  MOVLB  00
3433:  CALL   470
3434:  MOVLP  30
3435:  MOVLB  0C
3436:  MOVF   5C,W
3437:  MOVLB  0E
3438:  MOVWF  4E
3439:  MOVLW  37
343A:  MOVWF  4F
343B:  MOVLP  08
343C:  MOVLB  00
343D:  CALL   470
343E:  MOVLP  30
343F:  MOVLB  0C
3440:  MOVF   5B,W
3441:  MOVLB  0E
3442:  MOVWF  4E
3443:  MOVLW  37
3444:  MOVWF  4F
3445:  MOVLP  08
3446:  MOVLB  00
3447:  CALL   470
3448:  MOVLP  30
3449:  MOVLB  0C
344A:  MOVF   5A,W
344B:  MOVLB  0E
344C:  MOVWF  4E
344D:  MOVLW  37
344E:  MOVWF  4F
344F:  MOVLP  08
3450:  MOVLB  00
3451:  CALL   470
3452:  MOVLP  30
3453:  MOVLW  29
3454:  MOVLB  0F
3455:  MOVWF  43
3456:  MOVLP  08
3457:  MOVLB  00
3458:  CALL   0A7
3459:  MOVLP  30
345A:  MOVLW  0D
345B:  MOVLB  0F
345C:  MOVWF  43
345D:  MOVLP  08
345E:  MOVLB  00
345F:  CALL   0A7
3460:  MOVLP  30
3461:  MOVLW  0A
3462:  MOVLB  0F
3463:  MOVWF  43
3464:  MOVLP  08
3465:  MOVLB  00
3466:  CALL   0A7
3467:  MOVLP  30
....................     fprintf(PC, "loop count= %d  (src 0x%08LX)\r\n\r\n", *loop_count, *mis_start_address + 4);
3468:  MOVLB  0C
3469:  MOVF   4D,W
346A:  MOVWF  04
346B:  MOVF   4E,W
346C:  MOVWF  05
346D:  MOVF   00,W
346E:  MOVWF  56
346F:  MOVF   46,W
3470:  MOVWF  7A
3471:  MOVF   45,W
3472:  MOVWF  04
3473:  MOVF   46,W
3474:  MOVWF  05
3475:  MOVF   00,W
3476:  MOVWF  57
3477:  ADDFSR 01,FSR0
3478:  MOVF   00,W
3479:  MOVWF  58
347A:  ADDFSR 01,FSR0
347B:  MOVF   00,W
347C:  MOVWF  59
347D:  ADDFSR 01,FSR0
347E:  MOVF   00,W
347F:  MOVWF  5A
3480:  ADDFSR 3D,FSR0
3481:  MOVLW  04
3482:  ADDWF  57,F
3483:  MOVLW  00
3484:  ADDWFC 58,F
3485:  ADDWFC 59,F
3486:  ADDWFC 5A,F
3487:  MOVLW  E3
3488:  MOVLB  03
3489:  MOVWF  11
348A:  MOVLW  06
348B:  MOVWF  12
348C:  BCF    03.0
348D:  MOVLW  0C
348E:  MOVLB  0C
348F:  MOVWF  5E
3490:  MOVLP  08
3491:  MOVLB  00
3492:  CALL   416
3493:  MOVLP  30
3494:  MOVLB  0C
3495:  MOVF   56,W
3496:  MOVWF  5B
3497:  MOVLW  18
3498:  MOVWF  5C
3499:  MOVLP  18
349A:  MOVLB  00
349B:  CALL   78C
349C:  MOVLP  30
349D:  MOVLW  EA
349E:  MOVLB  03
349F:  MOVWF  11
34A0:  MOVLW  06
34A1:  MOVWF  12
34A2:  BCF    03.0
34A3:  MOVLW  09
34A4:  MOVLB  0C
34A5:  MOVWF  5E
34A6:  MOVLP  08
34A7:  MOVLB  00
34A8:  CALL   416
34A9:  MOVLP  30
34AA:  MOVLB  0C
34AB:  MOVF   5A,W
34AC:  MOVLB  0E
34AD:  MOVWF  4E
34AE:  MOVLW  37
34AF:  MOVWF  4F
34B0:  MOVLP  08
34B1:  MOVLB  00
34B2:  CALL   470
34B3:  MOVLP  30
34B4:  MOVLB  0C
34B5:  MOVF   59,W
34B6:  MOVLB  0E
34B7:  MOVWF  4E
34B8:  MOVLW  37
34B9:  MOVWF  4F
34BA:  MOVLP  08
34BB:  MOVLB  00
34BC:  CALL   470
34BD:  MOVLP  30
34BE:  MOVLB  0C
34BF:  MOVF   58,W
34C0:  MOVLB  0E
34C1:  MOVWF  4E
34C2:  MOVLW  37
34C3:  MOVWF  4F
34C4:  MOVLP  08
34C5:  MOVLB  00
34C6:  CALL   470
34C7:  MOVLP  30
34C8:  MOVLB  0C
34C9:  MOVF   57,W
34CA:  MOVLB  0E
34CB:  MOVWF  4E
34CC:  MOVLW  37
34CD:  MOVWF  4F
34CE:  MOVLP  08
34CF:  MOVLB  00
34D0:  CALL   470
34D1:  MOVLP  30
34D2:  MOVLW  F1
34D3:  MOVLB  03
34D4:  MOVWF  11
34D5:  MOVLW  06
34D6:  MOVWF  12
34D7:  BCF    03.0
34D8:  MOVLW  05
34D9:  MOVLB  0C
34DA:  MOVWF  5E
34DB:  MOVLP  08
34DC:  MOVLB  00
34DD:  CALL   416
34DE:  MOVLP  30
34DF:  MOVLP  30
34E0:  GOTO   6A9 (RETURN)
.................... }
.................... 
.................... #separate
.................... void check_and_erase_if_wrap(unsigned int32 start_addr, unsigned int32 end_addr)
.................... {
....................     fprintf(PC, "Wrap triggered: Resetting data_write_addr to start\r\n");
*
2F9F:  MOVLW  F4
2FA0:  MOVLB  03
2FA1:  MOVWF  11
2FA2:  MOVLW  06
2FA3:  MOVWF  12
2FA4:  MOVLP  08
2FA5:  MOVLB  00
2FA6:  CALL   0CC
2FA7:  MOVLP  28
....................     for (unsigned int32 addr = start_addr; addr < end_addr; addr += SUBSECTOR_SIZE)
2FA8:  MOVLB  0C
2FA9:  MOVF   44,W
2FAA:  MOVWF  4C
2FAB:  MOVF   43,W
2FAC:  MOVWF  4B
2FAD:  MOVF   42,W
2FAE:  MOVWF  4A
2FAF:  MOVF   41,W
2FB0:  MOVWF  49
2FB1:  MOVF   4C,W
2FB2:  SUBWF  48,W
2FB3:  BTFSS  03.0
2FB4:  GOTO   7F2
2FB5:  BTFSS  03.2
2FB6:  GOTO   7C7
2FB7:  MOVF   4B,W
2FB8:  SUBWF  47,W
2FB9:  BTFSS  03.0
2FBA:  GOTO   7F2
2FBB:  BTFSS  03.2
2FBC:  GOTO   7C7
2FBD:  MOVF   4A,W
2FBE:  SUBWF  46,W
2FBF:  BTFSS  03.0
2FC0:  GOTO   7F2
2FC1:  BTFSS  03.2
2FC2:  GOTO   7C7
2FC3:  MOVF   45,W
2FC4:  SUBWF  49,W
2FC5:  BTFSC  03.0
2FC6:  GOTO   7F2
....................         subsector_4kByte_erase(smf, addr);
2FC7:  MOVLB  08
2FC8:  MOVF   61,W
2FC9:  MOVLB  0F
2FCA:  MOVWF  41
2FCB:  MOVLB  08
2FCC:  MOVF   60,W
2FCD:  MOVLB  0F
2FCE:  MOVWF  40
2FCF:  MOVLB  08
2FD0:  MOVF   5F,W
2FD1:  MOVLB  0F
2FD2:  MOVWF  3F
2FD3:  MOVLB  08
2FD4:  MOVF   5E,W
2FD5:  MOVLB  0F
2FD6:  MOVWF  3E
2FD7:  MOVLB  0C
2FD8:  MOVF   4C,W
2FD9:  MOVLB  0F
2FDA:  MOVWF  45
2FDB:  MOVLB  0C
2FDC:  MOVF   4B,W
2FDD:  MOVLB  0F
2FDE:  MOVWF  44
2FDF:  MOVLB  0C
2FE0:  MOVF   4A,W
2FE1:  MOVLB  0F
2FE2:  MOVWF  43
2FE3:  MOVLB  0C
2FE4:  MOVF   49,W
2FE5:  MOVLB  0F
2FE6:  MOVWF  42
2FE7:  MOVLP  10
2FE8:  MOVLB  00
2FE9:  CALL   23B
2FEA:  MOVLP  28
2FEB:  MOVLW  10
2FEC:  MOVLB  0C
2FED:  ADDWF  4A,F
2FEE:  MOVLW  00
2FEF:  ADDWFC 4B,F
2FF0:  ADDWFC 4C,F
2FF1:  GOTO   7B1
2FF2:  MOVLP  30
2FF3:  MOVLB  00
2FF4:  GOTO   71B (RETURN)
.................... }
.................... 
.................... #separate
.................... void erase_write_area(unsigned int32 start_addr, unsigned int32 size, unsigned int32 max_addr)
*
34E1:  MOVLB  0C
34E2:  CLRF   4D
34E3:  MOVF   42,W
34E4:  ANDLW  F0
34E5:  MOVWF  4E
34E6:  CLRF   4F
34E7:  CLRF   50
34E8:  MOVF   45,W
34E9:  ADDWF  41,W
34EA:  MOVWF  5C
34EB:  MOVF   46,W
34EC:  ADDWFC 42,W
34ED:  MOVWF  5D
34EE:  MOVF   47,W
34EF:  ADDWFC 43,W
34F0:  MOVWF  5E
34F1:  MOVF   48,W
34F2:  ADDWFC 44,W
34F3:  MOVWF  5F
34F4:  MOVLW  FF
34F5:  ADDWF  5C,F
34F6:  MOVLW  0F
34F7:  ADDWFC 5D,F
34F8:  MOVLW  00
34F9:  ADDWFC 5E,F
34FA:  ADDWFC 5F,F
34FB:  CLRF   51
34FC:  MOVF   5D,W
34FD:  ANDLW  F0
34FE:  MOVWF  52
34FF:  CLRF   53
3500:  CLRF   54
.................... {
....................     unsigned int32 erase_start = start_addr & ~0xFFF;
....................     unsigned int32 erase_end = (start_addr + size + 0xFFF) & ~0xFFF;
.................... 
....................     for (unsigned int32 addr = erase_start; addr < erase_end && addr < max_addr; addr += SUBSECTOR_SIZE)
3501:  MOVF   50,W
3502:  MOVWF  58
3503:  MOVF   4F,W
3504:  MOVWF  57
3505:  MOVF   4E,W
3506:  MOVWF  56
3507:  MOVF   4D,W
3508:  MOVWF  55
3509:  MOVF   58,W
350A:  SUBWF  54,W
350B:  BTFSS  03.0
350C:  GOTO   560
350D:  BTFSS  03.2
350E:  GOTO   51F
350F:  MOVF   57,W
3510:  SUBWF  53,W
3511:  BTFSS  03.0
3512:  GOTO   560
3513:  BTFSS  03.2
3514:  GOTO   51F
3515:  MOVF   56,W
3516:  SUBWF  52,W
3517:  BTFSS  03.0
3518:  GOTO   560
3519:  BTFSS  03.2
351A:  GOTO   51F
351B:  MOVF   51,W
351C:  SUBWF  55,W
351D:  BTFSC  03.0
351E:  GOTO   560
351F:  MOVF   58,W
3520:  SUBWF  4C,W
3521:  BTFSS  03.0
3522:  GOTO   560
3523:  BTFSS  03.2
3524:  GOTO   535
3525:  MOVF   57,W
3526:  SUBWF  4B,W
3527:  BTFSS  03.0
3528:  GOTO   560
3529:  BTFSS  03.2
352A:  GOTO   535
352B:  MOVF   56,W
352C:  SUBWF  4A,W
352D:  BTFSS  03.0
352E:  GOTO   560
352F:  BTFSS  03.2
3530:  GOTO   535
3531:  MOVF   49,W
3532:  SUBWF  55,W
3533:  BTFSC  03.0
3534:  GOTO   560
....................         subsector_4kByte_erase(smf, addr);
3535:  MOVLB  08
3536:  MOVF   61,W
3537:  MOVLB  0F
3538:  MOVWF  41
3539:  MOVLB  08
353A:  MOVF   60,W
353B:  MOVLB  0F
353C:  MOVWF  40
353D:  MOVLB  08
353E:  MOVF   5F,W
353F:  MOVLB  0F
3540:  MOVWF  3F
3541:  MOVLB  08
3542:  MOVF   5E,W
3543:  MOVLB  0F
3544:  MOVWF  3E
3545:  MOVLB  0C
3546:  MOVF   58,W
3547:  MOVLB  0F
3548:  MOVWF  45
3549:  MOVLB  0C
354A:  MOVF   57,W
354B:  MOVLB  0F
354C:  MOVWF  44
354D:  MOVLB  0C
354E:  MOVF   56,W
354F:  MOVLB  0F
3550:  MOVWF  43
3551:  MOVLB  0C
3552:  MOVF   55,W
3553:  MOVLB  0F
3554:  MOVWF  42
3555:  MOVLP  10
3556:  MOVLB  00
3557:  CALL   23B
3558:  MOVLP  30
3559:  MOVLW  10
355A:  MOVLB  0C
355B:  ADDWF  56,F
355C:  MOVLW  00
355D:  ADDWFC 57,F
355E:  ADDWFC 58,F
355F:  GOTO   509
3560:  MOVLP  30
3561:  MOVLB  00
3562:  GOTO   745 (RETURN)
.................... }
.................... 
.................... #separate
.................... void write_mission_data(unsigned int32 src, unsigned int32 size, unsigned int32 dst,
....................                         int8* buffer, unsigned int32* used_size)
3563:  MOVLB  0C
3564:  MOVF   48,W
3565:  MOVWF  54
3566:  MOVF   47,W
3567:  MOVWF  53
3568:  MOVF   46,W
3569:  MOVWF  52
356A:  MOVF   45,W
356B:  MOVWF  51
356C:  MOVF   44,W
356D:  MOVWF  58
356E:  MOVF   43,W
356F:  MOVWF  57
3570:  MOVF   42,W
3571:  MOVWF  56
3572:  MOVF   41,W
3573:  MOVWF  55
3574:  MOVF   4C,W
3575:  MOVWF  5C
3576:  MOVF   4B,W
3577:  MOVWF  5B
3578:  MOVF   4A,W
3579:  MOVWF  5A
357A:  MOVF   49,W
357B:  MOVWF  59
.................... {
....................     unsigned int32 remaining = size;
....................     unsigned int32 src_addr = src;
....................     unsigned int32 data_write_addr = dst;
.................... 
....................     while (remaining > 0)
357C:  MOVF   51,F
357D:  BTFSS  03.2
357E:  GOTO   588
357F:  MOVF   52,F
3580:  BTFSS  03.2
3581:  GOTO   588
3582:  MOVF   53,F
3583:  BTFSS  03.2
3584:  GOTO   588
3585:  MOVF   54,F
3586:  BTFSC  03.2
3587:  GOTO   63A
....................     {
....................         unsigned int16 chunk = (remaining > MAX_READ_SIZE) ? MAX_READ_SIZE : remaining;
3588:  MOVF   54,F
3589:  BTFSS  03.2
358A:  GOTO   595
358B:  MOVF   53,F
358C:  BTFSS  03.2
358D:  GOTO   595
358E:  MOVF   52,F
358F:  BTFSS  03.2
3590:  GOTO   595
3591:  MOVF   51,W
3592:  SUBLW  40
3593:  BTFSC  03.0
3594:  GOTO   598
3595:  CLRF   7A
3596:  MOVLW  40
3597:  GOTO   59B
3598:  MOVF   52,W
3599:  MOVWF  7A
359A:  MOVF   51,W
359B:  MOVWF  5D
359C:  MOVF   7A,W
359D:  MOVWF  5E
.................... 
....................         read_data_bytes(mis_fm, src_addr, buffer, chunk);
359E:  MOVLB  08
359F:  MOVF   5D,W
35A0:  MOVLB  0E
35A1:  MOVWF  42
35A2:  MOVLB  08
35A3:  MOVF   5C,W
35A4:  MOVLB  0E
35A5:  MOVWF  41
35A6:  MOVLB  08
35A7:  MOVF   5B,W
35A8:  MOVLB  0E
35A9:  MOVWF  40
35AA:  MOVLB  08
35AB:  MOVF   5A,W
35AC:  MOVLB  0E
35AD:  MOVWF  3F
35AE:  MOVLB  0C
35AF:  MOVF   58,W
35B0:  MOVLB  0E
35B1:  MOVWF  46
35B2:  MOVLB  0C
35B3:  MOVF   57,W
35B4:  MOVLB  0E
35B5:  MOVWF  45
35B6:  MOVLB  0C
35B7:  MOVF   56,W
35B8:  MOVLB  0E
35B9:  MOVWF  44
35BA:  MOVLB  0C
35BB:  MOVF   55,W
35BC:  MOVLB  0E
35BD:  MOVWF  43
35BE:  MOVLB  0C
35BF:  MOVF   4E,W
35C0:  MOVLB  0E
35C1:  MOVWF  48
35C2:  MOVLB  0C
35C3:  MOVF   4D,W
35C4:  MOVLB  0E
35C5:  MOVWF  47
35C6:  CLRF   4C
35C7:  CLRF   4B
35C8:  MOVLB  0C
35C9:  MOVF   5E,W
35CA:  MOVLB  0E
35CB:  MOVWF  4A
35CC:  MOVLB  0C
35CD:  MOVF   5D,W
35CE:  MOVLB  0E
35CF:  MOVWF  49
35D0:  MOVLP  08
35D1:  MOVLB  00
35D2:  CALL   321
35D3:  MOVLP  30
....................         write_data_bytes(smf, data_write_addr, buffer, chunk);
35D4:  MOVLB  08
35D5:  MOVF   61,W
35D6:  MOVLB  0F
35D7:  MOVWF  41
35D8:  MOVLB  08
35D9:  MOVF   60,W
35DA:  MOVLB  0F
35DB:  MOVWF  40
35DC:  MOVLB  08
35DD:  MOVF   5F,W
35DE:  MOVLB  0F
35DF:  MOVWF  3F
35E0:  MOVLB  08
35E1:  MOVF   5E,W
35E2:  MOVLB  0F
35E3:  MOVWF  3E
35E4:  MOVLB  0C
35E5:  MOVF   5C,W
35E6:  MOVLB  0F
35E7:  MOVWF  45
35E8:  MOVLB  0C
35E9:  MOVF   5B,W
35EA:  MOVLB  0F
35EB:  MOVWF  44
35EC:  MOVLB  0C
35ED:  MOVF   5A,W
35EE:  MOVLB  0F
35EF:  MOVWF  43
35F0:  MOVLB  0C
35F1:  MOVF   59,W
35F2:  MOVLB  0F
35F3:  MOVWF  42
35F4:  MOVLB  0C
35F5:  MOVF   4E,W
35F6:  MOVLB  0F
35F7:  MOVWF  47
35F8:  MOVLB  0C
35F9:  MOVF   4D,W
35FA:  MOVLB  0F
35FB:  MOVWF  46
35FC:  MOVLB  0C
35FD:  MOVF   5E,W
35FE:  MOVLB  0F
35FF:  MOVWF  49
3600:  MOVLB  0C
3601:  MOVF   5D,W
3602:  MOVLB  0F
3603:  MOVWF  48
3604:  MOVLP  10
3605:  MOVLB  00
3606:  CALL   0A5
3607:  MOVLP  30
.................... 
....................         src_addr += chunk;
3608:  MOVLB  0C
3609:  MOVF   5D,W
360A:  ADDWF  55,F
360B:  MOVF   5E,W
360C:  ADDWFC 56,F
360D:  MOVLW  00
360E:  ADDWFC 57,F
360F:  ADDWFC 58,F
....................         data_write_addr += chunk;
3610:  MOVF   5D,W
3611:  ADDWF  59,F
3612:  MOVF   5E,W
3613:  ADDWFC 5A,F
3614:  MOVLW  00
3615:  ADDWFC 5B,F
3616:  ADDWFC 5C,F
....................         *used_size += chunk;
3617:  MOVF   4F,W
3618:  MOVWF  04
3619:  MOVF   50,W
361A:  MOVWF  05
361B:  MOVF   5D,W
361C:  ADDWF  00,W
361D:  MOVWF  77
361E:  ADDFSR 01,FSR0
361F:  MOVF   5E,W
3620:  ADDWFC 00,W
3621:  MOVWF  78
3622:  ADDFSR 01,FSR0
3623:  MOVLW  00
3624:  ADDWFC 00,W
3625:  MOVWF  79
3626:  ADDFSR 01,FSR0
3627:  MOVLW  00
3628:  ADDWFC 00,W
3629:  MOVWF  7A
362A:  MOVF   77,W
362B:  MOVWI  W,[FSR0-03]
362C:  MOVF   78,W
362D:  MOVWI  W,[FSR0-02]
362E:  MOVF   79,W
362F:  MOVWI  W,[FSR0-01]
3630:  MOVF   7A,W
3631:  MOVWI  W,[FSR0+00]
....................         remaining -= chunk;
3632:  MOVF   5D,W
3633:  SUBWF  51,F
3634:  MOVF   5E,W
3635:  SUBWFC 52,F
3636:  MOVLW  00
3637:  SUBWFC 53,F
3638:  SUBWFC 54,F
3639:  GOTO   57C
....................     }
363A:  MOVLP  30
363B:  MOVLB  00
363C:  GOTO   768 (RETURN)
.................... }
.................... 
.................... #separate
.................... void update_size_area(unsigned int32 base_addr, unsigned int32 used_size, unsigned int8 loop_count)
.................... {
....................     fprintf(PC, "Update size area\r\n");
*
39DB:  MOVLW  0F
39DC:  MOVLB  03
39DD:  MOVWF  11
39DE:  MOVLW  07
39DF:  MOVWF  12
39E0:  MOVLP  08
39E1:  MOVLB  00
39E2:  CALL   0CC
39E3:  MOVLP  38
....................     subsector_4kByte_erase(smf, base_addr);
39E4:  MOVLB  08
39E5:  MOVF   61,W
39E6:  MOVLB  0F
39E7:  MOVWF  41
39E8:  MOVLB  08
39E9:  MOVF   60,W
39EA:  MOVLB  0F
39EB:  MOVWF  40
39EC:  MOVLB  08
39ED:  MOVF   5F,W
39EE:  MOVLB  0F
39EF:  MOVWF  3F
39F0:  MOVLB  08
39F1:  MOVF   5E,W
39F2:  MOVLB  0F
39F3:  MOVWF  3E
39F4:  MOVLB  0C
39F5:  MOVF   44,W
39F6:  MOVLB  0F
39F7:  MOVWF  45
39F8:  MOVLB  0C
39F9:  MOVF   43,W
39FA:  MOVLB  0F
39FB:  MOVWF  44
39FC:  MOVLB  0C
39FD:  MOVF   42,W
39FE:  MOVLB  0F
39FF:  MOVWF  43
3A00:  MOVLB  0C
3A01:  MOVF   41,W
3A02:  MOVLB  0F
3A03:  MOVWF  42
3A04:  MOVLP  10
3A05:  MOVLB  00
3A06:  CALL   23B
3A07:  MOVLP  38
.................... 
....................     write_data_byte(smf, base_addr + 0, (used_size >> 0)  & 0xFF);
3A08:  MOVLB  0C
3A09:  MOVF   48,W
3A0A:  MOVWF  50
3A0B:  MOVF   47,W
3A0C:  MOVWF  4F
3A0D:  MOVF   46,W
3A0E:  MOVWF  4E
3A0F:  MOVF   45,W
3A10:  MOVWF  4D
3A11:  CLRF   4E
3A12:  CLRF   4F
3A13:  CLRF   50
3A14:  MOVLB  08
3A15:  MOVF   61,W
3A16:  MOVLB  0C
3A17:  MOVWF  58
3A18:  MOVLB  08
3A19:  MOVF   60,W
3A1A:  MOVLB  0C
3A1B:  MOVWF  57
3A1C:  MOVLB  08
3A1D:  MOVF   5F,W
3A1E:  MOVLB  0C
3A1F:  MOVWF  56
3A20:  MOVLB  08
3A21:  MOVF   5E,W
3A22:  MOVLB  0C
3A23:  MOVWF  55
3A24:  MOVF   44,W
3A25:  MOVWF  5C
3A26:  MOVF   43,W
3A27:  MOVWF  5B
3A28:  MOVF   42,W
3A29:  MOVWF  5A
3A2A:  MOVF   41,W
3A2B:  MOVWF  59
3A2C:  MOVF   45,W
3A2D:  MOVWF  5D
3A2E:  MOVLB  00
3A2F:  CALL   000
....................     write_data_byte(smf, base_addr + 1, (used_size >> 8)  & 0xFF);
3A30:  MOVLW  01
3A31:  MOVLB  0C
3A32:  ADDWF  41,W
3A33:  MOVWF  4C
3A34:  MOVLW  00
3A35:  ADDWFC 42,W
3A36:  MOVWF  4D
3A37:  MOVLW  00
3A38:  ADDWFC 43,W
3A39:  MOVWF  4E
3A3A:  MOVLW  00
3A3B:  ADDWFC 44,W
3A3C:  MOVWF  4F
3A3D:  MOVF   46,W
3A3E:  MOVWF  51
3A3F:  MOVF   47,W
3A40:  MOVWF  52
3A41:  MOVF   48,W
3A42:  MOVWF  53
3A43:  CLRF   54
3A44:  CLRF   52
3A45:  CLRF   53
3A46:  CLRF   54
3A47:  MOVLB  08
3A48:  MOVF   61,W
3A49:  MOVLB  0C
3A4A:  MOVWF  58
3A4B:  MOVLB  08
3A4C:  MOVF   60,W
3A4D:  MOVLB  0C
3A4E:  MOVWF  57
3A4F:  MOVLB  08
3A50:  MOVF   5F,W
3A51:  MOVLB  0C
3A52:  MOVWF  56
3A53:  MOVLB  08
3A54:  MOVF   5E,W
3A55:  MOVLB  0C
3A56:  MOVWF  55
3A57:  MOVF   4F,W
3A58:  MOVWF  5C
3A59:  MOVF   4E,W
3A5A:  MOVWF  5B
3A5B:  MOVF   4D,W
3A5C:  MOVWF  5A
3A5D:  MOVF   4C,W
3A5E:  MOVWF  59
3A5F:  MOVF   46,W
3A60:  MOVWF  5D
3A61:  MOVLB  00
3A62:  CALL   000
....................     write_data_byte(smf, base_addr + 2, (used_size >> 16) & 0xFF);
3A63:  MOVLW  02
3A64:  MOVLB  0C
3A65:  ADDWF  41,W
3A66:  MOVWF  4C
3A67:  MOVLW  00
3A68:  ADDWFC 42,W
3A69:  MOVWF  4D
3A6A:  MOVLW  00
3A6B:  ADDWFC 43,W
3A6C:  MOVWF  4E
3A6D:  MOVLW  00
3A6E:  ADDWFC 44,W
3A6F:  MOVWF  4F
3A70:  MOVF   47,W
3A71:  MOVWF  51
3A72:  MOVF   48,W
3A73:  MOVWF  52
3A74:  CLRF   53
3A75:  CLRF   54
3A76:  CLRF   52
3A77:  CLRF   53
3A78:  CLRF   54
3A79:  MOVLB  08
3A7A:  MOVF   61,W
3A7B:  MOVLB  0C
3A7C:  MOVWF  58
3A7D:  MOVLB  08
3A7E:  MOVF   60,W
3A7F:  MOVLB  0C
3A80:  MOVWF  57
3A81:  MOVLB  08
3A82:  MOVF   5F,W
3A83:  MOVLB  0C
3A84:  MOVWF  56
3A85:  MOVLB  08
3A86:  MOVF   5E,W
3A87:  MOVLB  0C
3A88:  MOVWF  55
3A89:  MOVF   4F,W
3A8A:  MOVWF  5C
3A8B:  MOVF   4E,W
3A8C:  MOVWF  5B
3A8D:  MOVF   4D,W
3A8E:  MOVWF  5A
3A8F:  MOVF   4C,W
3A90:  MOVWF  59
3A91:  MOVF   47,W
3A92:  MOVWF  5D
3A93:  MOVLB  00
3A94:  CALL   000
....................     write_data_byte(smf, base_addr + 3, (used_size >> 24) & 0xFF);
3A95:  MOVLW  03
3A96:  MOVLB  0C
3A97:  ADDWF  41,W
3A98:  MOVWF  4C
3A99:  MOVLW  00
3A9A:  ADDWFC 42,W
3A9B:  MOVWF  4D
3A9C:  MOVLW  00
3A9D:  ADDWFC 43,W
3A9E:  MOVWF  4E
3A9F:  MOVLW  00
3AA0:  ADDWFC 44,W
3AA1:  MOVWF  4F
3AA2:  MOVF   48,W
3AA3:  MOVWF  51
3AA4:  CLRF   52
3AA5:  CLRF   53
3AA6:  CLRF   54
3AA7:  CLRF   52
3AA8:  CLRF   53
3AA9:  CLRF   54
3AAA:  MOVLB  08
3AAB:  MOVF   61,W
3AAC:  MOVLB  0C
3AAD:  MOVWF  58
3AAE:  MOVLB  08
3AAF:  MOVF   60,W
3AB0:  MOVLB  0C
3AB1:  MOVWF  57
3AB2:  MOVLB  08
3AB3:  MOVF   5F,W
3AB4:  MOVLB  0C
3AB5:  MOVWF  56
3AB6:  MOVLB  08
3AB7:  MOVF   5E,W
3AB8:  MOVLB  0C
3AB9:  MOVWF  55
3ABA:  MOVF   4F,W
3ABB:  MOVWF  5C
3ABC:  MOVF   4E,W
3ABD:  MOVWF  5B
3ABE:  MOVF   4D,W
3ABF:  MOVWF  5A
3AC0:  MOVF   4C,W
3AC1:  MOVWF  59
3AC2:  MOVF   48,W
3AC3:  MOVWF  5D
3AC4:  MOVLB  00
3AC5:  CALL   000
....................     write_data_byte(smf, base_addr + 4, loop_count);
3AC6:  MOVLW  04
3AC7:  MOVLB  0C
3AC8:  ADDWF  41,W
3AC9:  MOVWF  4C
3ACA:  MOVLW  00
3ACB:  ADDWFC 42,W
3ACC:  MOVWF  4D
3ACD:  MOVLW  00
3ACE:  ADDWFC 43,W
3ACF:  MOVWF  4E
3AD0:  MOVLW  00
3AD1:  ADDWFC 44,W
3AD2:  MOVWF  4F
3AD3:  MOVLB  08
3AD4:  MOVF   61,W
3AD5:  MOVLB  0C
3AD6:  MOVWF  58
3AD7:  MOVLB  08
3AD8:  MOVF   60,W
3AD9:  MOVLB  0C
3ADA:  MOVWF  57
3ADB:  MOVLB  08
3ADC:  MOVF   5F,W
3ADD:  MOVLB  0C
3ADE:  MOVWF  56
3ADF:  MOVLB  08
3AE0:  MOVF   5E,W
3AE1:  MOVLB  0C
3AE2:  MOVWF  55
3AE3:  MOVF   4F,W
3AE4:  MOVWF  5C
3AE5:  MOVF   4E,W
3AE6:  MOVWF  5B
3AE7:  MOVF   4D,W
3AE8:  MOVWF  5A
3AE9:  MOVF   4C,W
3AEA:  MOVWF  59
3AEB:  MOVF   49,W
3AEC:  MOVWF  5D
3AED:  MOVLB  00
3AEE:  CALL   000
.................... 
....................     fprintf(PC, "used_size = %ld\r\n", used_size);
3AEF:  MOVLW  19
3AF0:  MOVLB  03
3AF1:  MOVWF  11
3AF2:  MOVLW  07
3AF3:  MOVWF  12
3AF4:  BCF    03.0
3AF5:  MOVLW  0C
3AF6:  MOVLB  0C
3AF7:  MOVWF  5E
3AF8:  MOVLP  08
3AF9:  MOVLB  00
3AFA:  CALL   416
3AFB:  MOVLP  38
3AFC:  MOVLW  41
3AFD:  MOVWF  04
3AFE:  MOVLB  0C
3AFF:  MOVF   48,W
3B00:  MOVWF  4F
3B01:  MOVF   47,W
3B02:  MOVWF  4E
3B03:  MOVF   46,W
3B04:  MOVWF  4D
3B05:  MOVF   45,W
3B06:  MOVWF  4C
*
3BB6:  MOVLW  0D
3BB7:  MOVLB  0F
3BB8:  MOVWF  43
3BB9:  MOVLP  08
3BBA:  MOVLB  00
3BBB:  CALL   0A7
3BBC:  MOVLP  38
3BBD:  MOVLW  0A
3BBE:  MOVLB  0F
3BBF:  MOVWF  43
3BC0:  MOVLP  08
3BC1:  MOVLB  00
3BC2:  CALL   0A7
3BC3:  MOVLP  38
....................     fprintf(PC, "loop_count = %u\r\n\r\n", loop_count);
3BC4:  MOVLW  22
3BC5:  MOVLB  03
3BC6:  MOVWF  11
3BC7:  MOVLW  07
3BC8:  MOVWF  12
3BC9:  BCF    03.0
3BCA:  MOVLW  0D
3BCB:  MOVLB  0C
3BCC:  MOVWF  5E
3BCD:  MOVLP  08
3BCE:  MOVLB  00
3BCF:  CALL   416
3BD0:  MOVLP  38
3BD1:  MOVLB  0C
3BD2:  MOVF   49,W
3BD3:  MOVWF  4C
3BD4:  MOVLW  1B
3BD5:  MOVWF  4D
3BD6:  MOVLP  10
3BD7:  MOVLB  00
3BD8:  CALL   705
3BD9:  MOVLP  38
3BDA:  MOVLW  29
3BDB:  MOVLB  03
3BDC:  MOVWF  11
3BDD:  MOVLW  07
3BDE:  MOVWF  12
3BDF:  BSF    03.0
3BE0:  MOVLW  04
3BE1:  MOVLB  0C
3BE2:  MOVWF  5E
3BE3:  MOVLP  08
3BE4:  MOVLB  00
3BE5:  CALL   416
3BE6:  MOVLP  38
3BE7:  MOVLP  30
3BE8:  GOTO   787 (RETURN)
.................... }
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... /*
.................... void copy_data()
.................... {
....................     fprintf(PC, "\r\n____________________\r\n");
....................     fprintf(PC, "___Start copy_data__\r\n");
.................... 
....................     int8 buffer[MAX_READ_SIZE];
.................... 
....................     for (int8 i = 0; !is_empty_smf_data(); i++)
....................     {
....................         fprintf(PC, "Start [%d th] data copy\r\n\r\n", i);
....................         
....................         // value initialize
....................         smfDataStruct *smf_data = dequeue_smf_data();
....................         MissionTypeStruct mission_type = getMissionTypeStruct(smf_data->mission_type);
....................         status[i+1] = mission_type.mission_flag; // `i` is assigned mis mcu status flag. so mission_flag start `i+1`
....................         unsigned int32 mis_start_address = mission_type.start_address;
....................         unsigned int32 mis_end_address = mission_type.end_address;
....................         unsigned int32 write_src = smf_data->src;
....................         unsigned int32 write_size = smf_data->size;
....................         fprintf(PC, "In smf mission data start   address: %LX\r\n", mis_start_address);
....................         fprintf(PC, "In smf mission data end     address: %LX\r\n", mis_end_address);
....................         fprintf(PC, "In MIS FM Write source data address: %LX\r\n", write_src);
....................         fprintf(PC, "In MIS FM Write data size          : %lu (0x%lx)\r\n\r\n", write_size, write_size);
....................       
....................       
....................         // flash setting
....................         //flash_setting(mis_fm);
....................         //flash_setting(smf);
.................... 
.................... 
....................         // read size area
....................         uint8_t used_size_bytes[4];
....................         read_data_bytes(smf, mis_start_address, used_size_bytes, 4);
....................         unsigned int32 used_size = 
....................            ((unsigned int32)used_size_bytes[3] << 24) |
....................            ((unsigned int32)used_size_bytes[2] << 16) |
....................            ((unsigned int32)used_size_bytes[1] << 8)  |
....................            ((unsigned int32)used_size_bytes[0]);
....................         int8 loop_count = read_data_byte(smf, mis_start_address + 4);
....................         fprintf(PC, "Size area read\r\n");
....................         fprintf(PC, "used_size = %lu (src 0x%08LX)\r\n", used_size, mis_start_address);
....................         fprintf(PC, "loop count= %d  (src 0x%08LX)\r\n\r\n", loop_count, mis_start_address + 4);
....................         
.................... 
....................         // Calculate data write address and check for wrap-around
....................         unsigned int32 data_region_start = mis_start_address + SUBSECTOR_SIZE;
....................         unsigned int32 data_region_end = mis_end_address;
....................         unsigned int32 data_region_size = data_region_end - data_region_start;
....................         unsigned int32 data_write_addr = data_region_start + used_size;
.................... 
.................... 
....................         // Delete the first part in advance in case of looping
....................         if ((used_size + write_size) > data_region_size)
....................         {
....................             fprintf(PC, "Wrap triggered: Resetting data_write_addr to start\r\n");
....................             loop_count++;
....................             used_size = 0;
....................             data_write_addr = data_region_start;
....................             unsigned int32 erase_ptr = data_region_start;
....................             while (erase_ptr < data_region_end)
....................             {
....................                 subsector_4kByte_erase(smf, erase_ptr);
....................                 erase_ptr += SUBSECTOR_SIZE;     // tips: `value += 0x1000` means add up 4KB (0x1000 = 0d4096)
....................             }
....................         }
.................... 
.................... 
....................         // Erase the space you will be writing in now
....................         unsigned int32 erase_start = data_write_addr & ~0xFFF;       // tips: `value & ~0xFFF` means alignment 4KB.
....................         unsigned int32 erase_end = (data_write_addr + write_size + 0xFFF) & ~0xFFF;
....................         for (unsigned int32 addr = erase_start; addr < erase_end && addr < mis_end_address; addr += SUBSECTOR_SIZE)
....................             subsector_4kByte_erase(smf, addr);
.................... 
....................         unsigned int32 remaining = write_size;
....................         unsigned int32 src_addr = write_src;
....................         while (remaining > 0)
....................         {
....................             unsigned int16 chunk = (remaining > MAX_READ_SIZE) ? MAX_READ_SIZE : remaining; //  = max(MAX_READ_SIZE, rest write_size)
.................... 
....................             read_data_bytes(mis_fm, src_addr, buffer, chunk);
....................             write_data_bytes(smf, data_write_addr, buffer, chunk);
.................... 
....................             src_addr += chunk;
....................             data_write_addr += chunk;
....................             used_size += chunk;
....................             remaining -= chunk;
....................         }
.................... 
.................... 
....................        // write size area
....................         fprintf(PC, "Update size area\r\n");
....................         subsector_4kByte_erase(smf, mis_start_address);
....................         write_data_byte(smf, mis_start_address + 0, (used_size >> 0)  & 0xFF);
....................         write_data_byte(smf, mis_start_address + 1, (used_size >> 8)  & 0xFF);
....................         write_data_byte(smf, mis_start_address + 2, (used_size >> 16) & 0xFF);
....................         write_data_byte(smf, mis_start_address + 3, (used_size >> 24) & 0xFF);
....................         write_data_byte(smf, mis_start_address + 4, loop_count);
....................         fprintf(PC, "used_size = %ld\r\n", used_size);
....................         fprintf(PC, "loop_count = %u\r\n\r\n", loop_count);
....................     }
.................... 
....................     fprintf(PC, "\r\n___End copy_data____\r\n");
....................     fprintf(PC, "____________________\r\n\r\n");
.................... }
.................... */
.................... 
.................... 
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... 
.................... #include "mmj_cigs_excute_mission.h"
.................... #ifndef MMJ_CIGS_EXCUTE_MISSION_H
.................... #define MMJ_CIGS_EXCUTE_MISSION_H
.................... 
.................... // _________ values _________
.................... //#define PARAMETER_LENGTH 8
.................... 
.................... #Separate
.................... int1 execute_command(Command *command);
.................... #Separate
.................... void handle_uplink_command(Command *command);
.................... #Separate
.................... int1 handle_status_check(Command *command);
.................... #Separate
.................... void handle_smf_available(Command *command);
.................... 
.................... 
.................... #separate
.................... void execute_mission(unsigned int8 *content);
.................... 
.................... unsigned int8 duration_sec = 30; // duration sec for mission
.................... 
.................... #include "src/mmj_cigs_excute_mission.c"
.................... #include "../mmj_cigs_excute_mission.h"
.................... #ifndef MMJ_CIGS_EXCUTE_MISSION_H
.................... #define MMJ_CIGS_EXCUTE_MISSION_H
.................... 
.................... // _________ values _________
.................... //#define PARAMETER_LENGTH 8
.................... 
.................... #Separate
.................... int1 execute_command(Command *command);
.................... #Separate
.................... void handle_uplink_command(Command *command);
.................... #Separate
.................... int1 handle_status_check(Command *command);
.................... #Separate
.................... void handle_smf_available(Command *command);
.................... 
.................... 
.................... #separate
.................... void execute_mission(unsigned int8 *content);
.................... 
.................... unsigned int8 duration_sec = 30; // duration sec for mission
.................... 
.................... #include "src/mmj_cigs_excute_mission.c"
.................... 
.................... #endif
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_mode.h"
.................... #ifndef MMJ_CIGS_MODE_H
.................... #define MMJ_CIGS_MODE_H
.................... 
.................... #define PARAMETER_LENGTH 9
.................... 
.................... // ___________MODE FUNCTIONS____________
.................... 
.................... #Separate
.................... void mode_dummy(unsigned int8 uplinkcmd[]);
.................... typedef struct {
....................     unsigned int8 id;
....................     unsigned int32 param1;
....................     unsigned int16 param2;
.................... } DUMMY_CMD;
.................... 
.................... // Flash command 
.................... #Separate
.................... void mode_flash_erase_all(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_erase_1sector(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_erase_4kbyte_subsector(unsigned int8 parameter[]);
.................... 
.................... #separate
.................... void mode_flash_write_demo(unsigned int8 parameter[]);
.................... typedef struct {
....................     unsigned int8 id;
....................     unsigned int32 writeaddress;
....................     unsigned int16 packetnum;
.................... } FLASH_WRITE_PARAM;
.................... 
.................... #Separate
.................... void mode_flash_write_4kbyte_subsecotr(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_read(unsigned int8 parameter[]);
.................... 
.................... typedef struct{
....................     unsigned int8 id;
....................     unsigned int16 readpacketnum;
....................     unsigned int32 readaddress;
.................... }FLASH_PARAM;
.................... 
.................... #Separate
.................... void mode_flash_read_address(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_smf_copy(unsigned int8 parameter[]);
.................... #Separate
.................... void mode_flash_address_reset(unsigned int8 parameter[]);
.................... 
.................... 
.................... // IV command
.................... #Separate
.................... void mode_iv_measure();
.................... #Separate
.................... void mode_iv_measure_voltage();
.................... #Separate
.................... void mode_iv_meas_adc();
.................... 
.................... 
.................... 
.................... // Development command
.................... #Separate
.................... void mode_dev_vol();
.................... #Separate
.................... void mode_dev_cur();
.................... #Separate
.................... void mode_dev_temp();   
.................... #Separate
.................... void mode_dev_pd();
.................... #Separate
.................... void mode_dev_cigs();
.................... #Separate
.................... void mode_dev_time();
.................... #Separate
.................... void mode_dev_sweep();
.................... 
.................... // ______________CMD ID________________
.................... #define ID_DUMMY 0x00
.................... #define ID_SWEEP 0x01
.................... 
.................... // Flash command 
.................... #define ID_FLASH_ERASE_ALL 0x90
.................... #define ID_FLASH_ERASE_1SECTOR 0x91
.................... #define ID_FLASH_ERASE_4kByte_SUBSECTOR 0x92
.................... #define ID_FALSH_WRITE_DEMO 0x93
.................... #define ID_FLASH_4kByte_SUBSECTOR 0x94
.................... #define ID_FLASH_READ 0x96
.................... #define ID_FLASH_READ_ADDRESS 0x97
.................... #define ID_FLASH_SMF_COPY 0x9A
.................... #define ID_FLASH_ADDRESS_RESET 0x9F
.................... // IV command
.................... #define ID_IV_MEASURE 0xB0
.................... #define ID_IV_MEASURE_VOLTAGE 0xB1
.................... 
.................... // Development command
.................... #define ID_DEV_VOL 0xC0
.................... #define ID_DEV_CUR 0xC1
.................... #define ID_DEV_TEMP 0xC1
.................... #define ID_DEV_PD 0xC2
.................... #define ID_DEV_CIGS 0xC3
.................... #define ID_DEV_TIME 0xC4
.................... #define ID_DEV_SWEEP 0xC5
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_mode.c"
.................... 
.................... #endif // MMJ_CIGS_MODE_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... #include "../mmj_cigs_config.h"
.................... #ifndef MMJ_CIGS_CONFIG_H
.................... #define MMJ_CIGS_CONFIG_H
.................... 
.................... #include <16F1789.h>
.................... 
.................... //#opt 0 // 0 = no optimization, 1 = optimize for speed, 2 = optimize for size
.................... 
.................... //#device ADC=12
.................... #use delay(crystal=16MHz)
.................... #fuses NOMCLR
.................... 
.................... 
.................... 
.................... //#define SELF_DEVICE_ID CIGS_PIC
.................... 
.................... 
.................... //-------------Serial--------------------
.................... #use rs232(baud=9600,parity=N,xmit=PIN_C6,rcv=PIN_C7,bits=8,stream=BOSS)
.................... #use rs232(baud=9600,parity=N,xmit=PIN_B4,bits=8,stream=PC,FORCE_SW)
.................... 
.................... 
.................... // -------------SPI--------------------
.................... // MOSI:PIN_C5, MISO:PIN_C4, SCK:PIN_C3
.................... // Shared Mission Flash
.................... #define MIS_FM_CS  PIN_D3
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS= 8, STREAM = MIS_FM_STREAM)
.................... 
.................... // Mission Flash
.................... #define SMF_CS PIN_D1
.................... #use spi(MASTER, SPI1, BAUD = 400000, MODE = 0, BITS = 8, STREAM = SMF_STREAM)
.................... 
.................... // Analog to Digital Converter 
.................... #define ADC_CS PIN_D2
.................... //#use spi(MASTER, SPI1, BAUD = 9600, MODE=2, BITS = 16, STREAM = ADC_STREAM)
.................... #use spi(MASTER, CLK = PIN_C3, DI = PIN_C4, DO = PIN_C5,ENABLE = PIN_D2, BAUD = 9600, BITS = 16, STREAM = ADC_STREAM, MODE = 2 )
.................... 
.................... 
.................... 
.................... /* DEMO
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A0, MODE=0, BITS=8, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A1, MODE=0, BITS=8, ENABLE_ACTIVE=1, STREAM=MISF)
.................... #use spi (MASTER, SPI1, ENABLE=PIN_A3, BAUD=40000, MODE=2, BITS=16, ENABLE_ACTIVE=1, STREAM=ADC)
.................... #use spi (MASTER, MODE=0, BITS=8, STREAM=SPI_4)
.................... */
.................... 
.................... 
.................... //-------------I/O port--------------------
.................... 
.................... // AI/O___ADC
.................... #define TEMP_TOP PIN_B0
.................... #define TEMP_BOT PIN_A3
.................... #define CIGS_VOLT PIN_A0 //PIN_A0
.................... #define CIGS_CURR PIN_A1
.................... #define PD PIN_E0
.................... #define VREF PIN_A4
.................... 
.................... // AI/O___DAC
.................... #define LOAD PIN_A5
.................... 
.................... // DI/O___
.................... #define CONNECT_CIGS PIN_E0
.................... #define EN_NPWR PIN_A4
.................... #define EN_MEAS_VOL PIN_A5
.................... 
.................... 
.................... // ADC Settings
.................... #define ADC_CIGS_VOLT   AD7490_VIN0
.................... #define ADC_CIGS_CURR   AD7490_VIN1
.................... #define ADC_PD          AD7490_VIN2
.................... #define ADC_TEMP_TOP    AD7490_VIN3
.................... #define ADC_TEMP_BOT    AD7490_VIN4
.................... 
.................... // Flasj Settings
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #endif // MMJ_CIGS_CONFIG_H
.................... 
.................... //------------------End of File------------------
.................... 
.................... #include "../../lib/typedef_content.h"
.................... #ifndef TYPEDEF_CONTENT_H
.................... #define TYPEDEF_CONTENT_H
.................... 
.................... // there is used in main.c
.................... 
.................... typedef enum {
....................     EXECUTING_MISSION = 0x02,
....................     IDLE              = 0x03,
....................     SMF_USE_REQ       = 0x04,
....................     COPYING           = 0x05,
....................     FINISHED          = 0x06
.................... } MisMcuStatusContent;
.................... 
.................... 
.................... typedef enum {
....................     ALLOW = 0x00,
....................     DENY  = 0x01
.................... } IsSmfAvailableContent;
.................... 
.................... 
.................... #endif
.................... 
.................... 
.................... #include "../../lib/smf_queue.h"
.................... #ifndef SMF_QUEUE_H
.................... #define SMF_QUEUE_H
.................... 
.................... 
.................... 
.................... typedef enum {
....................    APRS_DATA,  // <- assign your missoins
....................    IN_VEHICLE, 
....................    ECOSYSTEM_DATA, 
....................    APRS_PIC_LOG
.................... } MissionType;
.................... 
.................... typedef struct {
....................    unsigned int32 start_address;
....................    unsigned int32 end_address;
....................    int8 mission_flag;
.................... } MissionTypeStruct;
.................... 
.................... typedef struct {
....................     MissionType   mission_type;
....................     unsigned int32 src;
....................     unsigned int32 size;
.................... } SmfDataStruct;
.................... 
.................... #define SMF_DATA_SIZE 16
.................... typedef struct {
....................    SmfDataStruct smf_data[SMF_DATA_SIZE];
....................    int8 smf_data_head;
....................    int8 smf_data_tail;
.................... } SmfQueueStruct;
.................... 
.................... // _____________________ values _________________
.................... 
.................... volatile SmfQueueStruct smf_queue = {0};
.................... 
.................... 
.................... // ___________________ functions ________________
.................... 
.................... #separate
.................... void enqueue_smf_data(SmfDataStruct *data);
.................... #separate
.................... SmfDataStruct *dequeue_smf_data();
.................... #separate
.................... int1 is_empty_smf_data(void);
.................... #separate
.................... MissionTypeStruct getMissionTypeStruct(MissionType mis_type);
.................... 
.................... #include "./src/smf_queue.c"
.................... 
.................... #endif
.................... 
.................... 
.................... #include "../../lib/mt25q.h"
.................... #ifndef MT25Q_H
.................... #define MT25Q_H
.................... 
.................... // =========
.................... //#define MT25Q_DEBUG
.................... // =========
.................... 
.................... 
.................... #define FLASH_STREAM0 MIS_FM_STREAM     // <- Align the names to `config.h` Stream name
.................... #define FLASH_STREAM1 SMF_STREAM
.................... #define FLASH_STREAM2 SMF_STREAM // dont use
.................... #define FLASH_STREAM3 SMF_STREAM // dont use
.................... typedef enum spi_stream{
....................     SPI_0,
....................     SPI_1,
....................     SPI_2,
....................     SPI_3,
.................... }SpiStreamId;
.................... 
.................... #define MT25QL128ABA 0x00     //Mission Flash
.................... #define MT25QL01GBBB 0x01     //SMF,CF
.................... typedef struct select_stream_to_flash{
....................     SpiStreamId spi_stream_id;
....................     unsigned int8 flash_model;
....................     int16 cs_pin;
.................... }Flash;
.................... 
.................... 
.................... Flash mis_fm = {SPI_0, MT25QL128ABA, MIS_FM_CS};
.................... Flash smf = {SPI_1, MT25QL01GBBB, SMF_CS};
.................... 
.................... 
.................... 
.................... // ===================== Function List =====================
.................... // Public Functions
.................... #Separate
.................... int1 is_connect(Flash flash_stream);
.................... #Separate
.................... void write_data_bytes(Flash flash_stream, unsigned int32 write_start_address, int8 *write_data, unsigned int16 write_amount);      
.................... #Separate
.................... void read_data_bytes(Flash flash_stream, unsigned int32 read_start_address, int8 *read_data, unsigned int32 read_amount);  
.................... #Separate
.................... void sector_erase(Flash flash_stream, unsigned int32 sector_address);
.................... #Separate
.................... void subsector_32kByte_erase(Flash flash_stream, unsigned int32 subsector_address);  
.................... #Separate                               
.................... void subsector_4kByte_erase(Flash flash_stream, unsigned int32 subsector_address);      
.................... 
.................... //Private Functions
.................... #Separate 
.................... void flash_setting(Flash flash_stream);
.................... #Separate 
.................... int8 status_register(Flash flash_stream);
.................... #Separate 
.................... int8 read_id(Flash flash_stream);
.................... #Separate 
.................... int8 read_data_byte(Flash flash_stream, unsigned int32 read_address);                                               
.................... #Separate 
.................... void write_data_byte(Flash flash_stream, unsigned int32 write_address,int8 write_data);                             
....................         //
.................... 
.................... 
.................... // ===================== Flash Commands =====================
.................... #define CMD_READ_ID                     0x9F
.................... #define CMD_READ_STATUS_REGISTER        0x05
.................... #define CMD_READ                        0x03//for MT25QL128ABA
.................... #define CMD_4BYTE_READ                  0x13//for MT25QL01GBBB
.................... #define CMD_WRITE_ENABLE                0x06
.................... #define CMD_PAGE_PROGRAM                0x02//for MT25QL128ABA
.................... #define CMD_4BYTE_PAGE_PROGRAM          0x12//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_4KB_ERASE         0x20//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_4KB_ERASE   0x21//for MT25QL01GBBB
.................... #define CMD_SUBSECTOR_32KB_ERASE        0x52//for MT25QL128ABA
.................... #define CMD_4BYTE_SUBSECTOR_32KB_ERASE  0x5C//for MT25QL01GBBB
.................... #define CMD_SECTOR_ERASE                0xD8//for MT25QL128ABA
.................... #define CMD_4BYTE_SECTOR_ERASE          0xDC//for MT25QL01GBBB
.................... 
.................... // ====================== Value List =====================
.................... #define MANUFACTURER_ID_MICRON 0x20 // Manufacturer ID for Micron flash
.................... #define READ_ID_DATASIZE 4 // 20 bytes for read ID data
.................... 
.................... 
.................... // ====================== Data Structures =====================
.................... typedef union
.................... {
.................... unsigned int8 bytes[READ_ID_DATASIZE]; // 20 bytes for read ID
.................... struct {
....................     unsigned int8 manufacturer_id; // 1 byte
....................     unsigned int8 memory_type;     // 1 byte
....................     unsigned int8 capacity;        // 1 byte
....................     unsigned int8 reserved;    
.................... } fields;
.................... }READ_ID_DATA;
.................... 
.................... #include "./src/mt25q.c"
.................... 
.................... #endif
.................... 
.................... 
.................... 
.................... #include "../../lib/mission_tools.h"
.................... #ifndef MISSION_TOOLS_H
.................... #define MISSION_TOOLS_H
.................... 
.................... #include "communication_driver.h"
.................... 
.................... 
.................... // ________________ fuctions ____________
.................... 
.................... // Check and reply to messages received from BOSS PIC
.................... void check_and_respond_to_boss();
.................... 
.................... // Request using SMF to BOSS PIC
.................... // !!!After use, you must call `void finished_use_smf()`
.................... int1 req_use_smf();
.................... 
.................... // Call after using SMF
.................... void finished_use_smf();
.................... 
.................... //unsigned int8 calc_crc8(unsigned int8 frame[], int8 payload_size);
.................... 
.................... #include "./src/mission_tools.c"
.................... 
.................... #endif
.................... 
.................... 
.................... #include "../mmj_cigs_piclog.h"
.................... #ifndef     MMJ_CIGS_PICLOG_H
.................... #define     MMJ_CIGS_PICLOG_H
.................... 
.................... #define PICLOG_PACKET_SIZE 6
.................... unsigned int8 PICLOG_STARTUP = 0x00;
.................... 
.................... // PICLOG Parameter
.................... #define PICLOG_PARAM_START 0x01
.................... #define PICLOG_PARAM_END 0x02
.................... 
.................... 
.................... // PICLOG
.................... typedef union {
....................     struct {
....................         unsigned int32  time;
....................         unsigned int8   function;
....................         unsigned int8   parameter;
....................     };
....................     unsigned int8 bytes[PICLOG_PACKET_SIZE];  
.................... } PICLOG;
.................... 
.................... // extern.c
.................... #define PICLOG_BLANK_SIZE 4 // PICLOG
.................... unsigned int8 PICLOG_BLANK_DATA[PICLOG_BLANK_SIZE] = {0x00, 0x00, 0x00, 0x00}; // PICLOG
.................... void piclog_make(unsigned int8 function, unsigned int8 parameter);
.................... void piclog_write(unsigned int8 *data);
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_piclog.c"
.................... 
.................... #endif // MMJ_CIGS_PICLOG_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... #separate
.................... void execute_mission(unsigned int8 *content)
*
2D07:  MOVLB  0B
2D08:  MOVF   22,W
2D09:  MOVWF  04
2D0A:  MOVF   23,W
2D0B:  MOVWF  05
2D0C:  MOVIW  [FSR0+00],W
2D0D:  MOVWF  24
.................... {
....................    // record to executed mission list
....................    unsigned int8 command_id = content[0];
....................    //unsigned int8 *parameter = &content[1];
....................       
....................    // execution mission
....................    fprintf(PC, "\r\n______________________________\r\n_____Start execute_mission_____\r\n\r\n");
2D0E:  MOVLW  2C
2D0F:  MOVLB  03
2D10:  MOVWF  11
2D11:  MOVLW  07
2D12:  MOVWF  12
2D13:  MOVLP  08
2D14:  MOVLB  00
2D15:  CALL   0CC
2D16:  MOVLP  28
....................    fprintf(PC, "Command ID: %X\r\n\r\n", command_id);
2D17:  MOVLW  4F
2D18:  MOVLB  03
2D19:  MOVWF  11
2D1A:  MOVLW  07
2D1B:  MOVWF  12
2D1C:  BCF    03.0
2D1D:  MOVLW  0C
2D1E:  MOVLB  0C
2D1F:  MOVWF  5E
2D20:  MOVLP  08
2D21:  MOVLB  00
2D22:  CALL   416
2D23:  MOVLP  28
2D24:  MOVLB  0B
2D25:  MOVF   24,W
2D26:  MOVLB  0E
2D27:  MOVWF  4E
2D28:  MOVLW  37
2D29:  MOVWF  4F
2D2A:  MOVLP  08
2D2B:  MOVLB  00
2D2C:  CALL   470
2D2D:  MOVLP  28
2D2E:  MOVLW  56
2D2F:  MOVLB  03
2D30:  MOVWF  11
2D31:  MOVLW  07
2D32:  MOVWF  12
2D33:  BCF    03.0
2D34:  MOVLW  04
2D35:  MOVLB  0C
2D36:  MOVWF  5E
2D37:  MOVLP  08
2D38:  MOVLB  00
2D39:  CALL   416
2D3A:  MOVLP  28
....................    switch(command_id)
2D3B:  MOVLB  0B
2D3C:  MOVF   24,W
2D3D:  XORLW  00
2D3E:  MOVLB  00
2D3F:  BTFSC  03.2
2D40:  GOTO   572
2D41:  XORLW  10
2D42:  BTFSC  03.2
2D43:  GOTO   57C
2D44:  XORLW  11
2D45:  BTFSC  03.2
2D46:  GOTO   580
2D47:  XORLW  03
2D48:  BTFSC  03.2
2D49:  GOTO   581
2D4A:  XORLW  92
2D4B:  BTFSC  03.2
2D4C:  GOTO   582
2D4D:  XORLW  01
2D4E:  BTFSC  03.2
2D4F:  GOTO   58C
2D50:  XORLW  03
2D51:  BTFSC  03.2
2D52:  GOTO   596
2D53:  XORLW  01
2D54:  BTFSC  03.2
2D55:  GOTO   5A0
2D56:  XORLW  07
2D57:  BTFSC  03.2
2D58:  GOTO   5AA
2D59:  XORLW  02
2D5A:  BTFSC  03.2
2D5B:  GOTO   5B4
2D5C:  XORLW  01
2D5D:  BTFSC  03.2
2D5E:  GOTO   5BE
2D5F:  XORLW  0D
2D60:  BTFSC  03.2
2D61:  GOTO   5C8
2D62:  XORLW  05
2D63:  BTFSC  03.2
2D64:  GOTO   5D2
2D65:  XORLW  EE
2D66:  BTFSC  03.2
2D67:  GOTO   5DC
2D68:  XORLW  03
2D69:  BTFSC  03.2
2D6A:  GOTO   5DE
2D6B:  XORLW  01
2D6C:  BTFSC  03.2
2D6D:  GOTO   5E0
2D6E:  XORLW  03
2D6F:  BTFSC  03.2
2D70:  GOTO   5E2
2D71:  GOTO   5E4
....................    {
....................       case ID_DUMMY: // example command
....................          mode_dummy(content);
2D72:  MOVLB  0B
2D73:  MOVF   23,W
2D74:  MOVWF  26
2D75:  MOVF   22,W
2D76:  MOVWF  25
2D77:  MOVLP  18
2D78:  MOVLB  00
2D79:  GOTO   22A
2D7A:  MOVLP  28
....................          //mode_iv_meas_adc();
....................          break;
2D7B:  GOTO   5ED
....................       case 0x10:
....................          mode_test_iv();
2D7C:  MOVLP  18
2D7D:  GOTO   359
2D7E:  MOVLP  28
....................          break;
2D7F:  GOTO   5ED
....................       case 0x01:
....................          //example_01(parameter);
....................          break;
2D80:  GOTO   5ED
....................       case 0x02:
....................          //example_02(parameter);
....................          break;
2D81:  GOTO   5ED
....................       case ID_FLASH_ERASE_ALL:
....................          mode_flash_erase_all(content);
2D82:  MOVLB  0B
2D83:  MOVF   23,W
2D84:  MOVWF  26
2D85:  MOVF   22,W
2D86:  MOVWF  25
2D87:  MOVLP  10
2D88:  MOVLB  00
2D89:  GOTO   79D
2D8A:  MOVLP  28
....................          break;
2D8B:  GOTO   5ED
....................       case ID_FLASH_ERASE_1SECTOR:
....................          mode_flash_erase_1sector(content);
2D8C:  MOVLB  0B
2D8D:  MOVF   23,W
2D8E:  MOVWF  26
2D8F:  MOVF   22,W
2D90:  MOVWF  25
2D91:  MOVLP  18
2D92:  MOVLB  00
2D93:  GOTO   5B3
2D94:  MOVLP  28
....................          break;
2D95:  GOTO   5ED
....................       case ID_FLASH_ERASE_4kByte_SUBSECTOR:
....................          mode_flash_erase_4kbyte_subsector(content);
2D96:  MOVLB  0B
2D97:  MOVF   23,W
2D98:  MOVWF  26
2D99:  MOVF   22,W
2D9A:  MOVWF  25
2D9B:  MOVLP  18
2D9C:  MOVLB  00
2D9D:  GOTO   694
2D9E:  MOVLP  28
....................          break;
2D9F:  GOTO   5ED
....................       case ID_FALSH_WRITE_DEMO:
....................          mode_flash_write_demo(content);
2DA0:  MOVLB  0B
2DA1:  MOVF   23,W
2DA2:  MOVWF  26
2DA3:  MOVF   22,W
2DA4:  MOVWF  25
2DA5:  MOVLP  20
2DA6:  MOVLB  00
2DA7:  GOTO   000
2DA8:  MOVLP  28
....................          break;
2DA9:  GOTO   5ED
....................       case ID_FLASH_4kByte_SUBSECTOR:
....................          mode_flash_write_4kbyte_subsecotr(content);
2DAA:  MOVLB  0B
2DAB:  MOVF   23,W
2DAC:  MOVWF  26
2DAD:  MOVF   22,W
2DAE:  MOVWF  25
2DAF:  MOVLP  20
2DB0:  MOVLB  00
2DB1:  GOTO   214
2DB2:  MOVLP  28
....................          break;
2DB3:  GOTO   5ED
....................       case ID_FLASH_READ:
....................          mode_flash_read(content);
2DB4:  MOVLB  0B
2DB5:  MOVF   23,W
2DB6:  MOVWF  26
2DB7:  MOVF   22,W
2DB8:  MOVWF  25
2DB9:  MOVLP  20
2DBA:  MOVLB  00
2DBB:  GOTO   393
2DBC:  MOVLP  28
....................          break;
2DBD:  GOTO   5ED
....................       case ID_FLASH_READ_ADDRESS:
....................          mode_flash_read_address(content);
2DBE:  MOVLB  0B
2DBF:  MOVF   23,W
2DC0:  MOVWF  26
2DC1:  MOVF   22,W
2DC2:  MOVWF  25
2DC3:  MOVLP  20
2DC4:  MOVLB  00
2DC5:  GOTO   60C
2DC6:  MOVLP  28
....................          break;
2DC7:  GOTO   5ED
....................       case ID_FLASH_SMF_COPY:
....................          mode_flash_smf_copy(content);
2DC8:  MOVLB  0B
2DC9:  MOVF   23,W
2DCA:  MOVWF  26
2DCB:  MOVF   22,W
2DCC:  MOVWF  25
2DCD:  MOVLP  20
2DCE:  MOVLB  00
2DCF:  GOTO   6BE
2DD0:  MOVLP  28
....................          break;
2DD1:  GOTO   5ED
....................       case ID_FLASH_ADDRESS_RESET:
....................          mode_flash_address_reset(content);
2DD2:  MOVLB  0B
2DD3:  MOVF   23,W
2DD4:  MOVWF  26
2DD5:  MOVF   22,W
2DD6:  MOVWF  25
2DD7:  MOVLP  20
2DD8:  MOVLB  00
2DD9:  GOTO   75C
2DDA:  MOVLP  28
....................          break;
2DDB:  GOTO   5ED
....................       case 0x71: // example command
....................          mode_iv_meas_adc();
2DDC:  CALL   3C8
....................          break;
2DDD:  GOTO   5ED
....................       case 0x72: // example command
....................          mode_iv_meas_adc();
2DDE:  CALL   3C8
....................          break;
2DDF:  GOTO   5ED
....................       case 0x73: // example command
....................          mode_iv_meas_adc();
2DE0:  CALL   3C8
....................          break;
2DE1:  GOTO   5ED
.................... 
....................       case 0x70: // example command
....................          mode_iv_meas_adc();
2DE2:  CALL   3C8
....................          break;
2DE3:  GOTO   5ED
....................       default:
....................          fprintf(PC, "\t\t-> Invalid CMD ID!\r\n");
2DE4:  MOVLW  59
2DE5:  MOVLB  03
2DE6:  MOVWF  11
2DE7:  MOVLW  07
2DE8:  MOVWF  12
2DE9:  MOVLP  08
2DEA:  MOVLB  00
2DEB:  CALL   0CC
2DEC:  MOVLP  28
....................    }
....................    fprintf(PC, "\r\n______End execute_mission______\r\n_______________________________\r\n");
2DED:  MOVLW  65
2DEE:  MOVLB  03
2DEF:  MOVWF  11
2DF0:  MOVLW  07
2DF1:  MOVWF  12
2DF2:  MOVLP  08
2DF3:  MOVLB  00
2DF4:  CALL   0CC
2DF5:  MOVLP  28
2DF6:  MOVLP  28
2DF7:  GOTO   61E (RETURN)
.................... }
.................... 
.................... 
.................... #separate
.................... int1 execute_command(Command *command)
.................... {
....................    fprintf(PC, "Start execute_command\r\n");
*
3BE9:  MOVLW  88
3BEA:  MOVLB  03
3BEB:  MOVWF  11
3BEC:  MOVLW  07
3BED:  MOVWF  12
3BEE:  MOVLP  08
3BEF:  MOVLB  00
3BF0:  CALL   0CC
3BF1:  MOVLP  38
....................    
....................    switch(command->frame_id)
3BF2:  MOVLB  0A
3BF3:  MOVF   6B,W
3BF4:  MOVWF  04
3BF5:  MOVF   6C,W
3BF6:  MOVWF  05
3BF7:  ADDFSR 00,FSR0
3BF8:  MOVF   00,W
3BF9:  XORLW  00
3BFA:  MOVLB  00
3BFB:  BTFSC  03.2
3BFC:  GOTO   404
3BFD:  XORLW  01
3BFE:  BTFSC  03.2
3BFF:  GOTO   40E
3C00:  XORLW  03
3C01:  BTFSC  03.2
3C02:  GOTO   41E
3C03:  GOTO   427
....................    {
....................       case UPLINK_COMMAND:
....................          handle_uplink_command(command);
3C04:  MOVLB  0A
3C05:  MOVF   6C,W
3C06:  MOVWF  6E
3C07:  MOVF   6B,W
3C08:  MOVWF  6D
3C09:  MOVLP  28
3C0A:  MOVLB  00
3C0B:  GOTO   5F8
3C0C:  MOVLP  38
....................          break;
3C0D:  GOTO   427
....................       
....................       case STATUS_CHECK:
....................          if (handle_status_check(command)){
3C0E:  MOVLB  0A
3C0F:  MOVF   6C,W
3C10:  MOVWF  6E
3C11:  MOVF   6B,W
3C12:  MOVWF  6D
3C13:  MOVLP  28
3C14:  MOVLB  00
3C15:  GOTO   63A
3C16:  MOVLP  38
3C17:  MOVF   78,F
3C18:  BTFSC  03.2
3C19:  GOTO   41D
....................             return TRUE; // if status is finished, return TRUE
3C1A:  MOVLW  01
3C1B:  MOVWF  78
3C1C:  GOTO   429
....................          }        
....................          break;
3C1D:  GOTO   427
....................       
....................       case IS_SMF_AVAILABLE:
....................          handle_smf_available(command);
3C1E:  MOVLB  0A
3C1F:  MOVF   6C,W
3C20:  MOVWF  6E
3C21:  MOVF   6B,W
3C22:  MOVWF  6D
3C23:  MOVLP  30
3C24:  MOVLB  00
3C25:  GOTO   7A0
3C26:  MOVLP  38
....................          break;
....................    }
....................    return FALSE;
3C27:  MOVLW  00
3C28:  MOVWF  78
3C29:  MOVLP  38
3C2A:  GOTO   546 (RETURN)
.................... }
.................... 
.................... 
.................... #Separate
.................... void handle_uplink_command(Command *command) {
....................    fprintf(PC, "\t-> Uplink command\r\n");
*
2DF8:  MOVLW  94
2DF9:  MOVLB  03
2DFA:  MOVWF  11
2DFB:  MOVLW  07
2DFC:  MOVWF  12
2DFD:  MOVLP  08
2DFE:  MOVLB  00
2DFF:  CALL   0CC
2E00:  MOVLP  28
....................    fprintf(PC, "\t   Transmit Acknolegde\r\n");
2E01:  MOVLW  9F
2E02:  MOVLB  03
2E03:  MOVWF  11
2E04:  MOVLW  07
2E05:  MOVWF  12
2E06:  MOVLP  08
2E07:  MOVLB  00
2E08:  CALL   0CC
2E09:  MOVLP  28
....................    transmit_ack();
2E0A:  MOVLP  08
2E0B:  CALL   7DE
2E0C:  MOVLP  28
.................... 
....................    status[0] = EXECUTING_MISSION;
2E0D:  MOVLW  02
2E0E:  MOVWF  29
....................    execute_mission(command->content);
2E0F:  MOVLW  03
2E10:  MOVLB  0A
2E11:  ADDWF  6D,W
2E12:  MOVLB  0B
2E13:  MOVWF  20
2E14:  MOVLW  00
2E15:  MOVLB  0A
2E16:  ADDWFC 6E,W
2E17:  MOVLB  0B
2E18:  MOVWF  21
2E19:  MOVWF  23
2E1A:  MOVF   20,W
2E1B:  MOVWF  22
2E1C:  MOVLB  00
2E1D:  GOTO   507
....................    if (is_empty_smf_data())
2E1E:  MOVLP  20
2E1F:  CALL   7F3
2E20:  MOVLP  28
2E21:  MOVF   78,F
2E22:  BTFSC  03.2
2E23:  GOTO   627
....................       status[0] = FINISHED;
2E24:  MOVLW  06
2E25:  MOVWF  29
2E26:  GOTO   629
....................    else
....................       status[0] = SMF_USE_REQ;
2E27:  MOVLW  04
2E28:  MOVWF  29
2E29:  MOVLP  38
2E2A:  GOTO   427 (RETURN)
.................... 
....................    //return TRUE; // TRUE
....................    
.................... }
.................... 
.................... #Separate
.................... int1 handle_status_check(Command *command) {
....................    fprintf(PC, "\t-> Status check\r\n");
*
2E3A:  MOVLW  AC
2E3B:  MOVLB  03
2E3C:  MOVWF  11
2E3D:  MOVLW  07
2E3E:  MOVWF  12
2E3F:  MOVLP  08
2E40:  MOVLB  00
2E41:  CALL   0CC
2E42:  MOVLP  28
....................    fprintf(PC, "\t   Transmit MIS MCU Status\r\n");
2E43:  MOVLW  B6
2E44:  MOVLB  03
2E45:  MOVWF  11
2E46:  MOVLW  07
2E47:  MOVWF  12
2E48:  MOVLP  08
2E49:  MOVLB  00
2E4A:  CALL   0CC
2E4B:  MOVLP  28
....................    transmit_status();
2E4C:  GOTO   62B
....................    if (status[0] == FINISHED)
2E4D:  MOVF   29,W
2E4E:  SUBLW  06
2E4F:  BTFSS  03.2
2E50:  GOTO   65E
....................    {
....................       fprintf(PC, "finished in status_check\r\n");
2E51:  MOVLW  C5
2E52:  MOVLB  03
2E53:  MOVWF  11
2E54:  MOVLW  07
2E55:  MOVWF  12
2E56:  MOVLP  08
2E57:  MOVLB  00
2E58:  CALL   0CC
2E59:  MOVLP  28
....................       return TRUE;
2E5A:  MOVLW  01
2E5B:  MOVWF  78
2E5C:  GOTO   660
....................    }
2E5D:  GOTO   660
....................    else{
....................       return FALSE;
2E5E:  MOVLW  00
2E5F:  MOVWF  78
....................    }
2E60:  MOVLP  38
2E61:  GOTO   416 (RETURN)
.................... 
.................... }
.................... 
.................... #Separate
.................... void handle_smf_available(Command *command) {
....................     fprintf(PC, "\t-> SMF available check\r\n");
*
37A0:  MOVLW  D3
37A1:  MOVLB  03
37A2:  MOVWF  11
37A3:  MOVLW  07
37A4:  MOVWF  12
37A5:  MOVLP  08
37A6:  MOVLB  00
37A7:  CALL   0CC
37A8:  MOVLP  30
....................     fprintf(PC, "\t   Transmit Acknolegde\r\n");
37A9:  MOVLW  E0
37AA:  MOVLB  03
37AB:  MOVWF  11
37AC:  MOVLW  07
37AD:  MOVWF  12
37AE:  MOVLP  08
37AF:  MOVLB  00
37B0:  CALL   0CC
37B1:  MOVLP  30
....................     transmit_ack();
37B2:  MOVLP  08
37B3:  CALL   7DE
37B4:  MOVLP  30
....................     
....................     if (command->content[0] == ALLOW) {
37B5:  MOVLB  0A
37B6:  MOVF   6D,W
37B7:  MOVWF  04
37B8:  MOVF   6E,W
37B9:  MOVWF  05
37BA:  ADDFSR 03,FSR0
37BB:  MOVF   00,F
37BC:  BTFSS  03.2
37BD:  GOTO   7CE
....................         fprintf(PC, "\t\t-> allowd\r\n");
37BE:  MOVLW  ED
37BF:  MOVLB  03
37C0:  MOVWF  11
37C1:  MOVLW  07
37C2:  MOVWF  12
37C3:  MOVLP  08
37C4:  MOVLB  00
37C5:  CALL   0CC
37C6:  MOVLP  30
....................         status[0] = COPYING;
37C7:  MOVLW  05
37C8:  MOVWF  29
....................         copy_data();
37C9:  GOTO   63D
....................         status[0] = FINISHED;
37CA:  MOVLW  06
37CB:  MOVWF  29
....................     } else {
37CC:  GOTO   7D7
37CD:  MOVLB  0A
....................         fprintf(PC, "\t\t-> denyed\r\n");
37CE:  MOVLW  F4
37CF:  MOVLB  03
37D0:  MOVWF  11
37D1:  MOVLW  07
37D2:  MOVWF  12
37D3:  MOVLP  08
37D4:  MOVLB  00
37D5:  CALL   0CC
37D6:  MOVLP  30
....................     }
37D7:  MOVLP  38
37D8:  GOTO   427 (RETURN)
.................... }
.................... 
.................... 
.................... #endif
.................... //------------------End of File------------------
.................... 
.................... 
.................... #include "mmj_cigs_piclog.h"
.................... #ifndef     MMJ_CIGS_PICLOG_H
.................... #define     MMJ_CIGS_PICLOG_H
.................... 
.................... #define PICLOG_PACKET_SIZE 6
.................... unsigned int8 PICLOG_STARTUP = 0x00;
.................... 
.................... // PICLOG Parameter
.................... #define PICLOG_PARAM_START 0x01
.................... #define PICLOG_PARAM_END 0x02
.................... 
.................... 
.................... // PICLOG
.................... typedef union {
....................     struct {
....................         unsigned int32  time;
....................         unsigned int8   function;
....................         unsigned int8   parameter;
....................     };
....................     unsigned int8 bytes[PICLOG_PACKET_SIZE];  
.................... } PICLOG;
.................... 
.................... // extern.c
.................... #define PICLOG_BLANK_SIZE 4 // PICLOG
.................... unsigned int8 PICLOG_BLANK_DATA[PICLOG_BLANK_SIZE] = {0x00, 0x00, 0x00, 0x00}; // PICLOG
.................... void piclog_make(unsigned int8 function, unsigned int8 parameter);
.................... void piclog_write(unsigned int8 *data);
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_piclog.c"
.................... 
.................... #endif // MMJ_CIGS_PICLOG_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... #include "mmj_cigs_func.h"
.................... #ifndef MMJ_CIGS_FUNC_H
.................... #define MMJ_CIGS_FUNC_H
.................... 
.................... /*
.................... // _________ values _________
.................... #define MISSION_DATA_SIZE 64
.................... volatile unsigned int8 mission_datas[MISSION_DATA_SIZE] = {0x00};
.................... volatile int8 executed_mission_count = 0;
.................... */
.................... 
.................... #define START_MAKER 0xFF
.................... #define RESERVED_VALUE 0x00
.................... 
.................... 
.................... 
.................... // _________ values ____________
.................... 
.................... 
.................... // _________ functions ____________
.................... #define DATA_BUFFER_SIZE 150
.................... #define HEADER_SIZE 12
.................... volatile unsigned int16 data_buffer [DATA_BUFFER_SIZE*2] = {0x00} ;
.................... volatile unsigned int32 measured_time = 0 ;
.................... volatile unsigned int16 measured_open_voltage = 0 ;
.................... volatile unsigned int16 measured_pd = 0 ;
.................... volatile unsigned int16 measured_temp_top = 0 ;
.................... volatile unsigned int16 measured_temp_bot = 0 ;     
.................... 
.................... 
.................... void make_meas_header(unsigned int8 *packetdata, unsigned int8 *cmd);
.................... 
.................... #separate
.................... void sweep(unsigned int8 parameter[]);
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_func.c"
.................... 
.................... #endif
.................... //------------------End of File------------------
.................... 
.................... 
.................... #include "mmj_cigs_flash.h"
.................... #ifndef  MMJ_CIGS_FLASH_H
.................... #define  MMJ_CIGS_FLASH_H
.................... 
.................... 
.................... 
.................... 
.................... // MIS_FM Function
.................... void misf_init(void);
.................... void update_misf_data_header(void);
.................... void write_misf_address_area(void);
.................... 
.................... 
.................... 
.................... #define PACKET_SIZE 64
.................... #define MISF_DATA_HEADER_SIZE 64 // MISF
.................... #define MISF_PICLOG_MAX_COUNT 60
.................... 
.................... 
.................... 
.................... 
.................... // __________MISF-ADDRESS__________
.................... #define ADDRESS_MISF_START              0x000000
.................... #define ADDRESS_MISF_END                0xF42400
.................... #define ADDRESS_MANEGE_START            0x000000
.................... #define ADDRESS_MANEGE_END              0x00FFFF
.................... #define ADDRESS_MISF_PICLOG_INDEX_START 0x010000
.................... #define ADDRESS_MISF_PICLOG_INDEX_END   0x01FFFF
.................... #define ADDRESS_MISF_PICLOG_DATA_START  0x020000
.................... #define ADDRESS_MISF_PICLOG_DATA_END    0x15FFFF
.................... #define ADDRESS_MISF_MEASUREMENT_START  0x160000
.................... #define ADDRESS_MISF_MEASUREMENT_END    0x95FFFF
.................... 
.................... //
.................... #define SECTOR_64K_BYTE 0x10000 // 64KByte
.................... #define SECTOR_32K_BYTE 0x8000  // 32KByte
.................... #define SECTOR_4K_BYTE  0x1000  // 4KByte
.................... 
.................... // Counter
.................... unsigned int32  smf_piclog_use_counter;
.................... unsigned int8   smf_piclog_loop_counter;
.................... unsigned int32  smf_meas_use_counter;
.................... unsigned int8   smf_meas_loop_counter;
.................... 
.................... unsigned int32  misf_piclog_use_counter;
.................... unsigned int8   misf_piclog_loop_counter;
.................... unsigned int32  misf_piclog_uncopyed_counter;
.................... unsigned int8   misf_piclog_write_counter;
.................... unsigned int32  misf_meas_use_counter;
.................... unsigned int8   misf_meas_loop_counter;
.................... unsigned int32  misf_meas_uncopyed_counter;
.................... 
.................... 
.................... #define DATA_HEADER_SIZE 64 
.................... 
.................... 
.................... 
.................... 
.................... // ___________SMF-ADDRESS___________
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... 
.................... #include "src/mmj_cigs_flash.c"
.................... 
.................... #endif // MMJ_CIGS_FLASH_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... #include "lib/ad7490.h"
.................... #ifndef     AD7490_H
.................... #define     AD7490_H
.................... 
.................... #ifdef AD7490_DEBUG
....................    #define DEBUG_PORT PC
.................... #endif
.................... 
.................... typedef struct AD7490_STREAM
.................... {
....................     int8 spi_stream; // SPI stream number
....................     int16 cs_pin;    // Chip Select pin number
.................... };
.................... //0x8B30
.................... 
.................... 
.................... 
.................... typedef union AD7490_RESISTOR
.................... {
....................     unsigned int16 value; // 16-bit value for direct access
....................     struct fields
....................     {
....................         unsigned int blank3 :1 ; // bit 0 (LSB)
....................         unsigned int blank2 :1   ; // bit 1
....................         unsigned int blank1 :1   ; // bit 2
....................         unsigned int blank0 :1   ; // bit 3
....................         unsigned int coding:1       ; // bit 12
....................         unsigned int range   :1    ; // bit 5
....................         unsigned int weak_tri:1     ; // bit 4
....................         unsigned int shadow:1   ; // bit 13
....................         unsigned int write:1    ; // bit 15 (MSB)
....................         unsigned int seq :1     ; // bit 14
....................         unsigned int add3 :1    ; // bit 11
....................         unsigned int add2  :1   ; // bit 10
....................         unsigned int add1   :1  ; // bit 9
....................         unsigned int add0    :1 ; // bit 8
....................         unsigned int pm1    :1  ; // bit 7
....................         unsigned int pm0     :1 ; // bit 6
....................     } fields;
.................... } AD7490_RESISTOR;
.................... 
.................... unsigned int8 coding; // 1: Two's complement, 0: Binary
.................... unsigned int8 write;  // 1: Write operation, 0: Read operation
.................... unsigned int8 seq;    // 1: Sequential mode, 0: Random mode
.................... unsigned int8 range; // 1: Range mode, 0: Normal mode
.................... unsigned int8 weak_tri; // 1: Weak trigger, 0: Strong trigger
.................... unsigned int8 shadow; // 1: Shadow register, 0: Direct access
.................... unsigned int16 ad7490_readdata(unsigned int16 channel);
.................... //AD7490_RESISTOR reg;
.................... 
.................... AD7490_RESISTOR reg = {0}; // Initialize the AD7490_RESISTOR union
.................... 
.................... // Public Function 
.................... void ad7490_init(void);
.................... unsigned int16 ad7490_read(int8 channel);
.................... 
.................... unsigned int16 ad7490_make_cmd(int8 channel);
.................... 
.................... // Private Functions
.................... void set_add(int8 channel);
.................... void set_pm(int8 powermode);
.................... void print_bits(unsigned int16 data);
.................... // Resistor Settings
.................... #define AD7490_EN_WRITE 0b1
.................... 
.................... // Power Mode Register
.................... #define AD7490_PM_NORMAL 0b00000000
.................... #define AD7490_PM_SHUTDOWN 0b00000001
.................... #define AD7490_PM_AUTO_SHUTDOWN 0b00000010
.................... #define AD7490_PM_AUTO_STANDBY 0b00000011
.................... 
.................... 
.................... // ADC Channel Register
.................... #define AD7490_VIN0 0b0000
.................... #define AD7490_VIN1 0b0001
.................... #define AD7490_VIN2 0b0010
.................... #define AD7490_VIN3 0b0011
.................... #define AD7490_VIN4 0b0100
.................... #define AD7490_VIN5 0b0101
.................... #define AD7490_VIN6 0b0110
.................... #define AD7490_VIN7 0b0111
.................... #define AD7490_VIN8 0b1000
.................... #define AD7490_VIN9 0b1001
.................... #define AD7490_VIN10 0b1010
.................... #define AD7490_VIN11 0b1011
.................... #define AD7490_VIN12 0b1100
.................... #define AD7490_VIN13 0b1101
.................... #define AD7490_VIN14 0b1110
.................... #define AD7490_VIN15 0b1111
.................... 
.................... 
.................... #include "src/ad7490.c"
.................... 
.................... #endif // AD7490_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... #endif // MMJ_CIGS_MAIN_H
.................... //------------------End of File------------------
.................... 
.................... 
.................... void main()
*
3C2B:  MOVLB  03
3C2C:  BSF    1F.3
3C2D:  MOVLW  A0
3C2E:  MOVWF  1B
3C2F:  MOVLW  01
3C30:  MOVWF  1C
3C31:  MOVLW  A6
3C32:  MOVWF  1E
3C33:  MOVLW  90
3C34:  MOVWF  1D
3C35:  MOVLB  01
3C36:  BCF    0D.4
3C37:  MOVLB  02
3C38:  BSF    0D.4
3C39:  MOVLB  04
3C3A:  BCF    15.5
3C3B:  MOVLW  40
3C3C:  MOVWF  14
3C3D:  MOVLW  09
3C3E:  MOVWF  12
3C3F:  MOVLW  2A
3C40:  MOVWF  15
3C41:  MOVLB  02
3C42:  BCF    1D.5
3C43:  BCF    1D.3
3C44:  BCF    1D.4
3C45:  MOVLB  01
3C46:  BCF    0E.5
3C47:  BSF    0E.4
3C48:  BCF    0E.3
3C49:  MOVLB  00
3C4A:  BCF    28.0
3C4B:  CLRF   30
3C4C:  CLRF   2F
3C4D:  CLRF   2E
3C4E:  CLRF   2D
3C4F:  CLRF   34
3C50:  CLRF   33
3C51:  CLRF   32
3C52:  CLRF   31
3C53:  CLRF   36
3C54:  CLRF   35
3C55:  CLRF   38
3C56:  CLRF   37
3C57:  CLRF   59
3C58:  MOVLB  08
3C59:  CLRF   35
3C5A:  CLRF   34
3C5B:  CLRF   33
3C5C:  CLRF   32
3C5D:  CLRF   37
3C5E:  CLRF   36
3C5F:  CLRF   39
3C60:  CLRF   38
3C61:  CLRF   3B
3C62:  CLRF   3A
3C63:  CLRF   3D
3C64:  CLRF   3C
3C65:  CLRF   70
3C66:  MOVLW  1E
3C67:  MOVLB  0A
3C68:  MOVWF  5D
3C69:  MOVLB  03
3C6A:  CLRF   0C
3C6B:  CLRF   0D
3C6C:  CLRF   0E
3C6D:  CLRF   0F
3C6E:  CLRF   10
3C6F:  MOVLB  02
3C70:  CLRF   12
3C71:  CLRF   11
3C72:  GOTO   4A9
3C73:  DATA 04,34
3C74:  DATA 20,34
3C75:  DATA 09,34
3C76:  DATA 03,34
3C77:  DATA 00,34
3C78:  DATA 00,34
3C79:  DATA 00,34
3C7A:  DATA 20,34
3C7B:  DATA 60,34
3C7C:  DATA 19,34
3C7D:  DATA 00,34
3C7E:  DATA FF,34
3C7F:  DATA 60,34
3C80:  DATA 3A,34
3C81:  DATA 00,34
3C82:  DATA FF,34
3C83:  DATA C0,34
3C84:  DATA 00,34
3C85:  DATA 5A,34
3C86:  DATA C0,34
3C87:  DATA 00,34
3C88:  DATA 04,34
3C89:  DATA 22,34
3C8A:  DATA 9E,34
3C8B:  DATA 00,34
3C8C:  DATA 00,34
3C8D:  DATA 00,34
3C8E:  DATA 00,34
3C8F:  DATA 08,34
3C90:  DATA 22,34
3C91:  DATA BA,34
3C92:  DATA 00,34
3C93:  DATA 00,34
3C94:  DATA 7B,34
3C95:  DATA 00,34
3C96:  DATA 01,34
3C97:  DATA 01,34
3C98:  DATA 79,34
3C99:  DATA 00,34
3C9A:  DATA 08,34
3C9B:  DATA 22,34
3C9C:  DATA C3,34
3C9D:  DATA 00,34
3C9E:  DATA 00,34
3C9F:  DATA 00,34
3CA0:  DATA 09,34
3CA1:  DATA 01,34
3CA2:  DATA 00,34
3CA3:  DATA 02,34
3CA4:  DATA 01,34
3CA5:  DATA 92,34
3CA6:  DATA C0,34
3CA7:  DATA 00,34
3CA8:  DATA 00,34
3CA9:  MOVLW  3C
3CAA:  MOVWF  05
3CAB:  MOVLW  73
3CAC:  MOVWF  04
3CAD:  BSF    05.7
3CAE:  MOVIW  [FSR0++],W
3CAF:  MOVWF  77
3CB0:  XORLW  00
3CB1:  BTFSC  03.2
3CB2:  GOTO   4C3
3CB3:  MOVIW  [FSR0++],W
3CB4:  MOVWF  78
3CB5:  BTFSC  78.7
3CB6:  GOTO   4BB
3CB7:  ANDLW  3F
3CB8:  MOVWF  07
3CB9:  MOVIW  [FSR0++],W
3CBA:  MOVWF  06
3CBB:  BTFSC  78.6
3CBC:  MOVIW  [FSR0++],W
3CBD:  BTFSS  78.6
3CBE:  MOVIW  [FSR0++],W
3CBF:  MOVWI  W,[FSR1++]
3CC0:  DECFSZ 77,F
3CC1:  GOTO   4BD
3CC2:  GOTO   4AE
.................... { 
....................    fprintf(PC,"\r\n\r\n\r\n============================================================\r\n");
3CC3:  MOVLW  00
3CC4:  MOVLB  03
3CC5:  MOVWF  11
3CC6:  MOVLW  08
3CC7:  MOVWF  12
3CC8:  MOVLP  08
3CC9:  MOVLB  00
3CCA:  CALL   0CC
3CCB:  MOVLP  38
....................    fprintf(PC,"This is MOMIJI CIGS PIC BBM for MIS7_BBM1.\r\n");
3CCC:  MOVLW  23
3CCD:  MOVLB  03
3CCE:  MOVWF  11
3CCF:  MOVLW  08
3CD0:  MOVWF  12
3CD1:  MOVLP  08
3CD2:  MOVLB  00
3CD3:  CALL   0CC
3CD4:  MOVLP  38
....................    fprintf(PC,"Last updated on 2025/06/15, by Inoue.\r\n\r\n");  
3CD5:  MOVLW  3A
3CD6:  MOVLB  03
3CD7:  MOVWF  11
3CD8:  MOVLW  08
3CD9:  MOVWF  12
3CDA:  MOVLP  08
3CDB:  MOVLB  00
3CDC:  CALL   0CC
3CDD:  MOVLP  38
.................... 
....................    
....................    io_init();
3CDE:  MOVLP  08
3CDF:  GOTO   11A
3CE0:  MOVLP  38
....................    adc_init();
3CE1:  MOVLP  08
3CE2:  GOTO   132
3CE3:  MOVLP  38
....................    setup_uart_to_boss();
3CE4:  MOVLP  08
3CE5:  GOTO   15A
3CE6:  MOVLP  38
....................    setup_timer();
3CE7:  MOVLP  08
3CE8:  GOTO   16E
3CE9:  MOVLP  38
....................    ad7490_init();
3CEA:  MOVLP  08
3CEB:  GOTO   18B
3CEC:  MOVLP  38
....................    misf_init();
3CED:  MOVLP  08
3CEE:  CALL   497
3CEF:  MOVLP  38
....................    piclog_make(PICLOG_STARTUP,0x00);
3CF0:  MOVF   70,W
3CF1:  MOVLB  0E
3CF2:  MOVWF  3C
3CF3:  CLRF   3D
3CF4:  MOVLP  10
3CF5:  MOVLB  00
3CF6:  CALL   3A7
3CF7:  MOVLP  38
.................... 
....................    int1 is_finished = FALSE;
3CF8:  MOVLB  0A
3CF9:  BCF    5E.0
....................    fprintf(PC,"____CIGS PIC Start Operation_____\r\n\r\n");
3CFA:  MOVLW  4F
3CFB:  MOVLB  03
3CFC:  MOVWF  11
3CFD:  MOVLW  08
3CFE:  MOVWF  12
3CFF:  MOVLP  08
3D00:  MOVLB  00
3D01:  CALL   0CC
3D02:  MOVLP  38
....................    
....................    
....................    
....................    
....................    
....................    
....................    fprintf(PC,"waiting for BOSS PIC command");
3D03:  MOVLW  62
3D04:  MOVLB  03
3D05:  MOVWF  11
3D06:  MOVLW  08
3D07:  MOVWF  12
3D08:  MOVLP  08
3D09:  MOVLB  00
3D0A:  CALL   0CC
3D0B:  MOVLP  38
....................    
....................    //Start loop
....................    while(!is_finished)
3D0C:  MOVLB  0A
3D0D:  BTFSC  5E.0
3D0E:  GOTO   56B
....................    {
....................       // handle from boss commands
....................       if(boss_receive_buffer_size > 0)
3D0F:  MOVLB  00
3D10:  MOVF   59,F
3D11:  BTFSC  03.2
3D12:  GOTO   553
....................       {
....................          //Command command = make_command(boss_receive_buffer, boss_receive_buffer_size);
....................          volatile Command recieve_cmd = make_receive_command(boss_receive_buffer, boss_receive_buffer_size);
3D13:  MOVLW  20
3D14:  MOVLB  0B
3D15:  MOVWF  22
3D16:  MOVLW  19
3D17:  MOVWF  21
3D18:  MOVLB  00
3D19:  MOVF   59,W
3D1A:  MOVLB  0B
3D1B:  MOVWF  23
3D1C:  MOVLP  18
3D1D:  MOVLB  00
3D1E:  GOTO   000
3D1F:  MOVLP  38
3D20:  MOVF   79,W
3D21:  MOVWF  7A
3D22:  MOVF   78,W
3D23:  MOVWF  04
3D24:  MOVF   7A,W
3D25:  MOVWF  05
3D26:  MOVLW  0C
3D27:  MOVWF  78
3D28:  MOVLW  23
3D29:  MOVWF  07
3D2A:  MOVLW  5F
3D2B:  MOVWF  06
3D2C:  MOVIW  [FSR0++],W
3D2D:  MOVWI  W,[FSR1++]
3D2E:  DECFSZ 78,F
3D2F:  GOTO   52C
....................          /*
....................          fprintf(PC, "Frame ID: %X\r\n", recieve_cmd.frame_id);
....................          fprintf(PC, "Content size: %u\r\n", recieve_cmd.size);
....................          fprintf(PC, "payload: ");
....................          for(int8 i = 0; i < recieve_cmd.size; i++)
....................             fprintf(PC, "%X ", recieve_cmd.content[i]);
....................          fprintf(PC, "\r\n\r\n");
....................          fprintf(PC, "is_exist: %d\r\n", recieve_cmd.is_exist);
....................          */
....................          clear_receive_signal(boss_receive_buffer, &boss_receive_buffer_size);
3D30:  MOVLW  20
3D31:  MOVLB  0A
3D32:  MOVWF  6C
3D33:  MOVLW  19
3D34:  MOVWF  6B
3D35:  MOVLW  20
3D36:  MOVWF  6E
3D37:  MOVLW  39
3D38:  MOVWF  6D
3D39:  MOVLP  10
3D3A:  MOVLB  00
3D3B:  GOTO   653
3D3C:  MOVLP  38
....................          
....................          if(recieve_cmd.is_exist)
3D3D:  MOVLB  0A
3D3E:  BTFSS  61.0
3D3F:  GOTO   54A
....................             is_finished = execute_command(&recieve_cmd); 
3D40:  MOVLW  23
3D41:  MOVWF  6C
3D42:  MOVLW  5F
3D43:  MOVWF  6B
3D44:  MOVLB  00
3D45:  GOTO   3E9
3D46:  MOVLB  0A
3D47:  BCF    5E.0
3D48:  BTFSC  78.0
3D49:  BSF    5E.0
....................             fprintf(PC,"\r\nwaiting for BOSS PIC command");
3D4A:  MOVLW  71
3D4B:  MOVLB  03
3D4C:  MOVWF  11
3D4D:  MOVLW  08
3D4E:  MOVWF  12
3D4F:  MOVLP  08
3D50:  MOVLB  00
3D51:  CALL   0CC
3D52:  MOVLP  38
....................       }
....................       
....................       // check `is break while loop`
....................       if(is_finished == TRUE)
3D53:  MOVLB  0A
3D54:  BTFSC  5E.0
....................          break;
3D55:  GOTO   56B
....................          
....................       delay_ms(400);
3D56:  MOVLW  02
3D57:  MOVWF  6B
3D58:  MOVLW  C8
3D59:  MOVLB  0F
3D5A:  MOVWF  57
3D5B:  MOVLP  08
3D5C:  MOVLB  00
3D5D:  CALL   7AD
3D5E:  MOVLP  38
3D5F:  MOVLB  0A
3D60:  DECFSZ 6B,F
3D61:  GOTO   558
....................       //fprintf(PC,"0x%08LX\r\n", get_current_sec());
....................       fprintf(PC, ".");
3D62:  MOVLW  2E
3D63:  MOVLB  0F
3D64:  MOVWF  43
3D65:  MOVLP  08
3D66:  MOVLB  00
3D67:  CALL   0A7
3D68:  MOVLP  38
3D69:  GOTO   50C
3D6A:  MOVLB  0A
....................    }
....................    
....................    
....................    fprintf(PC, "\r\n\r\n======\r\n\r\nFinished process.\r\nWait for BOSS PIC turn off me");
3D6B:  MOVLW  81
3D6C:  MOVLB  03
3D6D:  MOVWF  11
3D6E:  MOVLW  08
3D6F:  MOVWF  12
3D70:  MOVLP  08
3D71:  MOVLB  00
3D72:  CALL   0CC
3D73:  MOVLP  38
....................    
....................    while (TRUE)
....................    {
....................       fprintf(PC, ".");
3D74:  MOVLW  2E
3D75:  MOVLB  0F
3D76:  MOVWF  43
3D77:  MOVLP  08
3D78:  MOVLB  00
3D79:  CALL   0A7
3D7A:  MOVLP  38
....................       delay_ms(1000);
3D7B:  MOVLW  04
3D7C:  MOVLB  0A
3D7D:  MOVWF  6B
3D7E:  MOVLW  FA
3D7F:  MOVLB  0F
3D80:  MOVWF  57
3D81:  MOVLP  08
3D82:  MOVLB  00
3D83:  CALL   7AD
3D84:  MOVLP  38
3D85:  MOVLB  0A
3D86:  DECFSZ 6B,F
3D87:  GOTO   57E
3D88:  MOVLB  00
3D89:  GOTO   574
....................    }
....................    
....................    fprintf(PC, "End main\r\n");
3D8A:  MOVLW  A1
3D8B:  MOVLB  03
3D8C:  MOVWF  11
3D8D:  MOVLW  08
3D8E:  MOVWF  12
3D8F:  MOVLP  08
3D90:  MOVLB  00
3D91:  CALL   0CC
3D92:  MOVLP  38
....................    
.................... }
.................... 
3D93:  SLEEP
.................... // Enf of files

Configuration Fuses:
   Word  1: 3F82   HS NOWDT PUT NOMCLR NOPROTECT NOCPD BROWNOUT NOCLKOUT IESO FCMEN
   Word  2: 1EFF   NOWRT NOVCAP PLL_SW STVREN BORV19 NOLPBOR NODEBUG NOLVP
